<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-111673440-1', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->


  
  <title>在我的世界</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="who,where,what">
<meta property="og:type" content="website">
<meta property="og:title" content="在我的世界">
<meta property="og:url" content="http://jimolonely.github.io/history/page/12/index.html">
<meta property="og:site_name" content="在我的世界">
<meta property="og:description" content="who,where,what">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="Jackpler">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="在我的世界" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 6.1.0"><link rel="stylesheet" href="/css/prism-atom-dark.css" type="text/css">
<link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"><script src="/js/prism.js"></script>
<script src="/js/prism-line-numbers.min.js"></script></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">在我的世界</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">home</a>
        
          <a class="main-nav-link" href="/archives">archives</a>
        
          <a class="main-nav-link" href="/about">about</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="搜索"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://jimolonely.github.io/history"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-java/010-concurrent-lock" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/10/02/java/010-concurrent-lock/" class="article-date">
  <time datetime="2018-10-02T11:15:53.000Z" itemprop="datePublished">2018-10-02</time>
</a>
      
  </div>
  <div class="article-inner">
    
      
        <header class="article-header">
          
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/10/02/java/010-concurrent-lock/">java并发-Lock</a>
    </h1>
  

        </header>
        
          <!-- <div class="article-entry" itemprop="articleBody">
      
        <p><a target="_blank" rel="noopener" href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/locks/package-summary.html">https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/locks/package-summary.html</a><br>java.util.concurrent.locks.Lock接口用作类似于synchronized块的线程同步机制。 新的锁定机制比同步块更灵活，提供更多选项。 Lock和synchronized块之间的主要区别如下 ：</p>
<ol>
<li><p>保证顺序 - 同步块不提供任何顺序保证，等待线程将被授予访问权限。 锁接口处理它。</p>
</li>
<li><p>无超时 - 如果未授予锁定，则同步块没有超时选项。 Lock接口提供了这样的选项。</p>
</li>
<li><p>单个方法 - 同步块必须完全包含在单个方法中，而锁定接口的方法lock（）和unlock（）可以在不同的方法中调用。</p>
</li>
</ol>
<h1 id="代码示例"><a href="#代码示例" class="headerlink" title="代码示例"></a>代码示例</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.sinrail.lock;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.ThreadLocalRandom;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.locks.Lock;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.locks.ReentrantLock;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * ReentrantLock 可重入锁，锁和同步比起来有以下不同：</span></span><br><span class="line"><span class="comment"> * 1.保证序列：同步不能保证序列执行，除非锁整个方法</span></span><br><span class="line"><span class="comment"> * 2.超时机制：同步也没有</span></span><br><span class="line"><span class="comment"> * 3.单一方法：同步只能用于一个方法，而lock可以在不同的方法中lock和unlock</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * 下面使用打印机的例子，一个打印任务必须执行完才能进行下一个，我们使用锁来保证顺序</span></span><br><span class="line"><span class="comment"> * &lt;/p&gt;</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> jimo</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2018/9/29 14:26</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LockDemo</span> &#123;</span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * 打印机</span></span><br><span class="line"><span class="comment">	 *</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@author</span> jimo</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@date</span> 2018/9/29 14:33</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Printer</span> &#123;</span><br><span class="line">		<span class="keyword">private</span> <span class="keyword">final</span> <span class="type">Lock</span> <span class="variable">lock</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ReentrantLock</span>();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">print</span><span class="params">()</span> &#123;</span><br><span class="line">			lock.lock();</span><br><span class="line">			<span class="keyword">try</span> &#123;</span><br><span class="line">				<span class="keyword">final</span> <span class="type">int</span> <span class="variable">duration</span> <span class="operator">=</span> ThreadLocalRandom.current().nextInt(<span class="number">1000</span>);</span><br><span class="line">				System.out.println(Thread.currentThread().getName() + <span class="string">&quot;: 打印花费时间：&quot;</span> + duration + <span class="string">&quot; ms&quot;</span>);</span><br><span class="line">				Thread.sleep(duration);</span><br><span class="line">			&#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">			&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">				System.out.println(Thread.currentThread().getName() + <span class="string">&quot;: 打印成功！&quot;</span>);</span><br><span class="line">				lock.unlock();</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">Task</span> <span class="keyword">extends</span> <span class="title class_">Thread</span> &#123;</span><br><span class="line">		<span class="keyword">private</span> Printer printer;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">public</span> <span class="title function_">Task</span><span class="params">(String name, Printer printer)</span> &#123;</span><br><span class="line">			<span class="built_in">super</span>(name);</span><br><span class="line">			<span class="built_in">this</span>.printer = printer;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="meta">@Override</span></span><br><span class="line">		<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">			System.out.println(Thread.currentThread().getName() + <span class="string">&quot;: 开始打印...&quot;</span>);</span><br><span class="line">			printer.print();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">		<span class="keyword">final</span> <span class="type">Printer</span> <span class="variable">printer</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Printer</span>();</span><br><span class="line"></span><br><span class="line">		<span class="keyword">new</span> <span class="title class_">Task</span>(<span class="string">&quot;task 1&quot;</span>, printer).start();</span><br><span class="line">		<span class="keyword">new</span> <span class="title class_">Task</span>(<span class="string">&quot;task 2&quot;</span>, printer).start();</span><br><span class="line">		<span class="keyword">new</span> <span class="title class_">Task</span>(<span class="string">&quot;task 3&quot;</span>, printer).start();</span><br><span class="line">		<span class="keyword">new</span> <span class="title class_">Task</span>(<span class="string">&quot;task 4&quot;</span>, printer).start();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>结果：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">task <span class="number">2</span>: 开始打印...</span><br><span class="line">task <span class="number">1</span>: 开始打印...</span><br><span class="line">task <span class="number">3</span>: 开始打印...</span><br><span class="line">task <span class="number">4</span>: 开始打印...</span><br><span class="line">task <span class="number">2</span>: 打印花费时间：<span class="number">641</span> ms</span><br><span class="line">task <span class="number">2</span>: 打印成功！</span><br><span class="line">task <span class="number">1</span>: 打印花费时间：<span class="number">662</span> ms</span><br><span class="line">task <span class="number">1</span>: 打印成功！</span><br><span class="line">task <span class="number">3</span>: 打印花费时间：<span class="number">590</span> ms</span><br><span class="line">task <span class="number">3</span>: 打印成功！</span><br><span class="line">task <span class="number">4</span>: 打印花费时间：<span class="number">481</span> ms</span><br><span class="line">task <span class="number">4</span>: 打印成功！</span><br></pre></td></tr></table></figure>

<p>假如没有锁，代码这样写：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 没有锁时</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">print</span><span class="params">()</span> &#123;</span><br><span class="line">	<span class="keyword">try</span> &#123;</span><br><span class="line">		<span class="keyword">final</span> <span class="type">int</span> <span class="variable">duration</span> <span class="operator">=</span> ThreadLocalRandom.current().nextInt(<span class="number">1000</span>);</span><br><span class="line">		System.out.println(Thread.currentThread().getName() + <span class="string">&quot;: 打印花费时间：&quot;</span> + duration + <span class="string">&quot; ms&quot;</span>);</span><br><span class="line">		Thread.sleep(duration);</span><br><span class="line">		System.out.println(Thread.currentThread().getName() + <span class="string">&quot;: 打印成功！&quot;</span>);</span><br><span class="line">	&#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>则得到的结果将不是顺序的：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">task <span class="number">2</span>: 开始打印...</span><br><span class="line">task <span class="number">1</span>: 开始打印...</span><br><span class="line">task <span class="number">3</span>: 开始打印...</span><br><span class="line">task <span class="number">4</span>: 开始打印...</span><br><span class="line">task <span class="number">2</span>: 打印花费时间：<span class="number">58</span> ms</span><br><span class="line">task <span class="number">1</span>: 打印花费时间：<span class="number">38</span> ms</span><br><span class="line">task <span class="number">4</span>: 打印花费时间：<span class="number">532</span> ms</span><br><span class="line">task <span class="number">3</span>: 打印花费时间：<span class="number">849</span> ms</span><br><span class="line">task <span class="number">1</span>: 打印成功！</span><br><span class="line">task <span class="number">2</span>: 打印成功！</span><br><span class="line">task <span class="number">4</span>: 打印成功！</span><br><span class="line">task <span class="number">3</span>: 打印成功！</span><br></pre></td></tr></table></figure>

      
    </div> -->
          <div class="article-entry" itemprop="articleBody">
            
              
                
                      
                        
                          
                            
                              
                                
                                  
                                    <p>
                                      <p><a target="_blank" rel="noopener" href="https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/locks/package-summary.html">https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/locks/package-summary.html</a><br>java.util.concurrent.locks.Lock接口用作类似于synchronized块的线程同步机制。 新的锁定机制比同步块更灵活，提供更多选项。 Lock和synchronized块之间的主要区别如下 ：</p>

                                        <p>
                                          
                                            
                                              
                                                      
          </div>
    <p class="article-more-link">
      <a href="/2018/10/02/java/010-concurrent-lock/#more">
        Read More
      </a>
    </p>
    <!-- <div class="article-more-link">
      <a href="/2018/10/02/java/010-concurrent-lock/#more">
        read more
      </a>
    </div> -->
    


      <footer class="article-footer">
        <a data-url="http://jimolonely.github.io/history/2018/10/02/java/010-concurrent-lock/" data-id="cl1fw7fks008zvkd36fqa0ia0" class="article-share-link">
          Share
        </a>
        
            
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/java/" rel="tag">java</a><span class="article-tag-list-count">104</span></li></ul>

      </footer>
      </div>
      
</article>


  
    <article id="post-java/009-concurent-tool-class" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/10/01/java/009-concurent-tool-class/" class="article-date">
  <time datetime="2018-10-01T13:46:42.000Z" itemprop="datePublished">2018-10-01</time>
</a>
      
  </div>
  <div class="article-inner">
    
      
        <header class="article-header">
          
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/10/01/java/009-concurent-tool-class/">java并发-工具类</a>
    </h1>
  

        </header>
        
          <!-- <div class="article-entry" itemprop="articleBody">
      
        <h1 id="ThreadLocal"><a href="#ThreadLocal" class="headerlink" title="ThreadLocal"></a>ThreadLocal</h1><p>看代码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.Random;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ThreadLocal变量是每个线程独有的变量，也就是只能由同一个线程修改获取，相当于每个线程都有一份拷贝</span></span><br><span class="line"><span class="comment"> * 下面的代码为了证明每个线程可以独自修改自己的ThreadLocal变量，相互不影响</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> jimo</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2018/9/29 14:02</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ThreadLocalDemo</span> &#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> InterruptedException &#123;</span><br><span class="line">		<span class="keyword">final</span> <span class="type">Thread</span> <span class="variable">t1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Thread</span>(<span class="keyword">new</span> <span class="title class_">RandomCounter</span>(<span class="string">&quot;线程1&quot;</span>));</span><br><span class="line">		<span class="keyword">final</span> <span class="type">Thread</span> <span class="variable">t2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Thread</span>(<span class="keyword">new</span> <span class="title class_">RandomCounter</span>(<span class="string">&quot;线程2&quot;</span>));</span><br><span class="line">		<span class="keyword">final</span> <span class="type">Thread</span> <span class="variable">t3</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Thread</span>(<span class="keyword">new</span> <span class="title class_">RandomCounter</span>(<span class="string">&quot;线程3&quot;</span>));</span><br><span class="line"></span><br><span class="line">		t1.start();</span><br><span class="line">		t2.start();</span><br><span class="line">		t3.start();</span><br><span class="line"></span><br><span class="line">		t1.join();</span><br><span class="line">		t2.join();</span><br><span class="line">		t3.join();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">RandomCounter</span> <span class="keyword">implements</span> <span class="title class_">Runnable</span> &#123;</span><br><span class="line">		<span class="keyword">private</span> <span class="keyword">final</span> ThreadLocal&lt;Integer&gt; integerThreadLocal = <span class="keyword">new</span> <span class="title class_">ThreadLocal</span>&lt;&gt;();</span><br><span class="line">		<span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">		RandomCounter(String name) &#123;</span><br><span class="line">			<span class="built_in">this</span>.name = name;</span><br><span class="line">			Thread.currentThread().setName(name);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="meta">@Override</span></span><br><span class="line">		<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">			<span class="keyword">final</span> <span class="type">Random</span> <span class="variable">random</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Random</span>();</span><br><span class="line">			<span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">3</span>; i++) &#123;</span><br><span class="line"></span><br><span class="line">				integerThreadLocal.set(random.nextInt(<span class="number">1000</span>));</span><br><span class="line">				System.out.println(name + <span class="string">&quot;: 当前local值为：&quot;</span> + integerThreadLocal.get());</span><br><span class="line">				integerThreadLocal.remove();</span><br><span class="line">				<span class="keyword">try</span> &#123;</span><br><span class="line">					Thread.sleep(<span class="number">1000</span>);</span><br><span class="line">				&#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">					e.printStackTrace();</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行的一个结果：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">线程<span class="number">2</span>: 当前local值为：<span class="number">940</span></span><br><span class="line">线程<span class="number">3</span>: 当前local值为：<span class="number">789</span></span><br><span class="line">线程<span class="number">1</span>: 当前local值为：<span class="number">202</span></span><br><span class="line">线程<span class="number">1</span>: 当前local值为：<span class="number">474</span></span><br><span class="line">线程<span class="number">3</span>: 当前local值为：<span class="number">516</span></span><br><span class="line">线程<span class="number">2</span>: 当前local值为：<span class="number">819</span></span><br><span class="line">线程<span class="number">1</span>: 当前local值为：<span class="number">916</span></span><br><span class="line">线程<span class="number">3</span>: 当前local值为：<span class="number">50</span></span><br><span class="line">线程<span class="number">2</span>: 当前local值为：<span class="number">926</span></span><br></pre></td></tr></table></figure>
<h1 id="ThreadLocalRandom"><a href="#ThreadLocalRandom" class="headerlink" title="ThreadLocalRandom"></a>ThreadLocalRandom</h1><p>&#x2F;&#x2F;TODO</p>

      
    </div> -->
          <div class="article-entry" itemprop="articleBody">
            
              
                
                      
                        
                          
                            
                              
                                
                                  
                                    <p>
                                      <h1 id="ThreadLocal"><a href="#ThreadLocal" class="headerlink" title="ThreadLocal"></a>ThreadLocal</h1><p>看代码</p>

                                        <p>
                                          
                                            
                                              
                                                      
          </div>
    <p class="article-more-link">
      <a href="/2018/10/01/java/009-concurent-tool-class/#more">
        Read More
      </a>
    </p>
    <!-- <div class="article-more-link">
      <a href="/2018/10/01/java/009-concurent-tool-class/#more">
        read more
      </a>
    </div> -->
    


      <footer class="article-footer">
        <a data-url="http://jimolonely.github.io/history/2018/10/01/java/009-concurent-tool-class/" data-id="cl1fw7fkp008wvkd30233cg8e" class="article-share-link">
          Share
        </a>
        
            
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/java/" rel="tag">java</a><span class="article-tag-list-count">104</span></li></ul>

      </footer>
      </div>
      
</article>


  
    <article id="post-java/008-java-concurrent-deadlock" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/09/30/java/008-java-concurrent-deadlock/" class="article-date">
  <time datetime="2018-09-30T00:39:39.000Z" itemprop="datePublished">2018-09-30</time>
</a>
      
  </div>
  <div class="article-inner">
    
      
        <header class="article-header">
          
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/09/30/java/008-java-concurrent-deadlock/">java并发-死锁</a>
    </h1>
  

        </header>
        
          <!-- <div class="article-entry" itemprop="articleBody">
      
        <p>本文讲解死锁的概念和示例。</p>
<h1 id="死锁是什么"><a href="#死锁是什么" class="headerlink" title="死锁是什么"></a>死锁是什么</h1><p>死锁描述了两个或多个线程永远被阻塞，等待彼此的情况。当多个线程需要相同的锁但以不同的顺序获取它们时，会发生死锁。</p>
<h1 id="代码示例"><a href="#代码示例" class="headerlink" title="代码示例"></a>代码示例</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 演示死锁的由来：因为线程加锁的顺序不一致导致，相互等待对方持有的锁，形成死锁</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> jimo</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2018/9/29 13:46</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DeadLockDemo</span> &#123;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="type">Object</span> <span class="variable">LOCK1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Object</span>();</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="type">Object</span> <span class="variable">LOCK2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Object</span>();</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">		<span class="keyword">new</span> <span class="title class_">ThreadDemo1</span>().start();</span><br><span class="line">		<span class="keyword">new</span> <span class="title class_">ThreadDemo2</span>().start();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">ThreadDemo1</span> <span class="keyword">extends</span> <span class="title class_">Thread</span> &#123;</span><br><span class="line">		<span class="meta">@Override</span></span><br><span class="line">		<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">			<span class="keyword">synchronized</span> (LOCK1) &#123;</span><br><span class="line">				System.out.println(<span class="string">&quot;线程1持有lock1...&quot;</span>);</span><br><span class="line"></span><br><span class="line">				<span class="keyword">try</span> &#123;</span><br><span class="line">					Thread.sleep(<span class="number">10</span>);</span><br><span class="line">				&#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">				&#125;</span><br><span class="line">				System.out.println(<span class="string">&quot;线程1等待lock2&quot;</span>);</span><br><span class="line"></span><br><span class="line">				<span class="keyword">synchronized</span> (LOCK2) &#123;</span><br><span class="line">					System.out.println(<span class="string">&quot;线程1持有lock1和lock2&quot;</span>);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">ThreadDemo2</span> <span class="keyword">extends</span> <span class="title class_">Thread</span> &#123;</span><br><span class="line">		<span class="meta">@Override</span></span><br><span class="line">		<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">			<span class="keyword">synchronized</span> (LOCK2) &#123;</span><br><span class="line">				System.out.println(<span class="string">&quot;线程2持有lock2...&quot;</span>);</span><br><span class="line"></span><br><span class="line">				<span class="keyword">try</span> &#123;</span><br><span class="line">					Thread.sleep(<span class="number">10</span>);</span><br><span class="line">				&#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">				&#125;</span><br><span class="line">				System.out.println(<span class="string">&quot;线程2等待lock1&quot;</span>);</span><br><span class="line"></span><br><span class="line">				<span class="keyword">synchronized</span> (LOCK1) &#123;</span><br><span class="line">					System.out.println(<span class="string">&quot;线程2持有lock1和lock2&quot;</span>);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>运行结果：</p>
<img src="/2018/09/30/java/008-java-concurrent-deadlock/1.png" class="">

<h1 id="改正确"><a href="#改正确" class="headerlink" title="改正确"></a>改正确</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 演示死锁的由来：因为线程加锁的顺序不一致导致，相互等待对方持有的锁，形成死锁</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> jimo</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2018/9/29 13:46</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DeadLockDemo</span> &#123;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="type">Object</span> <span class="variable">LOCK1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Object</span>();</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="type">Object</span> <span class="variable">LOCK2</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Object</span>();</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">		<span class="keyword">new</span> <span class="title class_">ThreadDemo1</span>().start();</span><br><span class="line">		<span class="keyword">new</span> <span class="title class_">ThreadDemo2</span>().start();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">ThreadDemo1</span> <span class="keyword">extends</span> <span class="title class_">Thread</span> &#123;</span><br><span class="line">		<span class="meta">@Override</span></span><br><span class="line">		<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">			<span class="keyword">synchronized</span> (LOCK1) &#123;</span><br><span class="line">				System.out.println(<span class="string">&quot;线程1持有lock1...&quot;</span>);</span><br><span class="line"></span><br><span class="line">				<span class="keyword">try</span> &#123;</span><br><span class="line">					Thread.sleep(<span class="number">10</span>);</span><br><span class="line">				&#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">				&#125;</span><br><span class="line">				System.out.println(<span class="string">&quot;线程1等待lock2&quot;</span>);</span><br><span class="line"></span><br><span class="line">				<span class="keyword">synchronized</span> (LOCK2) &#123;</span><br><span class="line">					System.out.println(<span class="string">&quot;线程1持有lock1和lock2&quot;</span>);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">ThreadDemo2</span> <span class="keyword">extends</span> <span class="title class_">Thread</span> &#123;</span><br><span class="line">		<span class="meta">@Override</span></span><br><span class="line">		<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">			<span class="keyword">synchronized</span> (LOCK1) &#123;</span><br><span class="line">				System.out.println(<span class="string">&quot;线程2持有lock1...&quot;</span>);</span><br><span class="line"></span><br><span class="line">				<span class="keyword">try</span> &#123;</span><br><span class="line">					Thread.sleep(<span class="number">10</span>);</span><br><span class="line">				&#125; <span class="keyword">catch</span> (InterruptedException e) &#123;</span><br><span class="line">				&#125;</span><br><span class="line">				System.out.println(<span class="string">&quot;线程2等待lock2&quot;</span>);</span><br><span class="line"></span><br><span class="line">				<span class="keyword">synchronized</span> (LOCK2) &#123;</span><br><span class="line">					System.out.println(<span class="string">&quot;线程2持有lock1和lock2&quot;</span>);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>结果：</p>
<img src="/2018/09/30/java/008-java-concurrent-deadlock/2.png" class="">

      
    </div> -->
          <div class="article-entry" itemprop="articleBody">
            
              
                
                      
                        
                          
                            
                              
                                
                                  
                                    <p>
                                      <p>本文讲解死锁的概念和示例。</p>

                                        <p>
                                          
                                            
                                              
                                                      
          </div>
    <p class="article-more-link">
      <a href="/2018/09/30/java/008-java-concurrent-deadlock/#more">
        Read More
      </a>
    </p>
    <!-- <div class="article-more-link">
      <a href="/2018/09/30/java/008-java-concurrent-deadlock/#more">
        read more
      </a>
    </div> -->
    


      <footer class="article-footer">
        <a data-url="http://jimolonely.github.io/history/2018/09/30/java/008-java-concurrent-deadlock/" data-id="cl1fw7fko008uvkd3c1kshkz3" class="article-share-link">
          Share
        </a>
        
            
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/java/" rel="tag">java</a><span class="article-tag-list-count">104</span></li></ul>

      </footer>
      </div>
      
</article>


  
    <article id="post-basic/002-http" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/09/28/basic/002-http/" class="article-date">
  <time datetime="2018-09-28T01:01:11.000Z" itemprop="datePublished">2018-09-28</time>
</a>
      
  </div>
  <div class="article-inner">
    
      
        <header class="article-header">
          
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/09/28/basic/002-http/">http那些事</a>
    </h1>
  

        </header>
        
          <!-- <div class="article-entry" itemprop="articleBody">
      
        <p>本文是一个长期更新版本，记录遇到的有关http协议的相关问题，最佳参考资料为RFC：<a target="_blank" rel="noopener" href="http://www.rfcreader.com/#rfc2616_line301">http://www.rfcreader.com/#rfc2616_line301</a></p>
<h1 id="http的历史"><a href="#http的历史" class="headerlink" title="http的历史"></a>http的历史</h1><h1 id="常见问题"><a href="#常见问题" class="headerlink" title="常见问题"></a>常见问题</h1><h2 id="get请求的URL长度限制"><a href="#get请求的URL长度限制" class="headerlink" title="get请求的URL长度限制"></a>get请求的URL长度限制</h2><h2 id="post请求的request-body限制"><a href="#post请求的request-body限制" class="headerlink" title="post请求的request body限制"></a>post请求的request body限制</h2>
      
    </div> -->
          <div class="article-entry" itemprop="articleBody">
            
              
                
                      
                        
                          
                            
                              
                                
                                  
                                    <p>
                                      <p>本文是一个长期更新版本，记录遇到的有关http协议的相关问题，最佳参考资料为RFC：<a target="_blank" rel="noopener" href="http://www.rfcreader.com/#rfc2616_line301">http://www.rfcreader.com/#rfc2616_line301</a></p>

                                        <p>
                                          
                                            
                                              
                                                      
          </div>
    <p class="article-more-link">
      <a href="/2018/09/28/basic/002-http/#more">
        Read More
      </a>
    </p>
    <!-- <div class="article-more-link">
      <a href="/2018/09/28/basic/002-http/#more">
        read more
      </a>
    </div> -->
    


      <footer class="article-footer">
        <a data-url="http://jimolonely.github.io/history/2018/09/28/basic/002-http/" data-id="cl1fw7fhn000hvkd3d9043o8y" class="article-share-link">
          Share
        </a>
        
            
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/basic/" rel="tag">basic</a><span class="article-tag-list-count">7</span></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/http/" rel="tag">http</a><span class="article-tag-list-count">1</span></li></ul>

      </footer>
      </div>
      
</article>


  
    <article id="post-java/007-checkstyle-idea-git-pre-commit" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/09/28/java/007-checkstyle-idea-git-pre-commit/" class="article-date">
  <time datetime="2018-09-28T00:19:30.000Z" itemprop="datePublished">2018-09-28</time>
</a>
      
  </div>
  <div class="article-inner">
    
      
        <header class="article-header">
          
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/09/28/java/007-checkstyle-idea-git-pre-commit/">在git commit前自动检查checkstyle</a>
    </h1>
  

        </header>
        
          <!-- <div class="article-entry" itemprop="articleBody">
      
        <p>本文主要简介以下几个方面的内容：</p>
<ol>
<li>idea的checkstyle插件安装</li>
<li>checkstyle自定义</li>
<li>在commit前自动检查style</li>
</ol>
<h1 id="check-style是什么"><a href="#check-style是什么" class="headerlink" title="check style是什么"></a>check style是什么</h1><p>github： <a target="_blank" rel="noopener" href="https://github.com/checkstyle/checkstyle">https://github.com/checkstyle/checkstyle</a><br>官网： <a target="_blank" rel="noopener" href="http://checkstyle.sourceforge.net/">http://checkstyle.sourceforge.net/</a></p>
<p>参考资料（推荐）：<a target="_blank" rel="noopener" href="http://insights.thoughtworkers.org/save-java-code-style-obsessive-compulsive-disorder/">http://insights.thoughtworkers.org/save-java-code-style-obsessive-compulsive-disorder/</a></p>
<h1 id="idea如何配置"><a href="#idea如何配置" class="headerlink" title="idea如何配置"></a>idea如何配置</h1><p>我们使用idea相关插件：<br><a target="_blank" rel="noopener" href="https://github.com/jshiell/checkstyle-idea">https://github.com/jshiell/checkstyle-idea</a></p>
<h2 id="安装插件"><a href="#安装插件" class="headerlink" title="安装插件"></a>安装插件</h2><img src="/2018/09/28/java/007-checkstyle-idea-git-pre-commit/000.png" class="">

<p>装完重启后，会发现默认带有谷歌和sun公司的style：</p>
<img src="/2018/09/28/java/007-checkstyle-idea-git-pre-commit/001.png" class="">

<h2 id="如何使用"><a href="#如何使用" class="headerlink" title="如何使用"></a>如何使用</h2><p>选择一种方式，check就好：</p>
<img src="/2018/09/28/java/007-checkstyle-idea-git-pre-commit/002.png" class="">

<h1 id="配置我们自己的style"><a href="#配置我们自己的style" class="headerlink" title="配置我们自己的style"></a>配置我们自己的style</h1><p>阿里的style：<br><a target="_blank" rel="noopener" href="https://blog.csdn.net/KingBoyWorld/article/details/76082399">https://blog.csdn.net/KingBoyWorld/article/details/76082399</a></p>
<p>google style：<br><a target="_blank" rel="noopener" href="https://github.com/checkstyle/checkstyle/blob/master/src/main/resources/google_checks.xml">https://github.com/checkstyle/checkstyle/blob/master/src/main/resources/google_checks.xml</a></p>
<p>有关checkstyle的配置文件语法，参看官方文档：<br><a target="_blank" rel="noopener" href="http://checkstyle.sourceforge.net/config.html">http://checkstyle.sourceforge.net/config.html</a></p>
<p>&#x2F;&#x2F;TODO<br>现在你应该学会了如何写配置，下面就是我们自己的style了，skr把。</p>
<p>然后导入idea的checkstyle插件里，以便实时检查：</p>
<img src="/2018/09/28/java/007-checkstyle-idea-git-pre-commit/003.png" class="">

<img src="/2018/09/28/java/007-checkstyle-idea-git-pre-commit/004.png" class="">

<h1 id="如何在commit时自动检查"><a href="#如何在commit时自动检查" class="headerlink" title="如何在commit时自动检查"></a>如何在commit时自动检查</h1><p>如果只是在IDEA里使用一下，对于自觉的程序员来说这当然就够了，但是即便是高手也会在某个阴暗的晚上抱着一种疲惫的心态和得过且过的态度想蒙混过关，最后连check一下都难得执行，于是，自动化的检查必须存在，如果检查不通过，不能提交代码。</p>
<p>这个过程分为3步：</p>
<h2 id="1-准备好环境"><a href="#1-准备好环境" class="headerlink" title="1.准备好环境"></a>1.准备好环境</h2><ol>
<li>jdk与git环境配置</li>
<li>checkstyle的jar包，虽然可以用maven，但是不想写在项目里。</li>
<li>style xml配置文件，上面已写好</li>
<li>pre-commit脚本，下面会写</li>
</ol>
<p>在这里下载jar包：<br><a target="_blank" rel="noopener" href="https://github.com/checkstyle/checkstyle/releases">https://github.com/checkstyle/checkstyle/releases</a></p>
<h2 id="2-了解git-hook"><a href="#2-了解git-hook" class="headerlink" title="2. 了解git hook"></a>2. 了解git hook</h2><p>我们要在git commit之前自动检查style，就需要利用git hook（钩子），查看文档：<br><a target="_blank" rel="noopener" href="https://git-scm.com/book/zh/v2/%E8%87%AA%E5%AE%9A%E4%B9%89-Git-Git-%E9%92%A9%E5%AD%90">https://git-scm.com/book/zh/v2/%E8%87%AA%E5%AE%9A%E4%B9%89-Git-Git-%E9%92%A9%E5%AD%90</a></p>
<img src="/2018/09/28/java/007-checkstyle-idea-git-pre-commit/005.png" class="">

<p>我们就需要pre-commit，只需要用shell，ruby，python或其他语言写好脚本，命名为pre-commit，放到hooks目录下就行了。</p>
<h2 id="3-如何自动关联"><a href="#3-如何自动关联" class="headerlink" title="3. 如何自动关联"></a>3. 如何自动关联</h2><p>因为.git这个目录是不随项目文件一起提交的，所以不能实现共享，所以需要做一些配置，把脚本和jar包都放在项目下，为此，我建立了check-style目录来存放文件：</p>
<img src="/2018/09/28/java/007-checkstyle-idea-git-pre-commit/006.png" class="">

<p>然后现在有2种方法，可以拷贝pre-commit到.git&#x2F;hooks目录下：</p>
<ol>
<li><p>手工拷贝，执行下面命令<br><code>cp ./check-style/pre-commit ./.git/hooks/</code></p>
</li>
<li><p>使用maven复制自动在编译时复制文件</p>
</li>
</ol>
<h2 id="4-编写pre-commit脚本"><a href="#4-编写pre-commit脚本" class="headerlink" title="4.编写pre-commit脚本"></a>4.编写pre-commit脚本</h2><p>步骤很简单，采用shell语言：</p>
<ol>
<li>得到要提交的文件：类似git status</li>
<li>得到文件的全路径，只过滤出java文件</li>
<li>对每个文件执行style check，记录结果</li>
<li>如果结果不满意，则不执行git commit，返回非0</li>
</ol>
<p>完整脚本如下：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">@author:jimo<span class="comment">#</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">@func:pre-commit<span class="comment">#</span></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment"># cp ./check-style/pre-commit ./.git/hooks/</span></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">一个打印函数，前后加空行</span></span><br><span class="line">function print()&#123;</span><br><span class="line">    echo &quot;&quot;</span><br><span class="line">    echo &quot;===========$*============&quot;</span><br><span class="line">    echo &quot;&quot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">print 避免NPE是程序员的基本修养！</span><br><span class="line">print 开始style checking</span><br><span class="line"></span><br><span class="line">wd=`pwd`</span><br><span class="line">print &quot;当前工作目录：$wd&quot;</span><br><span class="line"></span><br><span class="line">check_jar_path=&quot;$wd/check-style/checkstyle-8.12-all.jar&quot;</span><br><span class="line">check_xml_path=&quot;$wd/check-style/iad-checkstyle.xml&quot;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">echo</span> <span class="variable">$check_jar_path</span> <span class="variable">$check_xml_path</span></span></span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">清空temp文件</span></span><br><span class="line">rm -f temp</span><br><span class="line"></span><br><span class="line">is_err=0</span><br><span class="line"></span><br><span class="line">for file in `git status --porcelain | sed s/^...// | grep &#x27;\.java$&#x27;`;do</span><br><span class="line">    path=&quot;$wd/$file&quot;</span><br><span class="line">    print &quot;检查文件：$path&quot;</span><br><span class="line">    re=`java -jar $check_jar_path -c $check_xml_path $path &gt;&gt; temp`</span><br><span class="line">    err=`cat temp | grep &quot;ERROR&quot;`</span><br><span class="line">    if [[ $err = *&quot;ERROR&quot;* ]];then</span><br><span class="line">        print $err</span><br><span class="line">        is_err=1</span><br><span class="line">    fi</span><br><span class="line">done</span><br><span class="line"></span><br><span class="line">print &quot;检查完成，祝你好运&quot;</span><br><span class="line"></span><br><span class="line">rm -f temp</span><br><span class="line"></span><br><span class="line">if [ $is_err -ne 0 ]</span><br><span class="line">then</span><br><span class="line">    print &quot;请先符合style才能提交！&quot;</span><br><span class="line">    exit 1</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line">exit 0</span><br></pre></td></tr></table></figure>

<h1 id="5-测试"><a href="#5-测试" class="headerlink" title="5.测试"></a>5.测试</h1><img src="/2018/09/28/java/007-checkstyle-idea-git-pre-commit/007.png" class="">

<img src="/2018/09/28/java/007-checkstyle-idea-git-pre-commit/008.png" class="">

      
    </div> -->
          <div class="article-entry" itemprop="articleBody">
            
              
                
                      
                        
                          
                            
                              
                                
                                  
                                    <p>
                                      <p>本文主要简介以下几个方面的内容：</p>

                                        <p>
                                          
                                            
                                              
                                                      
          </div>
    <p class="article-more-link">
      <a href="/2018/09/28/java/007-checkstyle-idea-git-pre-commit/#more">
        Read More
      </a>
    </p>
    <!-- <div class="article-more-link">
      <a href="/2018/09/28/java/007-checkstyle-idea-git-pre-commit/#more">
        read more
      </a>
    </div> -->
    


      <footer class="article-footer">
        <a data-url="http://jimolonely.github.io/history/2018/09/28/java/007-checkstyle-idea-git-pre-commit/" data-id="cl1fw7fko008rvkd318b425t8" class="article-share-link">
          Share
        </a>
        
            
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/checkstyle/" rel="tag">checkstyle</a><span class="article-tag-list-count">1</span></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/java/" rel="tag">java</a><span class="article-tag-list-count">104</span></li></ul>

      </footer>
      </div>
      
</article>


  
    <article id="post-java/006-ali-java-stadard-graph" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/09/27/java/006-ali-java-stadard-graph/" class="article-date">
  <time datetime="2018-09-27T03:04:28.000Z" itemprop="datePublished">2018-09-27</time>
</a>
      
  </div>
  <div class="article-inner">
    
      
        <header class="article-header">
          
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/09/27/java/006-ali-java-stadard-graph/">阿里java开发手册思维导图</a>
    </h1>
  

        </header>
        
          <!-- <div class="article-entry" itemprop="articleBody">
      
        <p>千言不如一图。</p>
<img src="/2018/09/27/java/006-ali-java-stadard-graph/000.png" class="">

      
    </div> -->
          <div class="article-entry" itemprop="articleBody">
            
              
                
                      
                        
                          
                            
                              
                                
                                  
                                    <p>
                                      <p>千言不如一图。</p>

                                        <p>
                                          
                                            
                                              
                                                      
          </div>
    <p class="article-more-link">
      <a href="/2018/09/27/java/006-ali-java-stadard-graph/#more">
        Read More
      </a>
    </p>
    <!-- <div class="article-more-link">
      <a href="/2018/09/27/java/006-ali-java-stadard-graph/#more">
        read more
      </a>
    </div> -->
    


      <footer class="article-footer">
        <a data-url="http://jimolonely.github.io/history/2018/09/27/java/006-ali-java-stadard-graph/" data-id="cl1fw7fkm008mvkd3gry1d8vq" class="article-share-link">
          Share
        </a>
        
            
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/java/" rel="tag">java</a><span class="article-tag-list-count">104</span></li></ul>

      </footer>
      </div>
      
</article>


  
    <article id="post-js/003-front-end-session-check" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/09/25/js/003-front-end-session-check/" class="article-date">
  <time datetime="2018-09-25T09:36:04.000Z" itemprop="datePublished">2018-09-25</time>
</a>
      
  </div>
  <div class="article-inner">
    
      
        <header class="article-header">
          
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/09/25/js/003-front-end-session-check/">js前端检测用户长时间未操作</a>
    </h1>
  

        </header>
        
          <!-- <div class="article-entry" itemprop="articleBody">
      
        <p>用在单页面中，前后端分离的情况。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">//10min</span></span><br><span class="line">    <span class="keyword">const</span> <span class="variable constant_">LOGOUT_TIME_LEN</span> = <span class="number">1000</span> * <span class="number">60</span> * <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> time = <span class="keyword">new</span> <span class="title class_">Date</span>().<span class="title function_">getTime</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//这里采用鼠标抬起事件，可以换成其他事件</span></span><br><span class="line">    <span class="variable language_">window</span>.<span class="property">onmouseup</span> = <span class="keyword">function</span> <span class="title function_">countTime</span>(<span class="params"></span>) &#123;</span><br><span class="line">        time = <span class="keyword">new</span> <span class="title class_">Date</span>().<span class="title function_">getTime</span>();</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//60s检测一次</span></span><br><span class="line">    <span class="keyword">const</span> id = <span class="variable language_">window</span>.<span class="built_in">setInterval</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">new</span> <span class="title class_">Date</span>().<span class="title function_">getTime</span>() - time &gt; <span class="variable constant_">LOGOUT_TIME_LEN</span>) &#123;</span><br><span class="line">            <span class="comment">//clear TOKEN</span></span><br><span class="line">            storage.<span class="title function_">clear</span>();</span><br><span class="line">            <span class="variable language_">window</span>.<span class="built_in">clearInterval</span>(id);</span><br><span class="line">            <span class="title function_">alert</span>(<span class="string">&quot;由于您长时间没有操作, session已过期, 请重新登录&quot;</span>);</span><br><span class="line">            <span class="variable language_">window</span>.<span class="title function_">open</span>(<span class="string">&#x27;/views/login/login.html&#x27;</span>, <span class="string">&#x27;_self&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;, <span class="number">1000</span> * <span class="number">60</span>);</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure>

      
    </div> -->
          <div class="article-entry" itemprop="articleBody">
            
              
                
                      
                        
                          
                            
                              
                                
                                  
                                    <p>
                                      <p>用在单页面中，前后端分离的情况。</p>

                                        <p>
                                          
                                            
                                              
                                                      
          </div>
    <p class="article-more-link">
      <a href="/2018/09/25/js/003-front-end-session-check/#more">
        Read More
      </a>
    </p>
    <!-- <div class="article-more-link">
      <a href="/2018/09/25/js/003-front-end-session-check/#more">
        read more
      </a>
    </div> -->
    


      <footer class="article-footer">
        <a data-url="http://jimolonely.github.io/history/2018/09/25/js/003-front-end-session-check/" data-id="cl1fw7fjt005ovkd350h93v6g" class="article-share-link">
          Share
        </a>
        
            
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/html/" rel="tag">html</a><span class="article-tag-list-count">2</span></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/js/" rel="tag">js</a><span class="article-tag-list-count">7</span></li></ul>

      </footer>
      </div>
      
</article>


  
    <article id="post-js/002-condition-juge" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/09/25/js/002-condition-juge/" class="article-date">
  <time datetime="2018-09-25T02:35:49.000Z" itemprop="datePublished">2018-09-25</time>
</a>
      
  </div>
  <div class="article-inner">
    
      
        <header class="article-header">
          
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/09/25/js/002-condition-juge/">js条件判断</a>
    </h1>
  

        </header>
        
          <!-- <div class="article-entry" itemprop="articleBody">
      
        <p>js条件判断，看似简单，却暗藏玄机。</p>
<h1 id="x3D-x3D-与-x3D-x3D-x3D"><a href="#x3D-x3D-与-x3D-x3D-x3D" class="headerlink" title="&#x3D;&#x3D;与&#x3D;&#x3D;&#x3D;"></a>&#x3D;&#x3D;与&#x3D;&#x3D;&#x3D;</h1><p><code>===</code>比<code>==</code>多的一个就是数据类型的判断，很重要，建议用<code>===</code>.</p>
<h1 id="true-x2F-false"><a href="#true-x2F-false" class="headerlink" title="true&#x2F;false"></a>true&#x2F;false</h1><p>在js中哪些是true，哪些是false呢？</p>
<ol>
<li><code>object(arr,class等)永远是</code>true&#96;</li>
<li><code>undefiend</code> &#x3D;&#x3D;&gt; <code>false</code></li>
<li><code>null</code> &#x3D;&#x3D;&gt; <code>false</code></li>
<li>Boolean条件</li>
<li>数字：<code>+0,-0,0,NaN</code>为<code>false</code>,其余为true</li>
<li>字符串：<code>&#39;&#39;</code>为<code>false</code>，其余有长度的为<code>true</code></li>
</ol>
<h1 id="对比分析"><a href="#对比分析" class="headerlink" title="对比分析"></a>对比分析</h1><p>为什么不建议用<code>==</code>判断，下面见证：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> cons = [&#123;&#125;,<span class="literal">undefined</span>,<span class="literal">null</span>,-<span class="number">0</span>,<span class="number">0</span>,<span class="title class_">NaN</span>,<span class="string">&#x27;&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">let</span> c1 <span class="keyword">of</span> cons)&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">let</span> c2 <span class="keyword">of</span> cons)&#123;</span><br><span class="line">        <span class="keyword">if</span>(c1!==c2)&#123;</span><br><span class="line">            <span class="keyword">if</span>(c1==c2)&#123;</span><br><span class="line">                    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`<span class="subst">$&#123;c1&#125;</span>==<span class="subst">$&#123;c2&#125;</span>`</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(c1===c2)&#123;</span><br><span class="line">                    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">`<span class="subst">$&#123;c1&#125;</span>===<span class="subst">$&#123;c2&#125;</span>`</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//console.log(`$&#123;c1&#125;==$&#123;c2&#125;--&gt;$&#123;c1==c2&#125; | $&#123;c1&#125;===$&#123;c2&#125;--&gt;$&#123;c1===c2&#125;`);</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>结果：(<code>&#39;&#39;</code>其实是看不到的哈)</p>
<pre><code>undefined==null
null==undefined
0==&#39;&#39;
-0==&#39;&#39;
</code></pre>

      
    </div> -->
          <div class="article-entry" itemprop="articleBody">
            
              
                
                      
                        
                          
                            
                              
                                
                                  
                                    <p>
                                      <p>js条件判断，看似简单，却暗藏玄机。</p>

                                        <p>
                                          
                                            
                                              
                                                      
          </div>
    <p class="article-more-link">
      <a href="/2018/09/25/js/002-condition-juge/#more">
        Read More
      </a>
    </p>
    <!-- <div class="article-more-link">
      <a href="/2018/09/25/js/002-condition-juge/#more">
        read more
      </a>
    </div> -->
    


      <footer class="article-footer">
        <a data-url="http://jimolonely.github.io/history/2018/09/25/js/002-condition-juge/" data-id="cl1fw7fjs005mvkd3ap8u45dx" class="article-share-link">
          Share
        </a>
        
            
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/js/" rel="tag">js</a><span class="article-tag-list-count">7</span></li></ul>

      </footer>
      </div>
      
</article>


  
    <article id="post-server/005-how-nginx-handle-a-request" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/09/23/server/005-how-nginx-handle-a-request/" class="article-date">
  <time datetime="2018-09-23T09:17:00.000Z" itemprop="datePublished">2018-09-23</time>
</a>
      
  </div>
  <div class="article-inner">
    
      
        <header class="article-header">
          
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/09/23/server/005-how-nginx-handle-a-request/">nginx如何处理一个请求</a>
    </h1>
  

        </header>
        
          <!-- <div class="article-entry" itemprop="articleBody">
      
        <p>nginx如何处理一个请求? 简单但不失为一个值得过问的问题。仔细一想，nginx本身不处理业务，只是提供一个请求的转发，所以问题变成：nginx如何转发一个请求？</p>
<p>下面基于几种情况说明：基于命名和基于IP的。</p>
<h1 id="基于命名的服务器"><a href="#基于命名的服务器" class="headerlink" title="基于命名的服务器"></a>基于命名的服务器</h1><p>假设有下面的全部监听80端口的服务映射：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">    listen      80;</span><br><span class="line">    server_name example.org www.example.org;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">server &#123;</span><br><span class="line">    listen      80;</span><br><span class="line">    server_name example.net www.example.net;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">server &#123;</span><br><span class="line">    listen      80;</span><br><span class="line">    server_name example.com www.example.com;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这时候来了一个请求，nginx如何选择哪一个响应呢？ 可以这样计算：</p>
<ol>
<li>检查请求的<code>Host</code>字段，如果匹配，则ok；</li>
<li>否则使用默认服务器，这里是第一个。</li>
</ol>
<p>如何指定默认服务器？如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">    listen      80 default_server;</span><br><span class="line">    server_name example.net www.example.net;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="如果不希望处理Host为空的请求呢？"><a href="#如果不希望处理Host为空的请求呢？" class="headerlink" title="如果不希望处理Host为空的请求呢？"></a>如果不希望处理Host为空的请求呢？</h2><p>可以直接配置返回<a target="_blank" rel="noopener" href="https://httpstatuses.com/444">444-CONNECTION CLOSED WITHOUT RESPONSE</a>：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">    listen      80;</span><br><span class="line">    server_name &quot;&quot;;</span><br><span class="line">    return      444;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="基于域名和IP混合的服务器"><a href="#基于域名和IP混合的服务器" class="headerlink" title="基于域名和IP混合的服务器"></a>基于域名和IP混合的服务器</h1><p>如果既有IP又有服务器名称，如下：有几个虚拟主机在不同的地址上监听</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">    listen      192.168.1.1:80;</span><br><span class="line">    server_name example.org www.example.org;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">server &#123;</span><br><span class="line">    listen      192.168.1.1:80;</span><br><span class="line">    server_name example.net www.example.net;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">server &#123;</span><br><span class="line">    listen      192.168.1.2:80;</span><br><span class="line">    server_name example.com www.example.com;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol>
<li>首先测试请求的IP地址和端口是否匹配某个server配置块中的listen指令配置;</li>
<li>接着测试请求的<code>Host</code>头是否匹配这个server块中的某个server_name的值;</li>
<li>如果<code>Host</code>没有找到，nginx将把这个请求交给默认虚拟主机处理</li>
</ol>
<p>例如，一个从<code>192.168.1.1:80</code>端口收到的访问<code>www.example.com</code>的请求将被监听<code>192.168.1.1:80</code>端口的默认虚拟主机处理，本例中就是第一个服务器，因为这个端口上没有定义名为<code>www.example.com</code>的虚拟主机。</p>
<p>默认服务器是监听端口的属性，所以不同的监听端口可以设置不同的默认服务器：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">    listen      192.168.1.1:80;</span><br><span class="line">    server_name example.org www.example.org;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">server &#123;</span><br><span class="line">    listen      192.168.1.1:80 default_server;</span><br><span class="line">    server_name example.net www.example.net;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">server &#123;</span><br><span class="line">    listen      192.168.1.2:80 default_server;</span><br><span class="line">    server_name example.com www.example.com;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="为什么可以listen多个IP？"><a href="#为什么可以listen多个IP？" class="headerlink" title="为什么可以listen多个IP？"></a>为什么可以<code>listen</code>多个IP？</h1><p>我得出的结论是：有多个网卡，每个网卡的IP不同。</p>
<p>我们知道，一个请求的<code>Host</code>可以是域名，也可以是IP，如果直接访问nginx服务器的IP，那么Host就是IP，如果加上了端口，则<code>Host=IP:port</code>，于是这样就解释得通了。</p>
<p>当我们只写端口时：<code>listen 80;</code>，nginx会监听所有网卡的流量，于是所有80端口的请求都到这个server块来了。</p>
<p><a target="_blank" rel="noopener" href="https://nginx.org/en/docs/http/request_processing.html">how nginx handle a request</a></p>

      
    </div> -->
          <div class="article-entry" itemprop="articleBody">
            
              
                
                      
                        
                          
                            
                              
                                
                                  
                                    <p>
                                      <p>nginx如何处理一个请求? 简单但不失为一个值得过问的问题。仔细一想，nginx本身不处理业务，只是提供一个请求的转发，所以问题变成：nginx如何转发一个请求？</p>

                                        <p>
                                          
                                            
                                              
                                                      
          </div>
    <p class="article-more-link">
      <a href="/2018/09/23/server/005-how-nginx-handle-a-request/#more">
        Read More
      </a>
    </p>
    <!-- <div class="article-more-link">
      <a href="/2018/09/23/server/005-how-nginx-handle-a-request/#more">
        read more
      </a>
    </div> -->
    


      <footer class="article-footer">
        <a data-url="http://jimolonely.github.io/history/2018/09/23/server/005-how-nginx-handle-a-request/" data-id="cl1fw7fnd00iivkd3bwj6cxg0" class="article-share-link">
          Share
        </a>
        
            
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/nginx/" rel="tag">nginx</a><span class="article-tag-list-count">6</span></li></ul>

      </footer>
      </div>
      
</article>


  
    <article id="post-server/004-nginx-directives" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/09/19/server/004-nginx-directives/" class="article-date">
  <time datetime="2018-09-19T02:06:57.000Z" itemprop="datePublished">2018-09-19</time>
</a>
      
  </div>
  <div class="article-inner">
    
      
        <header class="article-header">
          
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/09/19/server/004-nginx-directives/">nginx指令大全</a>
    </h1>
  

        </header>
        
          <!-- <div class="article-entry" itemprop="articleBody">
      
        <p>本文翻译自<a target="_blank" rel="noopener" href="https://nginx.org/en/docs/http/ngx_http_core_module.html#directives">官网</a></p>
<h1 id="absolute-redirect-on-off"><a href="#absolute-redirect-on-off" class="headerlink" title="absolute_redirect on | off"></a>absolute_redirect on | off</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">默认：on</span><br><span class="line">上下文：http,server,location</span><br><span class="line">如果禁用，nginx发出的重定向将是相对的。</span><br></pre></td></tr></table></figure>
<h1 id="aio-on-off-threads-x3D-pool"><a href="#aio-on-off-threads-x3D-pool" class="headerlink" title="aio on | off | threads[&#x3D;pool]"></a>aio on | off | threads[&#x3D;pool]</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">默认：off</span><br><span class="line">上下文：http,server,location</span><br><span class="line">异步文件IO，针对FreeBSD和linux</span><br></pre></td></tr></table></figure>
<h1 id="alias-path"><a href="#alias-path" class="headerlink" title="alias path"></a>alias path</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">context: location</span><br><span class="line">定义或替换指定路径</span><br><span class="line"></span><br><span class="line">location /i/ &#123;</span><br><span class="line">    alias /data/w3/images/;</span><br><span class="line">&#125;</span><br><span class="line">在请求 /i/top.gif时，会映射到 ：/data/w3/images/top.gif</span><br><span class="line"></span><br><span class="line">alias可以包含除了$document_root和$realpath_root的变量</span><br><span class="line"></span><br><span class="line">alias中可以使用正则，并且应该包含捕获</span><br><span class="line">location ~ ^/users/(.+\.(?:gif|jpe?g|png))$ &#123;</span><br><span class="line">    alias /data/w3/images/$1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>alias和root有什么区别？</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">location /images/ &#123;</span><br><span class="line">    alias /data/w3/images/;</span><br><span class="line">&#125;</span><br><span class="line">等价于：</span><br><span class="line">location /images/ &#123;</span><br><span class="line">    root /data/w3;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="client-body-buffer-size"><a href="#client-body-buffer-size" class="headerlink" title="client_body_buffer_size"></a>client_body_buffer_size</h1><p>设置读取客户端请求正文的缓冲区大小。 如果请求主体大于缓冲区，则整个主体或仅其部分被写入临时文件。 默认情况下，缓冲区大小等于两个内存页。 x86和其他32位平台和x86-64为8k。 在其他64位平台上通常为16K。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">client_body_buffer_size 8k | 16k;</span><br><span class="line">context: http,location,server</span><br></pre></td></tr></table></figure>
<h1 id="client-header-buffer-size"><a href="#client-header-buffer-size" class="headerlink" title="client_header_buffer_size"></a>client_header_buffer_size</h1><p>设置header的缓冲区大小，默认1k字节够用了，如果有些cookie很长，可以设大些。</p>
<h1 id="client-max-body-size"><a href="#client-max-body-size" class="headerlink" title="client_max_body_size"></a>client_max_body_size</h1><p>在header<code>Content-Length</code>中指定请求的body大小，超过1M会被返回<code>413(Request Entity Too Large)</code>,设置为0禁用这个检查，因为有些浏览器无法显示这个错误。</p>
<h1 id="connection-pool-size"><a href="#connection-pool-size" class="headerlink" title="connection_pool_size"></a>connection_pool_size</h1><p>每个连接的内存分配，对性能影响很小，应谨慎使用。默认32位是256字节，64位是512字节。</p>
<h1 id="default-type"><a href="#default-type" class="headerlink" title="default_type"></a>default_type</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">默认：default_type text/plain;</span><br><span class="line"></span><br><span class="line">mime-type有很多</span><br></pre></td></tr></table></figure>
<h1 id="error-page"><a href="#error-page" class="headerlink" title="error_page"></a>error_page</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">context: http,server,location</span><br><span class="line"></span><br><span class="line">例子：</span><br><span class="line">error_page 404 /404.html;</span><br><span class="line">error_page 500 502 504 /50x.html;</span><br><span class="line"></span><br><span class="line">动态改变响应码：</span><br><span class="line">error_page 404 =200 /empty.gif;</span><br><span class="line"></span><br><span class="line">转到指定location：</span><br><span class="line">location / &#123;</span><br><span class="line">    error_page 404 = @fallback;</span><br><span class="line">&#125;</span><br><span class="line">location @fallback &#123;</span><br><span class="line">    proxy_pass http://backend;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">重定向处理：</span><br><span class="line">error_page 403 http://example.html</span><br><span class="line">客户端会收到302.</span><br></pre></td></tr></table></figure>
<h1 id="http"><a href="#http" class="headerlink" title="http"></a>http</h1><p>运行于最外层的模块，里面指定server指令。</p>
<h1 id="internal"><a href="#internal" class="headerlink" title="internal"></a>internal</h1><p>内部请求重定向，有条件限制，比如，error_page</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">error_page 404 /404.html;</span><br><span class="line"></span><br><span class="line">location = /404.html &#123;</span><br><span class="line">    internal;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">internal限制为10个，避免循环跳转。</span><br></pre></td></tr></table></figure>
<h1 id="limit-except"><a href="#limit-except" class="headerlink" title="limit except"></a>limit except</h1><p>limit except methods(GET, HEAD, POST, PUT, DELETE, MKCOL, COPY, MOVE, OPTIONS, PROPFIND, PROPPATCH, LOCK, UNLOCK, or PATCH).</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">#除了 GET（包括HEAD）方法，其他禁用</span><br><span class="line">limit except GET &#123;</span><br><span class="line">    allow 192.168.1.0/32;</span><br><span class="line">    deny all;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="limit-rate"><a href="#limit-rate" class="headerlink" title="limit_rate"></a>limit_rate</h1><p>限制客户端每个链接的速率，默认为0，不限制。比如：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">    if($slow)&#123;</span><br><span class="line">        set $limit_rate 4k;# 字节</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="limit-rate-after"><a href="#limit-rate-after" class="headerlink" title="limit_rate_after"></a>limit_rate_after</h1><p>初始化时限制速度，后面不管，如下，开始时加载快点，后面慢慢来：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">location /flv/ &#123;</span><br><span class="line">    flv;</span><br><span class="line">    limit_rate_after 500k;</span><br><span class="line">    limit_rate 50k;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="lingering-close"><a href="#lingering-close" class="headerlink" title="lingering_close"></a>lingering_close</h1><p>控制nginx如何关闭链接：</p>
<ol>
<li>on: 默认，等待客户端发数据，但只是启发性建议发更多数据；</li>
<li>always: 总是无条件的等待处理客户端数据；</li>
<li>off: 从不等待并且立即关闭链接，这个行为打破了协议，正常不应该使用。</li>
</ol>
<h1 id="lingering-time"><a href="#lingering-time" class="headerlink" title="lingering_time"></a>lingering_time</h1><p>在<code>lingering_close</code>的影响下处理（读取或忽视）数据的最长时间，默认30s.</p>
<h1 id="lingering-timeout"><a href="#lingering-timeout" class="headerlink" title="lingering_timeout"></a>lingering_timeout</h1><p>在<code>lingering_close</code>的影响下等待数据到来的最长时间，默认5s.</p>
<h1 id="listen"><a href="#listen" class="headerlink" title="listen"></a>listen</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">default: listen *.80 | *.8000</span><br><span class="line">context: server</span><br></pre></td></tr></table></figure>
<p>&#x2F;&#x2F;TODO</p>
<h1 id="location"><a href="#location" class="headerlink" title="location"></a>location</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">syntax: location [= | ~ | ~* | ^* ] uri &#123;...&#125;</span><br><span class="line">        location @name &#123;...&#125;</span><br><span class="line">context: server, location</span><br></pre></td></tr></table></figure>
<p>解释：</p>
<ol>
<li><code>~*</code>: 大小写不敏感</li>
<li><code>~</code>: 大小写敏感</li>
<li><code>^~</code>: 如果最长前缀有这个，则不检查正则；</li>
<li><code>=</code>: 精确匹配，如果不匹配，则停止搜索；</li>
</ol>
<h2 id="匹配路径规则"><a href="#匹配路径规则" class="headerlink" title="匹配路径规则"></a>匹配路径规则</h2><p>先检查前缀匹配，且记住最长前缀，然后检查正则匹配，正则按声明的先后顺序检查，只要找到第一个匹配的就停止，然后使用正则，如果没有找到正则匹配，则使用前面的最长前缀，否则就只有404了。</p>
<h2 id="例子"><a href="#例子" class="headerlink" title="例子"></a>例子</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">location = / &#123;</span><br><span class="line">    A</span><br><span class="line">&#125;</span><br><span class="line">location / &#123;</span><br><span class="line">    B</span><br><span class="line">&#125;</span><br><span class="line">location /doc/ &#123;</span><br><span class="line">    C</span><br><span class="line">&#125;</span><br><span class="line">location ^~ /img/ &#123;</span><br><span class="line">    D</span><br><span class="line">&#125;</span><br><span class="line">location ~* \.(gif|jpg|jpeg)$ &#123;</span><br><span class="line">    E</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>/</code> &#x3D;&#x3D;&gt; A</p>
<p><code>/index.html</code> &#x3D;&#x3D;&gt; B</p>
<p><code>/doc/doc.html</code> &#x3D;&#x3D;&gt; C</p>
<p><code>/img/1.gif</code> &#x3D;&#x3D;&gt; D</p>
<p><code>/doc/1.jpg</code> &#x3D;&#x3D;&gt; E</p>
<h2 id="末尾加斜杠"><a href="#末尾加斜杠" class="headerlink" title="末尾加斜杠"></a>末尾加斜杠</h2><p>？？&#x2F;&#x2F;TODO</p>
<h1 id="merge-slashes"><a href="#merge-slashes" class="headerlink" title="merge_slashes"></a>merge_slashes</h1><p>是否合并斜杠，默认<code>on</code>:</p>
<p>context: http,server</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">location /scripts/ &#123;</span><br><span class="line">    xxx /one.php;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="open-file-cache"><a href="#open-file-cache" class="headerlink" title="open_file_cache"></a>open_file_cache</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">open_file_cache off;</span><br><span class="line">open_file_cache max=N [inactive=time];</span><br><span class="line"></span><br><span class="line">缓存存什么：</span><br><span class="line">    1.open file描述符，大小和修改次数</span><br><span class="line">    2.目录存在的信息；</span><br><span class="line">    3.文件被查找的次数，如&quot;file not found&quot;,&quot;no read permission&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">max: 缓存最大元素数量，LRU</span><br><span class="line">inactive： 最大时间从缓存移除</span><br></pre></td></tr></table></figure>
<h1 id="root"><a href="#root" class="headerlink" title="root"></a>root</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root path;</span><br><span class="line">default: root html;</span><br><span class="line">context: http,server,location</span><br></pre></td></tr></table></figure>
<p>如果一个URI必须被改变，则应该用alias命令。</p>
<h1 id="server"><a href="#server" class="headerlink" title="server"></a>server</h1><p>一个虚拟服务器的配置模块，<code>listen</code>指令描述监听的地址或端口并接收链接，<code>server_name</code>指令列出所有的服务器名称。<br>详细见<a href="/2018/09/23/server/005-how-nginx-handle-a-request/" title="nginx如何处理一个请求">nginx如何处理一个请求</a>.</p>
<h1 id="server-name"><a href="#server-name" class="headerlink" title="server_name"></a>server_name</h1><p>设置一个server的名称,可以有多个，因为匹配的站点可以有多个，但<code>listen</code>只有一个。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">    server_name example.com www.example.com</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>*</code>通配符可以用在开头或结尾表示省略的名字：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">    server_name example.com *.example_name www.example.*</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>同样可以用正则：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">    server_name www.example.com ~^www\d+\.example\.com$</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="server-name的匹配顺序"><a href="#server-name的匹配顺序" class="headerlink" title="server_name的匹配顺序"></a>server_name的匹配顺序</h2><ol>
<li>明确的名称</li>
<li>最长的通配符名开头的名字</li>
<li>最长的通配符名结尾的名字</li>
<li>按定义的顺序出现的第一个正则匹配的名字</li>
</ol>

      
    </div> -->
          <div class="article-entry" itemprop="articleBody">
            
              
                
                      
                        
                          
                            
                              
                                
                                  
                                    <p>
                                      <p>本文翻译自<a target="_blank" rel="noopener" href="https://nginx.org/en/docs/http/ngx_http_core_module.html#directives">官网</a></p>

                                        <p>
                                          
                                            
                                              
                                                      
          </div>
    <p class="article-more-link">
      <a href="/2018/09/19/server/004-nginx-directives/#more">
        Read More
      </a>
    </p>
    <!-- <div class="article-more-link">
      <a href="/2018/09/19/server/004-nginx-directives/#more">
        read more
      </a>
    </div> -->
    


      <footer class="article-footer">
        <a data-url="http://jimolonely.github.io/history/2018/09/19/server/004-nginx-directives/" data-id="cl1fw7fnd00ilvkd3ebdcbbxt" class="article-share-link">
          Share
        </a>
        
            
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/nginx/" rel="tag">nginx</a><span class="article-tag-list-count">6</span></li></ul>

      </footer>
      </div>
      
</article>


  
    <article id="post-server/003-nginx-serve-static" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/09/18/server/003-nginx-serve-static/" class="article-date">
  <time datetime="2018-09-18T12:23:59.000Z" itemprop="datePublished">2018-09-18</time>
</a>
      
  </div>
  <div class="article-inner">
    
      
        <header class="article-header">
          
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/09/18/server/003-nginx-serve-static/">nginx服务静态资源</a>
    </h1>
  

        </header>
        
          <!-- <div class="article-entry" itemprop="articleBody">
      
        
      
    </div> -->
          <div class="article-entry" itemprop="articleBody">
            
              
                
                      
                        
                          
                            
                                
                                            
                                              
                                                      
                                                        
          </div>
          


      <footer class="article-footer">
        <a data-url="http://jimolonely.github.io/history/2018/09/18/server/003-nginx-serve-static/" data-id="cl1fw7fnc00igvkd3846e18hk" class="article-share-link">
          Share
        </a>
        
            
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/nginx/" rel="tag">nginx</a><span class="article-tag-list-count">6</span></li></ul>

      </footer>
      </div>
      
</article>


  
    <article id="post-scala/003-scala-cheat-sheet" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/09/16/scala/003-scala-cheat-sheet/" class="article-date">
  <time datetime="2018-09-16T11:20:28.000Z" itemprop="datePublished">2018-09-16</time>
</a>
      
  </div>
  <div class="article-inner">
    
      
        <header class="article-header">
          
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/09/16/scala/003-scala-cheat-sheet/">scala语法图谱</a>
    </h1>
  

        </header>
        
          <!-- <div class="article-entry" itemprop="articleBody">
      
        <p>下面是几张scala的语法总结，可以打印出来方便查看。</p>
<img src="/2018/09/16/scala/003-scala-cheat-sheet/0.png" class="">

<img src="/2018/09/16/scala/003-scala-cheat-sheet/1.png" class="">

      
    </div> -->
          <div class="article-entry" itemprop="articleBody">
            
              
                
                      
                        
                          
                            
                              
                                
                                  
                                    <p>
                                      <p>下面是几张scala的语法总结，可以打印出来方便查看。</p>

                                        <p>
                                          
                                            
                                              
                                                      
          </div>
    <p class="article-more-link">
      <a href="/2018/09/16/scala/003-scala-cheat-sheet/#more">
        Read More
      </a>
    </p>
    <!-- <div class="article-more-link">
      <a href="/2018/09/16/scala/003-scala-cheat-sheet/#more">
        read more
      </a>
    </div> -->
    


      <footer class="article-footer">
        <a data-url="http://jimolonely.github.io/history/2018/09/16/scala/003-scala-cheat-sheet/" data-id="cl1fw7fnk00j7vkd3de2whfzi" class="article-share-link">
          Share
        </a>
        
            
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/scala/" rel="tag">scala</a><span class="article-tag-list-count">10</span></li></ul>

      </footer>
      </div>
      
</article>


  
    <article id="post-scala/002-sbt-shoud-know" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/09/15/scala/002-sbt-shoud-know/" class="article-date">
  <time datetime="2018-09-15T06:13:33.000Z" itemprop="datePublished">2018-09-15</time>
</a>
      
  </div>
  <div class="article-inner">
    
      
        <header class="article-header">
          
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/09/15/scala/002-sbt-shoud-know/">sbt那些事</a>
    </h1>
  

        </header>
        
          <!-- <div class="article-entry" itemprop="articleBody">
      
        <p>sbt(scala build tool)是scala的构建工具，在使用过程中有些基础的要点。</p>
<h1 id="sbt的安装"><a href="#sbt的安装" class="headerlink" title="sbt的安装"></a>sbt的安装</h1><p>注意修改maven镜像,位于<code>~/.sbt</code>,新建一个<code>repostories</code>文件，改为阿里云的镜像：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># cat ~/.sbt/repositories</span><br><span class="line">[repositories]</span><br><span class="line">local</span><br><span class="line">aliyun: http://maven.aliyun.com/nexus/content/groups/public</span><br><span class="line">jcenter: http://jcenter.bintray.com</span><br><span class="line">typesafe: http://repo.typesafe.com/typesafe/ivy-releases/, [organization]/[module]/(scala_[scalaVersion]/)(sbt_[sbtVersion]/)[revision]/[type]s/[artifact](-[classifier]).[ext], bootOnly</span><br></pre></td></tr></table></figure>

<h1 id="sbt-console"><a href="#sbt-console" class="headerlink" title="sbt console"></a>sbt console</h1><p>运行<code>sbt console</code>就可以进入scala命令行。</p>
<h2 id="帮助"><a href="#帮助" class="headerlink" title="帮助"></a>帮助</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">scala&gt; </span><span class="language-bash">:<span class="built_in">help</span></span></span><br><span class="line">All commands can be abbreviated, e.g., :he instead of :help.</span><br><span class="line">:completions &lt;string&gt;    output completions for the given string</span><br><span class="line">:edit &lt;id&gt;|&lt;line&gt;        edit history</span><br><span class="line">:help [command]          print this summary or command-specific help</span><br><span class="line">:history [num]           show the history (optional num is commands to show)</span><br><span class="line">:h? &lt;string&gt;             search the history</span><br><span class="line">:imports [name name ...] show import history, identifying sources of names</span><br><span class="line">:implicits [-v]          show the implicits in scope</span><br><span class="line">:javap &lt;path|class&gt;      disassemble a file or class name</span><br><span class="line">:line &lt;id&gt;|&lt;line&gt;        place line(s) at the end of history</span><br><span class="line">:load &lt;path&gt;             interpret lines in a file</span><br><span class="line">:paste [-raw] [path]     enter paste mode or paste a file</span><br><span class="line">:power                   enable power user mode</span><br><span class="line">:quit                    exit the interpreter</span><br><span class="line">:replay [options]        reset the repl and replay all previous commands</span><br><span class="line">:require &lt;path&gt;          add a jar to the classpath</span><br><span class="line">:reset [options]         reset the repl to its initial state, forgetting all session entries</span><br><span class="line">:save &lt;path&gt;             save replayable session to a file</span><br><span class="line">:sh &lt;command line&gt;       run a shell command (result is implicitly =&gt; List[String])</span><br><span class="line">:settings &lt;options&gt;      update compiler options, if possible; see reset</span><br><span class="line">:silent                  disable/enable automatic printing of results</span><br><span class="line">:type [-v] &lt;expr&gt;        display the type of an expression without evaluating it</span><br><span class="line">:kind [-v] &lt;type&gt;        display the kind of a type. see also :help kind</span><br><span class="line">:warnings                show the suppressed warnings from the most recent line which had any</span><br></pre></td></tr></table></figure>

<h2 id="清空界面"><a href="#清空界面" class="headerlink" title="清空界面"></a>清空界面</h2><p><code>Ctrl+L</code>应该是个通用快捷键了。</p>
<h2 id="重新加载"><a href="#重新加载" class="headerlink" title="重新加载"></a>重新加载</h2><p>这是个常用的命令，毕竟你不想重新开一遍：</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">scala&gt; :reset</span><br><span class="line"><span class="type">Resetting</span> interpreter state.</span><br><span class="line"><span class="type">Forgetting</span> <span class="keyword">this</span> session history:</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Foo</span></span>&#123;&#125;</span><br><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">FooMaker</span></span>&#123;</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">apply</span></span>() = <span class="keyword">new</span> <span class="type">Foo</span></span><br><span class="line">&#125;</span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<h2 id="退出"><a href="#退出" class="headerlink" title="退出"></a>退出</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">scala&gt; </span><span class="language-bash">:quit</span></span><br><span class="line"></span><br><span class="line">[success] Total time: 10763 s, completed Sep 15, 2018 2:19:20 PM</span><br></pre></td></tr></table></figure>

      
    </div> -->
          <div class="article-entry" itemprop="articleBody">
            
              
                
                      
                        
                          
                            
                              
                                
                                  
                                    <p>
                                      <p>sbt(scala build tool)是scala的构建工具，在使用过程中有些基础的要点。</p>

                                        <p>
                                          
                                            
                                              
                                                      
          </div>
    <p class="article-more-link">
      <a href="/2018/09/15/scala/002-sbt-shoud-know/#more">
        Read More
      </a>
    </p>
    <!-- <div class="article-more-link">
      <a href="/2018/09/15/scala/002-sbt-shoud-know/#more">
        read more
      </a>
    </div> -->
    


      <footer class="article-footer">
        <a data-url="http://jimolonely.github.io/history/2018/09/15/scala/002-sbt-shoud-know/" data-id="cl1fw7fni00j3vkd3f7bs1f0k" class="article-share-link">
          Share
        </a>
        
            
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/sbt/" rel="tag">sbt</a><span class="article-tag-list-count">1</span></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/scala/" rel="tag">scala</a><span class="article-tag-list-count">10</span></li></ul>

      </footer>
      </div>
      
</article>


  
    <article id="post-basic/000-ssh-config" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/09/14/basic/000-ssh-config/" class="article-date">
  <time datetime="2018-09-14T09:07:43.000Z" itemprop="datePublished">2018-09-14</time>
</a>
      
  </div>
  <div class="article-inner">
    
      
        <header class="article-header">
          
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/09/14/basic/000-ssh-config/">ssh连接超时配置</a>
    </h1>
  

        </header>
        
          <!-- <div class="article-entry" itemprop="articleBody">
      
        <p>本文解释ssh的超时配置。</p>
<h1 id="服务端和客户端"><a href="#服务端和客户端" class="headerlink" title="服务端和客户端"></a>服务端和客户端</h1><p>本文约定：</p>
<ol>
<li>客户端： 本机（想连远程主机）</li>
<li>服务端： 远程主机</li>
</ol>
<h1 id="配置文件地址"><a href="#配置文件地址" class="headerlink" title="配置文件地址"></a>配置文件地址</h1><p>分为sshd配置（守护进程）和ssh配置。<br>centos&#x2F;ubuntu</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/etc/ssh/sshd_config： 作为服务端的配置</span><br><span class="line">/etc/ssh/ssh_config： 作为客户端的配置</span><br></pre></td></tr></table></figure>

<h1 id="超时配置"><a href="#超时配置" class="headerlink" title="超时配置"></a>超时配置</h1><p>当连上远程的ssh服务器，如果没有操作，一会就断开连接了，这个时间可以设置得长一些。</p>
<h2 id="在客户端修改"><a href="#在客户端修改" class="headerlink" title="在客户端修改"></a>在客户端修改</h2><p>也就是在你本机上修改<code>/etc/ssh/ssh_config</code>文件，这样所有的连接都会起作用：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Host *</span><br><span class="line">ServerAliveInterval <span class="number">120</span> <span class="comment"># 秒</span></span><br></pre></td></tr></table></figure>
<p>每隔120秒模拟发送按键事件，防止断开，一般是你可能会遇到这个问题有用：<br><code>packet_write_wait: Connection to 192.168.100.11 port 22: Broken pipe</code></p>
<h2 id="在服务端修改"><a href="#在服务端修改" class="headerlink" title="在服务端修改"></a>在服务端修改</h2><p>当然，如果你只想针对某台服务器修改，就可以在服务端去修改（注意需要遵守规范，毕竟服务端是大家共有的）。</p>
<h3 id="方式1"><a href="#方式1" class="headerlink" title="方式1"></a>方式1</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ClientAliveInterval 10m          # 10 minutes</span><br><span class="line">ClientAliveCountMax 2           # 2 次</span><br></pre></td></tr></table></figure>
<h3 id="方式2"><a href="#方式2" class="headerlink" title="方式2"></a>方式2</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">vi /etc/ssh/sshd_config</span></span><br><span class="line">ClientAliveInterval 20m          # 20 minutes</span><br><span class="line">ClientAliveCountMax 0            # 0 次</span><br></pre></td></tr></table></figure>

<h3 id="区别"><a href="#区别" class="headerlink" title="区别"></a>区别</h3><p>这两种方法之间有一点区别。 对于第一种方法，sshd将通过加密通道发送消息，此处称为Client Alive Messages，如果客户端处于非活动状态10分钟，则从客户端请求响应。 sshd守护程序将最多发送这些消息两次。 如果在发送客户端活动消息时达到此阈值，sshd将断开客户端的连接。</p>
<p>但对于第二种方法，如果客户端处于非活动状态20分钟，sshd将不会发送客户端活动消息并直接终止会话。</p>
<h1 id="直接修改超时时间"><a href="#直接修改超时时间" class="headerlink" title="直接修改超时时间"></a>直接修改超时时间</h1><ol>
<li><p>修改&#x2F;etc&#x2F;profile下tmout参数<br>  如：sudo vi &#x2F;etc&#x2F;profile<br>  tmout&#x3D;300<br>  就是300秒后闲置自动退出；</p>
</li>
<li><p>在未设置TMOUT或者设置TMOUT&#x3D;0时，此闲置超时自动退出的功能禁用。</p>
</li>
</ol>
<p>这个很简单。</p>
<h1 id="重启ssh服务"><a href="#重启ssh服务" class="headerlink" title="重启ssh服务"></a>重启ssh服务</h1><p>修改了任何配置记得重启服务（对应修改的哪端就重启哪端）</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">service sshd restart</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">service ssh restart</span></span><br></pre></td></tr></table></figure>

<p>注意：在ubuntu上先安装<code>openssh-server</code>:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo apt install openssh-server</span></span><br></pre></td></tr></table></figure>

<h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><p><a target="_blank" rel="noopener" href="http://blog.51cto.com/9237101/1907424">http://blog.51cto.com/9237101/1907424</a></p>
<p><a target="_blank" rel="noopener" href="https://www.thegeekdiary.com/centos-rhel-how-to-setup-session-idle-timeout-inactivity-timeout-for-ssh-auto-logout/">https://www.thegeekdiary.com/centos-rhel-how-to-setup-session-idle-timeout-inactivity-timeout-for-ssh-auto-logout/</a></p>

      
    </div> -->
          <div class="article-entry" itemprop="articleBody">
            
              
                
                      
                        
                          
                            
                              
                                
                                  
                                    <p>
                                      <p>本文解释ssh的超时配置。</p>

                                        <p>
                                          
                                            
                                              
                                                      
          </div>
    <p class="article-more-link">
      <a href="/2018/09/14/basic/000-ssh-config/#more">
        Read More
      </a>
    </p>
    <!-- <div class="article-more-link">
      <a href="/2018/09/14/basic/000-ssh-config/#more">
        read more
      </a>
    </div> -->
    


      <footer class="article-footer">
        <a data-url="http://jimolonely.github.io/history/2018/09/14/basic/000-ssh-config/" data-id="cl1fw7fhl000dvkd3dkor7f69" class="article-share-link">
          Share
        </a>
        
            
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/basic/" rel="tag">basic</a><span class="article-tag-list-count">7</span></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ssh/" rel="tag">ssh</a><span class="article-tag-list-count">5</span></li></ul>

      </footer>
      </div>
      
</article>


  
    <article id="post-db/005-connection-pool" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/09/13/db/005-connection-pool/" class="article-date">
  <time datetime="2018-09-13T06:22:49.000Z" itemprop="datePublished">2018-09-13</time>
</a>
      
  </div>
  <div class="article-inner">
    
      
        <header class="article-header">
          
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/09/13/db/005-connection-pool/">数据库连接池那些事</a>
    </h1>
  

        </header>
        
          <!-- <div class="article-entry" itemprop="articleBody">
      
        <p>数据库连接池必备知识。</p>
<h1 id="基本概念"><a href="#基本概念" class="headerlink" title="基本概念"></a>基本概念</h1><p>这还用说吗？</p>
<h1 id="常见连接池"><a href="#常见连接池" class="headerlink" title="常见连接池"></a>常见连接池</h1><h2 id="HikariCP"><a href="#HikariCP" class="headerlink" title="HikariCP"></a>HikariCP</h2><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="comment">#数据库连接</span></span><br><span class="line">  <span class="attr">datasource:</span></span><br><span class="line">    <span class="attr">driver-class-name:</span> <span class="string">org.postgresql.Driver</span></span><br><span class="line">    <span class="attr">url:</span> <span class="string">jdbc:postgresql://xxx/db?charSet=utf-8</span></span><br><span class="line">    <span class="attr">username:</span> <span class="string">root</span></span><br><span class="line">    <span class="attr">password:</span> <span class="string">root</span></span><br><span class="line">    <span class="comment"># spring-boot2.0 默认连接池</span></span><br><span class="line">    <span class="attr">hikari:</span></span><br><span class="line">      <span class="attr">idle-timeout:</span> <span class="number">1200000</span> <span class="comment"># 20min</span></span><br><span class="line">      <span class="attr">connection-timeout:</span> <span class="number">30000</span></span><br><span class="line">      <span class="attr">max-lifetime:</span> <span class="number">3600000</span> <span class="comment"># 1h</span></span><br><span class="line">      <span class="attr">validation-timeout:</span> <span class="number">20000</span></span><br><span class="line">      <span class="attr">maximum-pool-size:</span> <span class="number">30</span></span><br><span class="line"><span class="string">````</span></span><br><span class="line">[<span class="string">详细配置看github</span>]<span class="string">(https://github.com/brettwooldridge/HikariCP#configuration-knobs-baby)</span></span><br><span class="line"></span><br><span class="line">[<span class="string">看别人翻译的</span>]<span class="string">(http://www.zhz.gift/2018/01/30/HikariCP%20%E9%85%8D%E7%BD%AE%E8%AF%B4%E6%98%8E/)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## DBCP</span></span><br><span class="line"><span class="string">```sql</span></span><br><span class="line"><span class="attr">dataSource:</span> <span class="string">要连接的</span> <span class="string">datasource</span> <span class="string">(通常我们不会定义在</span> <span class="string">server.xml)</span></span><br><span class="line"><span class="attr">defaultAutoCommit:</span> <span class="string">对于事务是否</span> <span class="string">autoCommit,</span> <span class="string">默认值为</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">defaultReadOnly:</span> <span class="string">对于数据库是否只能读取,</span> <span class="string">默认值为</span> <span class="literal">false</span></span><br><span class="line"><span class="string">driverClassName:连接数据库所用的</span> <span class="string">JDBC</span> <span class="string">Driver</span> <span class="string">Class</span></span><br><span class="line"><span class="attr">maxActive:</span> <span class="string">可以从对象池中取出的对象最大个数，为0则表示没有限制，默认为8</span></span><br><span class="line"><span class="attr">maxIdle:</span> <span class="string">最大等待连接中的数量,设</span> <span class="number">0</span> <span class="string">为没有限制</span> <span class="string">（对象池中对象最大个数）</span></span><br><span class="line"><span class="string">minIdle：对象池中对象最小个数</span></span><br><span class="line"><span class="attr">maxWait:</span> <span class="string">最大等待秒数,</span> <span class="string">单位为</span> <span class="string">ms,</span> <span class="string">超过时间会丟出错误信息</span></span><br><span class="line"><span class="attr">password:</span> <span class="string">登陆数据库所用的密码</span></span><br><span class="line"><span class="attr">url:</span> <span class="string">连接数据库的</span> <span class="string">URL</span></span><br><span class="line"><span class="attr">username:</span> <span class="string">登陆数据库所用的帐号</span></span><br><span class="line"><span class="attr">validationQuery:</span> <span class="string">验证连接是否成功,</span> <span class="string">SQL</span> <span class="string">SELECT</span> <span class="string">指令至少要返回一行</span></span><br><span class="line"><span class="attr">removeAbandoned:</span> <span class="string">是否自我中断,</span> <span class="string">默认是</span> <span class="literal">false</span></span><br><span class="line"><span class="attr">removeAbandonedTimeout:</span> <span class="string">几秒后会自我中断,</span> <span class="string">removeAbandoned</span> <span class="string">必须为</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">logAbandoned:</span> <span class="string">是否记录中断事件,</span> <span class="string">默认为</span> <span class="literal">false</span></span><br><span class="line"><span class="string">minEvictableIdleTimeMillis：大于0</span> <span class="string">，进行连接空闲时间判断，或为0，对空闲的连接不进行验证；默认30分钟</span></span><br><span class="line"><span class="string">timeBetweenEvictionRunsMillis：失效检查线程运行时间间隔，如果小于等于0，不会启动检查线程，默认-1</span></span><br><span class="line"><span class="string">testOnBorrow：取得对象时是否进行验证，检查对象是否有效，默认为fals</span></span><br><span class="line"><span class="string">etestOnReturn：返回对象时是否进行验证，检查对象是否有效，默认为false</span></span><br><span class="line"><span class="string">testWhileIdle：空闲时是否进行验证，检查对象是否有效，默认为false</span></span><br><span class="line"><span class="string">initialSize：初始化线程数</span></span><br></pre></td></tr></table></figure>
<h2 id="C3P0"><a href="#C3P0" class="headerlink" title="C3P0"></a>C3P0</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">acquireIncrement: 当连接池中的连接耗尽的时候c3p0一次同时获取的连接数。Default: 3</span><br><span class="line">acquireRetryAttempts: 定义在从数据库获取新连接失败后重复尝试的次数。Default: 30</span><br><span class="line">acquireRetryDelay: 两次连接中间隔时间，单位毫秒。Default: 1000</span><br><span class="line">autoCommitOnClose: 连接关闭时默认将所有未提交的操作回滚。Defaul t: false</span><br><span class="line">automaticTestTable: c3p0将建一张名为Test的空表，并使用其自带的查询语句进行测试。如果定义了这个参数那么属性preferredTestQuery将被忽略。你不 能在这张Test表上进行任何操作，它将只供c3p0测试使用。Default: null</span><br><span class="line">breakAfterAcquireFailure: 获取连接失败将会引起所有等待连接池来获取连接的线程抛出异常。但是数据源仍有效保留，并在下次调用getConnection()的时候继续尝试获取连 接。如果设为true，那么在尝试获取连接失败后该数据源将申明已断开并永久关闭。Default: false</span><br><span class="line">checkoutTimeout：当连接池用完时客户端调用getConnection()后等待获取新连接的时间，超时后将抛出SQLException,如设为0则无限期等待。单位毫秒。Default: 0</span><br><span class="line">connectionTesterClassName: 通过实现ConnectionTester或QueryConnectionT ester的类来测试连接。类名需制定全路径。Default: com.mchange.v2.c3p0.impl.Def aultConnectionTester</span><br><span class="line">factoryClassLocation: 指定c3p0 libraries的路径，如果（通常都是这样）在本地即可获得那么无需设置，默认null即可Default: null</span><br><span class="line">idleConnectionTestPeriod: 每60秒检查所有连接池中的空闲连接。Defaul t: 0</span><br><span class="line">initialPoolSize: 初始化时获取三个连接，取值应在minPoolSize与maxPoolSize之间。Default: 3</span><br><span class="line">maxIdleTime: 最大空闲时间,60秒内未使用则连接被丢弃。若为0则永不丢弃。Default: 0</span><br><span class="line">maxPoolSize: 连接池中保留的最大连接数。Default: 15</span><br><span class="line">maxStatements: JDBC的标准参数，用以控制数据源内加载的PreparedSt atements数量。但由于预缓存的statements属于单个connection而不是整个连接池。所以设置这个参数需要考虑到多方面的因素。如 果maxStatements与maxStatementsPerConnection均为0，则缓存被关闭。Default: 0</span><br><span class="line">maxStatementsPerConnection: maxStatementsPerConnection定义了连接池内单个连接所拥有的最大缓存statements数。Default: 0</span><br><span class="line">numHelperThreads：c3p0是异步操作的，缓慢的JDBC操作通过帮助进程完成。扩展这些操作可以有效的提升性能通过多线程实现多个操作同时被执行。Default: 3</span><br><span class="line">overrideDefaultUser：当用户调用getConnection()时使root用户成为去获取连接的用户。主要用于连接池连接非c3p0的数据源时。Default: null</span><br><span class="line">overrideDefaultPassword：与overrideDefaultUser参数对应使用的一个参数。Default: null</span><br><span class="line">password：密码。Default: null</span><br><span class="line">user：用户名。Default: null</span><br><span class="line">preferredTestQuery：定义所有连接测试都执行的测试语句。在使用连接测试的情况下这个一显著提高测试速度。注意：测试的表必须在初始数据源的时候就存在。Default: null</span><br><span class="line">propertyCycle：用户修改系统配置参数执行前最多等待300秒。Defaul t: 300</span><br><span class="line">testConnectionOnCheckout：因性能消耗大请只在需要的时候使用它。如果设为true那么在每个connection提交 的时候都将校验其有效性。建议使用idleConnectio nTestPeriod或automaticTestTable等方法来提升连接测试的性能。Default: false</span><br><span class="line">testConnectionOnCheckin：如果设为true那么在取得连接的同时将校验连接的有效性。Default: false</span><br></pre></td></tr></table></figure>
<h2 id="BoneCP"><a href="#BoneCP" class="headerlink" title="BoneCP"></a>BoneCP</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">acquireIncrement: 当连接池中的连接耗尽的时候c3p0一次同时获取的连接数。Default: 3</span><br><span class="line">driveClass:数据库驱动</span><br><span class="line">jdbcUrl:响应驱动的jdbcUrl</span><br><span class="line">username:数据库的用户名</span><br><span class="line">password:数据库的密码</span><br><span class="line">idleConnectionTestPeriod:检查数据库连接池中控线连接的间隔时间，单位是分，默认值：240，如果要取消则设置为0</span><br><span class="line">idleMaxAge:连接池中未使用的链接最大存活时间，单位是分，默认值：60，如果要永远存活设置为0</span><br><span class="line">maxConnectionsPerPartition:每个分区最大的连接数</span><br><span class="line">minConnectionsPerPartition:每个分区最小的连接数</span><br><span class="line">partitionCount:分区数，默认值2，最小1，推荐3-4，视应用而定</span><br><span class="line">acquireIncrement:每次去拿数据库连接的时候一次性要拿几个，默认值：2</span><br><span class="line">statementsCacheSize:缓存prepared statements的大小，默认值：0</span><br><span class="line">releaseHelperThreads:每个分区释放链接助理进程的数量，默认值：3，除非你的一个数据库连接的时间内做了很多工作，不然过多的助理进程会影响你的性能</span><br></pre></td></tr></table></figure>
<h2 id="Druid"><a href="#Druid" class="headerlink" title="Druid"></a>Druid</h2><p><a target="_blank" rel="noopener" href="https://github.com/alibaba/druid/wiki/DruidDataSource%E9%85%8D%E7%BD%AE%E5%B1%9E%E6%80%A7%E5%88%97%E8%A1%A8">https://github.com/alibaba/druid/wiki/DruidDataSource%E9%85%8D%E7%BD%AE%E5%B1%9E%E6%80%A7%E5%88%97%E8%A1%A8</a></p>

      
    </div> -->
          <div class="article-entry" itemprop="articleBody">
            
              
                
                      
                        
                          
                            
                              
                                
                                  
                                    <p>
                                      <p>数据库连接池必备知识。</p>

                                        <p>
                                          
                                            
                                              
                                                      
          </div>
    <p class="article-more-link">
      <a href="/2018/09/13/db/005-connection-pool/#more">
        Read More
      </a>
    </p>
    <!-- <div class="article-more-link">
      <a href="/2018/09/13/db/005-connection-pool/#more">
        read more
      </a>
    </div> -->
    


      <footer class="article-footer">
        <a data-url="http://jimolonely.github.io/history/2018/09/13/db/005-connection-pool/" data-id="cl1fw7fj3003svkd38pk3dfzv" class="article-share-link">
          Share
        </a>
        
            
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/sql/" rel="tag">sql</a><span class="article-tag-list-count">3</span></li></ul>

      </footer>
      </div>
      
</article>


  
    <article id="post-db/004-pgsql-function" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/09/11/db/004-pgsql-function/" class="article-date">
  <time datetime="2018-09-11T04:47:47.000Z" itemprop="datePublished">2018-09-11</time>
</a>
      
  </div>
  <div class="article-inner">
    
      
        <header class="article-header">
          
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/09/11/db/004-pgsql-function/">pgsql函数(存储过程)</a>
    </h1>
  

        </header>
        
          <!-- <div class="article-entry" itemprop="articleBody">
      
        <p>pgsql里的函数就是存储过程，触发器会用到函数。</p>
<h1 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h1><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">OR</span> REPLACE <span class="keyword">FUNCTION</span> code_trigger_func1() <span class="keyword">RETURNS</span> <span class="type">INT</span> <span class="keyword">AS</span> $$</span><br><span class="line"><span class="keyword">DECLARE</span></span><br><span class="line">	code <span class="type">VARCHAR</span>;</span><br><span class="line">	table_exist <span class="type">VARCHAR</span>;</span><br><span class="line">	sql_temp <span class="type">VARCHAR</span>;</span><br><span class="line">	t_name <span class="type">varchar</span>;</span><br><span class="line"><span class="keyword">BEGIN</span></span><br><span class="line">	code :<span class="operator">=</span> <span class="string">&#x27;c00001&#x27;</span>;</span><br><span class="line">	t_name :<span class="operator">=</span> <span class="string">&#x27;j_test_&#x27;</span><span class="operator">||</span>code;</span><br><span class="line"><span class="comment">-- 	code := NEW.code;</span></span><br><span class="line">	<span class="comment">-- 判断是否存在对应的表，否则新建,需要重建索引和主键</span></span><br><span class="line">	<span class="keyword">select</span> to_regclass(t_name) <span class="keyword">into</span> table_exist;</span><br><span class="line">	if table_exist <span class="keyword">is</span> <span class="keyword">NULL</span> <span class="keyword">THEN</span></span><br><span class="line"><span class="comment">-- 		create table xxxx() INHERITS old_table;</span></span><br><span class="line"><span class="comment">-- 		alter table xxxx add CONSTRAINT cons_xxxx PRIMARY KEY(id); </span></span><br><span class="line">		sql_temp :<span class="operator">=</span> <span class="string">&#x27;create table &#x27;</span><span class="operator">||</span>t_name<span class="operator">||</span><span class="string">&#x27;() inherits (j_code);&#x27;</span>;</span><br><span class="line">		<span class="keyword">EXECUTE</span>(sql_temp);</span><br><span class="line">		sql_temp :<span class="operator">=</span> <span class="string">&#x27;alter table &#x27;</span><span class="operator">||</span>t_name<span class="operator">||</span><span class="string">&#x27; add CONSTRAINT j_cons_&#x27;</span><span class="operator">||</span>t_name<span class="operator">||</span><span class="string">&#x27; PRIMARY KEY(code);&#x27;</span>;</span><br><span class="line">		<span class="keyword">EXECUTE</span>(sql_temp);</span><br><span class="line">		raise notice <span class="string">&#x27;existin: %&#x27;</span>, table_exist;</span><br><span class="line">		raise notice <span class="string">&#x27;table : % created&#x27;</span>, t_name;</span><br><span class="line">	<span class="keyword">ELSE</span></span><br><span class="line">		raise notice <span class="string">&#x27;exist: %&#x27;</span>,table_exist;</span><br><span class="line">	<span class="keyword">END</span> IF;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line"><span class="keyword">END</span>;</span><br><span class="line">$$ <span class="keyword">LANGUAGE</span> plpgsql;</span><br></pre></td></tr></table></figure>

<h1 id="一些常见问题"><a href="#一些常见问题" class="headerlink" title="一些常见问题"></a>一些常见问题</h1><h2 id="单引号嵌套"><a href="#单引号嵌套" class="headerlink" title="单引号嵌套"></a>单引号嵌套</h2><p>要在单引号里打印出单引号，比如<code>raise notice &#39;xxxx&#39;</code></p>
<p>正确写法：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27;&#x27;&#x27;yes&#x27;&#x27;&#x27; --&gt; &#x27;yes&#x27;</span><br></pre></td></tr></table></figure>
<p>也就是不是用<code>/</code>转义，而是用单引号转义.</p>
<h2 id="array-append"><a href="#array-append" class="headerlink" title="array_append"></a>array_append</h2><p>追加数据需要返回数组，否则报错：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">arr := array_append(arr, &#x27;ele&#x27;);</span><br></pre></td></tr></table></figure>
<p>打印数组：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">raise notice &#x27;%s&#x27;,array_to_string(arr, &#x27;,&#x27;);</span><br></pre></td></tr></table></figure>



<h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1>
      
    </div> -->
          <div class="article-entry" itemprop="articleBody">
            
              
                
                      
                        
                          
                            
                              
                                
                                  
                                    <p>
                                      <p>pgsql里的函数就是存储过程，触发器会用到函数。</p>

                                        <p>
                                          
                                            
                                              
                                                      
          </div>
    <p class="article-more-link">
      <a href="/2018/09/11/db/004-pgsql-function/#more">
        Read More
      </a>
    </p>
    <!-- <div class="article-more-link">
      <a href="/2018/09/11/db/004-pgsql-function/#more">
        read more
      </a>
    </div> -->
    


      <footer class="article-footer">
        <a data-url="http://jimolonely.github.io/history/2018/09/11/db/004-pgsql-function/" data-id="cl1fw7fj2003ovkd3305h79ia" class="article-share-link">
          Share
        </a>
        
            
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/pgsql/" rel="tag">pgsql</a><span class="article-tag-list-count">4</span></li></ul>

      </footer>
      </div>
      
</article>


  
    <article id="post-lang/012-redis-distributed-lock" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/09/10/lang/012-redis-distributed-lock/" class="article-date">
  <time datetime="2018-09-10T05:48:49.000Z" itemprop="datePublished">2018-09-10</time>
</a>
      
  </div>
  <div class="article-inner">
    
      
        <header class="article-header">
          
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/09/10/lang/012-redis-distributed-lock/">redis分布式锁</a>
    </h1>
  

        </header>
        
          <!-- <div class="article-entry" itemprop="articleBody">
      
        <p>在许多环境中，分布式锁是一种非常有用的原语，其中不同的进程必须以互斥的方式与共享资源一起运行。</p>
<p>有许多库和博客文章描述了如何使用Redis实现DLM（分布式锁管理器），但是每个库都使用不同的方法，并且许多库使用简单的方法，与稍微复杂的方法相比可以实现更低的保证设计。</p>
<p>本文试图提供一种更典型的算法来使用Redis实现分布式锁。 我们提出了一种称为Redlock的算法，它实现了一种我们认为比vanilla单实例方法更安全的DLM。 我们希望社区将对其进行分析，提供反馈，并将其作为实施或更复杂或替代设计的起点。</p>
<h1 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h1><p>在描述算法之前，这里有几个已经可用的实现的链接，可用于参考。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">Redlock-rb（Ruby实现）。 还有一个Redlock-rb的分支，它可以添加一个宝石，方便分发，也许更多。</span><br><span class="line">Redlock-py（Python实现）。</span><br><span class="line">Aioredlock（Asyncio Python实现）。</span><br><span class="line">Redlock-php（PHP实现）。</span><br><span class="line">PHPRedisMutex（进一步的PHP实现）</span><br><span class="line">cheprasov / php-redis-lock（用于锁的PHP库）</span><br><span class="line">Redsync.go（Go实现）。</span><br><span class="line">Redisson（Java实现）。</span><br><span class="line">Redis :: DistLock（Perl实现）。</span><br><span class="line">Redlock-cpp（C ++实现）。</span><br><span class="line">Redlock-cs（C＃/ .NET实现）。</span><br><span class="line">RedLock.net（C＃/ .NET实现）。 包括异步和锁扩展支持。</span><br><span class="line">ScarletLock（带可配置数据存储区的C＃.NET实现）</span><br><span class="line">node-redlock（NodeJS实现）。 包括对锁定扩展的支持。</span><br></pre></td></tr></table></figure>
<h1 id="安全和存活保障"><a href="#安全和存活保障" class="headerlink" title="安全和存活保障"></a>安全和存活保障</h1><p>我们将仅使用三个属性对我们的设计进行建模，从我们的角度来看，这些属性是以有效方式使用分布式锁所需的最低保证。</p>
<ol>
<li>安全属性：相互排斥。 在任何给定时刻，只有一个客户端可以持有锁。</li>
<li>活力属性A：无死锁。 最终，即使锁定资源的客户端崩溃或被分区，也始终可以获取锁。</li>
<li>活力属性B：容错。 只要大多数Redis节点启动，客户端就能够获取和释放锁。</li>
</ol>
<h1 id="为什么基于故障转移的实现还不够"><a href="#为什么基于故障转移的实现还不够" class="headerlink" title="为什么基于故障转移的实现还不够"></a>为什么基于故障转移的实现还不够</h1><p>为了理解我们想要改进的内容，让我们分析大多数基于Redis的分布式锁库的当前状态。</p>
<p>使用Redis锁定资源的最简单方法是在实例中创建key。 key通常使用Redis expires功能在有限的生存时间内创建，因此最终它将被释放（我们列表中的属性2）。 当客户端需要释放资源时，它会删除key。</p>
<p>从表面上看，这很有效，但存在一个问题：这是我们架构中的单点故障。 如果Redis主机出现故障会怎样？ 好吧，让我们添加一个奴隶！ 如果主服务器不可用，请使用它。 遗憾的是，这不可行。 通过这样做，我们无法实现互斥的安全属性，因为Redis复制是异步的。</p>
<p>这个模型有明显的竞争条件：</p>
<ol>
<li>客户端A获取主服务器中的锁。</li>
<li>在写入key之前，主机崩溃并发送到从机。</li>
<li>奴隶被提升为主人。</li>
<li>客户端B获取对已经拥有锁的相同资源的锁。 安全违规！</li>
</ol>
<p>有时在特殊情况下，例如在故障期间，多个客户端可以同时保持锁定，这是完全正常的。 如果是这种情况，您可以使用基于复制的解决方案。 否则，我们建议实施本文档中描述的解决方案。</p>
<h1 id="使用单个实例正确实现"><a href="#使用单个实例正确实现" class="headerlink" title="使用单个实例正确实现"></a>使用单个实例正确实现</h1><p>在尝试克服上述单实例设置的限制之前，让我们在这个简单的情况下检查如何正确地进行操作，因为这实际上是一个可行的解决方案，在不时可以接受竞争条件的应用程序中，并且因为锁定到 单个实例是我们将用于此处描述的分布式算法的基础。</p>
<p>要获得锁，可以采取以下措施：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SET resource_name my_random_value NX PX 30000</span><br></pre></td></tr></table></figure>
<p>该命令仅在key尚不存在时才设置key（NX选项），过期时间为30000毫秒（PX选项）。 值“myrandomvalue”。 此值必须在所有客户端和所有锁定请求中都是唯一的。</p>
<p>基本上使用随机值是为了以安全的方式释放锁，使用一个告诉Redis的脚本：仅当key存在且存储在key上的值恰好是我期望的值时才删除key。 这是通过以下Lua脚本完成的：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">if redis.call(&quot;get&quot;,KEYS[1]) == ARGV[1] then</span><br><span class="line">    return redis.call(&quot;del&quot;,KEYS[1])</span><br><span class="line">else</span><br><span class="line">    return 0</span><br><span class="line">end</span><br></pre></td></tr></table></figure>
<p>这很重要，以避免删除由另一个客户端创建的锁。 例如，客户端可能获得锁定，在某些操作中被阻止的时间超过锁定有效时间（key将到期的时间），并且稍后移除已经由某个其他客户端获取的锁定。 仅使用DEL是不安全的，因为客户端可能会删除另一个客户端的锁定。 使用上面的脚本而不是每个锁都使用随机字符串“签名”，因此只有在客户端尝试删除锁时，锁才会被删除。</p>
<h1 id="hello"><a href="#hello" class="headerlink" title="hello"></a>hello</h1>
      
    </div> -->
          <div class="article-entry" itemprop="articleBody">
            
              
                
                      
                        
                          
                            
                              
                                
                                  
                                    <p>
                                      <p>在许多环境中，分布式锁是一种非常有用的原语，其中不同的进程必须以互斥的方式与共享资源一起运行。</p>

                                        <p>
                                          
                                            
                                              
                                                      
          </div>
    <p class="article-more-link">
      <a href="/2018/09/10/lang/012-redis-distributed-lock/#more">
        Read More
      </a>
    </p>
    <!-- <div class="article-more-link">
      <a href="/2018/09/10/lang/012-redis-distributed-lock/#more">
        read more
      </a>
    </div> -->
    


      <footer class="article-footer">
        <a data-url="http://jimolonely.github.io/history/2018/09/10/lang/012-redis-distributed-lock/" data-id="cl1fw7fm800e8vkd37zkjgvna" class="article-share-link">
          Share
        </a>
        
            
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/redis/" rel="tag">redis</a><span class="article-tag-list-count">12</span></li></ul>

      </footer>
      </div>
      
</article>


  
    <article id="post-server/002-tomcat-config" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/09/10/server/002-tomcat-config/" class="article-date">
  <time datetime="2018-09-09T23:57:11.000Z" itemprop="datePublished">2018-09-10</time>
</a>
      
  </div>
  <div class="article-inner">
    
      
        <header class="article-header">
          
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/09/10/server/002-tomcat-config/">tomcat配置</a>
    </h1>
  

        </header>
        
          <!-- <div class="article-entry" itemprop="articleBody">
      
        <p>tomcat目前是使用量最大的服务器，不得不学。</p>
<h1 id="了解目录结构"><a href="#了解目录结构" class="headerlink" title="了解目录结构"></a>了解目录结构</h1><ul>
<li>&#x2F; bin - 启动，关闭和其他脚本。 * .sh文件（对于Unix系统）是* .bat文件的功能重复（对于Windows系统）。 由于Win32命令行缺少某些功能，因此这里有一些额外的文件。</li>
<li>&#x2F; conf - 配置文件和相关的DTD。 这里最重要的文件是server.xml。 它是容器的主要配置文件。</li>
<li>&#x2F; logs - 默认情况下，日志文件在此处。</li>
<li>&#x2F; webapps - 这是您的webapps的用武之地。</li>
</ul>
<h1 id="如何管理APP"><a href="#如何管理APP" class="headerlink" title="如何管理APP"></a>如何管理APP</h1><p><a target="_blank" rel="noopener" href="https://tomcat.apache.org/tomcat-8.5-doc/manager-howto.html">https://tomcat.apache.org/tomcat-8.5-doc/manager-howto.html</a></p>
<h2 id="manager"><a href="#manager" class="headerlink" title="manager"></a>manager</h2><p>manager就是管理app的页面，tomcat自带有，它能做的事情有以下几个：</p>
<p>&#x2F;&#x2F;TODO</p>
<p>但我们直接访问时会发现权限问题：</p>


<p>所以需要做一些配置：</p>
<p>我们会发现在<code>/webapps/manager/WEB-INF/web.xml</code>下有几个角色的定义：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">120   <span class="comment">&lt;!-- Define a Security Constraint on this Application --&gt;</span></span><br><span class="line">121   <span class="comment">&lt;!-- <span class="doctag">NOTE:</span>  None of these roles are present in the default users file --&gt;</span></span><br><span class="line">122   <span class="tag">&lt;<span class="name">security-constraint</span>&gt;</span></span><br><span class="line">123     <span class="tag">&lt;<span class="name">web-resource-collection</span>&gt;</span></span><br><span class="line">124       <span class="tag">&lt;<span class="name">web-resource-name</span>&gt;</span>HTML Manager interface (for humans)<span class="tag">&lt;/<span class="name">web-resource-name</span>&gt;</span></span><br><span class="line">125       <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/html/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">126     <span class="tag">&lt;/<span class="name">web-resource-collection</span>&gt;</span></span><br><span class="line">127     <span class="tag">&lt;<span class="name">auth-constraint</span>&gt;</span></span><br><span class="line">128        <span class="tag">&lt;<span class="name">role-name</span>&gt;</span>manager-gui<span class="tag">&lt;/<span class="name">role-name</span>&gt;</span></span><br><span class="line">129     <span class="tag">&lt;/<span class="name">auth-constraint</span>&gt;</span></span><br><span class="line">130   <span class="tag">&lt;/<span class="name">security-constraint</span>&gt;</span></span><br><span class="line">131   <span class="tag">&lt;<span class="name">security-constraint</span>&gt;</span></span><br><span class="line">132     <span class="tag">&lt;<span class="name">web-resource-collection</span>&gt;</span></span><br><span class="line">133       <span class="tag">&lt;<span class="name">web-resource-name</span>&gt;</span>Text Manager interface (for scripts)<span class="tag">&lt;/<span class="name">web-resource-name</span>&gt;</span></span><br><span class="line">134       <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/text/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">135     <span class="tag">&lt;/<span class="name">web-resource-collection</span>&gt;</span></span><br><span class="line">136     <span class="tag">&lt;<span class="name">auth-constraint</span>&gt;</span></span><br><span class="line">137        <span class="tag">&lt;<span class="name">role-name</span>&gt;</span>manager-script<span class="tag">&lt;/<span class="name">role-name</span>&gt;</span></span><br><span class="line">138     <span class="tag">&lt;/<span class="name">auth-constraint</span>&gt;</span></span><br><span class="line">139   <span class="tag">&lt;/<span class="name">security-constraint</span>&gt;</span></span><br><span class="line">140   <span class="tag">&lt;<span class="name">security-constraint</span>&gt;</span></span><br><span class="line">141     <span class="tag">&lt;<span class="name">web-resource-collection</span>&gt;</span></span><br><span class="line">142       <span class="tag">&lt;<span class="name">web-resource-name</span>&gt;</span>JMX Proxy interface<span class="tag">&lt;/<span class="name">web-resource-name</span>&gt;</span></span><br><span class="line">143       <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/jmxproxy/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">144     <span class="tag">&lt;/<span class="name">web-resource-collection</span>&gt;</span></span><br><span class="line">145     <span class="tag">&lt;<span class="name">auth-constraint</span>&gt;</span></span><br><span class="line">146        <span class="tag">&lt;<span class="name">role-name</span>&gt;</span>manager-jmx<span class="tag">&lt;/<span class="name">role-name</span>&gt;</span></span><br><span class="line">147     <span class="tag">&lt;/<span class="name">auth-constraint</span>&gt;</span></span><br><span class="line">148   <span class="tag">&lt;/<span class="name">security-constraint</span>&gt;</span></span><br><span class="line">149   <span class="tag">&lt;<span class="name">security-constraint</span>&gt;</span></span><br><span class="line">150     <span class="tag">&lt;<span class="name">web-resource-collection</span>&gt;</span></span><br><span class="line">151       <span class="tag">&lt;<span class="name">web-resource-name</span>&gt;</span>Status interface<span class="tag">&lt;/<span class="name">web-resource-name</span>&gt;</span></span><br><span class="line">152       <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/status/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">153     <span class="tag">&lt;/<span class="name">web-resource-collection</span>&gt;</span></span><br><span class="line">154     <span class="tag">&lt;<span class="name">auth-constraint</span>&gt;</span></span><br><span class="line">155        <span class="tag">&lt;<span class="name">role-name</span>&gt;</span>manager-gui<span class="tag">&lt;/<span class="name">role-name</span>&gt;</span></span><br><span class="line">156        <span class="tag">&lt;<span class="name">role-name</span>&gt;</span>manager-script<span class="tag">&lt;/<span class="name">role-name</span>&gt;</span></span><br><span class="line">157        <span class="tag">&lt;<span class="name">role-name</span>&gt;</span>manager-jmx<span class="tag">&lt;/<span class="name">role-name</span>&gt;</span></span><br><span class="line">158        <span class="tag">&lt;<span class="name">role-name</span>&gt;</span>manager-status<span class="tag">&lt;/<span class="name">role-name</span>&gt;</span></span><br><span class="line">159     <span class="tag">&lt;/<span class="name">auth-constraint</span>&gt;</span></span><br><span class="line">160   <span class="tag">&lt;/<span class="name">security-constraint</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>分别是：</p>
<ol>
<li>manager-gui — Access to the HTML interface.</li>
<li>manager-status — Access to the “Server Status” page only.</li>
<li>manager-script — Access to the tools-friendly plain text interface that is described in this document, and to the “Server Status” page.</li>
<li>manager-jmx — Access to JMX proxy interface and to the “Server Status” page.</li>
</ol>
<p>当然，这几个权限各有各的风险，需要谨慎使用。我们必须使用至少其中一个角色，并设置用户名和密码才能访问管理页面。<br>因此，我们需要在<code>/conf/tomcat-users.xml</code>里进行用户添加：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">user</span> <span class="attr">username</span>=<span class="string">&quot;jimo&quot;</span> <span class="attr">password</span>=<span class="string">&quot;jimo&quot;</span> <span class="attr">roles</span>=<span class="string">&quot;standard,manager-gui,manager-script,manager-status&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/38551166/403-access-denied-on-tomcat-8-manager-app-without-prompting-for-user-password">https://stackoverflow.com/questions/38551166/403-access-denied-on-tomcat-8-manager-app-without-prompting-for-user-password</a></p>
<h1 id="Host管理"><a href="#Host管理" class="headerlink" title="Host管理"></a>Host管理</h1><h1 id="集群"><a href="#集群" class="headerlink" title="集群"></a>集群</h1><p><a target="_blank" rel="noopener" href="https://tomcat.apache.org/tomcat-8.5-doc/cluster-howto.html">https://tomcat.apache.org/tomcat-8.5-doc/cluster-howto.html</a></p>
<h1 id="负载均衡"><a href="#负载均衡" class="headerlink" title="负载均衡"></a>负载均衡</h1><p><a target="_blank" rel="noopener" href="https://tomcat.apache.org/tomcat-8.5-doc/balancer-howto.html">https://tomcat.apache.org/tomcat-8.5-doc/balancer-howto.html</a></p>
<h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><ol>
<li><a target="_blank" rel="noopener" href="https://tomcat.apache.org/tomcat-8.5-doc/introduction.html">https://tomcat.apache.org/tomcat-8.5-doc/introduction.html</a></li>
</ol>

      
    </div> -->
          <div class="article-entry" itemprop="articleBody">
            
              
                
                      
                        
                          
                            
                              
                                
                                  
                                    <p>
                                      <p>tomcat目前是使用量最大的服务器，不得不学。</p>

                                        <p>
                                          
                                            
                                              
                                                      
          </div>
    <p class="article-more-link">
      <a href="/2018/09/10/server/002-tomcat-config/#more">
        Read More
      </a>
    </p>
    <!-- <div class="article-more-link">
      <a href="/2018/09/10/server/002-tomcat-config/#more">
        read more
      </a>
    </div> -->
    


      <footer class="article-footer">
        <a data-url="http://jimolonely.github.io/history/2018/09/10/server/002-tomcat-config/" data-id="cl1fw7fnb00idvkd381r637ag" class="article-share-link">
          Share
        </a>
        
            
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/tomcat/" rel="tag">tomcat</a><span class="article-tag-list-count">7</span></li></ul>

      </footer>
      </div>
      
</article>


  
    <article id="post-java/005-jdk11-new-feature" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/09/08/java/005-jdk11-new-feature/" class="article-date">
  <time datetime="2018-09-08T07:20:32.000Z" itemprop="datePublished">2018-09-08</time>
</a>
      
  </div>
  <div class="article-inner">
    
      
        <header class="article-header">
          
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/09/08/java/005-jdk11-new-feature/">jdk11新特性</a>
    </h1>
  

        </header>
        
          <!-- <div class="article-entry" itemprop="articleBody">
      
        <p>如果您熟悉英文强烈建议阅读<a target="_blank" rel="noopener" href="http://openjdk.java.net/projects/jdk/11/">官方文档</a>。</p>
<h1 id="java新增方法"><a href="#java新增方法" class="headerlink" title="java新增方法"></a>java新增方法</h1><p>当然，下面只是部分：</p>
<h2 id="String"><a href="#String" class="headerlink" title="String"></a>String</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testString</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">String</span> <span class="variable">s</span> <span class="operator">=</span> <span class="string">&quot; Jimo &quot;</span>;</span><br><span class="line">    Assert.assertEquals(<span class="string">&quot;Jimo&quot;</span>, s.strip());</span><br><span class="line">    Assert.assertEquals(<span class="string">&quot;Jimo &quot;</span>, s.stripLeading());</span><br><span class="line">    Assert.assertEquals(<span class="string">&quot; Jimo&quot;</span>, s.stripTrailing());</span><br><span class="line">    Assert.assertFalse(s.isBlank());</span><br><span class="line">    Assert.assertEquals(<span class="string">&quot; Jimo  Jimo  Jimo &quot;</span>, s.repeat(<span class="number">3</span>));</span><br><span class="line"></span><br><span class="line">    <span class="type">var</span> <span class="variable">lines</span> <span class="operator">=</span> <span class="string">&quot;I&#x27;m a super man\ndo you know me?\n&quot;</span>;</span><br><span class="line">    <span class="keyword">final</span> Stream&lt;String&gt; stringStream = lines.lines();</span><br><span class="line">    System.out.println(stringStream.collect(Collectors.toList()));</span><br><span class="line">    <span class="comment">/*[I&#x27;m a super man, do you know me?]*/</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="File"><a href="#File" class="headerlink" title="File"></a>File</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testFile</span><span class="params">()</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">    <span class="keyword">final</span> <span class="type">Path</span> <span class="variable">path</span> <span class="operator">=</span> Path.of(<span class="string">&quot;test.txt&quot;</span>);</span><br><span class="line">    Files.writeString(path, <span class="string">&quot;Ha jimo&quot;</span>);</span><br><span class="line">    Assert.assertEquals(<span class="string">&quot;Ha jimo&quot;</span>, Files.readString(path));</span><br><span class="line"></span><br><span class="line">    Assert.assertTrue(Files.isSameFile(path, path));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Predicate"><a href="#Predicate" class="headerlink" title="Predicate"></a>Predicate</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testPredicate</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">final</span> <span class="type">long</span> <span class="variable">count</span> <span class="operator">=</span> Stream.of(<span class="string">&quot;a&quot;</span>, <span class="string">&quot;b&quot;</span>, <span class="string">&quot;&quot;</span>)</span><br><span class="line">            .filter(Predicate.not(String::isEmpty))</span><br><span class="line">            .count();</span><br><span class="line">    Assert.assertEquals(<span class="number">2</span>, count);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">final</span> Predicate&lt;String&gt; predicate =</span><br><span class="line">            Pattern.compile(<span class="string">&quot;jimo.&quot;</span>).asMatchPredicate();</span><br><span class="line">    Assert.assertTrue(predicate.test(<span class="string">&quot;jimo1&quot;</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Thread"><a href="#Thread" class="headerlink" title="Thread"></a>Thread</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@func</span> Thread移除stop和destroy方法</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> jimo</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2018/8/27 8:37</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testThread</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">final</span> <span class="type">Thread</span> <span class="variable">t</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Thread</span>();</span><br><span class="line">    t.stop();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="TimeUnit"><a href="#TimeUnit" class="headerlink" title="TimeUnit"></a>TimeUnit</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testTimeUnit</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">final</span> <span class="type">TimeUnit</span> <span class="variable">unit</span> <span class="operator">=</span> TimeUnit.DAYS;</span><br><span class="line">    Assert.assertEquals(<span class="number">2</span>, unit.convert(Duration.ofHours(<span class="number">49</span>)));</span><br><span class="line">    Assert.assertEquals(<span class="number">1</span>, unit.convert(Duration.ofMinutes(<span class="number">1450</span>)));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="lambda-var"><a href="#lambda-var" class="headerlink" title="lambda var"></a>lambda var</h2><p>lambda表达式中支持可变参数var，并且可以注解.</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testParam</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">final</span> <span class="type">long</span> <span class="variable">count</span> <span class="operator">=</span> Arrays</span><br><span class="line">            .stream(<span class="keyword">new</span> <span class="title class_">int</span>[]&#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>&#125;)</span><br><span class="line">            .filter((<span class="meta">@Nonnull</span> <span class="keyword">var</span> x) -&gt; x &gt; <span class="number">2</span>)</span><br><span class="line">            .count();</span><br><span class="line">    System.out.println(count);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="改进64位架构内部函数"><a href="#改进64位架构内部函数" class="headerlink" title="改进64位架构内部函数"></a>改进64位架构内部函数</h1><p>改进现有的String和array内在函数，并在AArch64处理器上为java.lang.Math sin，cos和log函数实现新的内在函数。</p>
<p>原因：专用的CPU架构的代码模式可提高用户应用程序和基准测试的性能</p>
<p>下面分别在JDK8和JDK11上测试对比：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@func</span> 测试Math函数的时间, 看JDK11在优化了64位架构后有什么提升</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> jimo</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2018/8/25 19:24</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testMathOnJDK11</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">final</span> <span class="type">long</span> <span class="variable">startTime</span> <span class="operator">=</span> System.nanoTime();</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">10000000</span>; i++) &#123;</span><br><span class="line">        Math.sin(i);</span><br><span class="line">        Math.cos(i);</span><br><span class="line">        Math.log(i);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">final</span> <span class="type">long</span> <span class="variable">endTime</span> <span class="operator">=</span> System.nanoTime();</span><br><span class="line">    System.out.println(TimeUnit.NANOSECONDS.toMillis(endTime - startTime) + <span class="string">&quot;ms&quot;</span>);</span><br><span class="line">    <span class="comment">/*1279ms,1477ms*/</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testMathOnJDK8</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">final</span> <span class="type">long</span> <span class="variable">startTime</span> <span class="operator">=</span> System.nanoTime();</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">10000000</span>; i++) &#123;</span><br><span class="line">        Math.sin(i);</span><br><span class="line">        Math.cos(i);</span><br><span class="line">        Math.log(i);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">final</span> <span class="type">long</span> <span class="variable">endTime</span> <span class="operator">=</span> System.nanoTime();</span><br><span class="line">    System.out.println(TimeUnit.NANOSECONDS.toMillis(endTime - startTime) + <span class="string">&quot;ms&quot;</span>);</span><br><span class="line">    <span class="comment">/*8700ms ,8724ms*/</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="移除Java-EE和CORBA模块"><a href="#移除Java-EE和CORBA模块" class="headerlink" title="移除Java EE和CORBA模块"></a>移除Java EE和CORBA模块</h1><p>JDK6包含完整的Web Service开发栈</p>
<h2 id="名词解释"><a href="#名词解释" class="headerlink" title="名词解释"></a>名词解释</h2><ol>
<li><p>JAX-WS（基于XML的Web服务Java API），JAXB（用于XML绑定的Java架构），<br>JAF（JavaBeans Activation Framework）和Common Annotations</p>
</li>
<li><p>CORBA（Common Object Request Broker Architecture）通用对象请求代理架构是软件构建的一个标准</p>
</li>
</ol>
<h2 id="为什么移除？"><a href="#为什么移除？" class="headerlink" title="为什么移除？"></a>为什么移除？</h2><ol>
<li>JavaSE集成JavaEE存在问题：相关性，版本</li>
<li>Java EE的包可以很方便的从Maven等三方库获取</li>
<li>并没多少人用JDK中的Java EE</li>
</ol>
<h1 id="HTTP-Client标准化"><a href="#HTTP-Client标准化" class="headerlink" title="HTTP Client标准化"></a>HTTP Client标准化</h1><p>HTTP Client：JDK9提出，JDK10更新，JDK11标准化</p>
<p>从开始的孵化特性走向成熟，形成标准，有意思</p>
<p>JDK HTTP Client可用于通过网络请求HTTP资源；</p>
<ol>
<li>它支持HTTP &#x2F; 1.1和HTTP &#x2F; 2</li>
<li>包括同步和异步编程模型，还支持并发</li>
<li>将请求和响应主体作为反应流处理</li>
<li>遵循熟悉的Builder模式。</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">testGet</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">final</span> <span class="type">HttpClient</span> <span class="variable">client</span> <span class="operator">=</span> HttpClient.newHttpClient();</span><br><span class="line">    <span class="keyword">final</span> <span class="type">HttpRequest</span> <span class="variable">request</span> <span class="operator">=</span> HttpRequest.newBuilder()</span><br><span class="line">            .uri(URI.create(<span class="string">&quot;http://openjdk.java.net&quot;</span>))</span><br><span class="line">            .build();</span><br><span class="line">    client.sendAsync(request, HttpResponse.BodyHandlers.ofString())</span><br><span class="line">            .thenApply(HttpResponse::body)</span><br><span class="line">            .thenAccept(System.out::println)</span><br><span class="line">            .join();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="java单文件运行"><a href="#java单文件运行" class="headerlink" title="java单文件运行"></a>java单文件运行</h1><p><a target="_blank" rel="noopener" href="http://openjdk.java.net/jeps/330">http://openjdk.java.net/jeps/330</a></p>
<h2 id="以前运行java文件"><a href="#以前运行java文件" class="headerlink" title="以前运行java文件"></a>以前运行java文件</h2><img src="/2018/09/08/java/005-jdk11-new-feature/000.png" class="">

<img src="/2018/09/08/java/005-jdk11-new-feature/001.png" class="">

<h2 id="现在"><a href="#现在" class="headerlink" title="现在"></a>现在</h2><img src="/2018/09/08/java/005-jdk11-new-feature/002.png" class="">

<p>但是如果有内部类则找不到：</p>
<img src="/2018/09/08/java/005-jdk11-new-feature/003.png" class="">

<h1 id="Filght-Recorder-JFR"><a href="#Filght-Recorder-JFR" class="headerlink" title="Filght Recorder(JFR)"></a>Filght Recorder(JFR)</h1><p><a target="_blank" rel="noopener" href="http://openjdk.java.net/jeps/328">http://openjdk.java.net/jeps/328</a></p>
<h2 id="干什么的"><a href="#干什么的" class="headerlink" title="干什么的"></a>干什么的</h2><ol>
<li>提供用于生成和使用数据作为事件的API</li>
<li>提供缓冲机制和二进制数据格式</li>
<li>允许配置和过滤事件</li>
<li>为OS，HotSpot JVM和JDK库提供事件</li>
</ol>
<h2 id="为什么需要"><a href="#为什么需要" class="headerlink" title="为什么需要"></a>为什么需要</h2><p>故障排除，监视和分析是开发生命周期中不可或缺的部分，但是在涉及实际数据的繁重负载下，某些问题仅发生在生产中。</p>
<p>Flight Recorder记录来自应用程序，JVM和OS的事件。 事件存储在一个文件中，该文件可以附加到错误报告中并由支持工程师进行检查，允许事后分析导致问题时的问题。 工具可以使用API从记录文件中提取信息。</p>
<p>飞行记录嘛：飞机飞行时的记录，对于程序就是程序运行时的记录，包括状态监控和数据收集等</p>
<h2 id="如何启动"><a href="#如何启动" class="headerlink" title="如何启动"></a>如何启动</h2><img src="/2018/09/08/java/005-jdk11-new-feature/004.png" class="">

<img src="/2018/09/08/java/005-jdk11-new-feature/005.png" class="">

<h2 id="JFR-测试"><a href="#JFR-测试" class="headerlink" title="JFR-测试"></a>JFR-测试</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FlightRecorderTest</span> <span class="keyword">extends</span> <span class="title class_">Event</span> &#123;</span><br><span class="line">    <span class="meta">@Label(&quot;Hello World&quot;)</span></span><br><span class="line">    <span class="meta">@Description(&quot;Helps the programmer getting started&quot;)</span></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">class</span> <span class="title class_">HelloWorld</span> <span class="keyword">extends</span> <span class="title class_">Event</span> &#123;</span><br><span class="line">        <span class="meta">@Label(&quot;Message&quot;)</span></span><br><span class="line">        String message;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">HelloWorld</span> <span class="variable">event</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HelloWorld</span>();</span><br><span class="line">        event.message = <span class="string">&quot;hello, world!&quot;</span>;</span><br><span class="line">        event.commit();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行时加上命令行参数：</p>
<img src="/2018/09/08/java/005-jdk11-new-feature/006.png" class="">

<h2 id="读取记录"><a href="#读取记录" class="headerlink" title="读取记录"></a>读取记录</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@func</span> 读取jfr文件</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> jimo</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2018/8/26 16:52</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">readRecordFile</span><span class="params">()</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">    <span class="keyword">final</span> <span class="type">Path</span> <span class="variable">path</span> <span class="operator">=</span> Paths.get(<span class="string">&quot;E:\\ws\\Git\\java-version-compare\\myrecording.jfr&quot;</span>);</span><br><span class="line">    <span class="keyword">final</span> List&lt;RecordedEvent&gt; recordedEvents = RecordingFile.readAllEvents(path);</span><br><span class="line">    <span class="keyword">for</span> (RecordedEvent event : recordedEvents) &#123;</span><br><span class="line">        System.out.println(event.getStartTime() + <span class="string">&quot;,&quot;</span> + event.getValue(<span class="string">&quot;message&quot;</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<img src="/2018/09/08/java/005-jdk11-new-feature/007.png" class="">

<p><a target="_blank" rel="noopener" href="https://docs.oracle.com/javacomponents/jmc-5-5/jfr-runtime-guide/run.htm#JFRRT164">https://docs.oracle.com/javacomponents/jmc-5-5/jfr-runtime-guide/run.htm#JFRRT164</a></p>
<h1 id="JDK11-低开销堆内存分析"><a href="#JDK11-低开销堆内存分析" class="headerlink" title="JDK11-低开销堆内存分析"></a>JDK11-低开销堆内存分析</h1><p>提供一种从JVM获取有关Java对象堆分配的信息的方法：</p>
<ol>
<li>低开销</li>
<li>可通过定义明确的程序接口访问，</li>
<li>可以对所有分配进行采样（即，不限于在一个特定堆区域中的分配或以一种特定方式分配的分配），</li>
<li>可以以与实现无关的方式定义（即，不依赖于任何特定的GC算法或VM实现）</li>
<li>以及可以提供有关实时和死Java对象的信息。</li>
</ol>
<h2 id="why"><a href="#why" class="headerlink" title="why"></a>why</h2><p>现有的堆内存工具：Java Flight Recorder, jmap, YourKit, and VisualVM</p>
<p>现在获取Hotspot信息的方式：</p>
<ol>
<li><a target="_blank" rel="noopener" href="https://github.com/google/allocation-instrumenter">https://github.com/google/allocation-instrumenter</a></li>
<li>Java Flight Recorder：只能记录，不能定制采样间隔，不能区分死&#x2F;活对象</li>
</ol>
<h2 id="how"><a href="#how" class="headerlink" title="how"></a>how</h2><p>扩展了JVM TI：增加了分析接口</p>
<p>JVMTI(JVM Tool Interface)： JDK1.5提出，一般是C，C++实现该接口，在JVM启动时加载</p>
<p><a target="_blank" rel="noopener" href="http://openjdk.java.net/jeps/331">http://openjdk.java.net/jeps/331</a></p>
<p>google开源内存分析工具：<a target="_blank" rel="noopener" href="https://github.com/google/allocation-instrumenter">https://github.com/google/allocation-instrumenter</a></p>
<p>JVMTI介绍：<a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Java_Virtual_Machine_Tools_Interface">https://en.wikipedia.org/wiki/Java_Virtual_Machine_Tools_Interface</a></p>
<p>Jvmti的使用：<a target="_blank" rel="noopener" href="https://docs.oracle.com/javase/8/docs/platform/jvmti/jvmti.html">https://docs.oracle.com/javase/8/docs/platform/jvmti/jvmti.html</a></p>
<h1 id="JDK11-无操作-No-Op-GC"><a href="#JDK11-无操作-No-Op-GC" class="headerlink" title="JDK11-无操作(No-Op)GC"></a>JDK11-无操作(No-Op)GC</h1><p>当堆内存枯竭时，JVM直接关闭，什么都不做 ，还有一个碉堡的名字：Epsilon </p>
<h2 id="why-1"><a href="#why-1" class="headerlink" title="why"></a>why</h2><p>不同的垃圾回收器做不同的事嘛，存在即合理</p>
<ol>
<li>性能测试</li>
<li>内存压力测试</li>
<li>VM接口测试</li>
<li>生存期极短Job测试</li>
<li>延时高敏感程序测试</li>
<li>吞吐量提高</li>
</ol>
<p>启动参数：<code>XX:+UseEpsilonGC</code></p>
<p><a target="_blank" rel="noopener" href="http://openjdk.java.net/jeps/318">http://openjdk.java.net/jeps/318</a></p>
<h1 id="JDK11-ZGC-实验性"><a href="#JDK11-ZGC-实验性" class="headerlink" title="JDK11-ZGC(实验性)"></a>JDK11-ZGC(实验性)</h1><p>Z垃圾回收器，也称为ZGC，是一个可扩展的低延迟(scalable low-latency)垃圾回收器.<br>ZGC是一个并发的，单例的，基于区域的，NUMA感知的压缩回收器。 Stop-the-world阶段仅限于根扫描，因此GC暂停时间不会随堆或活动集的大小而增加</p>
<ol>
<li>GC暂停时间不应超过10毫秒</li>
<li>处理堆的大小从相对较小（几百MB）到非常大（TB）不等</li>
<li>与使用G1相比，应用程序吞吐量减少不超过15％</li>
<li>为未来的GC功能、优化利用彩色指针和负载屏障奠定基础</li>
<li>最初支持的平台：Linux &#x2F; x64</li>
</ol>
<h2 id="如何使用"><a href="#如何使用" class="headerlink" title="如何使用"></a>如何使用</h2><p>使用：Linux&#x2F;x64下编译JDK时：<code>--with-jvm-features=zgc</code></p>
<p>命令行参数：<code>XX:+UnlockExperimentalVMOptions  -XX:+UseZGC</code></p>
<h2 id="比较"><a href="#比较" class="headerlink" title="比较"></a>比较</h2><p>吞吐量：</p>
<img src="/2018/09/08/java/005-jdk11-new-feature/008.png" class="">

<p>暂停时间：</p>
<img src="/2018/09/08/java/005-jdk11-new-feature/009.png" class="">

<p><a target="_blank" rel="noopener" href="http://openjdk.java.net/jeps/333">http://openjdk.java.net/jeps/333</a></p>
<h1 id="JDK11-TLS1-3"><a href="#JDK11-TLS1-3" class="headerlink" title="JDK11-TLS1.3"></a>JDK11-TLS1.3</h1><p>实现了传输层安全（TLS）协议RFC 8446的1.3版</p>
<p>TLS 1.3是TLS协议的重大改进，与以前的版本相比，它提供了显著的安全性和性能改进。 其他供应商的几个早期实现已经可用。 我们需要支持TLS 1.3以保持竞争力并与最新标准保持同步。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">useTLS</span><span class="params">()</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">    <span class="type">String</span> <span class="variable">host</span> <span class="operator">=</span> <span class="string">&quot;www.baidu.com&quot;</span>;</span><br><span class="line">    <span class="type">int</span> <span class="variable">port</span> <span class="operator">=</span> <span class="number">443</span>;</span><br><span class="line">    <span class="type">SocketFactory</span> <span class="variable">basicSocketFactory</span> <span class="operator">=</span> SocketFactory.getDefault();</span><br><span class="line">    <span class="type">Socket</span> <span class="variable">s</span> <span class="operator">=</span> basicSocketFactory.createSocket(host, port);</span><br><span class="line">    <span class="comment">/*s 是一个 TCP socket*/</span></span><br><span class="line">    <span class="type">SSLSocketFactory</span> <span class="variable">tlsSocketFactory</span> <span class="operator">=</span> (SSLSocketFactory) SSLSocketFactory.getDefault();</span><br><span class="line">    s = tlsSocketFactory.createSocket(s, host, port, <span class="literal">true</span>);</span><br><span class="line">    <span class="comment">/*s 现在是一个 基于TCP的TLS socket*/</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>TLS参考：<a target="_blank" rel="noopener" href="http://www.ruanyifeng.com/blog/2014/02/ssl_tls.html">http://www.ruanyifeng.com/blog/2014/02/ssl_tls.html</a> </p>
<p><a target="_blank" rel="noopener" href="http://openjdk.java.net/jeps/332">http://openjdk.java.net/jeps/332</a></p>
<p>RFC8446: <a target="_blank" rel="noopener" href="https://tools.ietf.org/html/rfc8446">https://tools.ietf.org/html/rfc8446</a></p>
<p>如何使用TLS：<a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/24868820/how-to-make-tls-work-with-java/24872636">https://stackoverflow.com/questions/24868820/how-to-make-tls-work-with-java/24872636</a><br><a target="_blank" rel="noopener" href="http://www.java2s.com/Tutorial/Java/0490__Security/SSLClientSession.htm">http://www.java2s.com/Tutorial/Java/0490__Security/SSLClientSession.htm</a></p>
<p>传输层 <a target="_blank" rel="noopener" href="https://zh.wikipedia.org/wiki/%E4%BC%A0%E8%BE%93%E5%B1%82">https://zh.wikipedia.org/wiki/%E4%BC%A0%E8%BE%93%E5%B1%82</a></p>
<h1 id="JDK11-Curve25519-and-Curve448"><a href="#JDK11-Curve25519-and-Curve448" class="headerlink" title="JDK11-Curve25519 and Curve448"></a>JDK11-Curve25519 and Curve448</h1><p>RFC 7748定义了一种密钥协商方案，该方案比现有的椭圆曲线Diffie-Hellman（ECDH）方案更有效（原来的是C实现的，现在可以用纯Java实现）和安全。 此JEP的主要目标是API和此标准的实现。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">keyAgreementTest</span><span class="params">()</span> <span class="keyword">throws</span> NoSuchAlgorithmException,</span><br><span class="line">        InvalidAlgorithmParameterException, InvalidKeySpecException, InvalidKeyException &#123;</span><br><span class="line">    <span class="type">KeyPairGenerator</span> <span class="variable">kpg</span> <span class="operator">=</span> KeyPairGenerator.getInstance(<span class="string">&quot;XDH&quot;</span>);</span><br><span class="line">    <span class="type">NamedParameterSpec</span> <span class="variable">paramSpec</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">NamedParameterSpec</span>(<span class="string">&quot;X25519&quot;</span>);</span><br><span class="line">    kpg.initialize(paramSpec);</span><br><span class="line">    <span class="type">KeyPair</span> <span class="variable">kp</span> <span class="operator">=</span> kpg.generateKeyPair();</span><br><span class="line"></span><br><span class="line">    <span class="type">KeyFactory</span> <span class="variable">kf</span> <span class="operator">=</span> KeyFactory.getInstance(<span class="string">&quot;XDH&quot;</span>);</span><br><span class="line">    <span class="type">BigInteger</span> <span class="variable">u</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">BigInteger</span>(<span class="string">&quot;1212324324&quot;</span>);</span><br><span class="line">    <span class="type">XECPublicKeySpec</span> <span class="variable">pubSpec</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">XECPublicKeySpec</span>(paramSpec, u);</span><br><span class="line">    <span class="type">PublicKey</span> <span class="variable">pubKey</span> <span class="operator">=</span> kf.generatePublic(pubSpec);</span><br><span class="line"></span><br><span class="line">    <span class="type">KeyAgreement</span> <span class="variable">ka</span> <span class="operator">=</span> KeyAgreement.getInstance(<span class="string">&quot;XDH&quot;</span>);</span><br><span class="line">    ka.init(kp.getPrivate());</span><br><span class="line">    ka.doPhase(pubKey, <span class="literal">true</span>);</span><br><span class="line">    <span class="type">byte</span>[] secret = ka.generateSecret();</span><br><span class="line">    System.out.println(Arrays.toString(secret));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="http://openjdk.java.net/jeps/324">http://openjdk.java.net/jeps/324</a></p>
<p>RFC定义的椭圆算法：<a target="_blank" rel="noopener" href="https://tools.ietf.org/html/rfc7748">https://tools.ietf.org/html/rfc7748</a></p>
<h1 id="JDK11-Deprecate-Nashorn"><a href="#JDK11-Deprecate-Nashorn" class="headerlink" title="JDK11-Deprecate Nashorn"></a>JDK11-Deprecate Nashorn</h1><p>弃用Nashorn JavaScript脚本引擎和API以及jjs工具，在将来的版本中可能会删除它们，如果一群可靠的开发人员表达出对Nashorn前进的明确愿望，那么这个JEP可以取消的</p>
<p>原因：随着ECMAScript语言构建的快速步伐以及API的调整和修改，JDK发现Nashorn难以维护</p>
<p><a target="_blank" rel="noopener" href="http://openjdk.java.net/jeps/335">http://openjdk.java.net/jeps/335</a></p>
<img src="/2018/09/08/java/005-jdk11-new-feature/010.png" class="">

<h1 id="JDK11-基于Nest的访问控制"><a href="#JDK11-基于Nest的访问控制" class="headerlink" title="JDK11-基于Nest的访问控制"></a>JDK11-基于Nest的访问控制</h1><p>在以前的private public protected的基础上，JVM又提供了一种新的访问控制机制：Nest。</p>
<p>Java代码都是以类为单位组织的，而且即使是在一个.java文件中的多个类也都会被分别编译为不同的.class类文件。但是对于开发者来说，在一个源文件中的代码在逻辑上应该是可以互相访问的，但是Java并不直接允许这样做。我们虽然可以在一个匿名内部类中访问外层类的成员方法，但是这实际上是通过编译器自动生成的所谓 访问桥(access bridge) 方法进行访问。这个解决方案在解决一部分问题的同时，也带来了如增加了不必要的程序大小和额外性能损耗等问题，而且很容易迷惑一部分Java程序员。</p>
<p>而JDK 11带来的Nest就是一个更完善的解决方案。编译器现在把一些 看起来 是在一个类中的代码（如上面提到的匿名内部类）组织到Nest 中。而在同一个Nest中的类将会拥有同等的访问权限。这会让应用程序和字节码更加简单、安全，并对开发者透明。</p>
<p>Java作为一种相对保守的语言，这是少数几个对《Java语言规范》和《Java虚拟机规范》做出较大改动的JEP之一。然而对于普通开发者，在通常的开发中也不会有很大的变动。但是对于反射的重度使用者或接触字节码工程的人来说，这个JEP还是有必要仔细了解一下的。</p>
<p><a target="_blank" rel="noopener" href="http://openjdk.java.net/jeps/181">http://openjdk.java.net/jeps/181</a></p>
<p><a target="_blank" rel="noopener" href="https://xsun.io/2018/06/29/jdk11-preview/">https://xsun.io/2018/06/29/jdk11-preview/</a></p>
<h1 id="JDK11-其他更新"><a href="#JDK11-其他更新" class="headerlink" title="JDK11-其他更新"></a>JDK11-其他更新</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">更新到Unicode 10标准</span><br><span class="line">Java SE 10实现了Unicode 8.0。 Unicode 9.0增加了7,500个字符和6个新脚本，Unicode 10.0.0增加了8,518个字符和4个新脚本。 此升级将包括Unicode 9.0更改，因此添加了总共16,018个字符和10个新脚本。</span><br><span class="line">主要影响的类：</span><br><span class="line">Character and String in the java.lang package,</span><br><span class="line">NumericShaper in the java.awt.font package,</span><br><span class="line">Bidi, BreakIterator, and Normalizer in the java.text package.</span><br><span class="line"></span><br><span class="line">弃用Pack200工具和API</span><br><span class="line">在java.util.jar中弃用pack200和unpack200工具以及Pack200 API。</span><br><span class="line"></span><br><span class="line">实现ChaCha20和Poly1305密码算法</span><br><span class="line">实现RFC 7539中指定的ChaCha20和ChaCha20-Poly1305密码.ChaCha20是一种相对较新的流密码，可以替代旧的，不安全的RC4流密码。</span><br><span class="line"></span><br><span class="line">动态类文件常量</span><br><span class="line">这个JEP扩展了Java类文件格式来支持一种新形式的常量池，CONSTANT_Dynamic。它在初始化的时候，会像invokedynamic指令生成代理方法一样，委托给一个初始化方法进行创建。这是一个JVM内部的特性，对上层软件没有很大的影响，但是为Java语言未来的重大变化铺设了道路。</span><br></pre></td></tr></table></figure>

<p>Unicode10：<a target="_blank" rel="noopener" href="http://openjdk.java.net/jeps/327">http://openjdk.java.net/jeps/327</a></p>
<p>Pack200：<a target="_blank" rel="noopener" href="http://openjdk.java.net/jeps/336">http://openjdk.java.net/jeps/336</a></p>
<p><a target="_blank" rel="noopener" href="http://openjdk.java.net/jeps/309">http://openjdk.java.net/jeps/309</a></p>
<h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><p><a target="_blank" rel="noopener" href="https://dzone.com/articles/features-of-java-11">https://dzone.com/articles/features-of-java-11
</a></p>
<p><a target="_blank" rel="noopener" href="http://openjdk.java.net/jeps/320">http://openjdk.java.net/jeps/320
</a></p>
<p><a target="_blank" rel="noopener" href="http://openjdk.java.net/jeps/321">http://openjdk.java.net/jeps/321</a></p>
<p>HTTP Client的用法：<a target="_blank" rel="noopener" href="http://openjdk.java.net/groups/net/httpclient/recipes.html">http://openjdk.java.net/groups/net/httpclient/recipes.html</a></p>
<p>Client介绍：<a target="_blank" rel="noopener" href="http://openjdk.java.net/groups/net/httpclient/intro.html">http://openjdk.java.net/groups/net/httpclient/intro.html</a></p>

      
    </div> -->
          <div class="article-entry" itemprop="articleBody">
            
              
                
                      
                        
                          
                            
                              
                                
                                  
                                    <p>
                                      <p>如果您熟悉英文强烈建议阅读<a target="_blank" rel="noopener" href="http://openjdk.java.net/projects/jdk/11/">官方文档</a>。</p>

                                        <p>
                                          
                                            
                                              
                                                      
          </div>
    <p class="article-more-link">
      <a href="/2018/09/08/java/005-jdk11-new-feature/#more">
        Read More
      </a>
    </p>
    <!-- <div class="article-more-link">
      <a href="/2018/09/08/java/005-jdk11-new-feature/#more">
        read more
      </a>
    </div> -->
    


      <footer class="article-footer">
        <a data-url="http://jimolonely.github.io/history/2018/09/08/java/005-jdk11-new-feature/" data-id="cl1fw7fkn008pvkd3gbvwd8ny" class="article-share-link">
          Share
        </a>
        
            
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/java/" rel="tag">java</a><span class="article-tag-list-count">104</span></li></ul>

      </footer>
      </div>
      
</article>


  
    <article id="post-lang/011-kafka-stream" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/09/08/lang/011-kafka-stream/" class="article-date">
  <time datetime="2018-09-08T06:27:25.000Z" itemprop="datePublished">2018-09-08</time>
</a>
      
  </div>
  <div class="article-inner">
    
      
        <header class="article-header">
          
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/09/08/lang/011-kafka-stream/">kafka stream</a>
    </h1>
  

        </header>
        
          <!-- <div class="article-entry" itemprop="articleBody">
      
        <p>本文介绍kafka2.0的stream操作，并用java实现调用,实现了官网的3个例子。</p>
<h1 id="最简Pipe"><a href="#最简Pipe" class="headerlink" title="最简Pipe"></a>最简Pipe</h1><p>pipe相当于管道，连接2个topic的流通道，这里注意的就是消费者的客户端怎么写。</p>
<h2 id="pipe"><a href="#pipe" class="headerlink" title="pipe"></a>pipe</h2><p>管道什么都不做：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.kafka.common.serialization.Serdes;</span><br><span class="line"><span class="keyword">import</span> org.apache.kafka.streams.KafkaStreams;</span><br><span class="line"><span class="keyword">import</span> org.apache.kafka.streams.StreamsBuilder;</span><br><span class="line"><span class="keyword">import</span> org.apache.kafka.streams.StreamsConfig;</span><br><span class="line"><span class="keyword">import</span> org.apache.kafka.streams.Topology;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Properties;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.CountDownLatch;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Pipe</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="keyword">final</span> <span class="type">Properties</span> <span class="variable">props</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Properties</span>();</span><br><span class="line">        props.put(StreamsConfig.APPLICATION_ID_CONFIG, <span class="string">&quot;stream-pipe&quot;</span>);</span><br><span class="line">        props.put(StreamsConfig.BOOTSTRAP_SERVERS_CONFIG,</span><br><span class="line">                <span class="string">&quot;hadoop4:9092,hadoop5:9092,hadoop6:9092,hadoop7:9092,hadoop8:9092,hadoop9:9092&quot;</span>);</span><br><span class="line">        props.put(StreamsConfig.DEFAULT_KEY_SERDE_CLASS_CONFIG, Serdes.String().getClass());</span><br><span class="line">        props.put(StreamsConfig.DEFAULT_VALUE_SERDE_CLASS_CONFIG, Serdes.String().getClass());</span><br><span class="line"></span><br><span class="line">        <span class="keyword">final</span> <span class="type">StreamsBuilder</span> <span class="variable">builder</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StreamsBuilder</span>();</span><br><span class="line"></span><br><span class="line">        builder.stream(<span class="string">&quot;jimo&quot;</span>).to(<span class="string">&quot;hehe&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">final</span> <span class="type">Topology</span> <span class="variable">topology</span> <span class="operator">=</span> builder.build();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">final</span> <span class="type">KafkaStreams</span> <span class="variable">streams</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">KafkaStreams</span>(topology, props);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">final</span> <span class="type">CountDownLatch</span> <span class="variable">latch</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">CountDownLatch</span>(<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// attach shutdown handler to catch control-c</span></span><br><span class="line">        Runtime.getRuntime().addShutdownHook(<span class="keyword">new</span> <span class="title class_">Thread</span>(<span class="string">&quot;streams-shutdown-hook&quot;</span>) &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">                streams.close();</span><br><span class="line">                latch.countDown();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            streams.start();</span><br><span class="line">            latch.await();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Throwable e) &#123;</span><br><span class="line">            System.exit(<span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        System.exit(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="生产者"><a href="#生产者" class="headerlink" title="生产者"></a>生产者</h2><p>生产者依然不变：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">    <span class="keyword">private</span> KafkaProducer&lt;String, String&gt; producer;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">TOPIC</span> <span class="operator">=</span> <span class="string">&quot;jimo&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Before</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">init</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">final</span> <span class="type">Properties</span> <span class="variable">properties</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Properties</span>();</span><br><span class="line">        properties.setProperty(<span class="string">&quot;metadata.broker.list&quot;</span>, <span class="string">&quot;hadoop4:9092,hadoop5:9092,hadoop6:9092,hadoop7:9092,hadoop8:9092,hadoop9:9092&quot;</span>);</span><br><span class="line">        properties.setProperty(<span class="string">&quot;bootstrap.servers&quot;</span>, <span class="string">&quot;hadoop4:9092,hadoop5:9092,hadoop6:9092,hadoop7:9092,hadoop8:9092,hadoop9:9092&quot;</span>);</span><br><span class="line">        properties.setProperty(<span class="string">&quot;acks&quot;</span>, <span class="string">&quot;all&quot;</span>);</span><br><span class="line">        properties.setProperty(<span class="string">&quot;retries&quot;</span>, <span class="string">&quot;0&quot;</span>);</span><br><span class="line">        properties.setProperty(<span class="string">&quot;batch.size&quot;</span>, <span class="string">&quot;16384&quot;</span>);</span><br><span class="line">        properties.setProperty(<span class="string">&quot;request.timeout.ms&quot;</span>, <span class="string">&quot;10000&quot;</span>);</span><br><span class="line">        properties.setProperty(<span class="string">&quot;message.send.max.retries&quot;</span>, <span class="string">&quot;3&quot;</span>);</span><br><span class="line">        properties.setProperty(<span class="string">&quot;linger.ms&quot;</span>, <span class="string">&quot;1&quot;</span>);</span><br><span class="line">        properties.setProperty(<span class="string">&quot;buffer.memory&quot;</span>, <span class="string">&quot;33554432&quot;</span>);</span><br><span class="line">        properties.setProperty(<span class="string">&quot;ssl.client.auth&quot;</span>, <span class="string">&quot;required&quot;</span>);</span><br><span class="line">        properties.setProperty(<span class="string">&quot;key.serializer&quot;</span>, <span class="string">&quot;org.apache.kafka.common.serialization.StringSerializer&quot;</span>);</span><br><span class="line">        properties.setProperty(<span class="string">&quot;value.serializer&quot;</span>, <span class="string">&quot;org.apache.kafka.common.serialization.StringSerializer&quot;</span>);</span><br><span class="line">        producer = <span class="keyword">new</span> <span class="title class_">KafkaProducer</span>&lt;&gt;(properties);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">sendMessage</span><span class="params">()</span> <span class="keyword">throws</span> InterruptedException &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">100</span>; i++) &#123;</span><br><span class="line">            ProducerRecord&lt;String, String&gt; record = <span class="keyword">new</span> <span class="title class_">ProducerRecord</span>&lt;&gt;(TOPIC, <span class="string">&quot;key&quot;</span> + i, <span class="string">&quot;hehe&quot;</span> + i);</span><br><span class="line">            producer.send(record, (recordMetadata, e) -&gt; &#123;</span><br><span class="line">                System.out.println(recordMetadata.offset());</span><br><span class="line">                <span class="keyword">if</span> (e != <span class="literal">null</span>) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">            Thread.sleep(<span class="number">1000</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@After</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">close</span><span class="params">()</span> &#123;</span><br><span class="line">        producer.close();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="消费者"><a href="#消费者" class="headerlink" title="消费者"></a>消费者</h2><p>现在到了jimo 的主题里，开启消费者去消费。</p>
<p>java客户端需要改为流的形式：</p>
<p>pom.xml</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependencies&gt;</span><br><span class="line">    &lt;dependency&gt;</span><br><span class="line">        &lt;groupId&gt;org.apache.kafka&lt;/groupId&gt;</span><br><span class="line">        &lt;artifactId&gt;kafka_2.10&lt;/artifactId&gt;</span><br><span class="line">        &lt;version&gt;0.9.0.1&lt;/version&gt;</span><br><span class="line">    &lt;/dependency&gt;</span><br><span class="line"></span><br><span class="line">    &lt;dependency&gt;</span><br><span class="line">        &lt;groupId&gt;org.apache.kafka&lt;/groupId&gt;</span><br><span class="line">        &lt;artifactId&gt;kafka-clients&lt;/artifactId&gt;</span><br><span class="line">        &lt;version&gt;0.9.0.1&lt;/version&gt;</span><br><span class="line">    &lt;/dependency&gt;</span><br><span class="line">&lt;/dependencies&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">StreamConsumer</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="keyword">final</span> <span class="type">Properties</span> <span class="variable">properties</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Properties</span>();</span><br><span class="line">        properties.setProperty(<span class="string">&quot;bootstrap.servers&quot;</span>, <span class="string">&quot;hadoop4:9092,hadoop5:9092,hadoop6:9092,hadoop7:9092,hadoop8:9092,hadoop9:9092&quot;</span>);</span><br><span class="line">        properties.setProperty(<span class="string">&quot;zookeeper.connect&quot;</span>, <span class="string">&quot;hadoop4:2181,hadoop5:2181,hadoop6:2181&quot;</span>);</span><br><span class="line">        properties.setProperty(<span class="string">&quot;group.id&quot;</span>, <span class="string">&quot;stream-pipe&quot;</span>);</span><br><span class="line">        properties.setProperty(<span class="string">&quot;zookeeper.session.timeout.ms&quot;</span>, <span class="string">&quot;5000&quot;</span>);</span><br><span class="line">        properties.setProperty(<span class="string">&quot;zookeeper.connection.timeout&quot;</span>, <span class="string">&quot;10000&quot;</span>);</span><br><span class="line">        properties.setProperty(<span class="string">&quot;zookeeper.sync.time.ms&quot;</span>, <span class="string">&quot;200&quot;</span>);</span><br><span class="line">        properties.setProperty(<span class="string">&quot;auto.commit.interval.ms&quot;</span>, <span class="string">&quot;1000&quot;</span>);</span><br><span class="line">        properties.setProperty(<span class="string">&quot;rebalance.max.retries&quot;</span>, <span class="string">&quot;10&quot;</span>);</span><br><span class="line">        properties.setProperty(<span class="string">&quot;rebalance.backoff.ms&quot;</span>, <span class="string">&quot;2000&quot;</span>);</span><br><span class="line">        properties.setProperty(<span class="string">&quot;auto.offset.reset&quot;</span>, <span class="string">&quot;largest&quot;</span>);</span><br><span class="line">        properties.setProperty(<span class="string">&quot;key.deserializer&quot;</span>, <span class="string">&quot;org.apache.kafka.common.serialization.StringDeserializer&quot;</span>);</span><br><span class="line">        properties.setProperty(<span class="string">&quot;value.deserializer&quot;</span>, <span class="string">&quot;org.apache.kafka.common.serialization.StringDeserializer&quot;</span>);</span><br><span class="line">        <span class="keyword">final</span> <span class="type">ConsumerConnector</span> <span class="variable">connector</span> <span class="operator">=</span> Consumer.createJavaConsumerConnector(<span class="keyword">new</span> <span class="title class_">ConsumerConfig</span>(properties));</span><br><span class="line"></span><br><span class="line">        Map&lt;String, Integer&gt; map = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">final</span> <span class="type">String</span> <span class="variable">topic</span> <span class="operator">=</span> <span class="string">&quot;hehe&quot;</span>;</span><br><span class="line">        map.put(topic, <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">final</span> Map&lt;String, List&lt;KafkaStream&lt;<span class="type">byte</span>[], <span class="type">byte</span>[]&gt;&gt;&gt; streamMap = connector.createMessageStreams(map);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">final</span> KafkaStream&lt;<span class="type">byte</span>[], <span class="type">byte</span>[]&gt; stream = streamMap.get(topic).get(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (MessageAndMetadata&lt;<span class="type">byte</span>[], <span class="type">byte</span>[]&gt; metadata : stream) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;------------------offset偏移量:&quot;</span> + metadata.offset());</span><br><span class="line">            System.out.println(<span class="string">&quot;-----------------------message:&quot;</span> + Arrays.toString(metadata.message()));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="LineSplit"><a href="#LineSplit" class="headerlink" title="LineSplit"></a>LineSplit</h1><p>出现了个时间戳的问题，</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">org.apache.kafka.streams.errors.StreamsException: Input <span class="keyword">record</span> <span class="title class_">ConsumerRecord</span><span class="params">(topic = telegraf, partition = 1, offset = 0, CreateTime = -1, serialized key size = -1, serialized value size = 283, headers = RecordHeaders(headers = [], isReadOnly = <span class="literal">false</span>)</span></span><br><span class="line"> has <span class="title function_">invalid</span> <span class="params">(negative)</span> timestamp。 Use a different TimestampExtractor to process <span class="built_in">this</span> data.</span><br></pre></td></tr></table></figure>

<p>于是重写了生成时间戳的方法：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.apache.kafka.clients.consumer.ConsumerRecord;</span><br><span class="line"><span class="keyword">import</span> org.apache.kafka.streams.processor.TimestampExtractor;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MyEventTimeExtractor</span> <span class="keyword">implements</span> <span class="title class_">TimestampExtractor</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">long</span> <span class="title function_">extract</span><span class="params">(ConsumerRecord&lt;Object, Object&gt; record, <span class="type">long</span> previousTimestamp)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> System.currentTimeMillis();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>使用：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">properties.put(StreamsConfig.DEFAULT_TIMESTAMP_EXTRACTOR_CLASS_CONFIG, MyEventTimeExtractor.class.getName());</span><br><span class="line">producer = <span class="keyword">new</span> <span class="title class_">KafkaProducer</span>&lt;&gt;(properties);</span><br></pre></td></tr></table></figure>

<p>这样写出的offset就是随机的了，不是原来的递增？</p>
<h2 id="生产者-1"><a href="#生产者-1" class="headerlink" title="生产者"></a>生产者</h2><p>生产者稍微改下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ProducerRecord&lt;String, String&gt; record = <span class="keyword">new</span> <span class="title class_">ProducerRecord</span>&lt;&gt;(TOPIC, <span class="string">&quot;key&quot;</span> + i, <span class="string">&quot;hehe helo aska cdd&quot;</span> + i);</span><br></pre></td></tr></table></figure>

<h2 id="LineSplit-1"><a href="#LineSplit-1" class="headerlink" title="LineSplit"></a>LineSplit</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LineSplit</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">Properties</span> <span class="variable">props</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Properties</span>();</span><br><span class="line">        props.put(StreamsConfig.APPLICATION_ID_CONFIG, <span class="string">&quot;streams-line-split&quot;</span>);</span><br><span class="line">        props.put(StreamsConfig.BOOTSTRAP_SERVERS_CONFIG, <span class="string">&quot;hadoop4:9092,hadoop5:9092,hadoop6:9092,hadoop7:9092,hadoop8:9092,hadoop9:9092&quot;</span>);</span><br><span class="line">        props.put(StreamsConfig.DEFAULT_KEY_SERDE_CLASS_CONFIG, Serdes.String().getClass());</span><br><span class="line">        props.put(StreamsConfig.DEFAULT_VALUE_SERDE_CLASS_CONFIG, Serdes.String().getClass());</span><br><span class="line"></span><br><span class="line">        <span class="keyword">final</span> <span class="type">StreamsBuilder</span> <span class="variable">builder</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StreamsBuilder</span>();</span><br><span class="line"></span><br><span class="line">        KStream&lt;String, String&gt; source = builder.stream(<span class="string">&quot;test&quot;</span>);</span><br><span class="line">        source.flatMapValues(value -&gt; Arrays.asList(value.split(<span class="string">&quot;\\W+&quot;</span>)))</span><br><span class="line">                .to(<span class="string">&quot;jimo&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">final</span> <span class="type">Topology</span> <span class="variable">topology</span> <span class="operator">=</span> builder.build();</span><br><span class="line">        <span class="keyword">final</span> <span class="type">KafkaStreams</span> <span class="variable">streams</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">KafkaStreams</span>(topology, props);</span><br><span class="line">        <span class="keyword">final</span> <span class="type">CountDownLatch</span> <span class="variable">latch</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">CountDownLatch</span>(<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// attach shutdown handler to catch control-c</span></span><br><span class="line">        Runtime.getRuntime().addShutdownHook(<span class="keyword">new</span> <span class="title class_">Thread</span>(<span class="string">&quot;streams-shutdown-hook&quot;</span>) &#123;</span><br><span class="line">            <span class="meta">@Override</span></span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">run</span><span class="params">()</span> &#123;</span><br><span class="line">                streams.close();</span><br><span class="line">                latch.countDown();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            streams.start();</span><br><span class="line">            latch.await();</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Throwable e) &#123;</span><br><span class="line">            System.exit(<span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        System.exit(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="消费者-1"><a href="#消费者-1" class="headerlink" title="消费者"></a>消费者</h2><p>消费者只需修改group.id</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">properties.setProperty(<span class="string">&quot;group.id&quot;</span>, <span class="string">&quot;streams-line-split&quot;</span>);</span><br></pre></td></tr></table></figure>

<img src="/2018/09/08/lang/011-kafka-stream/000.png" class="">

<h1 id="Word-Count"><a href="#Word-Count" class="headerlink" title="Word Count"></a>Word Count</h1><p>没什么问题，注意解析结果时要转成数字。</p>
<h2 id="生产者-2"><a href="#生产者-2" class="headerlink" title="生产者"></a>生产者</h2><p>生产者改了下数据：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> <span class="type">Random</span> <span class="variable">r</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Random</span>();</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; <span class="number">100</span>; i++) &#123;</span><br><span class="line">    ProducerRecord&lt;String, String&gt; record = <span class="keyword">new</span> <span class="title class_">ProducerRecord</span>&lt;&gt;(TOPIC,</span><br><span class="line">            <span class="string">&quot;key&quot;</span> + i,</span><br><span class="line">            <span class="string">&quot;hehe&quot;</span> + r.nextInt(<span class="number">20</span>) + <span class="string">&quot; helo&quot;</span> + r.nextInt(<span class="number">20</span>)</span><br><span class="line">                    + <span class="string">&quot; aska&quot;</span> + r.nextInt(<span class="number">20</span>) + <span class="string">&quot; cdd&quot;</span> + r.nextInt(<span class="number">20</span>));</span><br><span class="line">    producer.send(record, (recordMetadata, e) -&gt; &#123;</span><br><span class="line">        System.out.println(recordMetadata.offset());</span><br><span class="line">        <span class="keyword">if</span> (e != <span class="literal">null</span>) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    Thread.sleep(<span class="number">1000</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="WordCount"><a href="#WordCount" class="headerlink" title="WordCount"></a>WordCount</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">final</span> <span class="type">StreamsBuilder</span> <span class="variable">builder</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StreamsBuilder</span>();</span><br><span class="line"><span class="keyword">final</span> KStream&lt;String, String&gt; stream = builder.stream(<span class="string">&quot;test&quot;</span>);</span><br><span class="line">stream.flatMapValues(value -&gt; Arrays.asList(value.toLowerCase(Locale.getDefault()).split(<span class="string">&quot;\\W+&quot;</span>)))</span><br><span class="line">        .groupBy((key, value) -&gt; value)</span><br><span class="line">        .count(Materialized.as(<span class="string">&quot;count&quot;</span>))</span><br><span class="line">        .toStream()</span><br><span class="line">        .to(<span class="string">&quot;jimo&quot;</span>, Produced.with(Serdes.String(), Serdes.Long()));</span><br></pre></td></tr></table></figure>

<h2 id="消费者-2"><a href="#消费者-2" class="headerlink" title="消费者"></a>消费者</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">properties.setProperty(<span class="string">&quot;group.id&quot;</span>, <span class="string">&quot;streams-wordcount&quot;</span>);</span><br><span class="line">...</span><br><span class="line">...</span><br><span class="line"><span class="keyword">final</span> KafkaStream&lt;<span class="type">byte</span>[], <span class="type">byte</span>[]&gt; stream = streamMap.get(topic).get(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/*注意：这个例子返回的key-value是 String-Long型的*/</span></span><br><span class="line"><span class="keyword">for</span> (MessageAndMetadata&lt;<span class="type">byte</span>[], <span class="type">byte</span>[]&gt; metadata : stream) &#123;</span><br><span class="line">    System.out.format(<span class="string">&quot;-------------offset偏移量:%s,Key:%s,value:%d %n&quot;</span>,</span><br><span class="line">            metadata.offset(), <span class="keyword">new</span> <span class="title class_">String</span>(metadata.key(), StandardCharsets.UTF_8),</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">BigInteger</span>(metadata.message()).intValue()</span><br><span class="line">    );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<img src="/2018/09/08/lang/011-kafka-stream/001.png" class="">

<h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><p><a target="_blank" rel="noopener" href="https://kafka.apache.org/20/documentation/streams/quickstart">https://kafka.apache.org/20/documentation/streams/quickstart</a></p>
<p><a target="_blank" rel="noopener" href="https://kafka.apache.org/20/documentation/streams/tutorial">https://kafka.apache.org/20/documentation/streams/tutorial</a></p>

      
    </div> -->
          <div class="article-entry" itemprop="articleBody">
            
              
                
                      
                        
                          
                            
                              
                                
                                  
                                    <p>
                                      <p>本文介绍kafka2.0的stream操作，并用java实现调用,实现了官网的3个例子。</p>

                                        <p>
                                          
                                            
                                              
                                                      
          </div>
    <p class="article-more-link">
      <a href="/2018/09/08/lang/011-kafka-stream/#more">
        Read More
      </a>
    </p>
    <!-- <div class="article-more-link">
      <a href="/2018/09/08/lang/011-kafka-stream/#more">
        read more
      </a>
    </div> -->
    


      <footer class="article-footer">
        <a data-url="http://jimolonely.github.io/history/2018/09/08/lang/011-kafka-stream/" data-id="cl1fw7fm700e6vkd36be35k0o" class="article-share-link">
          Share
        </a>
        
            
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/kafka/" rel="tag">kafka</a><span class="article-tag-list-count">1</span></li></ul>

      </footer>
      </div>
      
</article>


  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/page/11/">&amp;laquo; 上一页</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/10/">10</a><a class="page-number" href="/page/11/">11</a><span class="page-number current">12</span><a class="page-number" href="/page/13/">13</a><a class="page-number" href="/page/14/">14</a><span class="space">&hellip;</span><a class="page-number" href="/page/18/">18</a><a class="extend next" rel="next" href="/page/13/">下一页 &amp;raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/AI/" rel="tag">AI</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/UI-test/" rel="tag">UI test</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/algorithm/" rel="tag">algorithm</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/android/" rel="tag">android</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/annotation/" rel="tag">annotation</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ansible/" rel="tag">ansible</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ant/" rel="tag">ant</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/aop/" rel="tag">aop</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/archiva/" rel="tag">archiva</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/asciidoc/" rel="tag">asciidoc</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/awk/" rel="tag">awk</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/axios/" rel="tag">axios</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/basic/" rel="tag">basic</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/big-data/" rel="tag">big data</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/blockchain/" rel="tag">blockchain</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/centos/" rel="tag">centos</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cglib/" rel="tag">cglib</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/checkstyle/" rel="tag">checkstyle</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/chrome/" rel="tag">chrome</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/computer-principle/" rel="tag">computer principle</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cors/" rel="tag">cors</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/data-structure/" rel="tag">data structure</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/design-pattern/" rel="tag">design-pattern</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/docker/" rel="tag">docker</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/elasticsearch/" rel="tag">elasticsearch</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/es/" rel="tag">es</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/eureka/" rel="tag">eureka</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/firefox/" rel="tag">firefox</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/flask/" rel="tag">flask</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/geohash/" rel="tag">geohash</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/geomesa/" rel="tag">geomesa</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/git/" rel="tag">git</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/gitlab/" rel="tag">gitlab</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/gradle/" rel="tag">gradle</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/groovy/" rel="tag">groovy</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hadoop/" rel="tag">hadoop</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hbase/" rel="tag">hbase</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hexo/" rel="tag">hexo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/html/" rel="tag">html</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/http/" rel="tag">http</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/idea/" rel="tag">idea</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ip/" rel="tag">ip</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/java/" rel="tag">java</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/javascript/" rel="tag">javascript</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/js/" rel="tag">js</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/junit/" rel="tag">junit</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jupyter/" rel="tag">jupyter</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jupyterhub/" rel="tag">jupyterhub</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jvm/" rel="tag">jvm</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jwt/" rel="tag">jwt</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/k8s/" rel="tag">k8s</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/kafka/" rel="tag">kafka</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/katalon/" rel="tag">katalon</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/keepalived/" rel="tag">keepalived</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/latex/" rel="tag">latex</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/life/" rel="tag">life</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux/" rel="tag">linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux-kernel/" rel="tag">linux kernel</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/load-balance/" rel="tag">load balance</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/log/" rel="tag">log</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/log4j/" rel="tag">log4j</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/log4j12/" rel="tag">log4j12</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/logback/" rel="tag">logback</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/lombok/" rel="tag">lombok</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/lru/" rel="tag">lru</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/lucene/" rel="tag">lucene</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/magnet/" rel="tag">magnet</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/make/" rel="tag">make</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/makefile/" rel="tag">makefile</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/manjaro/" rel="tag">manjaro</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/math/" rel="tag">math</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/maven/" rel="tag">maven</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/md5/" rel="tag">md5</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mhtml/" rel="tag">mhtml</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/microservice/" rel="tag">microservice</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/music/" rel="tag">music</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mybatis/" rel="tag">mybatis</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mysql/" rel="tag">mysql</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/nginx/" rel="tag">nginx</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/notebook/" rel="tag">notebook</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/npm/" rel="tag">npm</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/nvidia/" rel="tag">nvidia</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/oauth/" rel="tag">oauth</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/openstack/" rel="tag">openstack</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/optimization/" rel="tag">optimization</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/pandas/" rel="tag">pandas</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/pandoc/" rel="tag">pandoc</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/pgsql/" rel="tag">pgsql</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/probability/" rel="tag">probability</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/pyspark/" rel="tag">pyspark</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python/" rel="tag">python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/quartz/" rel="tag">quartz</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/react/" rel="tag">react</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/redis/" rel="tag">redis</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/resource/" rel="tag">resource</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/review/" rel="tag">review</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sbt/" rel="tag">sbt</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/scala/" rel="tag">scala</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/shell/" rel="tag">shell</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/slf4j/" rel="tag">slf4j</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/spark/" rel="tag">spark</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/spring/" rel="tag">spring</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/spring-cloud/" rel="tag">spring cloud</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/spring-boot/" rel="tag">spring-boot</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/springboot/" rel="tag">springboot</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sql/" rel="tag">sql</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sqlserver/" rel="tag">sqlserver</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ssh/" rel="tag">ssh</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/statistics/" rel="tag">statistics</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/syslog/" rel="tag">syslog</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/term/" rel="tag">term</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/test/" rel="tag">test</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/texlive/" rel="tag">texlive</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/thread/" rel="tag">thread</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tomcat/" rel="tag">tomcat</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tool/" rel="tag">tool</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ubuntu/" rel="tag">ubuntu</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/urban-computing/" rel="tag">urban computing</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/video/" rel="tag">video</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vim/" rel="tag">vim</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vpn/" rel="tag">vpn</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vscode/" rel="tag">vscode</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vue/" rel="tag">vue</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/web/" rel="tag">web</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/web-dav/" rel="tag">web-dav</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/webpack/" rel="tag">webpack</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/week/" rel="tag">week</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/windows/" rel="tag">windows</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/wordcloud/" rel="tag">wordcloud</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/work/" rel="tag">work</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/xml/" rel="tag">xml</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/zipkin/" rel="tag">zipkin</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/zookeeper/" rel="tag">zookeeper</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%BA%91%E8%AE%A1%E7%AE%97/" rel="tag">云计算</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%85%83%E7%BC%96%E7%A8%8B/" rel="tag">元编程</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%9F%8E%E5%B8%82%E8%AE%A1%E7%AE%97/" rel="tag">城市计算</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%9E%B6%E6%9E%84/" rel="tag">架构</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%A6%82%E5%BF%B5/" rel="tag">概念</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%B5%8B%E8%AF%95/" rel="tag">测试</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%88%AC%E8%99%AB/" rel="tag">爬虫</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%BF%90%E7%BB%B4/" rel="tag">运维</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签云</h3>
    <div class="widget tagcloud">
      <a href="/tags/AI/" style="font-size: 10.53px;">AI</a> <a href="/tags/UI-test/" style="font-size: 10px;">UI test</a> <a href="/tags/algorithm/" style="font-size: 10.53px;">algorithm</a> <a href="/tags/android/" style="font-size: 10.53px;">android</a> <a href="/tags/annotation/" style="font-size: 10px;">annotation</a> <a href="/tags/ansible/" style="font-size: 13.16px;">ansible</a> <a href="/tags/ant/" style="font-size: 10px;">ant</a> <a href="/tags/aop/" style="font-size: 10px;">aop</a> <a href="/tags/archiva/" style="font-size: 10px;">archiva</a> <a href="/tags/asciidoc/" style="font-size: 10px;">asciidoc</a> <a href="/tags/awk/" style="font-size: 10px;">awk</a> <a href="/tags/axios/" style="font-size: 10px;">axios</a> <a href="/tags/basic/" style="font-size: 13.16px;">basic</a> <a href="/tags/big-data/" style="font-size: 10.53px;">big data</a> <a href="/tags/blockchain/" style="font-size: 10px;">blockchain</a> <a href="/tags/centos/" style="font-size: 12.11px;">centos</a> <a href="/tags/cglib/" style="font-size: 10px;">cglib</a> <a href="/tags/checkstyle/" style="font-size: 10px;">checkstyle</a> <a href="/tags/chrome/" style="font-size: 11.05px;">chrome</a> <a href="/tags/computer-principle/" style="font-size: 10px;">computer principle</a> <a href="/tags/cors/" style="font-size: 10.53px;">cors</a> <a href="/tags/data-structure/" style="font-size: 10px;">data structure</a> <a href="/tags/design-pattern/" style="font-size: 10.53px;">design-pattern</a> <a href="/tags/docker/" style="font-size: 17.89px;">docker</a> <a href="/tags/elasticsearch/" style="font-size: 13.16px;">elasticsearch</a> <a href="/tags/es/" style="font-size: 10px;">es</a> <a href="/tags/eureka/" style="font-size: 10px;">eureka</a> <a href="/tags/firefox/" style="font-size: 10px;">firefox</a> <a href="/tags/flask/" style="font-size: 10px;">flask</a> <a href="/tags/geohash/" style="font-size: 10px;">geohash</a> <a href="/tags/geomesa/" style="font-size: 10px;">geomesa</a> <a href="/tags/git/" style="font-size: 13.16px;">git</a> <a href="/tags/gitlab/" style="font-size: 11.05px;">gitlab</a> <a href="/tags/gradle/" style="font-size: 10px;">gradle</a> <a href="/tags/groovy/" style="font-size: 10px;">groovy</a> <a href="/tags/hadoop/" style="font-size: 10.53px;">hadoop</a> <a href="/tags/hbase/" style="font-size: 11.58px;">hbase</a> <a href="/tags/hexo/" style="font-size: 10.53px;">hexo</a> <a href="/tags/html/" style="font-size: 10.53px;">html</a> <a href="/tags/http/" style="font-size: 10px;">http</a> <a href="/tags/idea/" style="font-size: 11.05px;">idea</a> <a href="/tags/ip/" style="font-size: 10px;">ip</a> <a href="/tags/java/" style="font-size: 20px;">java</a> <a href="/tags/javascript/" style="font-size: 11.58px;">javascript</a> <a href="/tags/js/" style="font-size: 13.16px;">js</a> <a href="/tags/junit/" style="font-size: 10px;">junit</a> <a href="/tags/jupyter/" style="font-size: 10px;">jupyter</a> <a href="/tags/jupyterhub/" style="font-size: 10.53px;">jupyterhub</a> <a href="/tags/jvm/" style="font-size: 10px;">jvm</a> <a href="/tags/jwt/" style="font-size: 10px;">jwt</a> <a href="/tags/k8s/" style="font-size: 11.05px;">k8s</a> <a href="/tags/kafka/" style="font-size: 10px;">kafka</a> <a href="/tags/katalon/" style="font-size: 10px;">katalon</a> <a href="/tags/keepalived/" style="font-size: 10.53px;">keepalived</a> <a href="/tags/latex/" style="font-size: 11.05px;">latex</a> <a href="/tags/life/" style="font-size: 18.95px;">life</a> <a href="/tags/linux/" style="font-size: 19.47px;">linux</a> <a href="/tags/linux-kernel/" style="font-size: 10px;">linux kernel</a> <a href="/tags/load-balance/" style="font-size: 10px;">load balance</a> <a href="/tags/log/" style="font-size: 10px;">log</a> <a href="/tags/log4j/" style="font-size: 10px;">log4j</a> <a href="/tags/log4j12/" style="font-size: 10px;">log4j12</a> <a href="/tags/logback/" style="font-size: 10px;">logback</a> <a href="/tags/lombok/" style="font-size: 10px;">lombok</a> <a href="/tags/lru/" style="font-size: 10px;">lru</a> <a href="/tags/lucene/" style="font-size: 10px;">lucene</a> <a href="/tags/magnet/" style="font-size: 10px;">magnet</a> <a href="/tags/make/" style="font-size: 10px;">make</a> <a href="/tags/makefile/" style="font-size: 10px;">makefile</a> <a href="/tags/manjaro/" style="font-size: 10px;">manjaro</a> <a href="/tags/math/" style="font-size: 11.05px;">math</a> <a href="/tags/maven/" style="font-size: 15.26px;">maven</a> <a href="/tags/md5/" style="font-size: 10px;">md5</a> <a href="/tags/mhtml/" style="font-size: 10px;">mhtml</a> <a href="/tags/microservice/" style="font-size: 14.21px;">microservice</a> <a href="/tags/music/" style="font-size: 10px;">music</a> <a href="/tags/mybatis/" style="font-size: 11.05px;">mybatis</a> <a href="/tags/mysql/" style="font-size: 12.11px;">mysql</a> <a href="/tags/nginx/" style="font-size: 12.63px;">nginx</a> <a href="/tags/notebook/" style="font-size: 10px;">notebook</a> <a href="/tags/npm/" style="font-size: 10px;">npm</a> <a href="/tags/nvidia/" style="font-size: 10px;">nvidia</a> <a href="/tags/oauth/" style="font-size: 10px;">oauth</a> <a href="/tags/openstack/" style="font-size: 12.11px;">openstack</a> <a href="/tags/optimization/" style="font-size: 10px;">optimization</a> <a href="/tags/pandas/" style="font-size: 10px;">pandas</a> <a href="/tags/pandoc/" style="font-size: 10px;">pandoc</a> <a href="/tags/pgsql/" style="font-size: 11.58px;">pgsql</a> <a href="/tags/probability/" style="font-size: 10px;">probability</a> <a href="/tags/pyspark/" style="font-size: 10px;">pyspark</a> <a href="/tags/python/" style="font-size: 17.37px;">python</a> <a href="/tags/quartz/" style="font-size: 10.53px;">quartz</a> <a href="/tags/react/" style="font-size: 10px;">react</a> <a href="/tags/redis/" style="font-size: 15.79px;">redis</a> <a href="/tags/resource/" style="font-size: 10px;">resource</a> <a href="/tags/review/" style="font-size: 10px;">review</a> <a href="/tags/sbt/" style="font-size: 10px;">sbt</a> <a href="/tags/scala/" style="font-size: 14.74px;">scala</a> <a href="/tags/shell/" style="font-size: 12.63px;">shell</a> <a href="/tags/slf4j/" style="font-size: 10px;">slf4j</a> <a href="/tags/spark/" style="font-size: 14.74px;">spark</a> <a href="/tags/spring/" style="font-size: 15.79px;">spring</a> <a href="/tags/spring-cloud/" style="font-size: 12.11px;">spring cloud</a> <a href="/tags/spring-boot/" style="font-size: 13.68px;">spring-boot</a> <a href="/tags/springboot/" style="font-size: 11.05px;">springboot</a> <a href="/tags/sql/" style="font-size: 11.05px;">sql</a> <a href="/tags/sqlserver/" style="font-size: 10.53px;">sqlserver</a> <a href="/tags/ssh/" style="font-size: 12.11px;">ssh</a> <a href="/tags/statistics/" style="font-size: 10px;">statistics</a> <a href="/tags/syslog/" style="font-size: 10px;">syslog</a> <a href="/tags/term/" style="font-size: 10px;">term</a> <a href="/tags/test/" style="font-size: 10px;">test</a> <a href="/tags/texlive/" style="font-size: 10px;">texlive</a> <a href="/tags/thread/" style="font-size: 10px;">thread</a> <a href="/tags/tomcat/" style="font-size: 13.16px;">tomcat</a> <a href="/tags/tool/" style="font-size: 16.84px;">tool</a> <a href="/tags/ubuntu/" style="font-size: 16.32px;">ubuntu</a> <a href="/tags/urban-computing/" style="font-size: 10px;">urban computing</a> <a href="/tags/video/" style="font-size: 10px;">video</a> <a href="/tags/vim/" style="font-size: 10.53px;">vim</a> <a href="/tags/vpn/" style="font-size: 10px;">vpn</a> <a href="/tags/vscode/" style="font-size: 10px;">vscode</a> <a href="/tags/vue/" style="font-size: 11.05px;">vue</a> <a href="/tags/web/" style="font-size: 10px;">web</a> <a href="/tags/web-dav/" style="font-size: 10px;">web-dav</a> <a href="/tags/webpack/" style="font-size: 10.53px;">webpack</a> <a href="/tags/week/" style="font-size: 18.42px;">week</a> <a href="/tags/windows/" style="font-size: 10px;">windows</a> <a href="/tags/wordcloud/" style="font-size: 10px;">wordcloud</a> <a href="/tags/work/" style="font-size: 10px;">work</a> <a href="/tags/xml/" style="font-size: 10px;">xml</a> <a href="/tags/zipkin/" style="font-size: 10px;">zipkin</a> <a href="/tags/zookeeper/" style="font-size: 10px;">zookeeper</a> <a href="/tags/%E4%BA%91%E8%AE%A1%E7%AE%97/" style="font-size: 12.63px;">云计算</a> <a href="/tags/%E5%85%83%E7%BC%96%E7%A8%8B/" style="font-size: 10px;">元编程</a> <a href="/tags/%E5%9F%8E%E5%B8%82%E8%AE%A1%E7%AE%97/" style="font-size: 10px;">城市计算</a> <a href="/tags/%E6%9E%B6%E6%9E%84/" style="font-size: 10px;">架构</a> <a href="/tags/%E6%A6%82%E5%BF%B5/" style="font-size: 10px;">概念</a> <a href="/tags/%E6%B5%8B%E8%AF%95/" style="font-size: 10px;">测试</a> <a href="/tags/%E7%88%AC%E8%99%AB/" style="font-size: 10px;">爬虫</a> <a href="/tags/%E8%BF%90%E7%BB%B4/" style="font-size: 10px;">运维</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/03/">三月 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/10/">十月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/09/">九月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/08/">八月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/07/">七月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/06/">六月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/05/">五月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/04/">四月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/03/">三月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/02/">二月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/01/">一月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">十二月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/11/">十一月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/10/">十月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/09/">九月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">八月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/07/">七月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/06/">六月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/05/">五月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/04/">四月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/03/">三月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/02/">二月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/01/">一月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/">十二月 2017</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2022/03/31/redis/000-redis-interview/">Redis面试总结202203</a>
          </li>
        
          <li>
            <a href="/2019/10/27/maven/009-maven-deploy/">使用IDEA部署jar包到maven仓库(maven deploy)</a>
          </li>
        
          <li>
            <a href="/2019/10/24/java/075-pluggable-annotation-processing-lombok/">Pluggable Annotation Processing的讲解与实践</a>
          </li>
        
          <li>
            <a href="/2019/10/18/life/036-weekly-learn/">2019-42-周报</a>
          </li>
        
          <li>
            <a href="/2019/10/15/shell/003-carriage-linechange/">r command not found</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2022 Jackpler<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">home</a>
  
    <a href="/archives" class="mobile-nav-link">archives</a>
  
    <a href="/about" class="mobile-nav-link">about</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>




  </div>
</body>
</html>