<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-111673440-1', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->


  
  <title>在我的世界</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="who,where,what">
<meta property="og:type" content="website">
<meta property="og:title" content="在我的世界">
<meta property="og:url" content="http://jimolonely.github.io/page/9/index.html">
<meta property="og:site_name" content="在我的世界">
<meta property="og:description" content="who,where,what">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="Jackpler">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="在我的世界" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 6.1.0"><link rel="stylesheet" href="/css/prism-atom-dark.css" type="text/css">
<link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"><script src="/js/prism.js"></script>
<script src="/js/prism-line-numbers.min.js"></script></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">在我的世界</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">home</a>
        
          <a class="main-nav-link" href="/archives">archives</a>
        
          <a class="main-nav-link" href="/about">about</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="搜索"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://jimolonely.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-basic/015-xml" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/02/27/basic/015-xml/" class="article-date">
  <time datetime="2019-02-27T02:06:05.000Z" itemprop="datePublished">2019-02-27</time>
</a>
      
  </div>
  <div class="article-inner">
    
      
        <header class="article-header">
          
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/02/27/basic/015-xml/">xml再认识</a>
    </h1>
  

        </header>
        
          <!-- <div class="article-entry" itemprop="articleBody">
      
        <p>虽然已经用了这么多年的xml了，因为很简单，所以从来没有系统学习过，有一些关键点不需要知道也可以使用，<br>因此一直没有重视，好吧，前面的是废话。重点是求知欲不够强。面试也基本不会问这个，所以就逃避了，但内心是拒绝的。<br>本文不会从0开始认识xml，而是在使用了n年后再完整学习后发现的知识盲区。</p>
<p>学习地址：</p>
<ol>
<li><a target="_blank" rel="noopener" href="http://www.runoob.com/xml/xml-tutorial.html">xml-runoob</a></li>
<li><a target="_blank" rel="noopener" href="http://www.w3school.com.cn/x.asp">xml-w3c</a></li>
</ol>
<p>下面是再学习到的知识点：</p>
<ol>
<li>xml必须有一个根结点，结构是树；</li>
<li>大小写敏感，标签必须关闭</li>
<li>特殊实体引用(特殊符号)： <code>&gt;(&amp;gt;),&lt;(&amp;lt;),&amp;(&amp;amp;),&#39;(&amp;apos;),&quot;(&amp;quot;)</code></li>
<li>对扩展开放： 就是增加标签不影响解析</li>
<li>什么时候使用属性： 属性不是数据，而是元数据，可以对比HTML标签的属性</li>
</ol>
<p>上面的是只关乎XML的知识，下面的涉及更广，更难一点：</p>
<p>首先明确一点： 形式良好和合法。<br>拥有正确语法的 XML 被称为”形式良好”的 XML。<br>通过 DTD 验证的XML是”合法”的 XML。</p>
<ol>
<li>什么是DTD？<br>  DTD(Document Type Define),作用是定义 XML 文档的合法构建模块，可以验证xml是否合法。具体参考<a target="_blank" rel="noopener" href="http://www.runoob.com/dtd/dtd-tutorial.html">DTD教程</a>。<br>  DTD语法很简单，表示2个东西： 有哪些标签(ELEMENT，ATTLIST，ENTITY)，标签的类型(#PCDATA, CDATA等)和结构：  <figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span>?&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- Edited by XMLSpy® --&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">note</span> [</span></span><br><span class="line"><span class="meta">  <span class="meta">&lt;!ELEMENT <span class="keyword">note</span>    (<span class="keyword">to</span>,<span class="keyword">from</span>,<span class="keyword">heading</span>,<span class="keyword">body</span>)&gt;</span></span></span><br><span class="line"><span class="meta">  <span class="meta">&lt;!ELEMENT <span class="keyword">to</span>      (<span class="keyword">#PCDATA</span>)&gt;</span></span></span><br><span class="line"><span class="meta">  <span class="meta">&lt;!ELEMENT <span class="keyword">from</span>    (<span class="keyword">#PCDATA</span>)&gt;</span></span></span><br><span class="line"><span class="meta">  <span class="meta">&lt;!ELEMENT <span class="keyword">heading</span> (<span class="keyword">#PCDATA</span>)&gt;</span></span></span><br><span class="line"><span class="meta">  <span class="meta">&lt;!ELEMENT <span class="keyword">body</span>    (<span class="keyword">#PCDATA</span>)&gt;</span></span></span><br><span class="line"><span class="meta">]&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">note</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">to</span>&gt;</span>Tove<span class="tag">&lt;/<span class="name">to</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">from</span>&gt;</span>Jani<span class="tag">&lt;/<span class="name">from</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">heading</span>&gt;</span>Reminder<span class="tag">&lt;/<span class="name">heading</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span>Don&#x27;t forget me this weekend!<span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">note</span>&gt;</span> </span><br></pre></td></tr></table></figure></li>
<li>当然，验证合法性不只一种，Schema被开发出来代替DTD：</li>
<li>Schema： 描述了XML文档的结构，比DTD更强大，所以复杂一点。<a target="_blank" rel="noopener" href="http://www.runoob.com/schema/schema-tutorial.html">具体教程</a></li>
<li>我只希望花5分钟学习schema，没啥，因为我时间宝贵，那么我只会用一个例子+几句话。<br>1. schema基本上已经取代DTD，2001年发布, 文件格式： *.xsd<br>2. schema是由XML来书写的，好处很多, 比DTD强大的地方就在于丰富的数据类型（boolean,string,decimal,integer,date,time）<br>3. 下面是如何引用schema：<ol>
<li>声明当前域名空间： <code>xmlns=&quot;http://java.sun.com/xml/ns/javaee&quot;</code></li>
<li>声明XML Schema 命名空间实例： <code>xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</code></li>
<li>使用<code>schemaLocation</code>引用xsd文件： <code>xsi:schemaLocation=&quot;http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd&quot;</code></li>
<li>这个例子就是 <code>web.xml</code>:   <figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">web-app</span> <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">xmlns</span>=<span class="string">&quot;http://java.sun.com/xml/ns/javaee&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">version</span>=<span class="string">&quot;3.0&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>JimoMvc<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>com.jimo.mvc.servlet.DispatcherServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>contextConfigLocation<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>application.properties<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">load-on-startup</span>&gt;</span>1<span class="tag">&lt;/<span class="name">load-on-startup</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>JimoMvc<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">web-app</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
</ol>
</li>
</ol>
<p>当然，现在我心里不慌了，后面还有一些更高级的东西，直到需要的时候再研究把，为啥？ 因为我时间宝贵呀！</p>

      
    </div> -->
          <div class="article-entry" itemprop="articleBody">
            
              
                
                      
                        
                          
                            
                              
                                
                                  
                                    <p>
                                      <p>虽然已经用了这么多年的xml了，因为很简单，所以从来没有系统学习过，有一些关键点不需要知道也可以使用，<br>因此一直没有重视，好吧，前面的是废话。重点是求知欲不够强。面试也基本不会问这个，所以就逃避了，但内心是拒绝的。<br>本文不会从0开始认识xml，而是在使用了n年后再完整学习后发现的知识盲区。</p>

                                        <p>
                                          
                                            
                                              
                                                      
          </div>
    <p class="article-more-link">
      <a href="/2019/02/27/basic/015-xml/#more">
        Read More
      </a>
    </p>
    <!-- <div class="article-more-link">
      <a href="/2019/02/27/basic/015-xml/#more">
        read more
      </a>
    </div> -->
    


      <footer class="article-footer">
        <a data-url="http://jimolonely.github.io/2019/02/27/basic/015-xml/" data-id="cl1fw7fhz0016vkd37l2eamtw" class="article-share-link">
          Share
        </a>
        
            
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/xml/" rel="tag">xml</a><span class="article-tag-list-count">1</span></li></ul>

      </footer>
      </div>
      
</article>


  
    <article id="post-life/005-weekly-learn" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/02/27/life/005-weekly-learn/" class="article-date">
  <time datetime="2019-02-27T01:21:37.000Z" itemprop="datePublished">2019-02-27</time>
</a>
      
  </div>
  <div class="article-inner">
    
      
        <header class="article-header">
          
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/02/27/life/005-weekly-learn/">2019-9-周报</a>
    </h1>
  

        </header>
        
          <!-- <div class="article-entry" itemprop="articleBody">
      
        <p>因为学的东西有点多，又有点杂，所以从这周开始，记录下自己的学习轨迹和内容，方便复习。</p>
<ol>
<li><p>spring的学习，深入到源码： <a href="/2019/02/21/java/025-spring-source/" title="spring source">spring source</a>， 关于我自己练习的代码：<a href=""></a></p>
</li>
<li><p>redis底层设计： <a href="/2019/02/21/lang/013-redis-design-principle/" title="redis design">redis design</a></p>
</li>
<li><p>把java创建对象复习了下： <a href="/2019/02/22/java/026-java-create-instance/" title="java create instance">java create instance</a></p>
</li>
<li><p>CGLib学习： <a href="/2019/02/25/java/027-cglib/" title="cglib">cglib</a></p>
</li>
<li><p>skip list,因为redis里用到，而我又是第一次见到： <a href="/2019/02/26/algorithm/002-skip-list/" title="skipList">skipList</a></p>
</li>
<li><p>事务和其隔离级别的复习, 理论不复习就会忘： <a target="_blank" rel="noopener" href="https://juejin.im/post/5b00c52ef265da0b95276091">事务</a></p>
</li>
<li><p>一个不错的博客作者：<a target="_blank" rel="noopener" href="https://juejin.im/user/59fbb2daf265da4319559f3a/posts">主页</a>, java学习面试地址，感觉作者能力也不是很强，单也有值得学习的地方： <a target="_blank" rel="noopener" href="https://github.com/Snailclimb/JavaGuide">github</a></p>
</li>
<li><p>先看了<a target="_blank" rel="noopener" href="https://github.com/Snailclimb/JavaGuide#java-%E9%9B%86%E5%90%88%E6%A1%86%E6%9E%B6">集合</a></p>
</li>
<li><p>复习了几个设计模式： 观察者、代理、责任链、策略模式</p>
</li>
<li><p>再学习XML： <a href="/2019/02/27/basic/015-xml/" title="xml again">xml again</a></p>
</li>
<li><p>关于java问题的再认识： <a href="/2019/02/27/java/028-equals-hashcode/" title="equals-hashcode">equals-hashcode</a></p>
</li>
<li><a href="/2019/02/27/java/029-eureka-record/" title="[eureka学习]">[eureka学习]</a></li>
</ol>
<p>最后在周末复习一下，准备迎接下周的架构师学习。</p>

      
    </div> -->
          <div class="article-entry" itemprop="articleBody">
            
              
                
                      
                        
                          
                            
                              
                                
                                  
                                    <p>
                                      <p>因为学的东西有点多，又有点杂，所以从这周开始，记录下自己的学习轨迹和内容，方便复习。</p>

                                        <p>
                                          
                                            
                                              
                                                      
          </div>
    <p class="article-more-link">
      <a href="/2019/02/27/life/005-weekly-learn/#more">
        Read More
      </a>
    </p>
    <!-- <div class="article-more-link">
      <a href="/2019/02/27/life/005-weekly-learn/#more">
        read more
      </a>
    </div> -->
    


      <footer class="article-footer">
        <a data-url="http://jimolonely.github.io/2019/02/27/life/005-weekly-learn/" data-id="cl1fw7fjz006bvkd3b6qs7996" class="article-share-link">
          Share
        </a>
        
            
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/life/" rel="tag">life</a><span class="article-tag-list-count">32</span></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/week/" rel="tag">week</a><span class="article-tag-list-count">26</span></li></ul>

      </footer>
      </div>
      
</article>


  
    <article id="post-algorithm/002-skip-list" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/02/26/algorithm/002-skip-list/" class="article-date">
  <time datetime="2019-02-26T05:49:14.000Z" itemprop="datePublished">2019-02-26</time>
</a>
      
  </div>
  <div class="article-inner">
    
      
        <header class="article-header">
          
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/02/26/algorithm/002-skip-list/">skip list理解与java实现</a>
    </h1>
  

        </header>
        
          <!-- <div class="article-entry" itemprop="articleBody">
      
        <p>本文学习跳跃表及其java代码实现。</p>
<h1 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h1><p><a target="_blank" rel="noopener" href="http://www.cl.cam.ac.uk/teaching/0506/Algorithms/skiplists.pdf">论文来源</a></p>
<p>学习其概念，看下面的文章：</p>
<p><a target="_blank" rel="noopener" href="http://blog.jobbole.com/111731/">漫画算法：什么是跳跃表？</a></p>
<p><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Skip_list">wiki</a></p>
<p><a target="_blank" rel="noopener" href="https://redisbook.readthedocs.io/en/latest/internal-datastruct/skiplist.html">redis里跳跃表的应用</a></p>
<p>插入的动态图：</p>
<img src="/2019/02/26/algorithm/002-skip-list/000.gif" class="">

<h1 id="实现跳跃表"><a href="#实现跳跃表" class="headerlink" title="实现跳跃表"></a>实现跳跃表</h1><p>参考：<a target="_blank" rel="noopener" href="https://blog.csdn.net/brillianteagle/article/details/52206261">算法导论33】跳跃表（Skip list）原理与java实现</a></p>
<p>SkipListNode</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.Objects;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> jimo</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 19-2-26 下午4:03</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SkipListNode</span>&lt;T&gt; &#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="type">int</span> key;</span><br><span class="line">	<span class="keyword">public</span> T value;</span><br><span class="line">	<span class="keyword">public</span> SkipListNode&lt;T&gt; up, down, left, right;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">HEAD_KEY</span> <span class="operator">=</span> Integer.MIN_VALUE;</span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">int</span> <span class="variable">TAIL_KEY</span> <span class="operator">=</span> Integer.MAX_VALUE;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="title function_">SkipListNode</span><span class="params">(<span class="type">int</span> key, T value)</span> &#123;</span><br><span class="line">		<span class="built_in">this</span>.key = key;</span><br><span class="line">		<span class="built_in">this</span>.value = value;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">equals</span><span class="params">(Object o)</span> &#123;</span><br><span class="line">		<span class="keyword">if</span> (<span class="built_in">this</span> == o) &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (o == <span class="literal">null</span> || getClass() != o.getClass()) &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		SkipListNode&lt;?&gt; that = (SkipListNode&lt;?&gt;) o;</span><br><span class="line">		<span class="type">return</span> <span class="variable">key</span> <span class="operator">=</span>= that.key &amp;&amp;</span><br><span class="line">				Objects.equals(value, that.value);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="keyword">public</span> <span class="type">int</span> <span class="title function_">hashCode</span><span class="params">()</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> Objects.hash(key, value);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;[&quot;</span> + key + <span class="string">&quot;,&quot;</span> + value + <span class="string">&quot;]&quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>SkipList:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> java.util.Random;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> com.jimo.structure.skiplist.SkipListNode.HEAD_KEY;</span><br><span class="line"><span class="keyword">import</span> <span class="keyword">static</span> com.jimo.structure.skiplist.SkipListNode.TAIL_KEY;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SkipList</span>&lt;T&gt; &#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> SkipListNode&lt;T&gt; head, tail;</span><br><span class="line">	<span class="keyword">private</span> <span class="type">int</span> nodes;</span><br><span class="line">	<span class="keyword">private</span> <span class="type">int</span> level;</span><br><span class="line">	<span class="keyword">private</span> Random random;</span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">double</span> <span class="variable">PROBABILITY</span> <span class="operator">=</span> <span class="number">0.5</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="title function_">SkipList</span><span class="params">()</span> &#123;</span><br><span class="line">		random = <span class="keyword">new</span> <span class="title class_">Random</span>();</span><br><span class="line">		head = <span class="keyword">new</span> <span class="title class_">SkipListNode</span>&lt;&gt;(HEAD_KEY, <span class="literal">null</span>);</span><br><span class="line">		tail = <span class="keyword">new</span> <span class="title class_">SkipListNode</span>&lt;&gt;(TAIL_KEY, <span class="literal">null</span>);</span><br><span class="line">		linkHorizontal(head, tail);</span><br><span class="line">		level = <span class="number">0</span>;</span><br><span class="line">		nodes = <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">isEmpty</span><span class="params">()</span> &#123;</span><br><span class="line">		<span class="type">return</span> <span class="variable">nodes</span> <span class="operator">=</span>= <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="type">int</span> <span class="title function_">size</span><span class="params">()</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> nodes;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> SkipListNode&lt;T&gt; <span class="title function_">findNode</span><span class="params">(<span class="type">int</span> key)</span> &#123;</span><br><span class="line">		SkipListNode&lt;T&gt; p = <span class="built_in">this</span>.head;</span><br><span class="line">		<span class="keyword">while</span> (<span class="literal">true</span>) &#123;</span><br><span class="line">			<span class="keyword">while</span> (p.right.key != TAIL_KEY &amp;&amp; p.right.key &lt;= key) &#123;</span><br><span class="line">				p = p.right;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span> (p.down != <span class="literal">null</span>) &#123;</span><br><span class="line">				p = p.down;</span><br><span class="line">			&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> p;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> SkipListNode&lt;T&gt; <span class="title function_">search</span><span class="params">(<span class="type">int</span> key)</span> &#123;</span><br><span class="line">		SkipListNode&lt;T&gt; p = findNode(key);</span><br><span class="line">		<span class="keyword">if</span> (p.key == key) &#123;</span><br><span class="line">			<span class="keyword">return</span> p;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">put</span><span class="params">(<span class="type">int</span> k, T v)</span> &#123;</span><br><span class="line">		SkipListNode&lt;T&gt; p = findNode(k);</span><br><span class="line">		<span class="keyword">if</span> (k == p.key) &#123;</span><br><span class="line">			p.value = v;</span><br><span class="line">			<span class="keyword">return</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		SkipListNode&lt;T&gt; newNode = <span class="keyword">new</span> <span class="title class_">SkipListNode</span>&lt;&gt;(k, v);</span><br><span class="line">		linkToRight(p, newNode);</span><br><span class="line">		<span class="type">int</span> <span class="variable">currentLevel</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">		<span class="comment">// 抛硬币</span></span><br><span class="line">		<span class="keyword">while</span> (random.nextDouble() &lt; PROBABILITY) &#123;</span><br><span class="line">			<span class="keyword">if</span> (currentLevel &gt;= level) &#123;</span><br><span class="line">				level++;</span><br><span class="line">				SkipListNode&lt;T&gt; p1 = <span class="keyword">new</span> <span class="title class_">SkipListNode</span>&lt;&gt;(HEAD_KEY, <span class="literal">null</span>);</span><br><span class="line">				SkipListNode&lt;T&gt; p2 = <span class="keyword">new</span> <span class="title class_">SkipListNode</span>&lt;&gt;(TAIL_KEY, <span class="literal">null</span>);</span><br><span class="line">				linkHorizontal(p1, p2);</span><br><span class="line">				linkVertical(p1, head);</span><br><span class="line">				linkVertical(p2, tail);</span><br><span class="line">				head = p1;</span><br><span class="line">				tail = p2;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="comment">// p移到上一层</span></span><br><span class="line">			<span class="keyword">while</span> (p.up == <span class="literal">null</span>) &#123;</span><br><span class="line">				p = p.left;</span><br><span class="line">			&#125;</span><br><span class="line">			p = p.up;</span><br><span class="line"></span><br><span class="line">			SkipListNode&lt;T&gt; e = <span class="keyword">new</span> <span class="title class_">SkipListNode</span>&lt;&gt;(k, <span class="literal">null</span>);</span><br><span class="line">			linkToRight(p, e);</span><br><span class="line">			linkVertical(e, newNode);</span><br><span class="line">			newNode = e;</span><br><span class="line">			currentLevel++;</span><br><span class="line">		&#125;</span><br><span class="line">		nodes++;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">/**</span></span><br><span class="line"><span class="comment">	 * n2 插在 n1后面</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@author</span> jimo</span></span><br><span class="line"><span class="comment">	 * <span class="doctag">@date</span> 19-2-26 下午4:19</span></span><br><span class="line"><span class="comment">	 */</span></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">linkToRight</span><span class="params">(SkipListNode&lt;T&gt; n1, SkipListNode&lt;T&gt; n2)</span> &#123;</span><br><span class="line">		n2.left = n1;</span><br><span class="line">		n2.right = n1.right;</span><br><span class="line">		n1.right.left = n2;</span><br><span class="line">		n1.right = n2;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">linkHorizontal</span><span class="params">(SkipListNode&lt;T&gt; n1, SkipListNode&lt;T&gt; n2)</span> &#123;</span><br><span class="line">		n1.right = n2;</span><br><span class="line">		n2.left = n1;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">linkVertical</span><span class="params">(SkipListNode&lt;T&gt; n1, SkipListNode&lt;T&gt; n2)</span> &#123;</span><br><span class="line">		n1.down = n2;</span><br><span class="line">		n2.up = n1;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">printByLevel</span><span class="params">()</span> &#123;</span><br><span class="line">		SkipListNode&lt;T&gt; p = <span class="built_in">this</span>.head;</span><br><span class="line">		<span class="keyword">while</span> (p != <span class="literal">null</span>) &#123;</span><br><span class="line">			SkipListNode&lt;T&gt; tmp = p;</span><br><span class="line">			<span class="type">StringBuilder</span> <span class="variable">sb</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">			<span class="keyword">while</span> (p != <span class="literal">null</span>) &#123;</span><br><span class="line">				sb.append(p).append(<span class="string">&quot; &quot;</span>);</span><br><span class="line">				p = p.right;</span><br><span class="line">			&#125;</span><br><span class="line">			System.out.println(sb.toString());</span><br><span class="line">			p = tmp.down;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">		<span class="keyword">if</span> (isEmpty()) &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="string">&quot;empty&quot;</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="type">StringBuilder</span> <span class="variable">sb</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>();</span><br><span class="line">		SkipListNode&lt;T&gt; p = <span class="built_in">this</span>.head;</span><br><span class="line">		<span class="keyword">while</span> (p.down != <span class="literal">null</span>) &#123;</span><br><span class="line">			p = p.down;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">while</span> (p.left != <span class="literal">null</span>) &#123;</span><br><span class="line">			p = p.left;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (p.right != <span class="literal">null</span>) &#123;</span><br><span class="line">			p = p.right;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">while</span> (p.right != <span class="literal">null</span>) &#123;</span><br><span class="line">			sb.append(p);</span><br><span class="line">			sb.append(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">			p = p.right;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> sb.toString();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>Test:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Test</span> &#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">		SkipList&lt;String&gt; skipList = <span class="keyword">new</span> <span class="title class_">SkipList</span>&lt;&gt;();</span><br><span class="line">		skipList.put(<span class="number">2</span>, <span class="string">&quot;like&quot;</span>);</span><br><span class="line">		skipList.put(<span class="number">1</span>, <span class="string">&quot;I&quot;</span>);</span><br><span class="line">		skipList.put(<span class="number">3</span>, <span class="string">&quot;Jimo&quot;</span>);</span><br><span class="line">		skipList.put(<span class="number">5</span>, <span class="string">&quot;much&quot;</span>);</span><br><span class="line">		skipList.put(<span class="number">4</span>, <span class="string">&quot;very&quot;</span>);</span><br><span class="line">		skipList.put(<span class="number">8</span>, <span class="string">&quot;I&quot;</span>);</span><br><span class="line">		skipList.put(<span class="number">6</span>, <span class="string">&quot;,&quot;</span>);</span><br><span class="line">		skipList.put(<span class="number">9</span>, <span class="string">&quot;do&quot;</span>);</span><br><span class="line">		skipList.put(<span class="number">7</span>, <span class="string">&quot;yes&quot;</span>);</span><br><span class="line">		skipList.put(<span class="number">6</span>, <span class="string">&quot;!&quot;</span>);</span><br><span class="line">		System.out.println(skipList);</span><br><span class="line">		System.out.println(skipList.size());</span><br><span class="line">		skipList.printByLevel();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>可能的结果：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[<span class="number">1</span>,I]</span><br><span class="line">[<span class="number">2</span>,like]</span><br><span class="line">[<span class="number">3</span>,Jimo]</span><br><span class="line">[<span class="number">4</span>,very]</span><br><span class="line">[<span class="number">5</span>,much]</span><br><span class="line">[<span class="number">6</span>,!]</span><br><span class="line">[<span class="number">7</span>,yes]</span><br><span class="line">[<span class="number">8</span>,I]</span><br><span class="line">[<span class="number">9</span>,<span class="keyword">do</span>]</span><br><span class="line"></span><br><span class="line"><span class="number">9</span></span><br><span class="line">[-<span class="number">2147483648</span>,<span class="literal">null</span>] [<span class="number">9</span>,<span class="literal">null</span>] [<span class="number">2147483647</span>,<span class="literal">null</span>] </span><br><span class="line">[-<span class="number">2147483648</span>,<span class="literal">null</span>] [<span class="number">8</span>,<span class="literal">null</span>] [<span class="number">9</span>,<span class="literal">null</span>] [<span class="number">2147483647</span>,<span class="literal">null</span>] </span><br><span class="line">[-<span class="number">2147483648</span>,<span class="literal">null</span>] [<span class="number">2</span>,<span class="literal">null</span>] [<span class="number">4</span>,<span class="literal">null</span>] [<span class="number">6</span>,<span class="literal">null</span>] [<span class="number">8</span>,<span class="literal">null</span>] [<span class="number">9</span>,<span class="literal">null</span>] [<span class="number">2147483647</span>,<span class="literal">null</span>] </span><br><span class="line">[-<span class="number">2147483648</span>,<span class="literal">null</span>] [<span class="number">1</span>,I] [<span class="number">2</span>,like] [<span class="number">3</span>,Jimo] [<span class="number">4</span>,very] [<span class="number">5</span>,much] [<span class="number">6</span>,!] [<span class="number">7</span>,yes] [<span class="number">8</span>,I] [<span class="number">9</span>,<span class="keyword">do</span>] [<span class="number">2147483647</span>,<span class="literal">null</span>] </span><br></pre></td></tr></table></figure>

      
    </div> -->
          <div class="article-entry" itemprop="articleBody">
            
              
                
                      
                        
                          
                            
                              
                                
                                  
                                    <p>
                                      <p>本文学习跳跃表及其java代码实现。</p>

                                        <p>
                                          
                                            
                                              
                                                      
          </div>
    <p class="article-more-link">
      <a href="/2019/02/26/algorithm/002-skip-list/#more">
        Read More
      </a>
    </p>
    <!-- <div class="article-more-link">
      <a href="/2019/02/26/algorithm/002-skip-list/#more">
        read more
      </a>
    </div> -->
    


      <footer class="article-footer">
        <a data-url="http://jimolonely.github.io/2019/02/26/algorithm/002-skip-list/" data-id="cl1fw7fhe0006vkd31y631hi7" class="article-share-link">
          Share
        </a>
        
            
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/data-structure/" rel="tag">data structure</a><span class="article-tag-list-count">1</span></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/java/" rel="tag">java</a><span class="article-tag-list-count">104</span></li></ul>

      </footer>
      </div>
      
</article>


  
    <article id="post-java/027-cglib" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/02/25/java/027-cglib/" class="article-date">
  <time datetime="2019-02-25T02:29:03.000Z" itemprop="datePublished">2019-02-25</time>
</a>
      
  </div>
  <div class="article-inner">
    
      
        <header class="article-header">
          
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/02/25/java/027-cglib/">CGLib学习资源</a>
    </h1>
  

        </header>
        
          <!-- <div class="article-entry" itemprop="articleBody">
      
        <p>学到spring aop原理时，发现一个cglib不太了解，特此记录下。</p>
<h1 id="官方介绍"><a href="#官方介绍" class="headerlink" title="官方介绍"></a>官方介绍</h1><p>官方只有一个<a target="_blank" rel="noopener" href="https://github.com/cglib/cglib/wiki">github wiki页</a>,介绍很少，重要的就是cglib是干嘛的：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cglib是一个功能强大，性能高，质量高的代码生成库，用于扩展JAVA类并在运行时实现接口。</span><br><span class="line"></span><br><span class="line">该库是免费软件，可以出于个人或商业目的自由重复使用。</span><br></pre></td></tr></table></figure>

<p>有哪些项目用到了呢？ 看这里： <a target="_blank" rel="noopener" href="https://github.com/cglib/cglib/wiki#projects">projects</a></p>
<p>既然这样，首先知道它的使用方式把。</p>
<h1 id="使用cglib"><a href="#使用cglib" class="headerlink" title="使用cglib"></a>使用cglib</h1><p>怎么使用很简单，就不重复造轮子了，见 <a target="_blank" rel="noopener" href="https://blog.csdn.net/zghwaicsdn/article/details/50957474">blog</a>,<br><a target="_blank" rel="noopener" href="https://dzone.com/articles/cglib-missing-manual">老外的讲解-很详细</a></p>

      
    </div> -->
          <div class="article-entry" itemprop="articleBody">
            
              
                
                      
                        
                          
                            
                              
                                
                                  
                                    <p>
                                      <p>学到spring aop原理时，发现一个cglib不太了解，特此记录下。</p>

                                        <p>
                                          
                                            
                                              
                                                      
          </div>
    <p class="article-more-link">
      <a href="/2019/02/25/java/027-cglib/#more">
        Read More
      </a>
    </p>
    <!-- <div class="article-more-link">
      <a href="/2019/02/25/java/027-cglib/#more">
        read more
      </a>
    </div> -->
    


      <footer class="article-footer">
        <a data-url="http://jimolonely.github.io/2019/02/25/java/027-cglib/" data-id="cl1fw7fl500a5vkd3hzbb4r62" class="article-share-link">
          Share
        </a>
        
            
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/cglib/" rel="tag">cglib</a><span class="article-tag-list-count">1</span></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/java/" rel="tag">java</a><span class="article-tag-list-count">104</span></li></ul>

      </footer>
      </div>
      
</article>


  
    <article id="post-java/026-java-create-instance" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/02/22/java/026-java-create-instance/" class="article-date">
  <time datetime="2019-02-22T08:49:53.000Z" itemprop="datePublished">2019-02-22</time>
</a>
      
  </div>
  <div class="article-inner">
    
      
        <header class="article-header">
          
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/02/22/java/026-java-create-instance/">java创建对象的方式和差别</a>
    </h1>
  

        </header>
        
          <!-- <div class="article-entry" itemprop="articleBody">
      
        <p>本文已例子和原理解释4种java创建对象的方式和原理。</p>
<p>在此之前，我们以User类为例：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">User</span> <span class="keyword">implements</span> <span class="title class_">Serializable</span> &#123;</span><br><span class="line">	<span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="title function_">User</span><span class="params">()</span> &#123;</span><br><span class="line">		System.out.println(<span class="string">&quot;user default constructor...&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="title function_">User</span><span class="params">(String name)</span> &#123;</span><br><span class="line">		<span class="built_in">this</span>.name = name;</span><br><span class="line">		System.out.println(<span class="string">&quot;constructor with name...&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> String <span class="title function_">getName</span><span class="params">()</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> name;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">setName</span><span class="params">(String name)</span> &#123;</span><br><span class="line">		<span class="built_in">this</span>.name = name;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h1 id="1-new"><a href="#1-new" class="headerlink" title="1.new"></a>1.new</h1><p>这种方式没什么好说的，主要从JVM的角度来看类的加载机制。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 1. new</span></span><br><span class="line"><span class="type">User</span> <span class="variable">user1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>();</span><br></pre></td></tr></table></figure>

<h1 id="2-反射"><a href="#2-反射" class="headerlink" title="2.反射"></a>2.反射</h1><p>下面是2种方式，区别在于第一种（<code>Class.forName().newInstance()</code>）只能调用无参构造方法。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">		<span class="comment">// 2. reflect</span></span><br><span class="line">		Class&lt;?&gt; cls = Class.forName(<span class="string">&quot;com.jimo.ioc.User&quot;</span>);</span><br><span class="line">		<span class="type">User</span> <span class="variable">user2</span> <span class="operator">=</span> (User) cls.newInstance();</span><br><span class="line"><span class="comment">///		User user3 = User.class.newInstance();</span></span><br><span class="line"></span><br><span class="line">		Constructor&lt;?&gt; c1 = cls.getDeclaredConstructor(String.class);</span><br><span class="line">		c1.setAccessible(<span class="literal">true</span>);</span><br><span class="line">		<span class="type">User</span> <span class="variable">user4</span> <span class="operator">=</span> (User) c1.newInstance(<span class="string">&quot;jimo&quot;</span>);</span><br></pre></td></tr></table></figure>

<h1 id="3-clone"><a href="#3-clone" class="headerlink" title="3.clone()"></a>3.clone()</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="4-反序列化"><a href="#4-反序列化" class="headerlink" title="4.反序列化"></a>4.反序列化</h1><p>注意，我们采用的实现Serializable接口的方式：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 4. 序列化/反序列化</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// write</span></span><br><span class="line"><span class="type">ObjectOutputStream</span> <span class="variable">out</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectOutputStream</span>(<span class="keyword">new</span> <span class="title class_">FileOutputStream</span>(<span class="string">&quot;User.file&quot;</span>));</span><br><span class="line">out.writeObject(user4);</span><br><span class="line">out.close();</span><br><span class="line"></span><br><span class="line"><span class="comment">// read</span></span><br><span class="line"><span class="type">ObjectInputStream</span> <span class="variable">in</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectInputStream</span>(<span class="keyword">new</span> <span class="title class_">FileInputStream</span>(<span class="string">&quot;User.file&quot;</span>));</span><br><span class="line"><span class="type">User</span> <span class="variable">user5</span> <span class="operator">=</span> (User) in.readObject();</span><br><span class="line">System.out.println(user5.getName());</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><ol>
<li><a target="_blank" rel="noopener" href="http://www.importnew.com/17964.html">Java对象的序列化与反序列化</a></li>
<li><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/4cc036dbef8d">Java中创建对象的方式</a></li>
</ol>

      
    </div> -->
          <div class="article-entry" itemprop="articleBody">
            
              
                
                      
                        
                          
                            
                              
                                
                                  
                                    <p>
                                      <p>本文已例子和原理解释4种java创建对象的方式和原理。</p>

                                        <p>
                                          
                                            
                                              
                                                      
          </div>
    <p class="article-more-link">
      <a href="/2019/02/22/java/026-java-create-instance/#more">
        Read More
      </a>
    </p>
    <!-- <div class="article-more-link">
      <a href="/2019/02/22/java/026-java-create-instance/#more">
        read more
      </a>
    </div> -->
    


      <footer class="article-footer">
        <a data-url="http://jimolonely.github.io/2019/02/22/java/026-java-create-instance/" data-id="cl1fw7fl500a3vkd37myabgn0" class="article-share-link">
          Share
        </a>
        
            
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/java/" rel="tag">java</a><span class="article-tag-list-count">104</span></li></ul>

      </footer>
      </div>
      
</article>


  
    <article id="post-lang/013-redis-design-principle" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/02/21/lang/013-redis-design-principle/" class="article-date">
  <time datetime="2019-02-21T06:01:29.000Z" itemprop="datePublished">2019-02-21</time>
</a>
      
  </div>
  <div class="article-inner">
    
      
        <header class="article-header">
          
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/02/21/lang/013-redis-design-principle/">redis设计和原理</a>
    </h1>
  

        </header>
        
          <!-- <div class="article-entry" itemprop="articleBody">
      
        <p>本文是《redis设计与实现–黄健宏》一书的读后感和笔记。</p>
<h1 id="SDS（simple-dynamic-string）"><a href="#SDS（simple-dynamic-string）" class="headerlink" title="SDS（simple dynamic string）"></a>SDS（simple dynamic string）</h1><p>简单动态字符串： redis自定义的字符串结构：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">sdshdr</span> &#123;</span></span><br><span class="line">  <span class="comment">// 已经使用的长度</span></span><br><span class="line">  <span class="type">int</span> len;</span><br><span class="line">  <span class="comment">// 未使用的长度</span></span><br><span class="line">  <span class="type">int</span> <span class="built_in">free</span>;</span><br><span class="line">  <span class="type">char</span> buf[];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>为什么不使用C语言的字符串字面量的原因：</p>
<ol>
<li>获取字符串长度复杂度为O(1), 而不是O(N)</li>
<li>杜绝缓冲区溢出： 增加字符串内容而忘记分配合适的长度造成覆盖等</li>
<li>减少修改字符串的内存重分配： 主要采用了2种策略<ol>
<li>空间预分配： 低于1MB长度时，扩展会翻倍，超过1MB时每次多分配1MB</li>
<li>惰性空间释放： 缩短字符串时并不内存分配，只是修改free的长度</li>
</ol>
</li>
<li>二进制安全： 可以保存除文本外，图像、视频、音频等2进制信息，因为不以<code>\0</code>来判断结尾，而是len</li>
<li>兼容部分C语言库函数： sds依然保留<code>\0</code>结尾，所以可以重复使用部分字符串函数。</li>
</ol>
<h1 id="链表"><a href="#链表" class="headerlink" title="链表"></a>链表</h1><p>list的数据结构</p>
<p>单个节点: 是一个双向链表</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">listNode</span> &#123;</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">listNode</span> *<span class="title">prev</span>;</span></span><br><span class="line"></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">listNode</span> *<span class="title">next</span>;</span></span><br><span class="line"></span><br><span class="line">  <span class="type">void</span> *value;</span><br><span class="line">&#125; listNode;</span><br></pre></td></tr></table></figure>
<p>list结构：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">list</span> &#123;</span></span><br><span class="line">  listNode *head;</span><br><span class="line"></span><br><span class="line">  listNode *tail;</span><br><span class="line"></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">long</span> len;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 几个函数 </span></span><br><span class="line">  <span class="type">void</span> (*dup)(<span class="type">void</span> *ptr);</span><br><span class="line">  <span class="type">void</span> (*<span class="built_in">free</span>)(<span class="type">void</span> *ptr);</span><br><span class="line">  <span class="type">void</span> (*match)(<span class="type">void</span> *ptr,<span class="type">void</span> *key);</span><br><span class="line">&#125; <span class="built_in">list</span>;</span><br></pre></td></tr></table></figure>


<h1 id="dict"><a href="#dict" class="headerlink" title="dict"></a>dict</h1><p>保存键值对</p>
<h2 id="数据结构"><a href="#数据结构" class="headerlink" title="数据结构"></a>数据结构</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">dictht</span> &#123;</span></span><br><span class="line">  <span class="comment">// hash entry array</span></span><br><span class="line">  dictEntry **table;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// hash table size</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">long</span> size;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 用于计算索引值，总是等于size-1</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">long</span> sizemask;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// used size</span></span><br><span class="line">  <span class="type">unsigned</span> ling used;</span><br><span class="line">&#125; dictht;</span><br></pre></td></tr></table></figure>
<p>下面是dictEntry: 每个entry后面可以跟一串entry， 用于到hash出的索引冲突时。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">dictEntry</span> &#123;</span></span><br><span class="line">  <span class="type">void</span> *key;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// value</span></span><br><span class="line">  <span class="class"><span class="keyword">union</span> &#123;</span></span><br><span class="line">    <span class="type">void</span> *val;</span><br><span class="line">    <span class="type">uint64_t</span> u64;</span><br><span class="line">    <span class="type">int64_t</span> s64;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 链表</span></span><br><span class="line">  <span class="class"><span class="keyword">struct</span> <span class="title">dictEntry</span> *<span class="title">next</span>;</span></span><br><span class="line">&#125; dictEntry;</span><br></pre></td></tr></table></figure>
<p>下面才是字典的最后封装：</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">dict</span> &#123;</span></span><br><span class="line">  <span class="comment">// 类型特定函数</span></span><br><span class="line">  dictType *type;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 私有数据保存传给特定函数的可选参数</span></span><br><span class="line">  <span class="type">void</span> *privdata;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// hash table</span></span><br><span class="line">  dictht ht[<span class="number">2</span>];</span><br><span class="line"></span><br><span class="line">  <span class="comment">// rehash index: 当rehash没有进行时值为-1</span></span><br><span class="line">  <span class="type">int</span> rehashidx;</span><br><span class="line">&#125; dict;</span><br></pre></td></tr></table></figure>
<ol>
<li>hash table为什么需要2个？<br>  因为ht[1]是在rehash时使用的，后面会说</li>
<li>rehashidx的作用是啥？<br>  是一个计数器，标记rehash的进度和是否完成。</li>
<li>绘制出dict的数据结构图</li>
</ol>
<img src="/2019/02/21/lang/013-redis-design-principle/000.png" class="">

<h2 id="hash算法"><a href="#hash算法" class="headerlink" title="hash算法"></a>hash算法</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">hash = dict-&gt;type-&gt;hashFunction(key);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 看到这里的sizemask的作用了把</span></span><br><span class="line">index = hash &amp; dict-&gt;ht[x].sizemask;</span><br></pre></td></tr></table></figure>
<p>这个索引值就是dictEntry数组里的下标。</p>
<p>hash算法： MurmurHash</p>
<h2 id="冲突解决"><a href="#冲突解决" class="headerlink" title="冲突解决"></a>冲突解决</h2><p>采用链地址法： 采用前插法，在dictEntry形成链表。</p>
<h2 id="rehash"><a href="#rehash" class="headerlink" title="rehash"></a>rehash</h2><ol>
<li>为什么需要？<br>  因为一段时间后hash表会变得要么很大，要么很少，为了维持一个负载均衡因子，会有2种可能：扩展和收缩。</li>
<li>rehash的步骤？</li>
<li>分配空间给ht[1]<br>1. 扩展： newSize &gt;&#x3D; used*2<br>2. 收缩： newSize &gt;&#x3D; used</li>
<li>转移，这是一个渐近的过程，并不是一下就过去了，后面会说</li>
<li>释放ht[0], 交换ht[1]为ht[0]</li>
<li>什么时候hash表会扩展？</li>
<li>负载因子： load_factor &#x3D; ht[0].used &#x2F; ht[0].size</li>
<li>当没有BGSAVE或BGREWRITEAOF在执行且负载因子&gt;&#x3D;1, 不知什么时候会大于1？</li>
<li>当上述命令在执行，且负载因子&gt;&#x3D;5，执行时负载因子会变大，因为copy on write技术需要节约内存</li>
<li>什么时候收缩？<br>  当负载因子 &lt; 0.1</li>
</ol>
<h2 id="渐近式rehash"><a href="#渐近式rehash" class="headerlink" title="渐近式rehash"></a>渐近式rehash</h2><ol>
<li>why？<br>  因为当键值对很大时，一次性转移会暂停服务，需要慢慢来</li>
<li>步骤</li>
<li>这个过程会同时用到ht[0],ht[1]</li>
<li>初始rehashidx设为0</li>
<li>每移动一个key-value，rehashidx++</li>
<li>直到完成，rehashidx重置为-1</li>
<li>在rehash阶段，CRUD怎么办？<br>  修改会只在ht[1]上进行， 查询会从ht[0]到ht[1]</li>
</ol>
<h1 id="跳跃表"><a href="#跳跃表" class="headerlink" title="跳跃表"></a>跳跃表</h1><ol>
<li>什么是跳跃表？解释其原理。<br>  见： <a href="/2019/02/26/algorithm/002-skip-list/" title="skip list理解与java实现">skip list理解与java实现</a></li>
<li>在redis中哪里用到了跳跃表？<br>  2个地方：1.有序集合集（sorted set） 2.集群节点中用作内部数据结构</li>
</ol>
<h1 id="对象"><a href="#对象" class="headerlink" title="对象"></a>对象</h1><p>实际上，redis的键值都是对象。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">redisObject</span> &#123;</span></span><br><span class="line">  <span class="type">unsigned</span> type:<span class="number">4</span>;</span><br><span class="line">  <span class="type">unsigned</span> encoding:<span class="number">4</span>;</span><br><span class="line">  <span class="comment">// 指向底层数据结构的指针</span></span><br><span class="line">  <span class="type">void</span> *ptr;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="type"><a href="#type" class="headerlink" title="type"></a>type</h2><p>有： <code>string, list, hash, set, zset</code>, 通过下面的命令可以查看：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">redis&gt; </span><span class="language-bash">SET msg <span class="string">&quot;hello world&quot;</span></span></span><br><span class="line">OK</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">redis&gt; </span><span class="language-bash">TYPE msg</span></span><br><span class="line">string</span><br></pre></td></tr></table></figure>
<h2 id="encoding"><a href="#encoding" class="headerlink" title="encoding"></a>encoding</h2><p>表示使用哪种数据结构，有：<code>int,embstr,raw,hashtable,linkedlist,ziplist,intset,skiplist</code>,<br>可以使用<code>OBJECT ENCODING xxx</code>查看：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">redis&gt; </span><span class="language-bash">SET msg <span class="string">&quot;hello string&quot;</span></span></span><br><span class="line">OK</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">redis&gt; </span><span class="language-bash">OBJECT ENCODING msg</span></span><br><span class="line">&quot;embstr&quot;</span><br></pre></td></tr></table></figure>
<p>一个数据结构可以有多种编码：</p>
<ol>
<li>string: int&#x2F;raw&#x2F;embstr</li>
<li>list: ziplist&#x2F;linkedlist</li>
<li>hash: ziplist&#x2F;hashtable</li>
<li>set: intset&#x2F;hashtable</li>
<li>zset: ziplist&#x2F;skiplist</li>
</ol>
<p>问： </p>
<ol>
<li>在什么条件由一种结构换到另一种？</li>
<li>有什么是embstr呢？ 见下面。</li>
</ol>
<h2 id="string对象"><a href="#string对象" class="headerlink" title="string对象"></a>string对象</h2><p>字符串对象的编码可以是： int, raw, embstr</p>
<ol>
<li>long能存下的数字肯定是int编码</li>
<li>小于等于39字节的恩字符串是 embstr</li>
<li>大于39字节的是 raw，用sds存</li>
</ol>
<p>embstr与raw的区别？<br>embstr只分配一次内存就将redisObject和sds存好，也只需要释放一次，而raw是2次。</p>
<p>long double类型的浮点数也是存的字符串对象， 在需要运算时才转换。</p>
<h2 id="编码的转换"><a href="#编码的转换" class="headerlink" title="编码的转换"></a>编码的转换</h2><p>编码在一定条件是会转换的，比如：</p>
<ol>
<li>int会转为embstr或raw， 在整数中加入字符串时。</li>
<li>embstr没有修改函数，要修改时也会转成raw。</li>
</ol>

      
    </div> -->
          <div class="article-entry" itemprop="articleBody">
            
              
                
                      
                        
                          
                            
                              
                                
                                  
                                    <p>
                                      <p>本文是《redis设计与实现–黄健宏》一书的读后感和笔记。</p>

                                        <p>
                                          
                                            
                                              
                                                      
          </div>
    <p class="article-more-link">
      <a href="/2019/02/21/lang/013-redis-design-principle/#more">
        Read More
      </a>
    </p>
    <!-- <div class="article-more-link">
      <a href="/2019/02/21/lang/013-redis-design-principle/#more">
        read more
      </a>
    </div> -->
    


      <footer class="article-footer">
        <a data-url="http://jimolonely.github.io/2019/02/21/lang/013-redis-design-principle/" data-id="cl1fw7fm800ebvkd3eb1o4jak" class="article-share-link">
          Share
        </a>
        
            
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/redis/" rel="tag">redis</a><span class="article-tag-list-count">12</span></li></ul>

      </footer>
      </div>
      
</article>


  
    <article id="post-java/025-spring-source" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/02/21/java/025-spring-source/" class="article-date">
  <time datetime="2019-02-21T03:27:42.000Z" itemprop="datePublished">2019-02-21</time>
</a>
      
  </div>
  <div class="article-inner">
    
      
        <header class="article-header">
          
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/02/21/java/025-spring-source/">spring源码学习（一）</a>
    </h1>
  

        </header>
        
          <!-- <div class="article-entry" itemprop="articleBody">
      
        <p>终于到了这一步，曾经无数次想过，没想到来得如此平缓。只要还在学习，就还在路上，就永远不晚。</p>
<h1 id="IOC理解"><a href="#IOC理解" class="headerlink" title="IOC理解"></a>IOC理解</h1><h2 id="1-理解概念"><a href="#1-理解概念" class="headerlink" title="1.理解概念"></a>1.理解概念</h2><p><a target="_blank" rel="noopener" href="https://jinnianshilongnian.iteye.com/blog/1413846">Ioc和DI概念的理解</a>.</p>
<p>然后问自己那几个问题：</p>
<ol>
<li>Ioc是什么，控制了什么，谁控制谁，反转了什么，谁反转谁</li>
<li>DI是什么，谁依赖谁，依赖了什么，为什么依赖，谁注入了什么，给谁注入</li>
<li>Ioc和DI的关系</li>
</ol>
<h2 id="2-学习源码"><a href="#2-学习源码" class="headerlink" title="2.学习源码"></a>2.学习源码</h2><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/lisongjia123/article/details/52129340">Spring源码剖析——核心IOC容器原理</a></p>
<h2 id="3-自己实现"><a href="#3-自己实现" class="headerlink" title="3.自己实现"></a>3.自己实现</h2><p>可以参考博客：<a target="_blank" rel="noopener" href="https://segmentfault.com/a/1190000013130650">blog1</a>, <a target="_blank" rel="noopener" href="https://www.jianshu.com/p/72aeb5d94360">blog2</a></p>
<p>在此之前，需要熟悉java通过反射创建对象的方式： <a href="/2019/02/22/java/026-java-create-instance/" title="java创建对象的方式和差别">java创建对象的方式和差别</a></p>
<p>&#x2F;&#x2F; TODO</p>
<h1 id="springmvc"><a href="#springmvc" class="headerlink" title="springmvc"></a>springmvc</h1><p>从理解到实现。</p>
<p>传统的基于servlet的spring和spring5+里面的基于reactive stream的东西，都需要熟悉。</p>
<h2 id="1-流程理解"><a href="#1-流程理解" class="headerlink" title="1.流程理解"></a>1.流程理解</h2><p>盗一下下面博客的图：</p>
<img src="/2019/02/21/java/025-spring-source/000.png" class="">

<img src="/2019/02/21/java/025-spring-source/001.png" class="">


<h2 id="2-实现一个"><a href="#2-实现一个" class="headerlink" title="2.实现一个"></a>2.实现一个</h2><p><a target="_blank" rel="noopener" href="https://my.oschina.net/liughDevelop/blog/1622646">自己手写一个SpringMVC框架(简化)</a></p>
<h1 id="AOP"><a href="#AOP" class="headerlink" title="AOP"></a>AOP</h1><p>aop是什么： 可以看作对OOP的一种扩展，目标是在扩展或增加新功能时解藕和，提高代码的可用性和灵活性。</p>
<p>aop可以做什么： 日志、性能、安全、事务、异常等。</p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/liuning8023/p/4343957.html">Java 面向切面编程（Aspect Oriented Programming，AOP）—推荐，写的不错</a></p>
<h2 id="1-原理理解"><a href="#1-原理理解" class="headerlink" title="1.原理理解"></a>1.原理理解</h2><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/dreamrealised/article/details/12885739">AOP的底层实现-CGLIB动态代理和JDK动态代理</a></p>
<a href="/2019/02/25/java/027-cglib/" title="关于CGLib的原理">关于CGLib的原理</a>

<p>学习了原理之后问自己以下问题，直到能快速回答出来为止：</p>
<ol>
<li>AOP是一种模式，与OOP的区别是什么</li>
<li>AOP要解决什么问题，常见的有哪些</li>
<li>AOP中间有哪些概念，解释切面、切点、连接点、通知等概念以及他们的关系</li>
<li>spring的AOP是怎么实现的，2种实现的区别和优缺点？</li>
</ol>
<h2 id="2-spring-AOP如何使用"><a href="#2-spring-AOP如何使用" class="headerlink" title="2.spring AOP如何使用"></a>2.spring AOP如何使用</h2><p>关于使用，推荐几篇博客，写的很仔细：</p>
<ol>
<li><a target="_blank" rel="noopener" href="https://segmentfault.com/a/1190000007469982">Spring AOP 实战</a></li>
<li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/davidwang456/p/4013631.html">基于注解的Spring AOP的配置和使用–转载</a></li>
</ol>
<p>学习完使用后问自己以下问题：</p>
<ol>
<li>实现AOP涉及的注解： <code>@Aspect, @PointCut</code>如何使用？</li>
<li>切点的书写规则, 可以是某个包、类、方法、带有某个注解等</li>
<li>通知的5种类型的含义和执行顺序：<code>@Before, @Around, @After, @AfterReturning, @AfterThrowing</code></li>
</ol>
<h2 id="2-实现AOP"><a href="#2-实现AOP" class="headerlink" title="2.实现AOP"></a>2.实现AOP</h2><p><a target="_blank" rel="noopener" href="https://juejin.im/post/5c1c402b6fb9a049a570df27">Spring系列之AOP的原理及手动实现</a>, 这篇文章介绍了aop涉及的设计模式。</p>
<p><a target="_blank" rel="noopener" href="https://github.com/lliyu/myspring/tree/master/src/main/java/aop">他的源码实现</a></p>
<p>跟着做一遍。</p>
<h1 id="spring事务机制"><a href="#spring事务机制" class="headerlink" title="spring事务机制"></a>spring事务机制</h1><h2 id="如何使用"><a href="#如何使用" class="headerlink" title="如何使用"></a>如何使用</h2><p>参考文章：<a target="_blank" rel="noopener" href="https://www.ibm.com/developerworks/cn/java/j-master-spring-transactional-use/index.html">透彻的掌握 Spring 中@transactional 的使用</a></p>
<p>然后问自己：</p>
<ol>
<li><code>@Transactional</code> 注解有哪些属性，分别代表什么意思？</li>
<li><code>propagation</code>属性的3个级别什么意思？</li>
<li><code>rollbackFor</code>在什么情况下不会回滚？</li>
<li>只有public方法才有效吗？</li>
<li>spring AOP的自调用问题： 非事务方法调用事务方法不会回滚</li>
</ol>
<h2 id="再深入一点"><a href="#再深入一点" class="headerlink" title="再深入一点"></a>再深入一点</h2><p>参考文章： <a target="_blank" rel="noopener" href="https://juejin.im/post/5b00c52ef265da0b95276091">可能是最漂亮的Spring事务管理详解</a></p>

      
    </div> -->
          <div class="article-entry" itemprop="articleBody">
            
              
                
                      
                        
                          
                            
                              
                                
                                  
                                    <p>
                                      <p>终于到了这一步，曾经无数次想过，没想到来得如此平缓。只要还在学习，就还在路上，就永远不晚。</p>

                                        <p>
                                          
                                            
                                              
                                                      
          </div>
    <p class="article-more-link">
      <a href="/2019/02/21/java/025-spring-source/#more">
        Read More
      </a>
    </p>
    <!-- <div class="article-more-link">
      <a href="/2019/02/21/java/025-spring-source/#more">
        read more
      </a>
    </div> -->
    


      <footer class="article-footer">
        <a data-url="http://jimolonely.github.io/2019/02/21/java/025-spring-source/" data-id="cl1fw7fl400a0vkd3e6we566d" class="article-share-link">
          Share
        </a>
        
            
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/java/" rel="tag">java</a><span class="article-tag-list-count">104</span></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/spring/" rel="tag">spring</a><span class="article-tag-list-count">12</span></li></ul>

      </footer>
      </div>
      
</article>


  
    <article id="post-maven/002-maven-install-linux" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/02/20/maven/002-maven-install-linux/" class="article-date">
  <time datetime="2019-02-20T06:12:12.000Z" itemprop="datePublished">2019-02-20</time>
</a>
      
  </div>
  <div class="article-inner">
    
      
        <header class="article-header">
          
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/02/20/maven/002-maven-install-linux/">linux下maven的安装/替换</a>
    </h1>
  

        </header>
        
          <!-- <div class="article-entry" itemprop="articleBody">
      
        <p>如果经常遇到，那么就该记住了，如果不想记，那么就记一个地方，让你随时可以找到。</p>
<p>本文来自： <a target="_blank" rel="noopener" href="https://linuxize.com/post/how-to-install-apache-maven-on-centos-7/">https://linuxize.com/post/how-to-install-apache-maven-on-centos-7/</a></p>

      
    </div> -->
          <div class="article-entry" itemprop="articleBody">
            
              
                
                      
                        
                          
                            
                              
                                
                                  
                                    <p>
                                      <p>如果经常遇到，那么就该记住了，如果不想记，那么就记一个地方，让你随时可以找到。</p>

                                        <p>
                                          
                                            
                                              
                                                      
          </div>
    <p class="article-more-link">
      <a href="/2019/02/20/maven/002-maven-install-linux/#more">
        Read More
      </a>
    </p>
    <!-- <div class="article-more-link">
      <a href="/2019/02/20/maven/002-maven-install-linux/#more">
        read more
      </a>
    </div> -->
    


      <footer class="article-footer">
        <a data-url="http://jimolonely.github.io/2019/02/20/maven/002-maven-install-linux/" data-id="cl1fw7fmz00h2vkd313d2badb" class="article-share-link">
          Share
        </a>
        
            
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/java/" rel="tag">java</a><span class="article-tag-list-count">104</span></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/linux/" rel="tag">linux</a><span class="article-tag-list-count">57</span></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/maven/" rel="tag">maven</a><span class="article-tag-list-count">11</span></li></ul>

      </footer>
      </div>
      
</article>


  
    <article id="post-basic/014-code-optimization-way" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/02/19/basic/014-code-optimization-way/" class="article-date">
  <time datetime="2019-02-19T05:49:28.000Z" itemprop="datePublished">2019-02-19</time>
</a>
      
  </div>
  <div class="article-inner">
    
      
        <header class="article-header">
          
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/02/19/basic/014-code-optimization-way/">那些神一样的程序优化方法</a>
    </h1>
  

        </header>
        
          <!-- <div class="article-entry" itemprop="articleBody">
      
        <p>对于一个确定的程序（除了难以解释的AI深度学习算法）而言，很可能存在一个更优的方法来实现，所以出现了算法。但本文不想谈算法，而是介于算法和暴力之间的优化讨论，那些和底层或原理相关的方法。</p>
<h1 id="尾调用-x2F-尾递归"><a href="#尾调用-x2F-尾递归" class="headerlink" title="尾调用&#x2F;尾递归"></a>尾调用&#x2F;尾递归</h1>
      
    </div> -->
          <div class="article-entry" itemprop="articleBody">
            
              
                
                      
                        
                          
                            
                              
                                
                                  
                                    <p>
                                      <p>对于一个确定的程序（除了难以解释的AI深度学习算法）而言，很可能存在一个更优的方法来实现，所以出现了算法。但本文不想谈算法，而是介于算法和暴力之间的优化讨论，那些和底层或原理相关的方法。</p>

                                        <p>
                                          
                                            
                                              
                                                      
          </div>
    <p class="article-more-link">
      <a href="/2019/02/19/basic/014-code-optimization-way/#more">
        Read More
      </a>
    </p>
    <!-- <div class="article-more-link">
      <a href="/2019/02/19/basic/014-code-optimization-way/#more">
        read more
      </a>
    </div> -->
    


      <footer class="article-footer">
        <a data-url="http://jimolonely.github.io/2019/02/19/basic/014-code-optimization-way/" data-id="cl1fw7fhz0015vkd35h2f81k7" class="article-share-link">
          Share
        </a>
        
            
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/optimization/" rel="tag">optimization</a><span class="article-tag-list-count">1</span></li></ul>

      </footer>
      </div>
      
</article>


  
    <article id="post-db/006-mysql-error-1133" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/02/19/db/006-mysql-error-1133/" class="article-date">
  <time datetime="2019-02-19T02:01:16.000Z" itemprop="datePublished">2019-02-19</time>
</a>
      
  </div>
  <div class="article-inner">
    
      
        <header class="article-header">
          
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/02/19/db/006-mysql-error-1133/">mysql ERROR 1133(42000)</a>
    </h1>
  

        </header>
        
          <!-- <div class="article-entry" itemprop="articleBody">
      
        <p>原因是存在一个用户名为空的用户，导致不能使用root用户登陆。</p>
<p>这里的安装方法采用：<a target="_blank" rel="noopener" href="https://www.linode.com/docs/databases/mysql/how-to-install-mysql-on-centos-7/">https://www.linode.com/docs/databases/mysql/how-to-install-mysql-on-centos-7/</a></p>
<p>官方文档： <a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/mysql-yum-repo-quick-guide/en/#repo-qg-yum-fresh-install">https://dev.mysql.com/doc/mysql-yum-repo-quick-guide/en/#repo-qg-yum-fresh-install</a></p>
<p>错误解决博客<a target="_blank" rel="noopener" href="https://www.cnblogs.com/Anker/p/3551610.html">https://www.cnblogs.com/Anker/p/3551610.html</a></p>
<p>copy一份：</p>
<h1 id="方法一"><a href="#方法一" class="headerlink" title="方法一"></a>方法一</h1><p>1.关闭mysql</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">systemctl stop mysqld</span></span><br></pre></td></tr></table></figure>
<p>2.屏蔽权限</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">mysqld_safe --skip-grant-table</span></span><br><span class="line">屏幕出现： Starting demo from .....</span><br></pre></td></tr></table></figure>
<p>3.新开起一个终端输入</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">mysql -u root mysql</span></span><br><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">UPDATE user SET Password=PASSWORD(<span class="string">&#x27;newpassword&#x27;</span>) <span class="built_in">where</span> USER=<span class="string">&#x27;root&#x27;</span>;</span></span><br><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">FLUSH PRIVILEGES;//记得要这句话，否则如果关闭先前的终端，又会出现原来的错误</span></span><br><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">\q</span></span><br></pre></td></tr></table></figure>

<h1 id="方法二"><a href="#方法二" class="headerlink" title="方法二"></a>方法二</h1><p>1.关闭mysql</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">systemctl stop mysqld</span></span><br></pre></td></tr></table></figure>
<p>2.屏蔽权限</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">mysqld_safe --skip-grant-table</span></span><br><span class="line">屏幕出现： Starting demo from .....</span><br></pre></td></tr></table></figure>
<p>3.新开起一个终端输入</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">mysql -u root mysql</span></span><br><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">delete from user <span class="built_in">where</span> USER=<span class="string">&#x27;&#x27;</span>;</span></span><br><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">FLUSH PRIVILEGES;//记得要这句话，否则如果关闭先前的终端，又会出现原来的错误</span></span><br><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">\q</span></span><br></pre></td></tr></table></figure>

      
    </div> -->
          <div class="article-entry" itemprop="articleBody">
            
              
                
                      
                        
                          
                            
                              
                                
                                  
                                    <p>
                                      <p>原因是存在一个用户名为空的用户，导致不能使用root用户登陆。</p>

                                        <p>
                                          
                                            
                                              
                                                      
          </div>
    <p class="article-more-link">
      <a href="/2019/02/19/db/006-mysql-error-1133/#more">
        Read More
      </a>
    </p>
    <!-- <div class="article-more-link">
      <a href="/2019/02/19/db/006-mysql-error-1133/#more">
        read more
      </a>
    </div> -->
    


      <footer class="article-footer">
        <a data-url="http://jimolonely.github.io/2019/02/19/db/006-mysql-error-1133/" data-id="cl1fw7fj2003qvkd348rt1ess" class="article-share-link">
          Share
        </a>
        
            
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/mysql/" rel="tag">mysql</a><span class="article-tag-list-count">5</span></li></ul>

      </footer>
      </div>
      
</article>


  
    <article id="post-linux/019-keepalived-learn" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/02/15/linux/019-keepalived-learn/" class="article-date">
  <time datetime="2019-02-15T04:32:02.000Z" itemprop="datePublished">2019-02-15</time>
</a>
      
  </div>
  <div class="article-inner">
    
      
        <header class="article-header">
          
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/02/15/linux/019-keepalived-learn/">keepalived踩坑记录</a>
    </h1>
  

        </header>
        
          <!-- <div class="article-entry" itemprop="articleBody">
      
        <p>本文记录了使用keepalived的常用场景和踩坑经历。</p>
<p>首先贴上官网： <a target="_blank" rel="noopener" href="http://www.keepalived.org/manpage.html">http://www.keepalived.org/manpage.html</a></p>
<p>对于每个配置的含义，还是以这里为准较好。</p>
<h1 id="关于环境和安装"><a href="#关于环境和安装" class="headerlink" title="关于环境和安装"></a>关于环境和安装</h1><p>这里就不说了，太多博客了。</p>
<h1 id="keealived可以做什么"><a href="#keealived可以做什么" class="headerlink" title="keealived可以做什么"></a>keealived可以做什么</h1><p>这个是首先要问的问题。</p>
<p>Keepalived是一个用C编写的路由软件。</p>
<p>主要目标是为Linux系统和基于Linux的基础架构提供简单而强大的负载平衡和高可用性设施。</p>
<p>简单来说就是： 负载均衡和高可用。一般和nginx结合使用。</p>
<h1 id="如何做到的"><a href="#如何做到的" class="headerlink" title="如何做到的"></a>如何做到的</h1><ol>
<li>负载平衡： 依赖于众所周知且广泛使用的Linux虚拟服务器（IPVS）内核模块，提供Layer4层负载均衡。 Keepalived实现了一组检查器，以根据其健康状况动态地和自适应地维护和管理负载平衡的服务器池。</li>
<li>VRRP协议实现了高可用性。 VRRP是路由器故障转移的基础。此外，Keepalived为VRRP有限状态机实现了一组挂钩，提供低级和高速协议交互。为了提供最快的网络故障检测，Keepalived实现了BFD协议。 VRRP状态转换可以考虑BFD提示来驱动快速状态转换。 </li>
<li>Keepalived框架可以单独使用，也可以一起使用，以提供灵活的基础架构。</li>
</ol>
<p>有一些关键词需要了解：</p>
<ol>
<li>LVS: <a target="_blank" rel="noopener" href="http://www.linuxvirtualserver.org/">http://www.linuxvirtualserver.org/</a></li>
<li>VRRP: <a target="_blank" rel="noopener" href="https://tools.ietf.org/html/rfc5798">https://tools.ietf.org/html/rfc5798</a></li>
<li>BFD: <a target="_blank" rel="noopener" href="https://tools.ietf.org/html/rfc5881">https://tools.ietf.org/html/rfc5881</a>, <a target="_blank" rel="noopener" href="http://www.h3c.com/cn/d_200804/603261_30003_0.htm">http://www.h3c.com/cn/d_200804&#x2F;603261_30003_0.htm</a></li>
</ol>
<h1 id="场景分析"><a href="#场景分析" class="headerlink" title="场景分析"></a>场景分析</h1><ol>
<li>keepalived+nginx： nginx做负载均衡，keepalived做高可用</li>
<li>keepalived+redis： 配置redis的主从备份</li>
<li>keepalived+mysql： 配置数据库的主从备份</li>
</ol>
<h1 id="关键问题"><a href="#关键问题" class="headerlink" title="关键问题"></a>关键问题</h1><p>很常见的应用就是主从备份，那关键就是主从何时切换？</p>
<ol>
<li>主keepalived挂了，肯定需要切换</li>
<li>主keepalived监控的应用挂了， 需要切换</li>
</ol>
<p>第一种好说，第二种需要注意： 看下面的配置：</p>
<p>MASTER：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">vrrp_script chk_app &#123;</span><br><span class="line">    script &quot;/etc/keepalived/scripts/monitor_app.sh&quot;</span><br><span class="line">    interval 2</span><br><span class="line">    weight   -20</span><br><span class="line">    fall   3</span><br><span class="line">    rise   1</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">vrrp_instance VI_112 &#123;</span><br><span class="line">    interface ens4f0</span><br><span class="line">    lvs_sync_daemon ens4f0</span><br><span class="line">    state MASTER </span><br><span class="line">    virtual_router_id 177 </span><br><span class="line"></span><br><span class="line">    priority 100</span><br><span class="line">    advert_int 1</span><br><span class="line">    garp_master_delay 1</span><br><span class="line"></span><br><span class="line">    track_interface &#123;</span><br><span class="line">       ens4f0 </span><br><span class="line">    &#125;</span><br><span class="line">    virtual_ipaddress &#123;</span><br><span class="line">        192.168.17.176/32 dev ens4f0 </span><br><span class="line">    &#125;</span><br><span class="line">    track_script &#123;</span><br><span class="line">       chk_nginx</span><br><span class="line">       chk_app</span><br><span class="line">    &#125;</span><br><span class="line">    authentication &#123;</span><br><span class="line">        auth_type PASS</span><br><span class="line">        auth_pass secret</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>BACKUP：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">vrrp_script chk_app &#123;</span><br><span class="line">    script &quot;/etc/keepalived/scripts/monitor_app.sh&quot;</span><br><span class="line">    interval 2</span><br><span class="line">    weight   -20</span><br><span class="line">    fall   3</span><br><span class="line">    rise   1</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">vrrp_instance VI_112 &#123;</span><br><span class="line">    interface ens4f0</span><br><span class="line">    lvs_sync_daemon ens4f0</span><br><span class="line">    state BACKUP </span><br><span class="line">    virtual_router_id 177 </span><br><span class="line"></span><br><span class="line">    priority 90</span><br><span class="line">    advert_int 1</span><br><span class="line">    garp_master_delay 1</span><br><span class="line"></span><br><span class="line">    track_interface &#123;</span><br><span class="line">       ens4f0 </span><br><span class="line">    &#125;</span><br><span class="line">    virtual_ipaddress &#123;</span><br><span class="line">        192.168.17.176/32 dev ens4f0 </span><br><span class="line">    &#125;</span><br><span class="line">    track_script &#123;</span><br><span class="line">       chk_nginx</span><br><span class="line">       chk_app</span><br><span class="line">    &#125;</span><br><span class="line">    authentication &#123;</span><br><span class="line">        auth_type PASS</span><br><span class="line">        auth_pass secret</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>vrrp_script里的weight很关键，master检测到应用挂了，权重会减少20，这样master的权重就比backup的低了，这样就会切换到backup。</p>
<p>如果把weight设为5，这样永远都切不过去，所以是没用的。</p>
<h2 id="keepalived-LVS"><a href="#keepalived-LVS" class="headerlink" title="keepalived-LVS"></a>keepalived-LVS</h2><p><a target="_blank" rel="noopener" href="http://www.keepalived.org/LVS-NAT-Keepalived-HOWTO.html">http://www.keepalived.org/LVS-NAT-Keepalived-HOWTO.html</a></p>
<h1 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h1><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/pangguoping/p/5721517.html">keepalived vip漂移基本原理及选举算法</a></p>
<p><a target="_blank" rel="noopener" href="http://blog.51cto.com/xiexiaojun/1718990">vrrp协议与keepalived详解</a></p>

      
    </div> -->
          <div class="article-entry" itemprop="articleBody">
            
              
                
                      
                        
                          
                            
                              
                                
                                  
                                    <p>
                                      <p>本文记录了使用keepalived的常用场景和踩坑经历。</p>

                                        <p>
                                          
                                            
                                              
                                                      
          </div>
    <p class="article-more-link">
      <a href="/2019/02/15/linux/019-keepalived-learn/#more">
        Read More
      </a>
    </p>
    <!-- <div class="article-more-link">
      <a href="/2019/02/15/linux/019-keepalived-learn/#more">
        read more
      </a>
    </div> -->
    


      <footer class="article-footer">
        <a data-url="http://jimolonely.github.io/2019/02/15/linux/019-keepalived-learn/" data-id="cl1fw7fmn00fpvkd3f62lddns" class="article-share-link">
          Share
        </a>
        
            
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/keepalived/" rel="tag">keepalived</a><span class="article-tag-list-count">2</span></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/linux/" rel="tag">linux</a><span class="article-tag-list-count">57</span></li></ul>

      </footer>
      </div>
      
</article>


  
    <article id="post-scala/004-scala-style" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/02/04/scala/004-scala-style/" class="article-date">
  <time datetime="2019-02-04T00:53:27.000Z" itemprop="datePublished">2019-02-04</time>
</a>
      
  </div>
  <div class="article-inner">
    
      
        <header class="article-header">
          
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/02/04/scala/004-scala-style/">scala编码规范风格</a>
    </h1>
  

        </header>
        
          <!-- <div class="article-entry" itemprop="articleBody">
      
        <p>本文翻译自: <a target="_blank" rel="noopener" href="https://docs.scala-lang.org/style/">https://docs.scala-lang.org/style/</a></p>
<h1 id="1-缩进"><a href="#1-缩进" class="headerlink" title="1.缩进"></a>1.缩进</h1><p>采用2个空格，而不是tab</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// wrong!</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Foo</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">fourspaces</span> </span>= &#123;</span><br><span class="line">        <span class="keyword">val</span> x = <span class="number">4</span></span><br><span class="line">        ..</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// right!</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Foo</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">twospaces</span> </span>= &#123;</span><br><span class="line">    <span class="keyword">val</span> x = <span class="number">2</span></span><br><span class="line">    ..</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="换行"><a href="#换行" class="headerlink" title="换行"></a>换行</h2><p>换行一般是80个字符。</p>
<p>每个连续的行应该从第一行缩进两个空格。 还要记住，Scala要求每个“换行”要么具有未闭合的括号，要么以中缀方法结束，其中没有给出正确的参数：</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> result = <span class="number">1</span> + <span class="number">2</span> + <span class="number">3</span> + <span class="number">4</span> + <span class="number">5</span> + <span class="number">6</span> +</span><br><span class="line">  <span class="number">7</span> + <span class="number">8</span> + <span class="number">9</span> + <span class="number">10</span> + <span class="number">11</span> + <span class="number">12</span> + <span class="number">13</span> + <span class="number">14</span> +</span><br><span class="line">  <span class="number">15</span> + <span class="number">16</span> + <span class="number">17</span> + <span class="number">18</span> + <span class="number">19</span> + <span class="number">20</span></span><br></pre></td></tr></table></figure>
<p>如果没有这种尾随方式，Scala会在一行的末尾推断出一个分号，它有时会包装，有时甚至不会发出警告而抛弃编译。</p>
<h2 id="有许多参数的方法"><a href="#有许多参数的方法" class="headerlink" title="有许多参数的方法"></a>有许多参数的方法</h2><p>当调用一个有大量参数（5个或更多）的方法时，通常需要将方法调用包装到多行上。 在这种情况下，将每个参数单独放在一行上，从当前缩进级别缩进两个空格：</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">foo(</span><br><span class="line">  someVeryLongFieldName,</span><br><span class="line">  andAnotherVeryLongFieldName,</span><br><span class="line">  <span class="string">&quot;this is a string&quot;</span>,</span><br><span class="line">  <span class="number">3.1415</span>)</span><br></pre></td></tr></table></figure>
<p>当太长时，将方法名也换到下一行：</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// right!</span></span><br><span class="line"><span class="keyword">val</span> myLongFieldNameWithNoRealPoint =</span><br><span class="line">  foo(</span><br><span class="line">    someVeryLongFieldName,</span><br><span class="line">    andAnotherVeryLongFieldName,</span><br><span class="line">    <span class="string">&quot;this is a string&quot;</span>,</span><br><span class="line">    <span class="number">3.1415</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// wrong!</span></span><br><span class="line"><span class="keyword">val</span> myLongFieldNameWithNoRealPoint = foo(someVeryLongFieldName,</span><br><span class="line">                                         andAnotherVeryLongFieldName,</span><br><span class="line">                                         <span class="string">&quot;this is a string&quot;</span>,</span><br><span class="line">                                         <span class="number">3.1415</span>)</span><br></pre></td></tr></table></figure>
<h1 id="命名约定"><a href="#命名约定" class="headerlink" title="命名约定"></a>命名约定</h1><p>一般来说，Scala使用驼峰命名法。</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">UpperCamelCase</span></span><br><span class="line">lowerCamelCase</span><br></pre></td></tr></table></figure>
<p>首字母缩略词应视为普通词：</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">使用：</span><br><span class="line"><span class="type">Xhtml</span></span><br><span class="line">maxId</span><br><span class="line"></span><br><span class="line">而不是：</span><br><span class="line"><span class="type">XHTML</span></span><br><span class="line">maxID</span><br></pre></td></tr></table></figure>
<p>编译器实际上不禁止名称（_）中的下划线，但强烈建议不要这样，因为它们在Scala语法中具有特殊含义。</p>
<h2 id="Classes-x2F-Traits"><a href="#Classes-x2F-Traits" class="headerlink" title="Classes&#x2F;Traits"></a>Classes&#x2F;Traits</h2><p>使用驼峰：</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyFairLady</span></span></span><br></pre></td></tr></table></figure>
<h2 id="Objects"><a href="#Objects" class="headerlink" title="Objects"></a>Objects</h2><p>对象名称类似于类名（上层驼峰案例）。</p>
<p>模仿包或函数时例外。 这并不常见。 例：</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">ast</span> </span>&#123;</span><br><span class="line">  <span class="keyword">sealed</span> <span class="class"><span class="keyword">trait</span> <span class="title">Expr</span></span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">case</span> <span class="class"><span class="keyword">class</span> <span class="title">Plus</span>(<span class="params">e1: <span class="type">Expr</span>, e2: <span class="type">Expr</span></span>) <span class="keyword">extends</span> <span class="title">Expr</span></span></span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">inc</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">apply</span></span>(x: <span class="type">Int</span>): <span class="type">Int</span> = x + <span class="number">1</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Package"><a href="#Package" class="headerlink" title="Package"></a>Package</h2><p>Scala包应遵循Java包命名约定：</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// wrong!</span></span><br><span class="line"><span class="keyword">package</span> coolness</span><br><span class="line"></span><br><span class="line"><span class="comment">// right! puts only coolness._ in scope</span></span><br><span class="line"><span class="keyword">package</span> com.novell.coolness</span><br><span class="line"></span><br><span class="line"><span class="comment">// right! puts both novell._ and coolness._ in scope</span></span><br><span class="line"><span class="keyword">package</span> com.novell</span><br><span class="line"><span class="keyword">package</span> coolness</span><br><span class="line"></span><br><span class="line"><span class="comment">// right, for package object com.novell.coolness</span></span><br><span class="line"><span class="keyword">package</span> com.novell</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * Provides classes related to coolness</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">package</span> <span class="class"><span class="keyword">object</span> <span class="title">coolness</span> </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>root</p>
<p>有时需要使用_root_完全限定导入。例如，如果另一个<code>net</code>包在范围内，那么要访问<code>net.liftweb</code>我们必须这样写：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> _root_.net.liftweb._</span><br></pre></td></tr></table></figure>
<p>不要过度使用_root_。通常，嵌套包解析是一件好事，对减少导入混乱很有帮助。使用_root_不仅会否定它们的好处，而且还会引入额外的混乱。</p>
<h2 id="方法"><a href="#方法" class="headerlink" title="方法"></a>方法</h2><p>方法的名称应该使用小写开头的驼峰：</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">myFairMethod</span> </span>= ...</span><br></pre></td></tr></table></figure>
<h3 id="get-x2F-set方法"><a href="#get-x2F-set方法" class="headerlink" title="get&#x2F;set方法"></a>get&#x2F;set方法</h3><p>scala没有和java一样的get&#x2F;set方法，但有下面的方式：</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Foo</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">bar</span> </span>= ...</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">bar_=</span></span>(bar: <span class="type">Bar</span>) &#123;</span><br><span class="line">    ...</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">isBaz</span> </span>= ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">val</span> foo = <span class="keyword">new</span> <span class="type">Foo</span></span><br><span class="line">foo.bar             <span class="comment">// accessor</span></span><br><span class="line">foo.bar = bar2      <span class="comment">// mutator</span></span><br><span class="line">foo.isBaz           <span class="comment">// boolean property</span></span><br></pre></td></tr></table></figure>
<p>私有变量：</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Company</span> </span>&#123;</span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">var</span> _name: <span class="type">String</span> = _</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">name</span> </span>= _name</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">name_=</span></span>(name: <span class="type">String</span>) &#123;</span><br><span class="line">    _name = name</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="括号"><a href="#括号" class="headerlink" title="括号"></a>括号</h3><p>方法声明可以有、也可以没有括号：</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">foo1</span></span>() = ...</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">foo2</span> </span>= ...</span><br></pre></td></tr></table></figure>
<p>但是，建议调用时和声明时一样。</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// doesn&#x27;t change state, call as birthdate</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">birthdate</span> </span>= firstName</span><br><span class="line"></span><br><span class="line"><span class="comment">// updates our internal state, call as age()</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">age</span></span>() = &#123;</span><br><span class="line">  _age = updateAge(birthdate)</span><br><span class="line">  _age</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="符号方法名"><a href="#符号方法名" class="headerlink" title="符号方法名"></a>符号方法名</h3><p>尽量避免，虽然可以用。例如：<code>a+b(), c::d, &gt;&gt;=</code>.</p>
<h3 id="常量、值、变量、方法"><a href="#常量、值、变量、方法" class="headerlink" title="常量、值、变量、方法"></a>常量、值、变量、方法</h3><p>类似java的<code>static final</code>, scala里常量的声明采用大写首字母的驼峰命名：</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">object</span> <span class="title">Container</span> </span>&#123;</span><br><span class="line">  <span class="keyword">val</span> <span class="type">MyConstant</span> = ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>而其他命名如下：</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> myValue = ...</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">myMethod</span> </span>= ...</span><br><span class="line"><span class="keyword">var</span> myVariable</span><br></pre></td></tr></table></figure>
<h2 id="泛型"><a href="#泛型" class="headerlink" title="泛型"></a>泛型</h2><p>不像Java的泛型用T，scala使用从A开始的字母：</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">List</span>[<span class="type">A</span>] </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">map</span></span>[<span class="type">B</span>](f: <span class="type">A</span> =&gt; <span class="type">B</span>): <span class="type">List</span>[<span class="type">B</span>] = ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>或者：</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Right</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Map</span>[<span class="type">Key</span>, <span class="type">Value</span>] </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">get</span></span>(key: <span class="type">Key</span>): <span class="type">Value</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">put</span></span>(key: <span class="type">Key</span>, value: <span class="type">Value</span>): <span class="type">Unit</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Wrong; don&#x27;t use all-caps</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Map</span>[<span class="type">KEY</span>, <span class="type">VALUE</span>] </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">get</span></span>(key: <span class="type">KEY</span>): <span class="type">VALUE</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">put</span></span>(key: <span class="type">KEY</span>, value: <span class="type">VALUE</span>): <span class="type">Unit</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Map</span>[<span class="type">K</span>, <span class="type">V</span>] </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">get</span></span>(key: <span class="type">K</span>): <span class="type">V</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">put</span></span>(key: <span class="type">K</span>, value: <span class="type">V</span>): <span class="type">Unit</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="高级参数类型"><a href="#高级参数类型" class="headerlink" title="高级参数类型"></a>高级参数类型</h3><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HigherOrderMap</span>[<span class="type">Key</span>[_], <span class="title">Value</span>[_]] </span>&#123; ... &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">doSomething</span></span>[<span class="type">M</span>[_]: <span class="type">Monad</span>](m: <span class="type">M</span>[<span class="type">Int</span>]) = ...</span><br></pre></td></tr></table></figure>

<h2 id="注解"><a href="#注解" class="headerlink" title="注解"></a>注解</h2><p>应该是小写：</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">cloneable</span> <span class="keyword">extends</span> <span class="title">StaticAnnotation</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">type</span> <span class="title">id</span> </span>= javax.persistence.<span class="type">Id</span> <span class="meta">@annotation</span>.target.field</span><br><span class="line"><span class="meta">@id</span></span><br><span class="line"><span class="keyword">var</span> id: <span class="type">Int</span> = <span class="number">0</span></span><br></pre></td></tr></table></figure>
<h2 id="简短的特殊性"><a href="#简短的特殊性" class="headerlink" title="简短的特殊性"></a>简短的特殊性</h2><p>在java里可能不是个好习惯，但scala里推荐：</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span></span>(a: <span class="type">Int</span>, b: <span class="type">Int</span>) = a + b</span><br></pre></td></tr></table></figure>

<h1 id="类型"><a href="#类型" class="headerlink" title="类型"></a>类型</h1><h2 id="引用类型"><a href="#引用类型" class="headerlink" title="引用类型"></a>引用类型</h2><p>&#x2F;&#x2F; TODO</p>
<h2 id="注解-1"><a href="#注解-1" class="headerlink" title="注解"></a>注解</h2><figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">value: <span class="type">Type</span></span><br></pre></td></tr></table></figure>
<p>冒号写在value后面而不是Type前面是有原因的，如下：</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">value :::</span><br></pre></td></tr></table></figure>
<p>可能会有Type是<code>::</code>的。</p>
<h2 id="Ascription"><a href="#Ascription" class="headerlink" title="Ascription"></a>Ascription</h2><p>&#x2F;&#x2F; TODO</p>
<h2 id="函数类型"><a href="#函数类型" class="headerlink" title="函数类型"></a>函数类型</h2><p>函数作为参数时，能省括号就省，一元参数时不加括号：</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">foo</span></span>(f: <span class="type">Int</span> =&gt; <span class="type">String</span>) = ...</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">bar</span></span>(f: (<span class="type">Boolean</span>, <span class="type">Double</span>) =&gt; <span class="type">List</span>[<span class="type">String</span>]) = ...</span><br></pre></td></tr></table></figure>
<p>极端例子：</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// wrong!</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">foo</span></span>(f: (<span class="type">Int</span>) =&gt; (<span class="type">String</span>) =&gt; (<span class="type">Boolean</span>) =&gt; <span class="type">Double</span>) = ...</span><br><span class="line"></span><br><span class="line"><span class="comment">// right!</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">foo</span></span>(f: <span class="type">Int</span> =&gt; <span class="type">String</span> =&gt; <span class="type">Boolean</span> =&gt; <span class="type">Double</span>) = ...</span><br></pre></td></tr></table></figure>
<h2 id="结构类型"><a href="#结构类型" class="headerlink" title="结构类型"></a>结构类型</h2><p>低于50个字符就写在一行，否则分开：</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// wrong!</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">foo</span></span>(a: &#123; <span class="function"><span class="keyword">def</span> <span class="title">bar</span></span>(a: <span class="type">Int</span>, b: <span class="type">Int</span>): <span class="type">String</span>; <span class="keyword">val</span> baz: <span class="type">List</span>[<span class="type">String</span> =&gt; <span class="type">String</span>] &#125;) = ...</span><br><span class="line"></span><br><span class="line"><span class="comment">// right!</span></span><br><span class="line"><span class="keyword">private</span> <span class="class"><span class="keyword">type</span> <span class="title">FooParam</span> </span>= &#123;</span><br><span class="line">  <span class="keyword">val</span> baz: <span class="type">List</span>[<span class="type">String</span> =&gt; <span class="type">String</span>]</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">bar</span></span>(a: <span class="type">Int</span>, b: <span class="type">Int</span>): <span class="type">String</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">foo</span></span>(a: <span class="type">FooParam</span>) = ...</span><br></pre></td></tr></table></figure>
<p>内联：</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">foo</span></span>(a: &#123; <span class="keyword">val</span> bar: <span class="type">String</span> &#125;) = ...</span><br></pre></td></tr></table></figure>

<h1 id="块"><a href="#块" class="headerlink" title="块"></a>块</h1><h2 id="大括号"><a href="#大括号" class="headerlink" title="大括号"></a>大括号</h2><p>左大括号必须和声明的语句在同一行：</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">foo</span> </span>= &#123;</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="小括号"><a href="#小括号" class="headerlink" title="小括号"></a>小括号</h2><p>很长的语句可以换行：</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">this</span> + is a very ++ long *</span><br><span class="line">  expression)</span><br></pre></td></tr></table></figure>
<p>条件语句：</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">(  someCondition</span><br><span class="line">|| someOtherCondition</span><br><span class="line">|| thirdCondition</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<h1 id="声明"><a href="#声明" class="headerlink" title="声明"></a>声明</h1><h2 id="class"><a href="#class" class="headerlink" title="class"></a>class</h2><p>class&#x2F;object&#x2F;trait的构造方法还是看情况，能一行就一行，否则分开：</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span>(<span class="params">name: <span class="type">String</span>, age: <span class="type">Int</span></span>) </span>&#123;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span>(<span class="params"></span></span></span><br><span class="line"><span class="params"><span class="class">    name: <span class="type">String</span>,</span></span></span><br><span class="line"><span class="params"><span class="class">    age: <span class="type">Int</span>,</span></span></span><br><span class="line"><span class="params"><span class="class">    birthdate: <span class="type">Date</span>,</span></span></span><br><span class="line"><span class="params"><span class="class">    astrologicalSign: <span class="type">String</span>,</span></span></span><br><span class="line"><span class="params"><span class="class">    shoeSize: <span class="type">Int</span>,</span></span></span><br><span class="line"><span class="params"><span class="class">    favoriteColor: java.awt.<span class="type">Color</span></span>) </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">firstMethod</span></span>: <span class="type">Foo</span> = ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>继承也是一样：</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span>(<span class="params"></span></span></span><br><span class="line"><span class="params"><span class="class">    name: <span class="type">String</span>,</span></span></span><br><span class="line"><span class="params"><span class="class">    age: <span class="type">Int</span>,</span></span></span><br><span class="line"><span class="params"><span class="class">    birthdate: <span class="type">Date</span>,</span></span></span><br><span class="line"><span class="params"><span class="class">    astrologicalSign: <span class="type">String</span>,</span></span></span><br><span class="line"><span class="params"><span class="class">    shoeSize: <span class="type">Int</span>,</span></span></span><br><span class="line"><span class="params"><span class="class">    favoriteColor: java.awt.<span class="type">Color</span></span>)</span></span><br><span class="line">  <span class="keyword">extends</span> <span class="type">Entity</span></span><br><span class="line">  <span class="keyword">with</span> <span class="type">Logging</span></span><br><span class="line">  <span class="keyword">with</span> <span class="type">Identifiable</span></span><br><span class="line">  <span class="keyword">with</span> <span class="type">Serializable</span> &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="类元素的顺序"><a href="#类元素的顺序" class="headerlink" title="类元素的顺序"></a>类元素的顺序</h2><p>换行：</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Foo</span> </span>&#123;</span><br><span class="line">  <span class="keyword">val</span> bar = <span class="number">42</span></span><br><span class="line">  <span class="keyword">val</span> baz = <span class="string">&quot;Daniel&quot;</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">doSomething</span></span>(): <span class="type">Unit</span> = &#123; ... &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">add</span></span>(x: <span class="type">Int</span>, y: <span class="type">Int</span>): <span class="type">Int</span> = x + y</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="方法-1"><a href="#方法-1" class="headerlink" title="方法"></a>方法</h2><p>如下声明方式：一定加上返回类型，否则私有方法或局部方法会忽略。</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">foo</span></span>(bar: <span class="type">Baz</span>): <span class="type">Bin</span> = expr</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">foo</span></span>(x: <span class="type">Int</span> = <span class="number">6</span>, y: <span class="type">Int</span> = <span class="number">7</span>): <span class="type">Int</span> = x + y</span><br></pre></td></tr></table></figure>
<p>如下：</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// don&#x27;t do this</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">printBar</span></span>(bar: <span class="type">Baz</span>) &#123;</span><br><span class="line">  println(bar)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// write this instead</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">printBar</span></span>(bar: <span class="type">Bar</span>): <span class="type">Unit</span> = &#123;</span><br><span class="line">  println(bar)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="修饰符"><a href="#修饰符" class="headerlink" title="修饰符"></a>修饰符</h2><p>声明顺序：</p>
<ol>
<li>注解</li>
<li><code>Override</code></li>
<li>访问修饰符（<code>private ,protected</code>）</li>
<li><code>implicit</code></li>
<li><code>final</code></li>
<li><code>def</code></li>
</ol>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Transaction</span></span><br><span class="line"><span class="meta">@throws</span>(classOf[<span class="type">IOException</span>])</span><br><span class="line"><span class="keyword">override</span> <span class="keyword">protected</span> <span class="keyword">final</span> <span class="function"><span class="keyword">def</span> <span class="title">foo</span></span>(): <span class="type">Unit</span> = &#123;</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="函数体"><a href="#函数体" class="headerlink" title="函数体"></a>函数体</h2><p>当函数体长度小于30个字符，写在一行：</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span></span>(a: <span class="type">Int</span>, b: <span class="type">Int</span>): <span class="type">Int</span> = a + b</span><br></pre></td></tr></table></figure>
<p>在30到70个字符时：</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sum</span></span>(ls: <span class="type">List</span>[<span class="type">String</span>]): <span class="type">Int</span> =</span><br><span class="line">  ls.map(_.toInt).foldLeft(<span class="number">0</span>)(_ + _)</span><br></pre></td></tr></table></figure>
<p>但推荐更易读的方式：</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sum</span></span>(ls: <span class="type">List</span>[<span class="type">String</span>]): <span class="type">Int</span> = &#123;</span><br><span class="line">  <span class="keyword">val</span> ints = ls map (_.toInt)</span><br><span class="line">  ints.foldLeft(<span class="number">0</span>)(_ + _)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>对于match语句：</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// right!</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sum</span></span>(ls: <span class="type">List</span>[<span class="type">Int</span>]): <span class="type">Int</span> = ls <span class="keyword">match</span> &#123;</span><br><span class="line">  <span class="keyword">case</span> hd :: tail =&gt; hd + sum(tail)</span><br><span class="line">  <span class="keyword">case</span> <span class="type">Nil</span> =&gt; <span class="number">0</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// wrong!</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sum</span></span>(ls: <span class="type">List</span>[<span class="type">Int</span>]): <span class="type">Int</span> = &#123;</span><br><span class="line">  ls <span class="keyword">match</span> &#123;</span><br><span class="line">    <span class="keyword">case</span> hd :: tail =&gt; hd + sum(tail)</span><br><span class="line">    <span class="keyword">case</span> <span class="type">Nil</span> =&gt; <span class="number">0</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>






      
    </div> -->
          <div class="article-entry" itemprop="articleBody">
            
              
                
                      
                        
                          
                            
                              
                                
                                  
                                    <p>
                                      <p>本文翻译自: <a target="_blank" rel="noopener" href="https://docs.scala-lang.org/style/">https://docs.scala-lang.org/style/</a></p>

                                        <p>
                                          
                                            
                                              
                                                      
          </div>
    <p class="article-more-link">
      <a href="/2019/02/04/scala/004-scala-style/#more">
        Read More
      </a>
    </p>
    <!-- <div class="article-more-link">
      <a href="/2019/02/04/scala/004-scala-style/#more">
        read more
      </a>
    </div> -->
    


      <footer class="article-footer">
        <a data-url="http://jimolonely.github.io/2019/02/04/scala/004-scala-style/" data-id="cl1fw7fnk00j9vkd3bzphaax7" class="article-share-link">
          Share
        </a>
        
            
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/scala/" rel="tag">scala</a><span class="article-tag-list-count">10</span></li></ul>

      </footer>
      </div>
      
</article>


  
    <article id="post-spark/005-big-data-tutorial" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/02/03/spark/005-big-data-tutorial/" class="article-date">
  <time datetime="2019-02-03T14:17:20.000Z" itemprop="datePublished">2019-02-03</time>
</a>
      
  </div>
  <div class="article-inner">
    
      
        <header class="article-header">
          
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/02/03/spark/005-big-data-tutorial/">大数据进阶教程</a>
    </h1>
  

        </header>
        
          <!-- <div class="article-entry" itemprop="articleBody">
      
        <p>记录大数据学习之路。</p>
<p>宗旨：在实践中学习。</p>
<p>拿到一个完整的项目，让项目代码变成你认为最好的样子，然后你就成为了King。</p>
<h1 id="熟悉Scala语言"><a href="#熟悉Scala语言" class="headerlink" title="熟悉Scala语言"></a>熟悉Scala语言</h1><p><a target="_blank" rel="noopener" href="https://docs.scala-lang.org/zh-cn/tour/tour-of-scala.html">https://docs.scala-lang.org/zh-cn/tour/tour-of-scala.html</a></p>
<ol>
<li>语法初级了解</li>
<li>scala编码规范：</li>
<li>语法高级使用</li>
</ol>
<p>1.scala中函数和方法的区别</p>
<p>函数是一条语句：由参数+函数体组成</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">val</span> addOne = (x: <span class="type">Int</span>) =&gt; x + <span class="number">1</span></span><br></pre></td></tr></table></figure>
<p>方法：由def定义</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">add</span></span>(x: <span class="type">Int</span>, y: <span class="type">Int</span>): <span class="type">Int</span> = x + y</span><br><span class="line">println(add(<span class="number">1</span>, <span class="number">2</span>)) <span class="comment">// 3</span></span><br></pre></td></tr></table></figure>

<p>object: </p>
<ol>
<li>单例</li>
<li>静态</li>
</ol>
<p>提取器对象：</p>
<p>List.tail 方法返回的是：</p>
<p>for循环里的yield操作是什么原理</p>
<p>scala的协变和逆变，java不支持。</p>
<p>类型上下界： <code>:&lt;</code>, <code>&gt;:</code>.</p>
<p>内部类和java不一样的地方，内部类是不一样的实例。<code>OuterClass#InnerClass</code></p>
<p>注意： 抽象类型、复合类型、自类型的定义和区别。</p>
<p>什么叫隐式参数？</p>
<p>隐式转换没懂： TODO</p>
<p>注意传值参数和传名参数的不同。</p>
<p>常用注解： <code>@deprecate, @tailrec(什么是尾递归？), @inline</code>.<br>注意： java定义的注解在java和scala中使用的差别， 关于默认值和明确表示</p>
<p>导包： </p>
<ol>
<li>如何设置别名：<code>import users.&#123;UserInfo =&gt; UI&#125;</code></li>
<li>scala 可以在任何地方导包</li>
<li>从根包导入： <code>import _root_.users._</code>.</li>
</ol>
<h1 id="spark"><a href="#spark" class="headerlink" title="spark"></a>spark</h1><p>接着就可以开始拿spark练手了，一方面是熟悉scala语言，一方面学习spark。</p>
<ol>
<li><p>spark-shell使用： <a target="_blank" rel="noopener" href="https://spark.apache.org/docs/latest/quick-start.html">https://spark.apache.org/docs/latest/quick-start.html</a></p>
</li>
<li><p>scala版本问题导致的运行失败，需要在<code>SPARK_HOME/jars</code>下查看spark需要的scala版本，然后编译时使用相应的scala版本：<a target="_blank" rel="noopener" href="https://blog.csdn.net/u013054888/article/details/54600229">blog</a></p>
</li>
</ol>

      
    </div> -->
          <div class="article-entry" itemprop="articleBody">
            
              
                
                      
                        
                          
                            
                              
                                
                                  
                                    <p>
                                      <p>记录大数据学习之路。</p>

                                        <p>
                                          
                                            
                                              
                                                      
          </div>
    <p class="article-more-link">
      <a href="/2019/02/03/spark/005-big-data-tutorial/#more">
        Read More
      </a>
    </p>
    <!-- <div class="article-more-link">
      <a href="/2019/02/03/spark/005-big-data-tutorial/#more">
        read more
      </a>
    </div> -->
    


      <footer class="article-footer">
        <a data-url="http://jimolonely.github.io/2019/02/03/spark/005-big-data-tutorial/" data-id="cl1fw7fno00jlvkd3bon0crdn" class="article-share-link">
          Share
        </a>
        
            
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/big-data/" rel="tag">big data</a><span class="article-tag-list-count">2</span></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/scala/" rel="tag">scala</a><span class="article-tag-list-count">10</span></li></ul>

      </footer>
      </div>
      
</article>


  
    <article id="post-life/004-new-year" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/01/29/life/004-new-year/" class="article-date">
  <time datetime="2019-01-29T00:34:45.000Z" itemprop="datePublished">2019-01-29</time>
</a>
      
  </div>
  <div class="article-inner">
    
      
        <header class="article-header">
          
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/01/29/life/004-new-year/">过年的人性</a>
    </h1>
  

        </header>
        
          <!-- <div class="article-entry" itemprop="articleBody">
      
        <p>早上一个人在办公室学习，因为挺早，门外的清洁大姐相互说： 哎呀，快过年了！</p>
<p>就是，以前过年都是穿新衣服，吃好吃的，现在就只是花钱，后辈们花钱。</p>
<p>然后我想到：极端情况才是显示人性的时候。</p>
<p>然后群里分享的关于林清玄的言语：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">今天比昨天慈悲，今天比昨天智慧，今天比昨天快乐。这就是成功。</span><br></pre></td></tr></table></figure>

<p>我就想说：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">我一定是个异常坚强的人，因为我每天都承受着失败。</span><br></pre></td></tr></table></figure>

      
    </div> -->
          <div class="article-entry" itemprop="articleBody">
            
              
                
                      
                        
                          
                            
                              
                                
                                  
                                    <p>
                                      <p>早上一个人在办公室学习，因为挺早，门外的清洁大姐相互说： 哎呀，快过年了！</p>

                                        <p>
                                          
                                            
                                              
                                                      
          </div>
    <p class="article-more-link">
      <a href="/2019/01/29/life/004-new-year/#more">
        Read More
      </a>
    </p>
    <!-- <div class="article-more-link">
      <a href="/2019/01/29/life/004-new-year/#more">
        read more
      </a>
    </div> -->
    


      <footer class="article-footer">
        <a data-url="http://jimolonely.github.io/2019/01/29/life/004-new-year/" data-id="cl1fw7fjz0069vkd34js6abzp" class="article-share-link">
          Share
        </a>
        
            
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/life/" rel="tag">life</a><span class="article-tag-list-count">32</span></li></ul>

      </footer>
      </div>
      
</article>


  
    <article id="post-java/024-java-fix-problem" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/01/28/java/024-java-fix-problem/" class="article-date">
  <time datetime="2019-01-28T06:13:31.000Z" itemprop="datePublished">2019-01-28</time>
</a>
      
  </div>
  <div class="article-inner">
    
      
        <header class="article-header">
          
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/01/28/java/024-java-fix-problem/">如何解决问题</a>
    </h1>
  

        </header>
        
          <!-- <div class="article-entry" itemprop="articleBody">
      
        <p>今天遇到一个简单的问题： nacos + springcloud<br>环境搭好后，spring-cloud项目启动，打了一条日志就退出了，而这条日志还是个INFO级别的，</p>
<p>让我很是困扰， 于是思考应该怎么解决，于是采用普遍思维：debug。</p>
<p>从那条日志的类开始打断点，经过十几个类，终于找到错误原因： 找不到一个类。</p>
<p>再一查，发现来自guava包，然后明白是版本冲突了，nacos使用的19.0版本被spring-cloud的12.0覆盖了，于是找不到类。</p>
<p>但编译时没报错，运行时报错了。</p>
<p>这也算一个经验把，于是查找IDEA下maven依赖包的有用工具，<br>比如下面这个：</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/sunpeng_sp/article/details/77393348">maven helper</a></p>
<p>虽然idea自带了查看依赖图，但真的太多包时根本看不过来。</p>

      
    </div> -->
          <div class="article-entry" itemprop="articleBody">
            
              
                
                      
                        
                          
                            
                              
                                
                                  
                                    <p>
                                      <p>今天遇到一个简单的问题： nacos + springcloud<br>环境搭好后，spring-cloud项目启动，打了一条日志就退出了，而这条日志还是个INFO级别的，</p>

                                        <p>
                                          
                                            
                                              
                                                      
          </div>
    <p class="article-more-link">
      <a href="/2019/01/28/java/024-java-fix-problem/#more">
        Read More
      </a>
    </p>
    <!-- <div class="article-more-link">
      <a href="/2019/01/28/java/024-java-fix-problem/#more">
        read more
      </a>
    </div> -->
    


      <footer class="article-footer">
        <a data-url="http://jimolonely.github.io/2019/01/28/java/024-java-fix-problem/" data-id="cl1fw7fl1009yvkd392lzgo0g" class="article-share-link">
          Share
        </a>
        
            
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/java/" rel="tag">java</a><span class="article-tag-list-count">104</span></li></ul>

      </footer>
      </div>
      
</article>


  
    <article id="post-linux/018-ubuntu-java" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/01/27/linux/018-ubuntu-java/" class="article-date">
  <time datetime="2019-01-27T01:50:17.000Z" itemprop="datePublished">2019-01-27</time>
</a>
      
  </div>
  <div class="article-inner">
    
      
        <header class="article-header">
          
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/01/27/linux/018-ubuntu-java/">ubuntu安装/更新Java</a>
    </h1>
  

        </header>
        
          <!-- <div class="article-entry" itemprop="articleBody">
      
        <h1 id="ubuntu18-x"><a href="#ubuntu18-x" class="headerlink" title="ubuntu18.x"></a>ubuntu18.x</h1><p>参考<a target="_blank" rel="noopener" href="https://linuxconfig.org/how-to-install-java-on-ubuntu-18-04-bionic-beaver-linux">文章</a></p>
<h2 id="安装相应版本Java"><a href="#安装相应版本Java" class="headerlink" title="安装相应版本Java"></a>安装相应版本Java</h2><p>JDK11（默认）</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo apt install openjdk-11-jdk</span></span><br></pre></td></tr></table></figure>
<p>JDK8</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo apt install openjdk-8-jdk</span></span><br></pre></td></tr></table></figure>

<h2 id="切换版本"><a href="#切换版本" class="headerlink" title="切换版本"></a>切换版本</h2><p>注意对于安装多个jdk版本时如何切换jdk版本：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">sudo update-alternatives --config java</span></span><br><span class="line">有 2 个候选项可用于替换 java (提供 /usr/bin/java)。</span><br><span class="line"></span><br><span class="line">  选择       路径                                          优先级  状态</span><br><span class="line">------------------------------------------------------------</span><br><span class="line">* 0            /usr/lib/jvm/java-11-openjdk-amd64/bin/java      1101      自动模式</span><br><span class="line">  1            /usr/lib/jvm/java-11-openjdk-amd64/bin/java      1101      手动模式</span><br><span class="line">  2            /usr/lib/jvm/java-8-openjdk-amd64/jre/bin/java   1081      手动模式</span><br><span class="line"></span><br><span class="line">要维持当前值[*]请按&lt;回车键&gt;，或者键入选择的编号：2</span><br><span class="line">update-alternatives: 使用 /usr/lib/jvm/java-8-openjdk-amd64/jre/bin/java 来在手动模式中提供 /usr/bin/java (java)</span><br><span class="line"></span><br><span class="line">jack@jack:~/workspace/iad-boot/nacos-server-0.8.0/nacos$ java -version</span><br><span class="line">openjdk version &quot;1.8.0_191&quot;</span><br><span class="line">OpenJDK Runtime Environment (build 1.8.0_191-8u191-b12-0ubuntu0.18.04.1-b12)</span><br><span class="line">OpenJDK 64-Bit Server VM (build 25.191-b12, mixed mode)</span><br></pre></td></tr></table></figure>

      
    </div> -->
          <div class="article-entry" itemprop="articleBody">
            
              
                
                      
                        
                          
                            
                              
                                
                                  
                                    <p>
                                      <h1 id="ubuntu18-x"><a href="#ubuntu18-x" class="headerlink" title="ubuntu18.x"></a>ubuntu18.x</h1><p>参考<a target="_blank" rel="noopener" href="https://linuxconfig.org/how-to-install-java-on-ubuntu-18-04-bionic-beaver-linux">文章</a></p>

                                        <p>
                                          
                                            
                                              
                                                      
          </div>
    <p class="article-more-link">
      <a href="/2019/01/27/linux/018-ubuntu-java/#more">
        Read More
      </a>
    </p>
    <!-- <div class="article-more-link">
      <a href="/2019/01/27/linux/018-ubuntu-java/#more">
        read more
      </a>
    </div> -->
    


      <footer class="article-footer">
        <a data-url="http://jimolonely.github.io/2019/01/27/linux/018-ubuntu-java/" data-id="cl1fw7fmm00fkvkd3a9mg0dar" class="article-share-link">
          Share
        </a>
        
            
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/java/" rel="tag">java</a><span class="article-tag-list-count">104</span></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/linux/" rel="tag">linux</a><span class="article-tag-list-count">57</span></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ubuntu/" rel="tag">ubuntu</a><span class="article-tag-list-count">13</span></li></ul>

      </footer>
      </div>
      
</article>


  
    <article id="post-java/023-springboot-logback-config" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/01/18/java/023-springboot-logback-config/" class="article-date">
  <time datetime="2019-01-18T05:44:06.000Z" itemprop="datePublished">2019-01-18</time>
</a>
      
  </div>
  <div class="article-inner">
    
      
        <header class="article-header">
          
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/01/18/java/023-springboot-logback-config/">spring-boot logback日志配置</a>
    </h1>
  

        </header>
        
          <!-- <div class="article-entry" itemprop="articleBody">
      
        <p>参考<a target="_blank" rel="noopener" href="https://logback.qos.ch/manual/appenders.html#SizeBasedTriggeringPolicy">文档</a></p>
<p>看一下常用配置：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span> <span class="attr">scan</span>=<span class="string">&quot;true&quot;</span> <span class="attr">scanPeriod</span>=<span class="string">&quot;60 seconds&quot;</span> <span class="attr">debug</span>=<span class="string">&quot;false&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">contextName</span>&gt;</span>route-log<span class="tag">&lt;/<span class="name">contextName</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;logback.logdir&quot;</span> <span class="attr">value</span>=<span class="string">&quot;/var/log/xxx&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;logback.appname&quot;</span> <span class="attr">value</span>=<span class="string">&quot;xxx-app&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--输出到控制台 ConsoleAppender--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">appender</span> <span class="attr">name</span>=<span class="string">&quot;consoleLog&quot;</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.core.ConsoleAppender&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--展示格式 layout--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">layout</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.classic.PatternLayout&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">pattern</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">pattern</span>&gt;</span>%d %-5level [%thread] %logger&#123;36&#125; %line - %msg%n<span class="tag">&lt;/<span class="name">pattern</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">pattern</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">layout</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.classic.filter.ThresholdFilter&quot;</span>&gt;</span></span><br><span class="line">             <span class="tag">&lt;<span class="name">level</span>&gt;</span>INFO<span class="tag">&lt;/<span class="name">level</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">appender</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--Info以及以上的日志--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">appender</span> <span class="attr">name</span>=<span class="string">&quot;fileInfoUpLog&quot;</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.core.rolling.RollingFileAppender&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--如果只是想要 Info 级别的日志，只是过滤 info 还是会输出 Error 日志，因为 Error 的级别高，</span></span><br><span class="line"><span class="comment">        所以我们使用下面的策略，可以避免输出 Error 的日志--&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!--&lt;filter class=&quot;ch.qos.logback.classic.filter.LevelFilter&quot;&gt;--&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--&amp;lt;!&amp;ndash;过滤 Error&amp;ndash;&amp;gt;--&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--&lt;level&gt;ERROR&lt;/level&gt;--&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--&amp;lt;!&amp;ndash;匹配到就禁止&amp;ndash;&amp;gt;--&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--&lt;onMatch&gt;DENY&lt;/onMatch&gt;--&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--&amp;lt;!&amp;ndash;没有匹配到就允许&amp;ndash;&amp;gt;--&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--&lt;onMismatch&gt;ACCEPT&lt;/onMismatch&gt;--&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--&lt;/filter&gt;--&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">filter</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.classic.filter.ThresholdFilter&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">level</span>&gt;</span>INFO<span class="tag">&lt;/<span class="name">level</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!--日志名称，如果没有File 属性，那么只会使用FileNamePattern的文件路径规则</span></span><br><span class="line"><span class="comment">            如果同时有&lt;File&gt;和&lt;FileNamePattern&gt;，那么当天日志是&lt;File&gt;，明天会自动把今天</span></span><br><span class="line"><span class="comment">            的日志改名为今天的日期。即，&lt;File&gt; 的日志都是当天的。</span></span><br><span class="line"><span class="comment">        --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">File</span>&gt;</span>$&#123;logback.logdir&#125;/$&#123;logback.appname&#125;.log<span class="tag">&lt;/<span class="name">File</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">rollingPolicy</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.core.rolling.SizeAndTimeBasedRollingPolicy&quot;</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- rollover monthly --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">fileNamePattern</span>&gt;</span>$&#123;logback.logdir&#125;/$&#123;logback.appname&#125;-%d&#123;yyyy-MM&#125;.%i.log<span class="tag">&lt;/<span class="name">fileNamePattern</span>&gt;</span></span><br><span class="line">            <span class="comment">&lt;!-- each file should be at most 100MB, keep 30 days worth of history, but at most 200MB --&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">maxFileSize</span>&gt;</span>100MB<span class="tag">&lt;/<span class="name">maxFileSize</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">maxHistory</span>&gt;</span>30<span class="tag">&lt;/<span class="name">maxHistory</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">totalSizeCap</span>&gt;</span>200MB<span class="tag">&lt;/<span class="name">totalSizeCap</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">rollingPolicy</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!--日志输出编码格式化--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">encoder</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">charset</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">charset</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">pattern</span>&gt;</span>%d %-5level [%thread] %logger&#123;36&#125; %line - %msg%n<span class="tag">&lt;/<span class="name">pattern</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">encoder</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">appender</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--&lt;appender name=&quot;fileErrorLog&quot; class=&quot;ch.qos.logback.core.rolling.RollingFileAppender&quot;&gt;--&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--&amp;lt;!&amp;ndash;如果只是想要 Error 级别的日志，那么需要过滤一下，默认是 info 级别的，ThresholdFilter&amp;ndash;&amp;gt;--&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--&lt;filter class=&quot;ch.qos.logback.classic.filter.ThresholdFilter&quot;&gt;--&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--&lt;level&gt;Error&lt;/level&gt;--&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--&lt;/filter&gt;--&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--&amp;lt;!&amp;ndash;日志名称，如果没有File 属性，那么只会使用FileNamePattern的文件路径规则--&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--如果同时有&lt;File&gt;和&lt;FileNamePattern&gt;，那么当天日志是&lt;File&gt;，明天会自动把今天--&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--的日志改名为今天的日期。即，&lt;File&gt; 的日志都是当天的。--&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--&amp;ndash;&amp;gt;--&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--&lt;File&gt;$&#123;logback.logdir&#125;/error.$&#123;logback.appname&#125;.log&lt;/File&gt;--&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--&amp;lt;!&amp;ndash;滚动策略，按照时间滚动 TimeBasedRollingPolicy&amp;ndash;&amp;gt;--&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--&lt;rollingPolicy class=&quot;ch.qos.logback.core.rolling.TimeBasedRollingPolicy&quot;&gt;--&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--&amp;lt;!&amp;ndash;文件路径,定义了日志的切分方式——把每一天的日志归档到一个文件中,以防止日志填满整个磁盘空间&amp;ndash;&amp;gt;--&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--&lt;FileNamePattern&gt;$&#123;logback.logdir&#125;/error.$&#123;logback.appname&#125;.%d&#123;yyyy-MM-dd&#125;.log&lt;/FileNamePattern&gt;--&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--&amp;lt;!&amp;ndash;只保留最近90天的日志&amp;ndash;&amp;gt;--&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--&lt;maxHistory&gt;90&lt;/maxHistory&gt;--&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--&amp;lt;!&amp;ndash;用来指定日志文件的上限大小，那么到了这个值，就会删除旧的日志&amp;ndash;&amp;gt;--&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--&amp;lt;!&amp;ndash;&lt;totalSizeCap&gt;1GB&lt;/totalSizeCap&gt;&amp;ndash;&amp;gt;--&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--&lt;/rollingPolicy&gt;--&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--&amp;lt;!&amp;ndash;日志输出编码格式化&amp;ndash;&amp;gt;--&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--&lt;encoder&gt;--&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--&lt;charset&gt;UTF-8&lt;/charset&gt;--&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--&lt;pattern&gt;%d [%thread] %-5level %logger&#123;36&#125; %line - %msg%n&lt;/pattern&gt;--&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--&lt;/encoder&gt;--&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--&lt;/appender&gt;--&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--指定最基础的日志输出级别--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">root</span> <span class="attr">level</span>=<span class="string">&quot;INFO&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--appender将会添加到这个loger--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">&quot;consoleLog&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">&quot;fileInfoUpLog&quot;</span>/&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--&lt;appender-ref ref=&quot;fileErrorLog&quot;/&gt;--&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">root</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>假如要压缩，达到一定大小后压缩，直接改文件名即可：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">appender</span> <span class="attr">name</span>=<span class="string">&quot;FILE&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.core.rolling.RollingFileAppender&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">File</span>&gt;</span>$&#123;LOGDIR&#125;/filename.log<span class="tag">&lt;/<span class="name">File</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">rollingPolicy</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.core.rolling.TimeBasedRollingPolicy&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- rollover daily --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">FileNamePattern</span>&gt;</span>$&#123;LOGDIR&#125;/file.%d&#123;yyyy-MM-dd&#125;.%i.log.gz</span><br><span class="line">        <span class="tag">&lt;/<span class="name">FileNamePattern</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- keep 30 days&#x27; worth of history --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">MaxHistory</span>&gt;</span>30<span class="tag">&lt;/<span class="name">MaxHistory</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- or whenever the file size reaches 10MB --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">timeBasedFileNamingAndTriggeringPolicy</span></span></span><br><span class="line"><span class="tag">            <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.core.rolling.SizeAndTimeBasedFNATP&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">maxFileSize</span>&gt;</span>10MB<span class="tag">&lt;/<span class="name">maxFileSize</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">timeBasedFileNamingAndTriggeringPolicy</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">rollingPolicy</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">encoder</span> <span class="attr">class</span>=<span class="string">&quot;ch.qos.logback.classic.encoder.PatternLayoutEncoder&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">Pattern</span>&gt;</span>%date [%thread] %-5level %logger&#123;36&#125; - %msg%n</span><br><span class="line">        <span class="tag">&lt;/<span class="name">Pattern</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">encoder</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">appender</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>上面的代码将在当天压缩文件, 如果日志文件大小超过10MB。</p>

      
    </div> -->
          <div class="article-entry" itemprop="articleBody">
            
              
                
                      
                        
                          
                            
                              
                                
                                  
                                    <p>
                                      <p>参考<a target="_blank" rel="noopener" href="https://logback.qos.ch/manual/appenders.html#SizeBasedTriggeringPolicy">文档</a></p>

                                        <p>
                                          
                                            
                                              
                                                      
          </div>
    <p class="article-more-link">
      <a href="/2019/01/18/java/023-springboot-logback-config/#more">
        Read More
      </a>
    </p>
    <!-- <div class="article-more-link">
      <a href="/2019/01/18/java/023-springboot-logback-config/#more">
        read more
      </a>
    </div> -->
    


      <footer class="article-footer">
        <a data-url="http://jimolonely.github.io/2019/01/18/java/023-springboot-logback-config/" data-id="cl1fw7fl1009vvkd317nbdvzm" class="article-share-link">
          Share
        </a>
        
            
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/java/" rel="tag">java</a><span class="article-tag-list-count">104</span></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/log/" rel="tag">log</a><span class="article-tag-list-count">1</span></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/spring/" rel="tag">spring</a><span class="article-tag-list-count">12</span></li></ul>

      </footer>
      </div>
      
</article>


  
    <article id="post-ansible/005-ansible-demo1" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/01/16/ansible/005-ansible-demo1/" class="article-date">
  <time datetime="2019-01-16T04:30:10.000Z" itemprop="datePublished">2019-01-16</time>
</a>
      
  </div>
  <div class="article-inner">
    
      
        <header class="article-header">
          
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/01/16/ansible/005-ansible-demo1/">ansible实用写法</a>
    </h1>
  

        </header>
        
          <!-- <div class="article-entry" itemprop="articleBody">
      
        <p>ansible一些常用知识。</p>
<h1 id="全局变量"><a href="#全局变量" class="headerlink" title="全局变量"></a>全局变量</h1><p>用在所有的组里的变量。</p>
<p>在hosts里指定所有的组，声明变量：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[all:vars]</span><br><span class="line">global_var=xxx</span><br></pre></td></tr></table></figure>
<h1 id="取一个路径的文件名或目录"><a href="#取一个路径的文件名或目录" class="headerlink" title="取一个路径的文件名或目录"></a>取一个路径的文件名或目录</h1><p>参考： <a target="_blank" rel="noopener" href="https://github.com/yteraoka/ansible-tutorial/wiki/path-filter">https://github.com/yteraoka/ansible-tutorial/wiki/path-filter</a></p>
<p>文件名：</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123; <span class="string">path</span> <span class="string">|</span> <span class="string">basename</span> &#125;&#125;</span><br></pre></td></tr></table></figure>

<p>目录：</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123; <span class="string">path</span> <span class="string">|</span> <span class="string">dirname</span> &#125;&#125;</span><br></pre></td></tr></table></figure>

<h1 id="shell-chdir"><a href="#shell-chdir" class="headerlink" title="shell-chdir"></a>shell-chdir</h1><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">shell:</span> <span class="string">xxx</span></span><br><span class="line"><span class="attr">args:</span></span><br><span class="line">  <span class="attr">chdir:</span> <span class="string">path</span></span><br></pre></td></tr></table></figure>

<h1 id="变量比较"><a href="#变量比较" class="headerlink" title="变量比较"></a>变量比较</h1><p>一开始以为需要使用：<code>&#123;&#123;var&#125;&#125;==&#39;dsdd&#39;</code></p>
<p>后来发现只需要： <code>var==&quot;dsdd&quot;</code></p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">tasks:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">compare</span></span><br><span class="line">    <span class="attr">when:</span> <span class="string">var==&quot;jimo&quot;</span></span><br></pre></td></tr></table></figure>

<h1 id="find-kill-pid"><a href="#find-kill-pid" class="headerlink" title="find-kill-pid"></a>find-kill-pid</h1><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> <span class="attr">name:</span> <span class="string">find</span> <span class="string">running</span> <span class="string">pid</span></span><br><span class="line">  <span class="attr">shell:</span> <span class="string">ps</span> <span class="string">-ef</span> <span class="string">|</span> <span class="string">grep</span> <span class="string">-v</span> <span class="string">grep</span> <span class="string">|</span> <span class="string">grep</span> <span class="string">xxx</span> <span class="string">|</span> <span class="string">awk</span> <span class="string">&#x27;&#123;print $2&#125;&#x27;</span></span><br><span class="line">  <span class="attr">register:</span> <span class="string">pid</span></span><br><span class="line"></span><br><span class="line"><span class="bullet">-</span> <span class="attr">name:</span> <span class="string">kill</span> <span class="string">process</span></span><br><span class="line">  <span class="attr">shell:</span> <span class="string">&quot;kill -9 <span class="template-variable">&#123;&#123;item&#125;&#125;</span>&quot;</span></span><br><span class="line">  <span class="attr">with_items:</span> <span class="string">&quot;<span class="template-variable">&#123;&#123;pid.stdout_lines&#125;&#125;</span>&quot;</span></span><br></pre></td></tr></table></figure>

<h1 id="replace"><a href="#replace" class="headerlink" title="replace"></a>replace</h1><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> <span class="attr">name:</span> <span class="string">replace</span></span><br><span class="line">  <span class="attr">replace:</span></span><br><span class="line">    <span class="attr">path:</span> <span class="string">path</span></span><br><span class="line">    <span class="attr">regexp:</span> <span class="string">old</span></span><br><span class="line">    <span class="attr">replace:</span> <span class="string">new</span></span><br></pre></td></tr></table></figure>
<p>对于有引号的内容，直接写就行：</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> <span class="attr">name:</span> <span class="string">modify</span> <span class="string">keepalived</span> <span class="string">conf</span></span><br><span class="line">  <span class="attr">replace:</span></span><br><span class="line">    <span class="attr">path:</span> <span class="string">&quot;/etc/sysconfig/keepalived&quot;</span></span><br><span class="line">    <span class="attr">regexp:</span> <span class="string">KEEPALIVED_OPTIONS=&quot;-D&quot;</span></span><br><span class="line">    <span class="attr">replace:</span> <span class="string">KEEPALIVED_OPTIONS=&quot;-D</span> <span class="string">-d</span> <span class="string">-S</span> <span class="number">0</span><span class="string">&quot;</span></span><br></pre></td></tr></table></figure>


<p>也可以使用： <code>ansible-doc -s lineinfile</code></p>
<h1 id="unarchive"><a href="#unarchive" class="headerlink" title="unarchive"></a>unarchive</h1><p>解压包，从src到dest：</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> <span class="attr">name:</span> <span class="string">unarchive</span></span><br><span class="line">  <span class="attr">unarchive:</span></span><br><span class="line">    <span class="attr">src:</span> <span class="string">&quot;本地地址/xxx.tar.gz&quot;</span></span><br><span class="line">    <span class="attr">dest:</span> <span class="string">&quot;远程地址&quot;</span></span><br><span class="line">    <span class="attr">remote_src:</span> <span class="literal">false</span></span><br></pre></td></tr></table></figure>
<p>2个地方需要注意：</p>
<ol>
<li>remote_src&#x3D;true代表src是远程的，默认是本地的</li>
<li>xxx.tar.gz 解压后会在远程地址创建一个xxx的目录，所以，远程就不要手动创建</li>
</ol>
<h1 id="设置自己的变量set-fact"><a href="#设置自己的变量set-fact" class="headerlink" title="设置自己的变量set_fact"></a>设置自己的变量set_fact</h1><p><a target="_blank" rel="noopener" href="https://docs.ansible.com/ansible/latest/modules/set_fact_module.html">文档</a></p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">tasks:</span></span><br><span class="line">  <span class="comment"># 设置变量</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">set_fact:</span></span><br><span class="line">      <span class="attr">JAR_DIR:</span> <span class="string">&quot;<span class="template-variable">&#123;&#123;playbook_dir&#125;&#125;</span>/iad-jars&quot;</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">debug:</span></span><br><span class="line">      <span class="attr">msg:</span> <span class="string">&quot;jar dir: <span class="template-variable">&#123;&#123;JAR_DIR&#125;&#125;</span>&quot;</span></span><br></pre></td></tr></table></figure>

<h1 id="获取主机IP"><a href="#获取主机IP" class="headerlink" title="获取主机IP"></a>获取主机IP</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&quot;inventory_hostname&quot;: &quot;192.168.17.70&quot;, </span><br><span class="line">&quot;inventory_hostname_short&quot;: &quot;192&quot;</span><br></pre></td></tr></table></figure>

<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> <span class="attr">debug:</span> <span class="string">var=hostvars</span></span><br><span class="line">  <span class="attr">tags:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">debug</span></span><br></pre></td></tr></table></figure>

<h1 id="判断文件是否存在"><a href="#判断文件是否存在" class="headerlink" title="判断文件是否存在"></a>判断文件是否存在</h1><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> <span class="attr">name:</span> <span class="string">check</span> <span class="string">if</span> <span class="string">application-prod.yml</span> <span class="string">exists</span></span><br><span class="line">  <span class="attr">stat:</span></span><br><span class="line">    <span class="attr">path:</span> <span class="string">/home/application-prod.yml</span></span><br><span class="line">  <span class="attr">register:</span> <span class="string">application_prod</span></span><br><span class="line"></span><br><span class="line"><span class="bullet">-</span> <span class="attr">fail:</span></span><br><span class="line">    <span class="attr">msg:</span> <span class="string">&quot;application-prod.yml not exist on /home/&quot;</span></span><br><span class="line">  <span class="attr">when:</span> <span class="string">application_prod.stat.exists</span> <span class="string">==</span> <span class="literal">False</span></span><br></pre></td></tr></table></figure>

<h1 id="只运行一次"><a href="#只运行一次" class="headerlink" title="只运行一次"></a>只运行一次</h1><p>假如，我在一个组下需要pull最新代码，而这个组里有多个机器，那么他们会并发执行，<br>但是git 模块只需要执行一次，否则会报错，这时候就需要执行一次：</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> <span class="attr">name:</span> <span class="string">pull</span> <span class="string">code</span></span><br><span class="line">  <span class="attr">git:</span> <span class="string">repo=&quot;&quot;</span> <span class="string">dest=&quot;&quot;</span></span><br><span class="line">  <span class="attr">run_once:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure>

<h1 id="sudo操作"><a href="#sudo操作" class="headerlink" title="sudo操作"></a>sudo操作</h1><p>执行sudo命令有2种情况</p>
<ol>
<li><code>sudo cmd</code>: 输入的是当前登录用户的密码，但是如果当前用户不在root用户组，则不行 <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[yunwei@h1 ~]$ sudo ls</span><br><span class="line">[sudo] password for yunwei: </span><br><span class="line">yunwei 不在 sudoers 文件中。此事将被报告。</span><br></pre></td></tr></table></figure></li>
<li>直接切换到root用户：<code>su - root</code>,这时候就是输入root用户密码。</li>
</ol>
<p>而ansible默认是第一种，由<code>become_method</code>标示,<a target="_blank" rel="noopener" href="https://docs.ansible.com/ansible/latest/user_guide/become.html#command-line-options">参考</a>。</p>
<p>所以，要使用第二种情况，需要设置：<code>become_method: su</code>.<br>完整示例：</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># hosts</span></span><br><span class="line"><span class="string">ansible_ssh_user=jimo</span></span><br><span class="line"><span class="string">ansible_ssh_pass=123456</span></span><br><span class="line"><span class="string">ansible_become_pass=&#x27;password&#x27;</span> <span class="comment"># root password</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用：</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">import_tasks:</span> <span class="string">deploy.yml</span></span><br><span class="line">  <span class="attr">become:</span> <span class="literal">yes</span></span><br><span class="line">  <span class="attr">become_user:</span> <span class="string">root</span></span><br><span class="line">  <span class="attr">become_method:</span> <span class="string">su</span></span><br></pre></td></tr></table></figure>

<h1 id="ansible清空目录"><a href="#ansible清空目录" class="headerlink" title="ansible清空目录"></a>ansible清空目录</h1><p><code>file absent</code>会删除整个目录，而有时只想清除目录下的文件, 清空或者清除部分文件：</p>
<p>find + file命令：先找出来，再删除</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">- name: list all jar files</span><br><span class="line">  local_action: find path=&quot;&#123;&#123;playbook_dir&#125;&#125;/any-dirs/&quot; patterns=&quot;*.jar&quot; file_type=file</span><br><span class="line">  register: jars</span><br><span class="line"></span><br><span class="line">- debug:</span><br><span class="line">    msg: &quot;&#123;&#123;jars.files&#125;&#125;&quot;</span><br><span class="line"></span><br><span class="line">- name: clear jars</span><br><span class="line">  local_action: file path=&#123;&#123;item.path&#125;&#125; state=absent</span><br><span class="line">  with_items:</span><br><span class="line">    - &quot;&#123;&#123;jars.files&#125;&#125;&quot;</span><br></pre></td></tr></table></figure>



      
    </div> -->
          <div class="article-entry" itemprop="articleBody">
            
              
                
                      
                        
                          
                            
                              
                                
                                  
                                    <p>
                                      <p>ansible一些常用知识。</p>

                                        <p>
                                          
                                            
                                              
                                                      
          </div>
    <p class="article-more-link">
      <a href="/2019/01/16/ansible/005-ansible-demo1/#more">
        Read More
      </a>
    </p>
    <!-- <div class="article-more-link">
      <a href="/2019/01/16/ansible/005-ansible-demo1/#more">
        read more
      </a>
    </div> -->
    


      <footer class="article-footer">
        <a data-url="http://jimolonely.github.io/2019/01/16/ansible/005-ansible-demo1/" data-id="cl1fw7fi9001zvkd31rmiejpv" class="article-share-link">
          Share
        </a>
        
            
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ansible/" rel="tag">ansible</a><span class="article-tag-list-count">7</span></li></ul>

      </footer>
      </div>
      
</article>


  
    <article id="post-ansible/004-ansible-playbook-variables" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/01/12/ansible/004-ansible-playbook-variables/" class="article-date">
  <time datetime="2019-01-12T09:11:37.000Z" itemprop="datePublished">2019-01-12</time>
</a>
      
  </div>
  <div class="article-inner">
    
      
        <header class="article-header">
          
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/01/12/ansible/004-ansible-playbook-variables/">ansible-playbook变量</a>
    </h1>
  

        </header>
        
          <!-- <div class="article-entry" itemprop="articleBody">
      
        <p>虽然存在自动化以使事情更容易重复，但所有系统都不完全相同; 有些可能需要与其他配置略有不同的配置。 在某些情况下，观察到的一个系统的行为或状态可能会影响您配置其他系统的方式。 例如，您可能需要找出系统的IP地址，并将其用作另一个系统上的配置值。</p>
<p>Ansible使用变量来帮助处理系统之间的差异。</p>
<p>要理解变量，您还需要阅读<a target="_blank" rel="noopener" href="https://docs.ansible.com/ansible/latest/user_guide/playbooks_conditionals.html#playbooks-conditionals">条件</a>和<a target="_blank" rel="noopener" href="https://docs.ansible.com/ansible/latest/user_guide/playbooks_loops.html#playbooks-loops">循环</a>。 像group_by模块和when条件这样的有用的东西也可以用于变量，并帮助管理系统之间的差异。</p>
<p><a target="_blank" rel="noopener" href="https://github.com/ansible/ansible-examples">ansible-examples github仓库</a>包含许多关于如何在Ansible中使用变量的示例。</p>
<h1 id="创建有效的变量名称"><a href="#创建有效的变量名称" class="headerlink" title="创建有效的变量名称"></a>创建有效的变量名称</h1><p>在开始使用变量之前，了解哪些是有效的变量名称很重要。</p>
<p>变量名称应为字母，数字和下划线。 变量应始终以字母开头。</p>
<p><code>foo_port</code>是一个很好的变量。 <code>foo5</code>也很好。</p>
<p><code>foo-port，foo port，foo.port和21</code>都不是有效的变量名。</p>
<p>YAML还支持将键映射到值的字典。 例如：</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">foo:</span></span><br><span class="line">  <span class="attr">field1:</span> <span class="string">one</span></span><br><span class="line">  <span class="attr">field2:</span> <span class="string">two</span></span><br></pre></td></tr></table></figure>
<p>然后，您可以使用括号表示法或点表示法引用字典中的特定字段：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">foo[<span class="string">&#x27;field1&#x27;</span>]</span><br><span class="line">foo.field1</span><br></pre></td></tr></table></figure>
<p>这些都将引用相同的值（“one”）。 但是，如果您选择使用点表示法，请注意某些键可能会导致问题，因为它们会与python词典的属性和方法发生冲突。 如果使用以两个下划线开头和结尾的键（那些是为python中的特殊含义保留的）或者是任何已知的公共属性，则应使用括号表示法而不是点表示法：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">add, append, as_integer_ratio, bit_length, capitalize, center, clear, conjugate, copy, count, decode, denominator, difference, difference_update, discard, encode, endswith, expandtabs, extend, find, <span class="built_in">format</span>, fromhex, fromkeys, get, has_key, <span class="built_in">hex</span>, imag, index, insert, intersection, intersection_update, isalnum, isalpha, isdecimal, isdigit, isdisjoint, is_integer, islower, isnumeric, isspace, issubset, issuperset, istitle, isupper, items, iteritems, iterkeys, itervalues, join, keys, ljust, lower, lstrip, numerator, partition, pop, popitem, real, remove, replace, reverse, rfind, rindex, rjust, rpartition, rsplit, rstrip, setdefault, sort, split, splitlines, startswith, strip, swapcase, symmetric_difference, symmetric_difference_update, title, translate, union, update, upper, values, viewitems, viewkeys, viewvalues, zfill.</span><br></pre></td></tr></table></figure>
<h1 id="在inventory中声明变量"><a href="#在inventory中声明变量" class="headerlink" title="在inventory中声明变量"></a>在inventory中声明变量</h1><p>通常，您需要为单个主机或inventory中的一组主机设置变量。 例如，波士顿的机器可能都使用’boston.ntp.example.com’作为NTP服务器。 “使用清单”页面提供了有关在清单中设置主机变量和组变量的详细信息。</p>
<h1 id="在playbook中定义变量"><a href="#在playbook中定义变量" class="headerlink" title="在playbook中定义变量"></a>在playbook中定义变量</h1><p>您可以直接在playbook中定义变量：</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> <span class="attr">hosts:</span> <span class="string">webservers</span></span><br><span class="line">  <span class="attr">vars:</span></span><br><span class="line">    <span class="attr">http_port:</span> <span class="number">80</span></span><br></pre></td></tr></table></figure>
<h1 id="在include文件和角色中定义变量"><a href="#在include文件和角色中定义变量" class="headerlink" title="在include文件和角色中定义变量"></a>在include文件和角色中定义变量</h1><p>如角色中所述，变量也可以通过include文件包含在playbook中，include文件可能是也可能不是Ansible角色的一部分。 首选角色的使用，因为它提供了一个很好的组织系统。</p>
<h1 id="使用Jinja2的变量"><a href="#使用Jinja2的变量" class="headerlink" title="使用Jinja2的变量"></a>使用Jinja2的变量</h1><p>一旦定义了变量，就可以在playbook中使用Jinja2模板系统。 这是一个简单的Jinja2模板：</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">My</span> <span class="string">amp</span> <span class="string">goes</span> <span class="string">to</span> &#123;&#123; <span class="string">max_amp_value</span> &#125;&#125;</span><br></pre></td></tr></table></figure>
<p>该表达式提供了变量替换的最基本形式。</p>
<p>您可以在playbooks中使用相同的语法。 例如：</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">template:</span> <span class="string">src=foo.cfg.j2</span> <span class="string">dest=&#123;&#123;</span> <span class="string">remote_install_path</span> <span class="string">&#125;&#125;/foo.cfg</span></span><br></pre></td></tr></table></figure>
<p>这里变量定义了文件的位置，该文件的位置可能因系统而异。</p>
<p>在模板内，您可以自动访问主机范围内的所有变量。 实际上它不止于此 - 您还可以读取有关其他主机的变量。 我们将展示如何做到这一点。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ansible允许模板中的Jinja2循环和条件，但在playbooks中，我们不使用它们。 Ansible剧本是纯机器可解析的YAML。 这是一个相当重要的功能，因为它意味着可以编码生成文件，或者让其他生态系统工具读取Ansible文件。 不是每个人都需要这个，但它可以解锁可能性。</span><br></pre></td></tr></table></figure>
<h1 id="使用Jinja2过滤器转换变量"><a href="#使用Jinja2过滤器转换变量" class="headerlink" title="使用Jinja2过滤器转换变量"></a>使用Jinja2过滤器转换变量</h1><p>Jinja2过滤器允许您在模板表达式中转换变量的值。 例如，大写过滤器会将传递给它的任何值大写; <code>to_yaml</code>和<code>to_json</code>过滤器会更改变量值的格式。 Jinja2包含许多内置过滤器，Ansible提供了更多过滤器。</p>
<h1 id="嘿等等，一个YAML陷阱"><a href="#嘿等等，一个YAML陷阱" class="headerlink" title="嘿等等，一个YAML陷阱"></a>嘿等等，一个YAML陷阱</h1><p>YAML语法要求如果您使用启动一个值，则引用整行，因为它要确保您不是要尝试启动YAML字典。 这在YAML语法文档中有所介绍。</p>
<p>这不起作用：</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> <span class="attr">hosts:</span> <span class="string">app_servers</span></span><br><span class="line">  <span class="attr">vars:</span></span><br><span class="line">      <span class="attr">app_path:</span> &#123;&#123; <span class="string">base_path</span> &#125;&#125;<span class="string">/22</span></span><br></pre></td></tr></table></figure>
<p>这样才行：</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> <span class="attr">hosts:</span> <span class="string">app_servers</span></span><br><span class="line">  <span class="attr">vars:</span></span><br><span class="line">       <span class="attr">app_path:</span> <span class="string">&quot;<span class="template-variable">&#123;&#123; base_path &#125;&#125;</span>/22&quot;</span></span><br></pre></td></tr></table></figure>
<h1 id="从系统中发现的变量：Facts"><a href="#从系统中发现的变量：Facts" class="headerlink" title="从系统中发现的变量：Facts"></a>从系统中发现的变量：Facts</h1><p>还有其他可以来自变量的地方，但这些是发现的变量类型，不是由用户设置的。</p>
<p>事实是通过与您的远程系统通话而获得的信息。 你可以在ansible_facts变量下找到一个完整的集合，大多数事实也被“注入”作为保留ansible_前缀的顶级变量，但是有些因冲突而被删除。 可以通过INJECT_FACTS_AS_VARS设置禁用此功能。</p>
<p>例如，远程主机的IP地址或操作系统是什么。</p>
<p>要查看可用的信息，请在play中尝试以下操作：</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> <span class="attr">debug:</span> <span class="string">var=ansible_facts</span></span><br></pre></td></tr></table></figure>
<p>要查看收集的“原始”信息：</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">ansible</span> <span class="string">hostname</span> <span class="string">-m</span> <span class="string">setup</span></span><br></pre></td></tr></table></figure>
<p>这将返回大量可变数据，在Ansible 2.7上可能如下所示：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;ansible_all_ipv4_addresses&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="string">&quot;REDACTED IP ADDRESS&quot;</span></span><br><span class="line">    <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ansible_all_ipv6_addresses&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="string">&quot;REDACTED IPV6 ADDRESS&quot;</span></span><br><span class="line">    <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ansible_apparmor&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;status&quot;</span><span class="punctuation">:</span> <span class="string">&quot;disabled&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ansible_architecture&quot;</span><span class="punctuation">:</span> <span class="string">&quot;x86_64&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ansible_bios_date&quot;</span><span class="punctuation">:</span> <span class="string">&quot;11/28/2013&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ansible_bios_version&quot;</span><span class="punctuation">:</span> <span class="string">&quot;4.1.5&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ansible_cmdline&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;BOOT_IMAGE&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/boot/vmlinuz-3.10.0-862.14.4.el7.x86_64&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;console&quot;</span><span class="punctuation">:</span> <span class="string">&quot;ttyS0,115200&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;no_timer_check&quot;</span><span class="punctuation">:</span> <span class="keyword">true</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;nofb&quot;</span><span class="punctuation">:</span> <span class="keyword">true</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;nomodeset&quot;</span><span class="punctuation">:</span> <span class="keyword">true</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;ro&quot;</span><span class="punctuation">:</span> <span class="keyword">true</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;root&quot;</span><span class="punctuation">:</span> <span class="string">&quot;LABEL=cloudimg-rootfs&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;vga&quot;</span><span class="punctuation">:</span> <span class="string">&quot;normal&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ansible_date_time&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;date&quot;</span><span class="punctuation">:</span> <span class="string">&quot;2018-10-25&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;day&quot;</span><span class="punctuation">:</span> <span class="string">&quot;25&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;epoch&quot;</span><span class="punctuation">:</span> <span class="string">&quot;1540469324&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;hour&quot;</span><span class="punctuation">:</span> <span class="string">&quot;12&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;iso8601&quot;</span><span class="punctuation">:</span> <span class="string">&quot;2018-10-25T12:08:44Z&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;iso8601_basic&quot;</span><span class="punctuation">:</span> <span class="string">&quot;20181025T120844109754&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;iso8601_basic_short&quot;</span><span class="punctuation">:</span> <span class="string">&quot;20181025T120844&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;iso8601_micro&quot;</span><span class="punctuation">:</span> <span class="string">&quot;2018-10-25T12:08:44.109968Z&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;minute&quot;</span><span class="punctuation">:</span> <span class="string">&quot;08&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;month&quot;</span><span class="punctuation">:</span> <span class="string">&quot;10&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;second&quot;</span><span class="punctuation">:</span> <span class="string">&quot;44&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;time&quot;</span><span class="punctuation">:</span> <span class="string">&quot;12:08:44&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;tz&quot;</span><span class="punctuation">:</span> <span class="string">&quot;UTC&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;tz_offset&quot;</span><span class="punctuation">:</span> <span class="string">&quot;+0000&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;weekday&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Thursday&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;weekday_number&quot;</span><span class="punctuation">:</span> <span class="string">&quot;4&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;weeknumber&quot;</span><span class="punctuation">:</span> <span class="string">&quot;43&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;year&quot;</span><span class="punctuation">:</span> <span class="string">&quot;2018&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ansible_default_ipv4&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;address&quot;</span><span class="punctuation">:</span> <span class="string">&quot;REDACTED&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;alias&quot;</span><span class="punctuation">:</span> <span class="string">&quot;eth0&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;broadcast&quot;</span><span class="punctuation">:</span> <span class="string">&quot;REDACTED&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;gateway&quot;</span><span class="punctuation">:</span> <span class="string">&quot;REDACTED&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;interface&quot;</span><span class="punctuation">:</span> <span class="string">&quot;eth0&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;macaddress&quot;</span><span class="punctuation">:</span> <span class="string">&quot;REDACTED&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;mtu&quot;</span><span class="punctuation">:</span> <span class="number">1500</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;netmask&quot;</span><span class="punctuation">:</span> <span class="string">&quot;255.255.255.0&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;network&quot;</span><span class="punctuation">:</span> <span class="string">&quot;REDACTED&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;ether&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ansible_default_ipv6&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ansible_device_links&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;ids&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;labels&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;xvda1&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                <span class="string">&quot;cloudimg-rootfs&quot;</span></span><br><span class="line">            <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;xvdd&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                <span class="string">&quot;config-2&quot;</span></span><br><span class="line">            <span class="punctuation">]</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;masters&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;uuids&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;xvda1&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                <span class="string">&quot;cac81d61-d0f8-4b47-84aa-b48798239164&quot;</span></span><br><span class="line">            <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;xvdd&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                <span class="string">&quot;2018-10-25-12-05-57-00&quot;</span></span><br><span class="line">            <span class="punctuation">]</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ansible_devices&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;xvda&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;holders&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;host&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;links&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;ids&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;labels&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;masters&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;uuids&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">]</span></span><br><span class="line">            <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;model&quot;</span><span class="punctuation">:</span> <span class="keyword">null</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;partitions&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;xvda1&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                    <span class="attr">&quot;holders&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="attr">&quot;links&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                        <span class="attr">&quot;ids&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;labels&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                            <span class="string">&quot;cloudimg-rootfs&quot;</span></span><br><span class="line">                        <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;masters&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;uuids&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                            <span class="string">&quot;cac81d61-d0f8-4b47-84aa-b48798239164&quot;</span></span><br><span class="line">                        <span class="punctuation">]</span></span><br><span class="line">                    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="attr">&quot;sectors&quot;</span><span class="punctuation">:</span> <span class="string">&quot;83883999&quot;</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="attr">&quot;sectorsize&quot;</span><span class="punctuation">:</span> <span class="number">512</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="attr">&quot;size&quot;</span><span class="punctuation">:</span> <span class="string">&quot;40.00 GB&quot;</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="attr">&quot;start&quot;</span><span class="punctuation">:</span> <span class="string">&quot;2048&quot;</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="attr">&quot;uuid&quot;</span><span class="punctuation">:</span> <span class="string">&quot;cac81d61-d0f8-4b47-84aa-b48798239164&quot;</span></span><br><span class="line">                <span class="punctuation">&#125;</span></span><br><span class="line">            <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;removable&quot;</span><span class="punctuation">:</span> <span class="string">&quot;0&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;rotational&quot;</span><span class="punctuation">:</span> <span class="string">&quot;0&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;sas_address&quot;</span><span class="punctuation">:</span> <span class="keyword">null</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;sas_device_handle&quot;</span><span class="punctuation">:</span> <span class="keyword">null</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;scheduler_mode&quot;</span><span class="punctuation">:</span> <span class="string">&quot;deadline&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;sectors&quot;</span><span class="punctuation">:</span> <span class="string">&quot;83886080&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;sectorsize&quot;</span><span class="punctuation">:</span> <span class="string">&quot;512&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;size&quot;</span><span class="punctuation">:</span> <span class="string">&quot;40.00 GB&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;support_discard&quot;</span><span class="punctuation">:</span> <span class="string">&quot;0&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;vendor&quot;</span><span class="punctuation">:</span> <span class="keyword">null</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;virtual&quot;</span><span class="punctuation">:</span> <span class="number">1</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;xvdd&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;holders&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;host&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;links&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;ids&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;labels&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                    <span class="string">&quot;config-2&quot;</span></span><br><span class="line">                <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;masters&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;uuids&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                    <span class="string">&quot;2018-10-25-12-05-57-00&quot;</span></span><br><span class="line">                <span class="punctuation">]</span></span><br><span class="line">            <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;model&quot;</span><span class="punctuation">:</span> <span class="keyword">null</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;partitions&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;removable&quot;</span><span class="punctuation">:</span> <span class="string">&quot;0&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;rotational&quot;</span><span class="punctuation">:</span> <span class="string">&quot;0&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;sas_address&quot;</span><span class="punctuation">:</span> <span class="keyword">null</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;sas_device_handle&quot;</span><span class="punctuation">:</span> <span class="keyword">null</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;scheduler_mode&quot;</span><span class="punctuation">:</span> <span class="string">&quot;deadline&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;sectors&quot;</span><span class="punctuation">:</span> <span class="string">&quot;131072&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;sectorsize&quot;</span><span class="punctuation">:</span> <span class="string">&quot;512&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;size&quot;</span><span class="punctuation">:</span> <span class="string">&quot;64.00 MB&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;support_discard&quot;</span><span class="punctuation">:</span> <span class="string">&quot;0&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;vendor&quot;</span><span class="punctuation">:</span> <span class="keyword">null</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;virtual&quot;</span><span class="punctuation">:</span> <span class="number">1</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;xvde&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;holders&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;host&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;links&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;ids&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;labels&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;masters&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;uuids&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">]</span></span><br><span class="line">            <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;model&quot;</span><span class="punctuation">:</span> <span class="keyword">null</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;partitions&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;xvde1&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                    <span class="attr">&quot;holders&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="attr">&quot;links&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">                        <span class="attr">&quot;ids&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;labels&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;masters&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">                        <span class="attr">&quot;uuids&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="punctuation">]</span></span><br><span class="line">                    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="attr">&quot;sectors&quot;</span><span class="punctuation">:</span> <span class="string">&quot;167770112&quot;</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="attr">&quot;sectorsize&quot;</span><span class="punctuation">:</span> <span class="number">512</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="attr">&quot;size&quot;</span><span class="punctuation">:</span> <span class="string">&quot;80.00 GB&quot;</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="attr">&quot;start&quot;</span><span class="punctuation">:</span> <span class="string">&quot;2048&quot;</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="attr">&quot;uuid&quot;</span><span class="punctuation">:</span> <span class="keyword">null</span></span><br><span class="line">                <span class="punctuation">&#125;</span></span><br><span class="line">            <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;removable&quot;</span><span class="punctuation">:</span> <span class="string">&quot;0&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;rotational&quot;</span><span class="punctuation">:</span> <span class="string">&quot;0&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;sas_address&quot;</span><span class="punctuation">:</span> <span class="keyword">null</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;sas_device_handle&quot;</span><span class="punctuation">:</span> <span class="keyword">null</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;scheduler_mode&quot;</span><span class="punctuation">:</span> <span class="string">&quot;deadline&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;sectors&quot;</span><span class="punctuation">:</span> <span class="string">&quot;167772160&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;sectorsize&quot;</span><span class="punctuation">:</span> <span class="string">&quot;512&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;size&quot;</span><span class="punctuation">:</span> <span class="string">&quot;80.00 GB&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;support_discard&quot;</span><span class="punctuation">:</span> <span class="string">&quot;0&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;vendor&quot;</span><span class="punctuation">:</span> <span class="keyword">null</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;virtual&quot;</span><span class="punctuation">:</span> <span class="number">1</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ansible_distribution&quot;</span><span class="punctuation">:</span> <span class="string">&quot;CentOS&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ansible_distribution_file_parsed&quot;</span><span class="punctuation">:</span> <span class="keyword">true</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ansible_distribution_file_path&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/etc/redhat-release&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ansible_distribution_file_variety&quot;</span><span class="punctuation">:</span> <span class="string">&quot;RedHat&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ansible_distribution_major_version&quot;</span><span class="punctuation">:</span> <span class="string">&quot;7&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ansible_distribution_release&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Core&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ansible_distribution_version&quot;</span><span class="punctuation">:</span> <span class="string">&quot;7.5.1804&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ansible_dns&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;nameservers&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">            <span class="string">&quot;127.0.0.1&quot;</span></span><br><span class="line">        <span class="punctuation">]</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ansible_domain&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ansible_effective_group_id&quot;</span><span class="punctuation">:</span> <span class="number">1000</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ansible_effective_user_id&quot;</span><span class="punctuation">:</span> <span class="number">1000</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ansible_env&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;HOME&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/home/zuul&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;LANG&quot;</span><span class="punctuation">:</span> <span class="string">&quot;en_US.UTF-8&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;LESSOPEN&quot;</span><span class="punctuation">:</span> <span class="string">&quot;||/usr/bin/lesspipe.sh %s&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;LOGNAME&quot;</span><span class="punctuation">:</span> <span class="string">&quot;zuul&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;MAIL&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/var/mail/zuul&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;PATH&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/usr/local/bin:/usr/bin&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;PWD&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/home/zuul&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;SELINUX_LEVEL_REQUESTED&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;SELINUX_ROLE_REQUESTED&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;SELINUX_USE_CURRENT_RANGE&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;SHELL&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/bin/bash&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;SHLVL&quot;</span><span class="punctuation">:</span> <span class="string">&quot;2&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;SSH_CLIENT&quot;</span><span class="punctuation">:</span> <span class="string">&quot;23.253.245.60 55672 22&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;SSH_CONNECTION&quot;</span><span class="punctuation">:</span> <span class="string">&quot;23.253.245.60 55672 104.130.127.149 22&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;USER&quot;</span><span class="punctuation">:</span> <span class="string">&quot;zuul&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;XDG_RUNTIME_DIR&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/run/user/1000&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;XDG_SESSION_ID&quot;</span><span class="punctuation">:</span> <span class="string">&quot;1&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;_&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/usr/bin/python2&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ansible_eth0&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;active&quot;</span><span class="punctuation">:</span> <span class="keyword">true</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;device&quot;</span><span class="punctuation">:</span> <span class="string">&quot;eth0&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;ipv4&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;address&quot;</span><span class="punctuation">:</span> <span class="string">&quot;REDACTED&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;broadcast&quot;</span><span class="punctuation">:</span> <span class="string">&quot;REDACTED&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;netmask&quot;</span><span class="punctuation">:</span> <span class="string">&quot;255.255.255.0&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;network&quot;</span><span class="punctuation">:</span> <span class="string">&quot;REDACTED&quot;</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;ipv6&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">            <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;address&quot;</span><span class="punctuation">:</span> <span class="string">&quot;REDACTED&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;prefix&quot;</span><span class="punctuation">:</span> <span class="string">&quot;64&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;scope&quot;</span><span class="punctuation">:</span> <span class="string">&quot;link&quot;</span></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;macaddress&quot;</span><span class="punctuation">:</span> <span class="string">&quot;REDACTED&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;module&quot;</span><span class="punctuation">:</span> <span class="string">&quot;xen_netfront&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;mtu&quot;</span><span class="punctuation">:</span> <span class="number">1500</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;pciid&quot;</span><span class="punctuation">:</span> <span class="string">&quot;vif-0&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;promisc&quot;</span><span class="punctuation">:</span> <span class="keyword">false</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;ether&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ansible_eth1&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;active&quot;</span><span class="punctuation">:</span> <span class="keyword">true</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;device&quot;</span><span class="punctuation">:</span> <span class="string">&quot;eth1&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;ipv4&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;address&quot;</span><span class="punctuation">:</span> <span class="string">&quot;REDACTED&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;broadcast&quot;</span><span class="punctuation">:</span> <span class="string">&quot;REDACTED&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;netmask&quot;</span><span class="punctuation">:</span> <span class="string">&quot;255.255.224.0&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;network&quot;</span><span class="punctuation">:</span> <span class="string">&quot;REDACTED&quot;</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;ipv6&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">            <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;address&quot;</span><span class="punctuation">:</span> <span class="string">&quot;REDACTED&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;prefix&quot;</span><span class="punctuation">:</span> <span class="string">&quot;64&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;scope&quot;</span><span class="punctuation">:</span> <span class="string">&quot;link&quot;</span></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;macaddress&quot;</span><span class="punctuation">:</span> <span class="string">&quot;REDACTED&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;module&quot;</span><span class="punctuation">:</span> <span class="string">&quot;xen_netfront&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;mtu&quot;</span><span class="punctuation">:</span> <span class="number">1500</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;pciid&quot;</span><span class="punctuation">:</span> <span class="string">&quot;vif-1&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;promisc&quot;</span><span class="punctuation">:</span> <span class="keyword">false</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;ether&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ansible_fips&quot;</span><span class="punctuation">:</span> <span class="keyword">false</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ansible_form_factor&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Other&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ansible_fqdn&quot;</span><span class="punctuation">:</span> <span class="string">&quot;centos-7-rax-dfw-0003427354&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ansible_hostname&quot;</span><span class="punctuation">:</span> <span class="string">&quot;centos-7-rax-dfw-0003427354&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ansible_interfaces&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="string">&quot;lo&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="string">&quot;eth1&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="string">&quot;eth0&quot;</span></span><br><span class="line">    <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ansible_is_chroot&quot;</span><span class="punctuation">:</span> <span class="keyword">false</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ansible_kernel&quot;</span><span class="punctuation">:</span> <span class="string">&quot;3.10.0-862.14.4.el7.x86_64&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ansible_lo&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;active&quot;</span><span class="punctuation">:</span> <span class="keyword">true</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;device&quot;</span><span class="punctuation">:</span> <span class="string">&quot;lo&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;ipv4&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;address&quot;</span><span class="punctuation">:</span> <span class="string">&quot;127.0.0.1&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;broadcast&quot;</span><span class="punctuation">:</span> <span class="string">&quot;host&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;netmask&quot;</span><span class="punctuation">:</span> <span class="string">&quot;255.0.0.0&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;network&quot;</span><span class="punctuation">:</span> <span class="string">&quot;127.0.0.0&quot;</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;ipv6&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">            <span class="punctuation">&#123;</span></span><br><span class="line">                <span class="attr">&quot;address&quot;</span><span class="punctuation">:</span> <span class="string">&quot;::1&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;prefix&quot;</span><span class="punctuation">:</span> <span class="string">&quot;128&quot;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="attr">&quot;scope&quot;</span><span class="punctuation">:</span> <span class="string">&quot;host&quot;</span></span><br><span class="line">            <span class="punctuation">&#125;</span></span><br><span class="line">        <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;mtu&quot;</span><span class="punctuation">:</span> <span class="number">65536</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;promisc&quot;</span><span class="punctuation">:</span> <span class="keyword">false</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;loopback&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ansible_local&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span><span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ansible_lsb&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;codename&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Core&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;description&quot;</span><span class="punctuation">:</span> <span class="string">&quot;CentOS Linux release 7.5.1804 (Core)&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;CentOS&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;major_release&quot;</span><span class="punctuation">:</span> <span class="string">&quot;7&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;release&quot;</span><span class="punctuation">:</span> <span class="string">&quot;7.5.1804&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ansible_machine&quot;</span><span class="punctuation">:</span> <span class="string">&quot;x86_64&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ansible_machine_id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;2db133253c984c82aef2fafcce6f2bed&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ansible_memfree_mb&quot;</span><span class="punctuation">:</span> <span class="number">7709</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ansible_memory_mb&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;nocache&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;free&quot;</span><span class="punctuation">:</span> <span class="number">7804</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;used&quot;</span><span class="punctuation">:</span> <span class="number">173</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;real&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;free&quot;</span><span class="punctuation">:</span> <span class="number">7709</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;total&quot;</span><span class="punctuation">:</span> <span class="number">7977</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;used&quot;</span><span class="punctuation">:</span> <span class="number">268</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;swap&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;cached&quot;</span><span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;free&quot;</span><span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;total&quot;</span><span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;used&quot;</span><span class="punctuation">:</span> <span class="number">0</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ansible_memtotal_mb&quot;</span><span class="punctuation">:</span> <span class="number">7977</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ansible_mounts&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;block_available&quot;</span><span class="punctuation">:</span> <span class="number">7220998</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;block_size&quot;</span><span class="punctuation">:</span> <span class="number">4096</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;block_total&quot;</span><span class="punctuation">:</span> <span class="number">9817227</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;block_used&quot;</span><span class="punctuation">:</span> <span class="number">2596229</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;device&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/dev/xvda1&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;fstype&quot;</span><span class="punctuation">:</span> <span class="string">&quot;ext4&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;inode_available&quot;</span><span class="punctuation">:</span> <span class="number">10052341</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;inode_total&quot;</span><span class="punctuation">:</span> <span class="number">10419200</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;inode_used&quot;</span><span class="punctuation">:</span> <span class="number">366859</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;mount&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;options&quot;</span><span class="punctuation">:</span> <span class="string">&quot;rw,seclabel,relatime,data=ordered&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;size_available&quot;</span><span class="punctuation">:</span> <span class="number">29577207808</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;size_total&quot;</span><span class="punctuation">:</span> <span class="number">40211361792</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;uuid&quot;</span><span class="punctuation">:</span> <span class="string">&quot;cac81d61-d0f8-4b47-84aa-b48798239164&quot;</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;block_available&quot;</span><span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;block_size&quot;</span><span class="punctuation">:</span> <span class="number">2048</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;block_total&quot;</span><span class="punctuation">:</span> <span class="number">252</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;block_used&quot;</span><span class="punctuation">:</span> <span class="number">252</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;device&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/dev/xvdd&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;fstype&quot;</span><span class="punctuation">:</span> <span class="string">&quot;iso9660&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;inode_available&quot;</span><span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;inode_total&quot;</span><span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;inode_used&quot;</span><span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;mount&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/mnt/config&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;options&quot;</span><span class="punctuation">:</span> <span class="string">&quot;ro,relatime,mode=0700&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;size_available&quot;</span><span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;size_total&quot;</span><span class="punctuation">:</span> <span class="number">516096</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;uuid&quot;</span><span class="punctuation">:</span> <span class="string">&quot;2018-10-25-12-05-57-00&quot;</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line">    <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ansible_nodename&quot;</span><span class="punctuation">:</span> <span class="string">&quot;centos-7-rax-dfw-0003427354&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ansible_os_family&quot;</span><span class="punctuation">:</span> <span class="string">&quot;RedHat&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ansible_pkg_mgr&quot;</span><span class="punctuation">:</span> <span class="string">&quot;yum&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ansible_processor&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="string">&quot;0&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="string">&quot;GenuineIntel&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="string">&quot;Intel(R) Xeon(R) CPU E5-2670 0 @ 2.60GHz&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="string">&quot;1&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="string">&quot;GenuineIntel&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="string">&quot;Intel(R) Xeon(R) CPU E5-2670 0 @ 2.60GHz&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="string">&quot;2&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="string">&quot;GenuineIntel&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="string">&quot;Intel(R) Xeon(R) CPU E5-2670 0 @ 2.60GHz&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="string">&quot;3&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="string">&quot;GenuineIntel&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="string">&quot;Intel(R) Xeon(R) CPU E5-2670 0 @ 2.60GHz&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="string">&quot;4&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="string">&quot;GenuineIntel&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="string">&quot;Intel(R) Xeon(R) CPU E5-2670 0 @ 2.60GHz&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="string">&quot;5&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="string">&quot;GenuineIntel&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="string">&quot;Intel(R) Xeon(R) CPU E5-2670 0 @ 2.60GHz&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="string">&quot;6&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="string">&quot;GenuineIntel&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="string">&quot;Intel(R) Xeon(R) CPU E5-2670 0 @ 2.60GHz&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="string">&quot;7&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="string">&quot;GenuineIntel&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="string">&quot;Intel(R) Xeon(R) CPU E5-2670 0 @ 2.60GHz&quot;</span></span><br><span class="line">    <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ansible_processor_cores&quot;</span><span class="punctuation">:</span> <span class="number">8</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ansible_processor_count&quot;</span><span class="punctuation">:</span> <span class="number">8</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ansible_processor_threads_per_core&quot;</span><span class="punctuation">:</span> <span class="number">1</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ansible_processor_vcpus&quot;</span><span class="punctuation">:</span> <span class="number">8</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ansible_product_name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;HVM domU&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ansible_product_serial&quot;</span><span class="punctuation">:</span> <span class="string">&quot;REDACTED&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ansible_product_uuid&quot;</span><span class="punctuation">:</span> <span class="string">&quot;REDACTED&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ansible_product_version&quot;</span><span class="punctuation">:</span> <span class="string">&quot;4.1.5&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ansible_python&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;executable&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/usr/bin/python2&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;has_sslcontext&quot;</span><span class="punctuation">:</span> <span class="keyword">true</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;CPython&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;version&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;major&quot;</span><span class="punctuation">:</span> <span class="number">2</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;micro&quot;</span><span class="punctuation">:</span> <span class="number">5</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;minor&quot;</span><span class="punctuation">:</span> <span class="number">7</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;releaselevel&quot;</span><span class="punctuation">:</span> <span class="string">&quot;final&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;serial&quot;</span><span class="punctuation">:</span> <span class="number">0</span></span><br><span class="line">        <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;version_info&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">            <span class="number">2</span><span class="punctuation">,</span></span><br><span class="line">            <span class="number">7</span><span class="punctuation">,</span></span><br><span class="line">            <span class="number">5</span><span class="punctuation">,</span></span><br><span class="line">            <span class="string">&quot;final&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="number">0</span></span><br><span class="line">        <span class="punctuation">]</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ansible_python_version&quot;</span><span class="punctuation">:</span> <span class="string">&quot;2.7.5&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ansible_real_group_id&quot;</span><span class="punctuation">:</span> <span class="number">1000</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ansible_real_user_id&quot;</span><span class="punctuation">:</span> <span class="number">1000</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ansible_selinux&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;config_mode&quot;</span><span class="punctuation">:</span> <span class="string">&quot;enforcing&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;mode&quot;</span><span class="punctuation">:</span> <span class="string">&quot;enforcing&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;policyvers&quot;</span><span class="punctuation">:</span> <span class="number">31</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;status&quot;</span><span class="punctuation">:</span> <span class="string">&quot;enabled&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;targeted&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ansible_selinux_python_present&quot;</span><span class="punctuation">:</span> <span class="keyword">true</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ansible_service_mgr&quot;</span><span class="punctuation">:</span> <span class="string">&quot;systemd&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ansible_ssh_host_key_ecdsa_public&quot;</span><span class="punctuation">:</span> <span class="string">&quot;REDACTED KEY VALUE&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ansible_ssh_host_key_ed25519_public&quot;</span><span class="punctuation">:</span> <span class="string">&quot;REDACTED KEY VALUE&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ansible_ssh_host_key_rsa_public&quot;</span><span class="punctuation">:</span> <span class="string">&quot;REDACTED KEY VALUE&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ansible_swapfree_mb&quot;</span><span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ansible_swaptotal_mb&quot;</span><span class="punctuation">:</span> <span class="number">0</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ansible_system&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Linux&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ansible_system_capabilities&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ansible_system_capabilities_enforced&quot;</span><span class="punctuation">:</span> <span class="string">&quot;True&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ansible_system_vendor&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Xen&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ansible_uptime_seconds&quot;</span><span class="punctuation">:</span> <span class="number">151</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ansible_user_dir&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/home/zuul&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ansible_user_gecos&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ansible_user_gid&quot;</span><span class="punctuation">:</span> <span class="number">1000</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ansible_user_id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;zuul&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ansible_user_shell&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/bin/bash&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ansible_user_uid&quot;</span><span class="punctuation">:</span> <span class="number">1000</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ansible_userspace_architecture&quot;</span><span class="punctuation">:</span> <span class="string">&quot;x86_64&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ansible_userspace_bits&quot;</span><span class="punctuation">:</span> <span class="string">&quot;64&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ansible_virtualization_role&quot;</span><span class="punctuation">:</span> <span class="string">&quot;guest&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;ansible_virtualization_type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;xen&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;gather_subset&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="string">&quot;all&quot;</span></span><br><span class="line">    <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;module_setup&quot;</span><span class="punctuation">:</span> <span class="keyword">true</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>
<p>在上面，第一个磁盘的模型可以在模板或剧本中引用为：</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123; <span class="string">ansible_facts</span>[<span class="string">&#x27;devices&#x27;</span>][<span class="string">&#x27;xvda&#x27;</span>][<span class="string">&#x27;model&#x27;</span>] &#125;&#125;</span><br></pre></td></tr></table></figure>
<p>同样，系统报告的主机名是：</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123; <span class="string">ansible_facts</span>[<span class="string">&#x27;nodename&#x27;</span>] &#125;&#125;</span><br></pre></td></tr></table></figure>
<p>Facts 经常用于<a target="_blank" rel="noopener" href="https://docs.ansible.com/ansible/latest/user_guide/playbooks_conditionals.html#playbooks-conditionals">条件（参见条件）</a>和模板中。</p>
<p>Facts 还可用于创建符合特定条件的动态主机组，有关详细信息，请参阅group_by上的导入模块文档，以及条件章节中讨论的通用条件语句。</p>
<h2 id="禁用Facts"><a href="#禁用Facts" class="headerlink" title="禁用Facts"></a>禁用Facts</h2><p>如果您知道自己不需要任何有关主机的事实数据，并且集中了解系统的所有信息，则可以关闭Facts收集。 这有利于在推送模式下使用大量系统扩展Ansible，主要是，或者如果您在实验平台上使用Ansible。 在任何play中，只需这样做：</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> <span class="attr">hosts:</span> <span class="string">whatever</span></span><br><span class="line">  <span class="attr">gather_facts:</span> <span class="literal">no</span></span><br></pre></td></tr></table></figure>


<h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><p><a target="_blank" rel="noopener" href="https://docs.ansible.com/ansible/latest/user_guide/playbooks_variables.html">https://docs.ansible.com/ansible/latest/user_guide&#x2F;playbooks_variables.html</a></p>

      
    </div> -->
          <div class="article-entry" itemprop="articleBody">
            
              
                
                      
                        
                          
                            
                              
                                
                                  
                                    <p>
                                      <p>虽然存在自动化以使事情更容易重复，但所有系统都不完全相同; 有些可能需要与其他配置略有不同的配置。 在某些情况下，观察到的一个系统的行为或状态可能会影响您配置其他系统的方式。 例如，您可能需要找出系统的IP地址，并将其用作另一个系统上的配置值。</p>

                                        <p>
                                          
                                            
                                              
                                                      
          </div>
    <p class="article-more-link">
      <a href="/2019/01/12/ansible/004-ansible-playbook-variables/#more">
        Read More
      </a>
    </p>
    <!-- <div class="article-more-link">
      <a href="/2019/01/12/ansible/004-ansible-playbook-variables/#more">
        read more
      </a>
    </div> -->
    


      <footer class="article-footer">
        <a data-url="http://jimolonely.github.io/2019/01/12/ansible/004-ansible-playbook-variables/" data-id="cl1fw7fi9001xvkd3hrjlhcwv" class="article-share-link">
          Share
        </a>
        
            
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ansible/" rel="tag">ansible</a><span class="article-tag-list-count">7</span></li></ul>

      </footer>
      </div>
      
</article>


  
    <article id="post-ansible/003-ansible-roles" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/01/10/ansible/003-ansible-roles/" class="article-date">
  <time datetime="2019-01-10T09:46:14.000Z" itemprop="datePublished">2019-01-10</time>
</a>
      
  </div>
  <div class="article-inner">
    
      
        <header class="article-header">
          
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/01/10/ansible/003-ansible-roles/">ansible 角色</a>
    </h1>
  

        </header>
        
          <!-- <div class="article-entry" itemprop="articleBody">
      
        <p>角色是什么，看了再来说。</p>
<h1 id="角色目录结构"><a href="#角色目录结构" class="headerlink" title="角色目录结构"></a>角色目录结构</h1><p>下面是一个例子：</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">site.yml</span></span><br><span class="line"><span class="string">webservers.yml</span></span><br><span class="line"><span class="string">fooservers.yml</span></span><br><span class="line"><span class="string">roles/</span></span><br><span class="line">   <span class="string">common/</span></span><br><span class="line">     <span class="string">tasks/</span></span><br><span class="line">     <span class="string">handlers/</span></span><br><span class="line">     <span class="string">files/</span></span><br><span class="line">     <span class="string">templates/</span></span><br><span class="line">     <span class="string">vars/</span></span><br><span class="line">     <span class="string">defaults/</span></span><br><span class="line">     <span class="string">meta/</span></span><br><span class="line">   <span class="string">webservers/</span></span><br><span class="line">     <span class="string">tasks/</span></span><br><span class="line">     <span class="string">defaults/</span></span><br><span class="line">     <span class="string">meta/</span></span><br></pre></td></tr></table></figure>
<p>角色期望文件位于某些目录名称中。 必须至少包含其中一个目录，但是排除任何未使用的目录是完全正确的。 在使用时，每个目录必须包含一个main.yml文件，其中包含相关内容：</p>
<ol>
<li>tasks: 该角色执行的任务</li>
<li>handlers： 可用于任何地方的handlers</li>
<li>defaults： 该角色的默认变量</li>
<li>vars： 该角色的其他变量</li>
<li>files： 包括可被该角色部署的文件</li>
<li>templates： 可被该角色部署的模板</li>
<li>meta： 元数据</li>
</ol>
<p>其他YAML文件可能包含在某些目录中。 例如，通常的做法是从<code>tasks / main.yml</code>文件中包含特定于平台的任务：</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># roles/example/tasks/main.yml</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">name:</span> <span class="string">added</span> <span class="string">in</span> <span class="number">2.4</span><span class="string">,</span> <span class="string">previously</span> <span class="string">you</span> <span class="string">used</span> <span class="string">&#x27;include&#x27;</span></span><br><span class="line">  <span class="attr">import_tasks:</span> <span class="string">redhat.yml</span></span><br><span class="line">  <span class="attr">when:</span> <span class="string">ansible_facts[&#x27;os_family&#x27;]|lower</span> <span class="string">==</span> <span class="string">&#x27;redhat&#x27;</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">import_tasks:</span> <span class="string">debian.yml</span></span><br><span class="line">  <span class="attr">when:</span> <span class="string">ansible_facts[&#x27;os_family&#x27;]|lower</span> <span class="string">==</span> <span class="string">&#x27;debian&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># roles/example/tasks/redhat.yml</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">yum:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">&quot;httpd&quot;</span></span><br><span class="line">    <span class="attr">state:</span> <span class="string">present</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># roles/example/tasks/debian.yml</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">apt:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">&quot;apache2&quot;</span></span><br><span class="line">    <span class="attr">state:</span> <span class="string">present</span></span><br></pre></td></tr></table></figure>
<h1 id="使用角色"><a href="#使用角色" class="headerlink" title="使用角色"></a>使用角色</h1><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">hosts:</span> <span class="string">webservers</span></span><br><span class="line">  <span class="attr">roles:</span></span><br><span class="line">     <span class="bullet">-</span> <span class="string">common</span></span><br><span class="line">     <span class="bullet">-</span> <span class="string">webservers</span></span><br></pre></td></tr></table></figure>

<p>对于每个角色<code>&#39;x&#39;</code>定义了以下行为：</p>
<ol>
<li>如果存在<code>roles / x / tasks / main.yml</code>，则其中列出的任务将添加到play中。</li>
<li>如果存在<code>roles / x / handlers / main.yml</code>，则其中列出的处理程序将添加到play中。</li>
<li>如果存在roles &#x2F; x &#x2F; vars &#x2F; main.yml，则其中列出的变量将添加到play中。</li>
<li>如果存在roles &#x2F; x &#x2F; defaults &#x2F; main.yml，则其中列出的变量将添加到play中。</li>
<li>如果存在roles &#x2F; x &#x2F; meta &#x2F; main.yml，则其中列出的任何角色依赖项将添加到角色列表（1.3及更高版本）。</li>
<li>任何copy，script，template或include task（在角色中）都可以引用<code>roles / x / &#123;files，templates，tasks&#125; /（dir取决于任务）</code>中的文件，而无需相对或绝对地路径化它们。</li>
</ol>
<p>以这种方式使用时，剧本的执行顺序如下：</p>
<ol>
<li>play中定义的任何pre_tasks。</li>
<li>到目前为止触发的任何处理程序都将运行。</li>
<li>角色中列出的每个角色将依次执行。 角色meta &#x2F; main.yml中定义的任何角色依赖关系都将首先运行，受标签过滤和条件限制。</li>
<li>play中定义的任何任务。</li>
<li>到目前为止触发的任何处理程序都将运行。</li>
<li>play中定义的任何post_tasks。</li>
<li>到目前为止触发的任何处理程序都将运行。</li>
</ol>
<p>从Ansible 2.4开始，可以使用import_role或include_role将角色与任何其他任务内联使用：</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">hosts:</span> <span class="string">webservers</span></span><br><span class="line">  <span class="attr">tasks:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">debug:</span></span><br><span class="line">      <span class="attr">msg:</span> <span class="string">&quot;before we run our role&quot;</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">import_role:</span></span><br><span class="line">      <span class="attr">name:</span> <span class="string">example</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">include_role:</span></span><br><span class="line">      <span class="attr">name:</span> <span class="string">example</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">debug:</span></span><br><span class="line">      <span class="attr">msg:</span> <span class="string">&quot;after we ran our role&quot;</span></span><br></pre></td></tr></table></figure>
<p>角色名字可以是一个简单的名字，也可以是完整的路径：</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">hosts:</span> <span class="string">webservers</span></span><br><span class="line">  <span class="attr">roles:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">role:</span> <span class="string">&#x27;/path/to/my/roles/common&#x27;</span></span><br></pre></td></tr></table></figure>
<p>角色可以接受其他关键字：</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">hosts:</span> <span class="string">webservers</span></span><br><span class="line">  <span class="attr">roles:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">common</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">role:</span> <span class="string">foo_app_instance</span></span><br><span class="line">      <span class="attr">vars:</span></span><br><span class="line">         <span class="attr">dir:</span> <span class="string">&#x27;/opt/a&#x27;</span></span><br><span class="line">         <span class="attr">app_port:</span> <span class="number">5000</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">role:</span> <span class="string">foo_app_instance</span></span><br><span class="line">      <span class="attr">vars:</span></span><br><span class="line">         <span class="attr">dir:</span> <span class="string">&#x27;/opt/b&#x27;</span></span><br><span class="line">         <span class="attr">app_port:</span> <span class="number">5001</span></span><br></pre></td></tr></table></figure>
<p>或者使用新的语法：</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">hosts:</span> <span class="string">webservers</span></span><br><span class="line">  <span class="attr">tasks:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">include_role:</span></span><br><span class="line">       <span class="attr">name:</span> <span class="string">foo_app_instance</span></span><br><span class="line">    <span class="attr">vars:</span></span><br><span class="line">      <span class="attr">dir:</span> <span class="string">&#x27;/opt/a&#x27;</span></span><br><span class="line">      <span class="attr">app_port:</span> <span class="number">5000</span></span><br><span class="line">  <span class="string">...</span></span><br></pre></td></tr></table></figure>
<p>也可以有条件的执行某个任务：</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">hosts:</span> <span class="string">webservers</span></span><br><span class="line">  <span class="attr">tasks:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">include_role:</span></span><br><span class="line">      <span class="attr">name:</span> <span class="string">some_role</span></span><br><span class="line">    <span class="attr">when:</span> <span class="string">&quot;ansible_facts[&#x27;os_family&#x27;] == &#x27;RedHat&#x27;&quot;</span></span><br></pre></td></tr></table></figure>
<p>最后，你可以在角色内将tag赋给任务：</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">hosts:</span> <span class="string">webservers</span></span><br><span class="line">  <span class="attr">roles:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">role:</span> <span class="string">bar</span></span><br><span class="line">      <span class="attr">tags:</span> [<span class="string">&quot;foo&quot;</span>]</span><br><span class="line">    <span class="comment"># using YAML shorthand, this is equivalent to the above</span></span><br><span class="line">    <span class="bullet">-</span> &#123; <span class="attr">role:</span> <span class="string">foo</span>, <span class="attr">tags:</span> [<span class="string">&quot;bar&quot;</span>, <span class="string">&quot;baz&quot;</span>] &#125;</span><br></pre></td></tr></table></figure>
<p>新的语法：</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">hosts:</span> <span class="string">webservers</span></span><br><span class="line">  <span class="attr">tasks:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">import_role:</span></span><br><span class="line">      <span class="attr">name:</span> <span class="string">foo</span></span><br><span class="line">    <span class="attr">tags:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">bar</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">baz</span></span><br></pre></td></tr></table></figure>

<h1 id="角色重复和执行"><a href="#角色重复和执行" class="headerlink" title="角色重复和执行"></a>角色重复和执行</h1><p>角色只会被执行一次，尽管被定义多次：</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">hosts:</span> <span class="string">webservers</span></span><br><span class="line">  <span class="attr">roles:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">foo</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">foo</span></span><br></pre></td></tr></table></figure>
<p>要想运行多次，有2个办法：</p>
<ol>
<li>给每次执行传递不同的参数</li>
<li>在<code>meta/main.yml</code>里给角色声明<code>allow_duplicates: true</code></li>
</ol>
<p>例1：</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">hosts:</span> <span class="string">webservers</span></span><br><span class="line">  <span class="attr">roles:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">role:</span> <span class="string">foo</span></span><br><span class="line">    <span class="attr">vars:</span></span><br><span class="line">         <span class="attr">message:</span> <span class="string">&quot;first&quot;</span></span><br><span class="line">  <span class="bullet">-</span> &#123; <span class="attr">role:</span> <span class="string">foo</span>, <span class="attr">vars:</span> &#123; <span class="attr">message:</span> <span class="string">&quot;second&quot;</span> &#125; &#125;</span><br></pre></td></tr></table></figure>
<p>例2：</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># playbook.yml</span></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">hosts:</span> <span class="string">webservers</span></span><br><span class="line">  <span class="attr">roles:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">foo</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">foo</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># roles/foo/meta/main.yml</span></span><br><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">allow_duplicates:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure>

<h1 id="角色默认变量"><a href="#角色默认变量" class="headerlink" title="角色默认变量"></a>角色默认变量</h1><p>版本1.3中的新功能。</p>
<p>角色默认变量允许您为包含或相关角色设置默认变量（参见下文）。 要创建默认值，只需在角色目录中添加defaults &#x2F; main.yml文件即可。 这些变量将具有可用变量的最低优先级，并且可以被任何其他变量轻松覆盖，包括库存变量。</p>
<h1 id="角色依赖"><a href="#角色依赖" class="headerlink" title="角色依赖"></a>角色依赖</h1><p>版本1.3中的新功能。</p>
<p>角色依赖性允许您在使用角色时自动引入其他角色。 角色依赖关系存储在角色目录中包含的meta &#x2F; main.yml文件中，如上所述。 此文件应包含要在指定角色之前插入的角色和参数列表，例如示例roles &#x2F; myapp &#x2F; meta &#x2F; main.yml中的以下内容：</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">dependencies:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">role:</span> <span class="string">common</span></span><br><span class="line">    <span class="attr">vars:</span></span><br><span class="line">      <span class="attr">some_parameter:</span> <span class="number">3</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">role:</span> <span class="string">apache</span></span><br><span class="line">    <span class="attr">vars:</span></span><br><span class="line">      <span class="attr">apache_port:</span> <span class="number">80</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">role:</span> <span class="string">postgres</span></span><br><span class="line">    <span class="attr">vars:</span></span><br><span class="line">      <span class="attr">dbname:</span> <span class="string">blarg</span></span><br><span class="line">      <span class="attr">other_parameter:</span> <span class="number">12</span></span><br></pre></td></tr></table></figure>
<p>角色依赖始终在包含它们的角色之前执行，并且可以是递归的。 依赖关系也遵循上面指定的复制规则。 如果另一个角色也将其列为依赖项，则不会根据上面给出的相同规则再次运行它。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">永远记住，当使用allow_duplicates：true时，它需要在依赖角色meta / main.yml中，而不是父级。</span><br></pre></td></tr></table></figure>
<p>例如，一个car角色依赖4个轮子：</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">dependencies:</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">role:</span> <span class="string">wheel</span></span><br><span class="line">  <span class="attr">vars:</span></span><br><span class="line">     <span class="attr">n:</span> <span class="number">1</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">role:</span> <span class="string">wheel</span></span><br><span class="line">  <span class="attr">vars:</span></span><br><span class="line">     <span class="attr">n:</span> <span class="number">2</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">role:</span> <span class="string">wheel</span></span><br><span class="line">  <span class="attr">vars:</span></span><br><span class="line">     <span class="attr">n:</span> <span class="number">3</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">role:</span> <span class="string">wheel</span></span><br><span class="line">  <span class="attr">vars:</span></span><br><span class="line">     <span class="attr">n:</span> <span class="number">4</span></span><br></pre></td></tr></table></figure>
<p>轮子的作用取决于两个角色：轮胎和刹车。 然后，wheel的meta &#x2F; main.yml将包含以下内容：</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">dependencies:</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">role:</span> <span class="string">tire</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">role:</span> <span class="string">brake</span></span><br></pre></td></tr></table></figure>
<p>那么轮胎和刹车就需要可以重复的声明：</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">allow_duplicates:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure>
<p>执行的顺序如下：</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">tire(n=1)</span></span><br><span class="line"><span class="string">brake(n=1)</span></span><br><span class="line"><span class="string">wheel(n=1)</span></span><br><span class="line"><span class="string">tire(n=2)</span></span><br><span class="line"><span class="string">brake(n=2)</span></span><br><span class="line"><span class="string">wheel(n=2)</span></span><br><span class="line"><span class="string">...</span></span><br><span class="line"><span class="string">car</span></span><br></pre></td></tr></table></figure>
<p>为什么wheel没有声明可重复呢？ 因为我们用了不同的参数呀！</p>
<h1 id="在角色中集成模块和插件"><a href="#在角色中集成模块和插件" class="headerlink" title="在角色中集成模块和插件"></a>在角色中集成模块和插件</h1><p>这是一个高级主题，与大多数用户无关。</p>
<p>如果您编写自定义模块（请参阅<a target="_blank" rel="noopener" href="https://docs.ansible.com/ansible/latest/dev_guide/developing_modules.html#developing-modules">开发模块</a>？）或插件（请参阅<a target="_blank" rel="noopener" href="https://docs.ansible.com/ansible/latest/dev_guide/developing_plugins.html#developing-plugins">开发插件</a>），您可能希望将其作为角色的一部分进行分发。 一般来说，Ansible作为一个项目非常有兴趣将高质量的模块纳入ansible核心，因此这不应该是常态，但它很容易做到。</p>
<p>一个很好的例子就是如果你在一家名为AcmeWidgets的公司工作，并编写了一个帮助配置内部软件的内部模块，并且你希望组织中的其他人能够轻松使用这个模块 - 但你不想告诉所有人 如何配置他们的Ansible库路径。</p>
<p>除了角色的“任务”和“处理程序”结构外，添加名为“library”的目录。 在这个’library’目录中，直接在其中包含模块。</p>
<p>假设你有这个：</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">roles/</span></span><br><span class="line">   <span class="string">my_custom_modules/</span></span><br><span class="line">       <span class="string">library/</span></span><br><span class="line">          <span class="string">module1</span></span><br><span class="line">          <span class="string">module2</span></span><br></pre></td></tr></table></figure>
<p>该模块可用于角色本身，以及在此角色之后调用的任何角色，如下所示：</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> <span class="attr">hosts:</span> <span class="string">webservers</span></span><br><span class="line">  <span class="attr">roles:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">my_custom_modules</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">some_other_role_using_my_custom_modules</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">yet_another_role_using_my_custom_modules</span></span><br></pre></td></tr></table></figure>
<p>在一些限制下，这也可用于修改Ansible核心发行版中的模块，例如在生产版本中发布之前使用模块的开发版本。 但这并不总是可取的，因为API签名可能会在核心组件中发生变化，但并不总能保证能够正常工作。 它可以是一种方便的方式来携带针对核心模块的补丁，但是，如果你有充分的理由这样做。 当然，项目希望通过拉取请求尽可能将贡献引导回github。</p>
<p>可以使用相同的机制使用相同的模式在一个角色中嵌入和分发插件。 例如，对于过滤器插件：</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">roles/</span></span><br><span class="line">   <span class="string">my_custom_filter/</span></span><br><span class="line">       <span class="string">filter_plugins</span></span><br><span class="line">          <span class="string">filter1</span></span><br><span class="line">          <span class="string">filter2</span></span><br></pre></td></tr></table></figure>
<p>然后可以在“my_custom_filter”之后调用的任何角色中使用模板或jinja模板。</p>
<h1 id="角色搜索路径"><a href="#角色搜索路径" class="headerlink" title="角色搜索路径"></a>角色搜索路径</h1><p>Ansible将以下列方式搜索角色：</p>
<ol>
<li>相对于playbook文件的<code>role/</code>目录。</li>
<li>默认情况下，在<code>/ etc / ansible / roles</code>中</li>
</ol>
<p>在Ansible 1.4及更高版本中，您可以配置其他roles_path来搜索角色。 使用此选项可以将所有常见角色放到一个位置，并在多个playbook项目之间轻松共享。 有关如何在ansible.cfg中进行设置的详细信息，请参阅<a target="_blank" rel="noopener" href="https://docs.ansible.com/ansible/latest/installation_guide/intro_configuration.html#intro-configuration">配置Ansible</a>。</p>
<h1 id="Ansible-Galaxy"><a href="#Ansible-Galaxy" class="headerlink" title="Ansible Galaxy"></a>Ansible Galaxy</h1><p>Ansible Galaxy是一个免费网站，用于查找，下载，评级和审查各种社区开发的Ansible角色，并且可以成为您自动化项目快速启动的绝佳方式。</p>
<p>客户端<code>ansible-galaxy</code>包含在Ansible中。 Galaxy客户端允许您从Ansible Galaxy下载角色，并且还提供了一个用于创建自己角色的出色默认框架。</p>
<p>阅读<a target="_blank" rel="noopener" href="https://galaxy.ansible.com/docs/">Ansible Galaxy文档</a>页面以获取更多信息</p>
<h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><p><a target="_blank" rel="noopener" href="https://docs.ansible.com/ansible/latest/user_guide/playbooks_reuse_roles.html#embedding-modules-and-plugins-in-roles">https://docs.ansible.com/ansible/latest/user_guide&#x2F;playbooks_reuse_roles.html#embedding-modules-and-plugins-in-roles</a></p>

      
    </div> -->
          <div class="article-entry" itemprop="articleBody">
            
              
                
                      
                        
                          
                            
                              
                                
                                  
                                    <p>
                                      <p>角色是什么，看了再来说。</p>

                                        <p>
                                          
                                            
                                              
                                                      
          </div>
    <p class="article-more-link">
      <a href="/2019/01/10/ansible/003-ansible-roles/#more">
        Read More
      </a>
    </p>
    <!-- <div class="article-more-link">
      <a href="/2019/01/10/ansible/003-ansible-roles/#more">
        read more
      </a>
    </div> -->
    


      <footer class="article-footer">
        <a data-url="http://jimolonely.github.io/2019/01/10/ansible/003-ansible-roles/" data-id="cl1fw7fi8001vvkd3d6b12qmq" class="article-share-link">
          Share
        </a>
        
            
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ansible/" rel="tag">ansible</a><span class="article-tag-list-count">7</span></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/linux/" rel="tag">linux</a><span class="article-tag-list-count">57</span></li></ul>

      </footer>
      </div>
      
</article>


  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/page/8/">&amp;laquo; 上一页</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/7/">7</a><a class="page-number" href="/page/8/">8</a><span class="page-number current">9</span><a class="page-number" href="/page/10/">10</a><a class="page-number" href="/page/11/">11</a><span class="space">&hellip;</span><a class="page-number" href="/page/18/">18</a><a class="extend next" rel="next" href="/page/10/">下一页 &amp;raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/AI/" rel="tag">AI</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/UI-test/" rel="tag">UI test</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/algorithm/" rel="tag">algorithm</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/android/" rel="tag">android</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/annotation/" rel="tag">annotation</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ansible/" rel="tag">ansible</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ant/" rel="tag">ant</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/aop/" rel="tag">aop</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/archiva/" rel="tag">archiva</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/asciidoc/" rel="tag">asciidoc</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/awk/" rel="tag">awk</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/axios/" rel="tag">axios</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/basic/" rel="tag">basic</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/big-data/" rel="tag">big data</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/blockchain/" rel="tag">blockchain</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/centos/" rel="tag">centos</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cglib/" rel="tag">cglib</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/checkstyle/" rel="tag">checkstyle</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/chrome/" rel="tag">chrome</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/computer-principle/" rel="tag">computer principle</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cors/" rel="tag">cors</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/data-structure/" rel="tag">data structure</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/design-pattern/" rel="tag">design-pattern</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/docker/" rel="tag">docker</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/elasticsearch/" rel="tag">elasticsearch</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/es/" rel="tag">es</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/eureka/" rel="tag">eureka</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/firefox/" rel="tag">firefox</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/flask/" rel="tag">flask</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/geohash/" rel="tag">geohash</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/geomesa/" rel="tag">geomesa</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/git/" rel="tag">git</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/gitlab/" rel="tag">gitlab</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/gradle/" rel="tag">gradle</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/groovy/" rel="tag">groovy</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hadoop/" rel="tag">hadoop</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hbase/" rel="tag">hbase</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hexo/" rel="tag">hexo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/html/" rel="tag">html</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/http/" rel="tag">http</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/idea/" rel="tag">idea</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ip/" rel="tag">ip</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/java/" rel="tag">java</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/javascript/" rel="tag">javascript</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/js/" rel="tag">js</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/junit/" rel="tag">junit</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jupyter/" rel="tag">jupyter</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jupyterhub/" rel="tag">jupyterhub</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jvm/" rel="tag">jvm</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jwt/" rel="tag">jwt</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/k8s/" rel="tag">k8s</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/kafka/" rel="tag">kafka</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/katalon/" rel="tag">katalon</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/keepalived/" rel="tag">keepalived</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/latex/" rel="tag">latex</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/life/" rel="tag">life</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux/" rel="tag">linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux-kernel/" rel="tag">linux kernel</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/load-balance/" rel="tag">load balance</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/log/" rel="tag">log</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/log4j/" rel="tag">log4j</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/log4j12/" rel="tag">log4j12</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/logback/" rel="tag">logback</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/lombok/" rel="tag">lombok</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/lru/" rel="tag">lru</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/lucene/" rel="tag">lucene</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/magnet/" rel="tag">magnet</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/make/" rel="tag">make</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/makefile/" rel="tag">makefile</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/manjaro/" rel="tag">manjaro</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/math/" rel="tag">math</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/maven/" rel="tag">maven</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/md5/" rel="tag">md5</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mhtml/" rel="tag">mhtml</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/microservice/" rel="tag">microservice</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/music/" rel="tag">music</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mybatis/" rel="tag">mybatis</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mysql/" rel="tag">mysql</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/nginx/" rel="tag">nginx</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/notebook/" rel="tag">notebook</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/npm/" rel="tag">npm</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/nvidia/" rel="tag">nvidia</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/oauth/" rel="tag">oauth</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/openstack/" rel="tag">openstack</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/optimization/" rel="tag">optimization</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/pandas/" rel="tag">pandas</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/pandoc/" rel="tag">pandoc</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/pgsql/" rel="tag">pgsql</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/probability/" rel="tag">probability</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/pyspark/" rel="tag">pyspark</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python/" rel="tag">python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/quartz/" rel="tag">quartz</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/react/" rel="tag">react</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/redis/" rel="tag">redis</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/resource/" rel="tag">resource</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/review/" rel="tag">review</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sbt/" rel="tag">sbt</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/scala/" rel="tag">scala</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/shell/" rel="tag">shell</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/slf4j/" rel="tag">slf4j</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/spark/" rel="tag">spark</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/spring/" rel="tag">spring</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/spring-cloud/" rel="tag">spring cloud</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/spring-boot/" rel="tag">spring-boot</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/springboot/" rel="tag">springboot</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sql/" rel="tag">sql</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sqlserver/" rel="tag">sqlserver</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ssh/" rel="tag">ssh</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/statistics/" rel="tag">statistics</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/syslog/" rel="tag">syslog</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/term/" rel="tag">term</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/test/" rel="tag">test</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/texlive/" rel="tag">texlive</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/thread/" rel="tag">thread</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tomcat/" rel="tag">tomcat</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tool/" rel="tag">tool</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ubuntu/" rel="tag">ubuntu</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/urban-computing/" rel="tag">urban computing</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/video/" rel="tag">video</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vim/" rel="tag">vim</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vpn/" rel="tag">vpn</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vscode/" rel="tag">vscode</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vue/" rel="tag">vue</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/web/" rel="tag">web</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/web-dav/" rel="tag">web-dav</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/webpack/" rel="tag">webpack</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/week/" rel="tag">week</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/windows/" rel="tag">windows</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/wordcloud/" rel="tag">wordcloud</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/work/" rel="tag">work</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/xml/" rel="tag">xml</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/zipkin/" rel="tag">zipkin</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/zookeeper/" rel="tag">zookeeper</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%BA%91%E8%AE%A1%E7%AE%97/" rel="tag">云计算</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%85%83%E7%BC%96%E7%A8%8B/" rel="tag">元编程</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%9F%8E%E5%B8%82%E8%AE%A1%E7%AE%97/" rel="tag">城市计算</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%9E%B6%E6%9E%84/" rel="tag">架构</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%A6%82%E5%BF%B5/" rel="tag">概念</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%B5%8B%E8%AF%95/" rel="tag">测试</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%88%AC%E8%99%AB/" rel="tag">爬虫</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%BF%90%E7%BB%B4/" rel="tag">运维</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签云</h3>
    <div class="widget tagcloud">
      <a href="/tags/AI/" style="font-size: 10.53px;">AI</a> <a href="/tags/UI-test/" style="font-size: 10px;">UI test</a> <a href="/tags/algorithm/" style="font-size: 10.53px;">algorithm</a> <a href="/tags/android/" style="font-size: 10.53px;">android</a> <a href="/tags/annotation/" style="font-size: 10px;">annotation</a> <a href="/tags/ansible/" style="font-size: 13.16px;">ansible</a> <a href="/tags/ant/" style="font-size: 10px;">ant</a> <a href="/tags/aop/" style="font-size: 10px;">aop</a> <a href="/tags/archiva/" style="font-size: 10px;">archiva</a> <a href="/tags/asciidoc/" style="font-size: 10px;">asciidoc</a> <a href="/tags/awk/" style="font-size: 10px;">awk</a> <a href="/tags/axios/" style="font-size: 10px;">axios</a> <a href="/tags/basic/" style="font-size: 13.16px;">basic</a> <a href="/tags/big-data/" style="font-size: 10.53px;">big data</a> <a href="/tags/blockchain/" style="font-size: 10px;">blockchain</a> <a href="/tags/centos/" style="font-size: 12.11px;">centos</a> <a href="/tags/cglib/" style="font-size: 10px;">cglib</a> <a href="/tags/checkstyle/" style="font-size: 10px;">checkstyle</a> <a href="/tags/chrome/" style="font-size: 11.05px;">chrome</a> <a href="/tags/computer-principle/" style="font-size: 10px;">computer principle</a> <a href="/tags/cors/" style="font-size: 10.53px;">cors</a> <a href="/tags/data-structure/" style="font-size: 10px;">data structure</a> <a href="/tags/design-pattern/" style="font-size: 10.53px;">design-pattern</a> <a href="/tags/docker/" style="font-size: 17.89px;">docker</a> <a href="/tags/elasticsearch/" style="font-size: 13.16px;">elasticsearch</a> <a href="/tags/es/" style="font-size: 10px;">es</a> <a href="/tags/eureka/" style="font-size: 10px;">eureka</a> <a href="/tags/firefox/" style="font-size: 10px;">firefox</a> <a href="/tags/flask/" style="font-size: 10px;">flask</a> <a href="/tags/geohash/" style="font-size: 10px;">geohash</a> <a href="/tags/geomesa/" style="font-size: 10px;">geomesa</a> <a href="/tags/git/" style="font-size: 13.16px;">git</a> <a href="/tags/gitlab/" style="font-size: 11.05px;">gitlab</a> <a href="/tags/gradle/" style="font-size: 10px;">gradle</a> <a href="/tags/groovy/" style="font-size: 10px;">groovy</a> <a href="/tags/hadoop/" style="font-size: 10.53px;">hadoop</a> <a href="/tags/hbase/" style="font-size: 11.58px;">hbase</a> <a href="/tags/hexo/" style="font-size: 10.53px;">hexo</a> <a href="/tags/html/" style="font-size: 10.53px;">html</a> <a href="/tags/http/" style="font-size: 10px;">http</a> <a href="/tags/idea/" style="font-size: 11.05px;">idea</a> <a href="/tags/ip/" style="font-size: 10px;">ip</a> <a href="/tags/java/" style="font-size: 20px;">java</a> <a href="/tags/javascript/" style="font-size: 11.58px;">javascript</a> <a href="/tags/js/" style="font-size: 13.16px;">js</a> <a href="/tags/junit/" style="font-size: 10px;">junit</a> <a href="/tags/jupyter/" style="font-size: 10px;">jupyter</a> <a href="/tags/jupyterhub/" style="font-size: 10.53px;">jupyterhub</a> <a href="/tags/jvm/" style="font-size: 10px;">jvm</a> <a href="/tags/jwt/" style="font-size: 10px;">jwt</a> <a href="/tags/k8s/" style="font-size: 11.05px;">k8s</a> <a href="/tags/kafka/" style="font-size: 10px;">kafka</a> <a href="/tags/katalon/" style="font-size: 10px;">katalon</a> <a href="/tags/keepalived/" style="font-size: 10.53px;">keepalived</a> <a href="/tags/latex/" style="font-size: 11.05px;">latex</a> <a href="/tags/life/" style="font-size: 18.95px;">life</a> <a href="/tags/linux/" style="font-size: 19.47px;">linux</a> <a href="/tags/linux-kernel/" style="font-size: 10px;">linux kernel</a> <a href="/tags/load-balance/" style="font-size: 10px;">load balance</a> <a href="/tags/log/" style="font-size: 10px;">log</a> <a href="/tags/log4j/" style="font-size: 10px;">log4j</a> <a href="/tags/log4j12/" style="font-size: 10px;">log4j12</a> <a href="/tags/logback/" style="font-size: 10px;">logback</a> <a href="/tags/lombok/" style="font-size: 10px;">lombok</a> <a href="/tags/lru/" style="font-size: 10px;">lru</a> <a href="/tags/lucene/" style="font-size: 10px;">lucene</a> <a href="/tags/magnet/" style="font-size: 10px;">magnet</a> <a href="/tags/make/" style="font-size: 10px;">make</a> <a href="/tags/makefile/" style="font-size: 10px;">makefile</a> <a href="/tags/manjaro/" style="font-size: 10px;">manjaro</a> <a href="/tags/math/" style="font-size: 11.05px;">math</a> <a href="/tags/maven/" style="font-size: 15.26px;">maven</a> <a href="/tags/md5/" style="font-size: 10px;">md5</a> <a href="/tags/mhtml/" style="font-size: 10px;">mhtml</a> <a href="/tags/microservice/" style="font-size: 14.21px;">microservice</a> <a href="/tags/music/" style="font-size: 10px;">music</a> <a href="/tags/mybatis/" style="font-size: 11.05px;">mybatis</a> <a href="/tags/mysql/" style="font-size: 12.11px;">mysql</a> <a href="/tags/nginx/" style="font-size: 12.63px;">nginx</a> <a href="/tags/notebook/" style="font-size: 10px;">notebook</a> <a href="/tags/npm/" style="font-size: 10px;">npm</a> <a href="/tags/nvidia/" style="font-size: 10px;">nvidia</a> <a href="/tags/oauth/" style="font-size: 10px;">oauth</a> <a href="/tags/openstack/" style="font-size: 12.11px;">openstack</a> <a href="/tags/optimization/" style="font-size: 10px;">optimization</a> <a href="/tags/pandas/" style="font-size: 10px;">pandas</a> <a href="/tags/pandoc/" style="font-size: 10px;">pandoc</a> <a href="/tags/pgsql/" style="font-size: 11.58px;">pgsql</a> <a href="/tags/probability/" style="font-size: 10px;">probability</a> <a href="/tags/pyspark/" style="font-size: 10px;">pyspark</a> <a href="/tags/python/" style="font-size: 17.37px;">python</a> <a href="/tags/quartz/" style="font-size: 10.53px;">quartz</a> <a href="/tags/react/" style="font-size: 10px;">react</a> <a href="/tags/redis/" style="font-size: 15.79px;">redis</a> <a href="/tags/resource/" style="font-size: 10px;">resource</a> <a href="/tags/review/" style="font-size: 10px;">review</a> <a href="/tags/sbt/" style="font-size: 10px;">sbt</a> <a href="/tags/scala/" style="font-size: 14.74px;">scala</a> <a href="/tags/shell/" style="font-size: 12.63px;">shell</a> <a href="/tags/slf4j/" style="font-size: 10px;">slf4j</a> <a href="/tags/spark/" style="font-size: 14.74px;">spark</a> <a href="/tags/spring/" style="font-size: 15.79px;">spring</a> <a href="/tags/spring-cloud/" style="font-size: 12.11px;">spring cloud</a> <a href="/tags/spring-boot/" style="font-size: 13.68px;">spring-boot</a> <a href="/tags/springboot/" style="font-size: 11.05px;">springboot</a> <a href="/tags/sql/" style="font-size: 11.05px;">sql</a> <a href="/tags/sqlserver/" style="font-size: 10.53px;">sqlserver</a> <a href="/tags/ssh/" style="font-size: 12.11px;">ssh</a> <a href="/tags/statistics/" style="font-size: 10px;">statistics</a> <a href="/tags/syslog/" style="font-size: 10px;">syslog</a> <a href="/tags/term/" style="font-size: 10px;">term</a> <a href="/tags/test/" style="font-size: 10px;">test</a> <a href="/tags/texlive/" style="font-size: 10px;">texlive</a> <a href="/tags/thread/" style="font-size: 10px;">thread</a> <a href="/tags/tomcat/" style="font-size: 13.16px;">tomcat</a> <a href="/tags/tool/" style="font-size: 16.84px;">tool</a> <a href="/tags/ubuntu/" style="font-size: 16.32px;">ubuntu</a> <a href="/tags/urban-computing/" style="font-size: 10px;">urban computing</a> <a href="/tags/video/" style="font-size: 10px;">video</a> <a href="/tags/vim/" style="font-size: 10.53px;">vim</a> <a href="/tags/vpn/" style="font-size: 10px;">vpn</a> <a href="/tags/vscode/" style="font-size: 10px;">vscode</a> <a href="/tags/vue/" style="font-size: 11.05px;">vue</a> <a href="/tags/web/" style="font-size: 10px;">web</a> <a href="/tags/web-dav/" style="font-size: 10px;">web-dav</a> <a href="/tags/webpack/" style="font-size: 10.53px;">webpack</a> <a href="/tags/week/" style="font-size: 18.42px;">week</a> <a href="/tags/windows/" style="font-size: 10px;">windows</a> <a href="/tags/wordcloud/" style="font-size: 10px;">wordcloud</a> <a href="/tags/work/" style="font-size: 10px;">work</a> <a href="/tags/xml/" style="font-size: 10px;">xml</a> <a href="/tags/zipkin/" style="font-size: 10px;">zipkin</a> <a href="/tags/zookeeper/" style="font-size: 10px;">zookeeper</a> <a href="/tags/%E4%BA%91%E8%AE%A1%E7%AE%97/" style="font-size: 12.63px;">云计算</a> <a href="/tags/%E5%85%83%E7%BC%96%E7%A8%8B/" style="font-size: 10px;">元编程</a> <a href="/tags/%E5%9F%8E%E5%B8%82%E8%AE%A1%E7%AE%97/" style="font-size: 10px;">城市计算</a> <a href="/tags/%E6%9E%B6%E6%9E%84/" style="font-size: 10px;">架构</a> <a href="/tags/%E6%A6%82%E5%BF%B5/" style="font-size: 10px;">概念</a> <a href="/tags/%E6%B5%8B%E8%AF%95/" style="font-size: 10px;">测试</a> <a href="/tags/%E7%88%AC%E8%99%AB/" style="font-size: 10px;">爬虫</a> <a href="/tags/%E8%BF%90%E7%BB%B4/" style="font-size: 10px;">运维</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/03/">三月 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/10/">十月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/09/">九月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/08/">八月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/07/">七月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/06/">六月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/05/">五月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/04/">四月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/03/">三月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/02/">二月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/01/">一月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">十二月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/11/">十一月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/10/">十月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/09/">九月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">八月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/07/">七月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/06/">六月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/05/">五月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/04/">四月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/03/">三月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/02/">二月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/01/">一月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/">十二月 2017</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2022/03/31/redis/000-redis-interview/">Redis面试总结202203</a>
          </li>
        
          <li>
            <a href="/2019/10/27/maven/009-maven-deploy/">使用IDEA部署jar包到maven仓库(maven deploy)</a>
          </li>
        
          <li>
            <a href="/2019/10/24/java/075-pluggable-annotation-processing-lombok/">Pluggable Annotation Processing的讲解与实践</a>
          </li>
        
          <li>
            <a href="/2019/10/18/life/036-weekly-learn/">2019-42-周报</a>
          </li>
        
          <li>
            <a href="/2019/10/15/shell/003-carriage-linechange/">r command not found</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2022 Jackpler<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">home</a>
  
    <a href="/archives" class="mobile-nav-link">archives</a>
  
    <a href="/about" class="mobile-nav-link">about</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>




  </div>
</body>
</html>