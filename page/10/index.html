<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-111673440-1', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->


  
  <title>在我的世界</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="who,where,what">
<meta property="og:type" content="website">
<meta property="og:title" content="在我的世界">
<meta property="og:url" content="http://http//jimolonely.github.io/page/10/index.html">
<meta property="og:site_name" content="在我的世界">
<meta property="og:description" content="who,where,what">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="Jackpler">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="在我的世界" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 6.1.0"><link rel="stylesheet" href="/css/prism-atom-dark.css" type="text/css">
<link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"><script src="/js/prism.js"></script>
<script src="/js/prism-line-numbers.min.js"></script></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">在我的世界</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">home</a>
        
          <a class="main-nav-link" href="/archives">archives</a>
        
          <a class="main-nav-link" href="/about">about</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="搜索"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://http://jimolonely.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-hadoop/004-frequently-hbase-shell-cmd" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/01/09/hadoop/004-frequently-hbase-shell-cmd/" class="article-date">
  <time datetime="2019-01-09T00:54:38.000Z" itemprop="datePublished">2019-01-09</time>
</a>
      
  </div>
  <div class="article-inner">
    
      
        <header class="article-header">
          
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/01/09/hadoop/004-frequently-hbase-shell-cmd/">常用的hbase shell命令</a>
    </h1>
  

        </header>
        
          <!-- <div class="article-entry" itemprop="articleBody">
      
        <p>本文记录一下经常在排查hbase问题时用到的 shell命令。</p>
<h1 id="list-查看有哪些表"><a href="#list-查看有哪些表" class="headerlink" title="list 查看有哪些表"></a>list 查看有哪些表</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">&gt; </span><span class="language-bash">list</span></span><br></pre></td></tr></table></figure>

<h1 id="查询起始行"><a href="#查询起始行" class="headerlink" title="查询起始行"></a>查询起始行</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">&gt; </span><span class="language-bash">scan <span class="string">&#x27;table&#x27;</span> , &#123; STARTROW=&gt;<span class="string">&#x27;&#x27;</span>, ENDROW=&gt;<span class="string">&#x27;&#x27;</span>, LIMIT=&gt;5 &#125;</span></span><br></pre></td></tr></table></figure>



      
    </div> -->
          <div class="article-entry" itemprop="articleBody">
            
              
                
                      
                        
                          
                            
                              
                                
                                  
                                    <p>
                                      <p>本文记录一下经常在排查hbase问题时用到的 shell命令。</p>

                                        <p>
                                          
                                            
                                              
                                                      
          </div>
    <p class="article-more-link">
      <a href="/2019/01/09/hadoop/004-frequently-hbase-shell-cmd/#more">
        Read More
      </a>
    </p>
    <!-- <div class="article-more-link">
      <a href="/2019/01/09/hadoop/004-frequently-hbase-shell-cmd/#more">
        read more
      </a>
    </div> -->
    


      <footer class="article-footer">
        <a data-url="http://http//jimolonely.github.io/2019/01/09/hadoop/004-frequently-hbase-shell-cmd/" data-id="cl1fw7fjp0059vkd3hq4r6f4d" class="article-share-link">
          Share
        </a>
        
            
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/hbase/" rel="tag">hbase</a><span class="article-tag-list-count">4</span></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/linux/" rel="tag">linux</a><span class="article-tag-list-count">57</span></li></ul>

      </footer>
      </div>
      
</article>


  
    <article id="post-ansible/002-reusable-playbook" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/01/04/ansible/002-reusable-playbook/" class="article-date">
  <time datetime="2019-01-04T09:54:32.000Z" itemprop="datePublished">2019-01-04</time>
</a>
      
  </div>
  <div class="article-inner">
    
      
        <header class="article-header">
          
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/01/04/ansible/002-reusable-playbook/">创建可重用playbook</a>
    </h1>
  

        </header>
        
          <!-- <div class="article-entry" itemprop="articleBody">
      
        <p>消除重复代码一直是程序员的目标，playbook也不例外。</p>
<p>当一个playbook内容变得很大时，你就会想拆分了。</p>
<p>拆分后，肯定要引入主剧本，这就有2种方式：<code>include/import</code>.</p>
<h1 id="静态和动态引入"><a href="#静态和动态引入" class="headerlink" title="静态和动态引入"></a>静态和动态引入</h1><ol>
<li>静态：使用<code>import</code>引入的；</li>
<li>动态：使用<code>include</code>引入的。</li>
</ol>
<p>区别：</p>
<ol>
<li>静态引入的文件会在解析时被预处理，类似编译过程；</li>
<li>动态引入的会在运行时才被处理</li>
</ol>
<p>当遇到如<code>tags</code>,<code>when</code>等选项：</p>
<ol>
<li>静态引入会将他们copy到所有子任务</li>
<li>而动态只会应用到当前任务</li>
</ol>
<h1 id="使用权衡"><a href="#使用权衡" class="headerlink" title="使用权衡"></a>使用权衡</h1><p>使用<code>include * vs. import *</code>有一些优点，用户在选择时应考虑一些权衡：</p>
<p>使用<code>include *</code>语句的主要优点是循环。当循环与include一起使用时，包含的任务或角色将对循环中的每个项执行一次。</p>
<p>与<code>import *</code>语句相比，使用<code>include *</code>确实有一些限制：</p>
<ol>
<li>仅存在于动态包含内的标记不会显示在–list-tags输出中。</li>
<li>仅存在于动态包含内的任务不会显示在–list-tasks输出中。</li>
<li>不能使用<code>notify</code>来触发来自动态包含内的处理程序名称（请参阅下面的注释）。</li>
<li>不能使用<code>--start-at-task</code>在动态包含内的任务中开启执行。</li>
</ol>
<p>与动态包含相比，使用<code>import *</code>也有一些限制：</p>
<ol>
<li>如上所述，循环根本不能与<code>import</code>一起使用。</li>
<li>将变量用于目标文件或角色名称时，不能使用inventory中的变量（host&#x2F;group变量等）。</li>
</ol>
<h1 id="import-playbook使用"><a href="#import-playbook使用" class="headerlink" title="import_playbook使用"></a>import_playbook使用</h1><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> <span class="attr">import_playbook:</span> <span class="string">webservers.yml</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">import_playbook:</span> <span class="string">databases.yml</span></span><br></pre></td></tr></table></figure>

<h1 id="include-x2F-import-tasks使用"><a href="#include-x2F-import-tasks使用" class="headerlink" title="include&#x2F;import_tasks使用"></a>include&#x2F;import_tasks使用</h1><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># common_tasks.yml</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">name:</span> <span class="string">placeholder</span> <span class="string">foo</span></span><br><span class="line">  <span class="attr">command:</span> <span class="string">/bin/foo</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">name:</span> <span class="string">placeholder</span> <span class="string">bar</span></span><br><span class="line">  <span class="attr">command:</span> <span class="string">/bin/bar</span></span><br></pre></td></tr></table></figure>
<p>然后引入：</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">tasks:</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">import_tasks:</span> <span class="string">common_tasks.yml</span></span><br><span class="line"><span class="comment"># or</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">include_tasks:</span> <span class="string">common_tasks.yml</span></span><br></pre></td></tr></table></figure>
<p>同时可以传递变量：</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">tasks:</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">import_tasks:</span> <span class="string">wordpress.yml</span></span><br><span class="line">  <span class="attr">vars:</span></span><br><span class="line">    <span class="attr">user_name:</span> <span class="string">jimo</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">import_tasks:</span> <span class="string">wordpress.yml</span></span><br><span class="line">  <span class="attr">vars:</span></span><br><span class="line">    <span class="attr">user_name:</span> <span class="string">jack</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">import_tasks:</span> <span class="string">wordpress.yml</span></span><br><span class="line">  <span class="attr">vars:</span></span><br><span class="line">    <span class="attr">user_name:</span> <span class="string">lily</span></span><br></pre></td></tr></table></figure>

<p>用到handler中，我们先定义一个handler.yml:</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># more_handlers.yml</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">name:</span> <span class="string">restart</span> <span class="string">apache</span></span><br><span class="line">  <span class="attr">service:</span> <span class="string">name=apache</span> <span class="string">state=restarted</span></span><br></pre></td></tr></table></figure>
<p>引入例子：</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">handlers:</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">include_tasks:</span> <span class="string">more_handlers.yml</span></span><br><span class="line"><span class="comment"># or</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">import_tasks:</span> <span class="string">more_handlers.yml</span></span><br></pre></td></tr></table></figure>


<h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><ol>
<li><a target="_blank" rel="noopener" href="https://docs.ansible.com/ansible/latest/user_guide/playbooks_reuse.html">https://docs.ansible.com/ansible/latest/user_guide&#x2F;playbooks_reuse.html</a></li>
<li><a target="_blank" rel="noopener" href="https://docs.ansible.com/ansible/latest/user_guide/playbooks_reuse_includes.html">https://docs.ansible.com/ansible/latest/user_guide&#x2F;playbooks_reuse_includes.html</a></li>
</ol>

      
    </div> -->
          <div class="article-entry" itemprop="articleBody">
            
              
                
                      
                        
                          
                            
                              
                                
                                  
                                    <p>
                                      <p>消除重复代码一直是程序员的目标，playbook也不例外。</p>

                                        <p>
                                          
                                            
                                              
                                                      
          </div>
    <p class="article-more-link">
      <a href="/2019/01/04/ansible/002-reusable-playbook/#more">
        Read More
      </a>
    </p>
    <!-- <div class="article-more-link">
      <a href="/2019/01/04/ansible/002-reusable-playbook/#more">
        read more
      </a>
    </div> -->
    


      <footer class="article-footer">
        <a data-url="http://http//jimolonely.github.io/2019/01/04/ansible/002-reusable-playbook/" data-id="cl1fw7fi7001uvkd3ckx5bqrl" class="article-share-link">
          Share
        </a>
        
            
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ansible/" rel="tag">ansible</a><span class="article-tag-list-count">7</span></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/linux/" rel="tag">linux</a><span class="article-tag-list-count">57</span></li></ul>

      </footer>
      </div>
      
</article>


  
    <article id="post-ansible/001-playbook" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/01/03/ansible/001-playbook/" class="article-date">
  <time datetime="2019-01-03T04:34:58.000Z" itemprop="datePublished">2019-01-03</time>
</a>
      
  </div>
  <div class="article-inner">
    
      
        <header class="article-header">
          
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/01/03/ansible/001-playbook/">ansible-playbook</a>
    </h1>
  

        </header>
        
          <!-- <div class="article-entry" itemprop="articleBody">
      
        <p>在入门了之后就开始进阶把。</p>
<p>本文来自<a target="_blank" rel="noopener" href="https://docs.ansible.com/ansible/latest/user_guide/playbooks_intro.html">playbooks简介</a></p>
<p>先理解3个东西：</p>
<ol>
<li>playbook（剧本）</li>
<li>tasks（任务）</li>
<li>handler（处理）</li>
</ol>
<p>理解他们都是什么，关系是什么，怎么用。</p>
<h1 id="playbook"><a href="#playbook" class="headerlink" title="playbook"></a>playbook</h1><p>只有一个剧本：</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">hosts:</span> <span class="string">webservers</span></span><br><span class="line">  <span class="attr">vars:</span></span><br><span class="line">    <span class="attr">http_port:</span> <span class="number">80</span></span><br><span class="line">    <span class="attr">max_clients:</span> <span class="number">200</span></span><br><span class="line">  <span class="attr">remote_user:</span> <span class="string">root</span></span><br><span class="line">  <span class="attr">tasks:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">ensure</span> <span class="string">apache</span> <span class="string">is</span> <span class="string">at</span> <span class="string">the</span> <span class="string">latest</span> <span class="string">version</span></span><br><span class="line">    <span class="attr">yum:</span></span><br><span class="line">      <span class="attr">name:</span> <span class="string">httpd</span></span><br><span class="line">      <span class="attr">state:</span> <span class="string">latest</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">write</span> <span class="string">the</span> <span class="string">apache</span> <span class="string">config</span> <span class="string">file</span></span><br><span class="line">    <span class="attr">template:</span></span><br><span class="line">      <span class="attr">src:</span> <span class="string">/srv/httpd.j2</span></span><br><span class="line">      <span class="attr">dest:</span> <span class="string">/etc/httpd.conf</span></span><br><span class="line">    <span class="attr">notify:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">restart</span> <span class="string">apache</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">ensure</span> <span class="string">apache</span> <span class="string">is</span> <span class="string">running</span></span><br><span class="line">    <span class="attr">service:</span></span><br><span class="line">      <span class="attr">name:</span> <span class="string">httpd</span></span><br><span class="line">      <span class="attr">state:</span> <span class="string">started</span></span><br><span class="line">  <span class="attr">handlers:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">restart</span> <span class="string">apache</span></span><br><span class="line">      <span class="attr">service:</span></span><br><span class="line">        <span class="attr">name:</span> <span class="string">httpd</span></span><br><span class="line">        <span class="attr">state:</span> <span class="string">restarted</span></span><br></pre></td></tr></table></figure>
<p>有多个剧本：</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">hosts:</span> <span class="string">webservers</span></span><br><span class="line">  <span class="attr">remote_user:</span> <span class="string">root</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">tasks:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">ensure</span> <span class="string">apache</span> <span class="string">is</span> <span class="string">at</span> <span class="string">the</span> <span class="string">latest</span> <span class="string">version</span></span><br><span class="line">    <span class="attr">yum:</span></span><br><span class="line">      <span class="attr">name:</span> <span class="string">httpd</span></span><br><span class="line">      <span class="attr">state:</span> <span class="string">latest</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">write</span> <span class="string">the</span> <span class="string">apache</span> <span class="string">config</span> <span class="string">file</span></span><br><span class="line">    <span class="attr">template:</span></span><br><span class="line">      <span class="attr">src:</span> <span class="string">/srv/httpd.j2</span></span><br><span class="line">      <span class="attr">dest:</span> <span class="string">/etc/httpd.conf</span></span><br><span class="line"></span><br><span class="line"><span class="bullet">-</span> <span class="attr">hosts:</span> <span class="string">databases</span></span><br><span class="line">  <span class="attr">remote_user:</span> <span class="string">root</span></span><br><span class="line"></span><br><span class="line">  <span class="attr">tasks:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">ensure</span> <span class="string">postgresql</span> <span class="string">is</span> <span class="string">at</span> <span class="string">the</span> <span class="string">latest</span> <span class="string">version</span></span><br><span class="line">    <span class="attr">yum:</span></span><br><span class="line">      <span class="attr">name:</span> <span class="string">postgresql</span></span><br><span class="line">      <span class="attr">state:</span> <span class="string">latest</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">ensure</span> <span class="string">that</span> <span class="string">postgresql</span> <span class="string">is</span> <span class="string">started</span></span><br><span class="line">    <span class="attr">service:</span></span><br><span class="line">      <span class="attr">name:</span> <span class="string">postgresql</span></span><br><span class="line">      <span class="attr">state:</span> <span class="string">started</span></span><br></pre></td></tr></table></figure>

<p>一眼就能看懂对把，还是学下基础知识。</p>
<h1 id="基础"><a href="#基础" class="headerlink" title="基础"></a>基础</h1><h2 id="Host和User"><a href="#Host和User" class="headerlink" title="Host和User"></a>Host和User</h2><p>hosts: 遵循pattern模式</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">hosts:</span> <span class="string">webservers</span></span><br><span class="line">  <span class="attr">remote_user:</span> <span class="string">root</span></span><br></pre></td></tr></table></figure>
<p>remote_user可以为每个任务独有：</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">hosts:</span> <span class="string">webservers</span></span><br><span class="line">  <span class="attr">remote_user:</span> <span class="string">root</span></span><br><span class="line">  <span class="attr">tasks:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">test</span> <span class="string">connection</span></span><br><span class="line">      <span class="attr">ping:</span></span><br><span class="line">      <span class="attr">remote_user:</span> <span class="string">yourname</span></span><br></pre></td></tr></table></figure>
<p>激活权限提升</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">hosts:</span> <span class="string">webservers</span></span><br><span class="line">  <span class="attr">remote_user:</span> <span class="string">yourname</span></span><br><span class="line">  <span class="attr">become:</span> <span class="literal">yes</span></span><br></pre></td></tr></table></figure>
<p>或者单独指定：</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">hosts:</span> <span class="string">webservers</span></span><br><span class="line">  <span class="attr">remote_user:</span> <span class="string">yourname</span></span><br><span class="line">  <span class="attr">tasks:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">service:</span></span><br><span class="line">        <span class="attr">name:</span> <span class="string">nginx</span></span><br><span class="line">        <span class="attr">state:</span> <span class="string">started</span></span><br><span class="line">      <span class="attr">become:</span> <span class="literal">yes</span></span><br><span class="line">      <span class="attr">become_method:</span> <span class="string">sudo</span></span><br></pre></td></tr></table></figure>
<p>切换用户：</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">hosts:</span> <span class="string">webservers</span></span><br><span class="line">  <span class="attr">remote_user:</span> <span class="string">yourname</span></span><br><span class="line">  <span class="attr">become:</span> <span class="literal">yes</span></span><br><span class="line">  <span class="attr">become_user:</span> <span class="string">postgres</span></span><br></pre></td></tr></table></figure>
<p>提升：</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">hosts:</span> <span class="string">webservers</span></span><br><span class="line">  <span class="attr">remote_user:</span> <span class="string">yourname</span></span><br><span class="line">  <span class="attr">become:</span> <span class="literal">yes</span></span><br><span class="line">  <span class="attr">become_method:</span> <span class="string">su</span></span><br></pre></td></tr></table></figure>

<p>如果需要指定密码，使用<code>--ask-become-pass</code>.</p>
<p>对主机排序，改变运行顺序：</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> <span class="attr">hosts:</span> <span class="string">all</span></span><br><span class="line">  <span class="attr">order:</span> <span class="string">sorted</span></span><br><span class="line">  <span class="attr">gather_facts:</span> <span class="literal">False</span></span><br><span class="line">  <span class="attr">tasks:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">debug:</span></span><br><span class="line">        <span class="attr">var:</span> <span class="string">inventory_hostname</span></span><br></pre></td></tr></table></figure>

<h2 id="Task列表"><a href="#Task列表" class="headerlink" title="Task列表"></a>Task列表</h2><ol>
<li>顺序执行</li>
<li>冥等性： 执行一次和多次结果一样</li>
<li>name属性：可读性输出</li>
</ol>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">tasks:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">make</span> <span class="string">sure</span> <span class="string">apache</span> <span class="string">is</span> <span class="string">running</span></span><br><span class="line">    <span class="attr">service:</span></span><br><span class="line">      <span class="attr">name:</span> <span class="string">httpd</span></span><br><span class="line">      <span class="attr">state:</span> <span class="string">started</span></span><br></pre></td></tr></table></figure>
<p>直接写命令，参数这些很自由：</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">tasks:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">enable</span> <span class="string">selinux</span></span><br><span class="line">    <span class="attr">command:</span> <span class="string">/sbin/setenforce</span> <span class="number">1</span></span><br></pre></td></tr></table></figure>
<p>shell和command关心返回值，也就是短路运算：</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">tasks:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">run</span> <span class="string">this</span> <span class="string">command</span> <span class="string">and</span> <span class="string">ignore</span> <span class="string">the</span> <span class="string">result</span></span><br><span class="line">    <span class="attr">shell:</span> <span class="string">/usr/bin/somecommand</span> <span class="string">||</span> <span class="string">/bin/true</span></span><br><span class="line"><span class="comment"># or</span></span><br><span class="line"><span class="attr">tasks:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">run</span> <span class="string">this</span> <span class="string">command</span> <span class="string">and</span> <span class="string">ignore</span> <span class="string">the</span> <span class="string">result</span></span><br><span class="line">    <span class="attr">shell:</span> <span class="string">/usr/bin/somecommand</span></span><br><span class="line">    <span class="attr">ignore_errors:</span> <span class="literal">True</span></span><br></pre></td></tr></table></figure>
<p>太长的命令可以缩进换行：</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">tasks:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">Copy</span> <span class="string">ansible</span> <span class="string">inventory</span> <span class="string">file</span> <span class="string">to</span> <span class="string">client</span></span><br><span class="line">    <span class="attr">copy:</span> <span class="string">src=/etc/ansible/hosts</span> <span class="string">dest=/etc/ansible/hosts</span></span><br><span class="line">            <span class="string">owner=root</span> <span class="string">group=root</span> <span class="string">mode=0644</span></span><br></pre></td></tr></table></figure>
<p>使用变量：</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">tasks:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">create</span> <span class="string">a</span> <span class="string">virtual</span> <span class="string">host</span> <span class="string">file</span> <span class="string">for</span> &#123;&#123; <span class="string">vhost</span> &#125;&#125;</span><br><span class="line">    <span class="attr">template:</span></span><br><span class="line">      <span class="attr">src:</span> <span class="string">somefile.j2</span></span><br><span class="line">      <span class="attr">dest:</span> <span class="string">/etc/httpd/conf.d/&#123;&#123;</span> <span class="string">vhost</span> <span class="string">&#125;&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="Hnadler"><a href="#Hnadler" class="headerlink" title="Hnadler"></a>Hnadler</h2><p>状态改变时执行的操作。</p>
<p>例如：文件内容改变时，重启2个服务</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> <span class="attr">name:</span> <span class="string">template</span> <span class="string">configuration</span> <span class="string">file</span></span><br><span class="line">  <span class="attr">template:</span></span><br><span class="line">    <span class="attr">src:</span> <span class="string">template.j2</span></span><br><span class="line">    <span class="attr">dest:</span> <span class="string">/etc/foo.conf</span></span><br><span class="line">  <span class="attr">notify:</span></span><br><span class="line">     <span class="bullet">-</span> <span class="string">restart</span> <span class="string">memcached</span></span><br><span class="line">     <span class="bullet">-</span> <span class="string">restart</span> <span class="string">apache</span></span><br></pre></td></tr></table></figure>
<p>相应的2个handler定义如下：</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">handlers:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">restart</span> <span class="string">memcached</span></span><br><span class="line">      <span class="attr">service:</span></span><br><span class="line">        <span class="attr">name:</span> <span class="string">memcached</span></span><br><span class="line">        <span class="attr">state:</span> <span class="string">restarted</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">restart</span> <span class="string">apache</span></span><br><span class="line">      <span class="attr">service:</span></span><br><span class="line">        <span class="attr">name:</span> <span class="string">apache</span></span><br><span class="line">        <span class="attr">state:</span> <span class="string">restarted</span></span><br></pre></td></tr></table></figure>
<p>在2.2版本后，可以使用listen，这样只需要notify一次： 通过监听主题</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">handlers:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">restart</span> <span class="string">memcached</span></span><br><span class="line">      <span class="attr">service:</span></span><br><span class="line">        <span class="attr">name:</span> <span class="string">memcached</span></span><br><span class="line">        <span class="attr">state:</span> <span class="string">restarted</span></span><br><span class="line">      <span class="attr">listen:</span> <span class="string">&quot;restart web services&quot;</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">restart</span> <span class="string">apache</span></span><br><span class="line">      <span class="attr">service:</span></span><br><span class="line">        <span class="attr">name:</span> <span class="string">apache</span></span><br><span class="line">        <span class="string">state:restarted</span></span><br><span class="line">      <span class="attr">listen:</span> <span class="string">&quot;restart web services&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">tasks:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">restart</span> <span class="string">everything</span></span><br><span class="line">      <span class="attr">command:</span> <span class="string">echo</span> <span class="string">&quot;this task will restart the web services&quot;</span></span><br><span class="line">      <span class="attr">notify:</span> <span class="string">&quot;restart web services&quot;</span></span><br></pre></td></tr></table></figure>

<h2 id="执行playbook"><a href="#执行playbook" class="headerlink" title="执行playbook"></a>执行playbook</h2><p>并行度10，fork 10：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ansible-playbook playbook.yml -f 10</span><br></pre></td></tr></table></figure>


<p>再看一个复合例子：</p>
<figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">$</span> <span class="string">cat</span> <span class="string">playbook.yml</span> </span><br><span class="line"><span class="bullet">-</span> <span class="attr">name:</span> <span class="string">top</span> <span class="string">playbook</span></span><br><span class="line">  <span class="attr">hosts:</span> <span class="string">all</span></span><br><span class="line">  <span class="attr">tasks:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">ping</span> <span class="string">ping</span></span><br><span class="line">    <span class="attr">ping:</span> </span><br><span class="line">  <span class="bullet">-</span> <span class="attr">include:</span> <span class="string">tasks/echo1.yml</span> <span class="string">the_user=root</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">include:</span> <span class="string">tasks/echo2.yml</span></span><br><span class="line">  <span class="attr">handlers:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="attr">include:</span> <span class="string">handlers/handlers.yml</span></span><br></pre></td></tr></table></figure>

<p>输出结果的方式</p>

      
    </div> -->
          <div class="article-entry" itemprop="articleBody">
            
              
                
                      
                        
                          
                            
                              
                                
                                  
                                    <p>
                                      <p>在入门了之后就开始进阶把。</p>

                                        <p>
                                          
                                            
                                              
                                                      
          </div>
    <p class="article-more-link">
      <a href="/2019/01/03/ansible/001-playbook/#more">
        Read More
      </a>
    </p>
    <!-- <div class="article-more-link">
      <a href="/2019/01/03/ansible/001-playbook/#more">
        read more
      </a>
    </div> -->
    


      <footer class="article-footer">
        <a data-url="http://http//jimolonely.github.io/2019/01/03/ansible/001-playbook/" data-id="cl1fw7fi5001pvkd31kve72if" class="article-share-link">
          Share
        </a>
        
            
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ansible/" rel="tag">ansible</a><span class="article-tag-list-count">7</span></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/linux/" rel="tag">linux</a><span class="article-tag-list-count">57</span></li></ul>

      </footer>
      </div>
      
</article>


  
    <article id="post-ansible/000-ansible-fresh" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/01/02/ansible/000-ansible-fresh/" class="article-date">
  <time datetime="2019-01-02T08:38:38.000Z" itemprop="datePublished">2019-01-02</time>
</a>
      
  </div>
  <div class="article-inner">
    
      
        <header class="article-header">
          
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/01/02/ansible/000-ansible-fresh/">ansible1-入门金殿</a>
    </h1>
  

        </header>
        
          <!-- <div class="article-entry" itemprop="articleBody">
      
        <p>入门总是简单的，看看你有多快。</p>
<p>关于ssh连接请查找相关知识。</p>
<h1 id="一条命令格式"><a href="#一条命令格式" class="headerlink" title="一条命令格式"></a>一条命令格式</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ansible PATTERNS -m MODULE -a PARAMS</span><br></pre></td></tr></table></figure>
<p>只需要明白模式、模块、参数就可以实现命令行级别的使用了。</p>
<h2 id="PATTERNS"><a href="#PATTERNS" class="headerlink" title="PATTERNS"></a>PATTERNS</h2><p><a target="_blank" rel="noopener" href="https://docs.ansible.com/ansible/latest/user_guide/intro_patterns.html">patterns</a></p>
<p>可以分为3个部分：</p>
<ol>
<li>all&#x2F;*， webservers[0-25]</li>
<li>逻辑运算： &amp;&#x2F;！</li>
<li>正则表达式：<del>正则， &#96;</del>(web|db).*.example.com&#96;</li>
</ol>
<h2 id="MODULE"><a href="#MODULE" class="headerlink" title="MODULE"></a>MODULE</h2><p>模块太多了，可以了解一下简单的：<br><a target="_blank" rel="noopener" href="https://docs.ansible.com/ansible/latest/user_guide/intro_adhoc.html">ad-hoc</a></p>
<p>大概有：</p>
<ol>
<li>ping</li>
<li>shell</li>
<li>copy</li>
<li>file</li>
<li>yum&#x2F;apt&#x2F;…</li>
<li>user</li>
<li>git</li>
<li>service</li>
<li>setup</li>
</ol>
<p>参数和模块对应。</p>
<h1 id="连接方式"><a href="#连接方式" class="headerlink" title="连接方式"></a>连接方式</h1><p>当然是ssh，只是连接方式有区别。</p>
<h2 id="SSH的key"><a href="#SSH的key" class="headerlink" title="SSH的key"></a>SSH的key</h2><p>不用说了。</p>
<h2 id="密码登陆"><a href="#密码登陆" class="headerlink" title="密码登陆"></a>密码登陆</h2><p>加上<code>-k</code>选项。</p>
<h1 id="Ansible配置文件"><a href="#Ansible配置文件" class="headerlink" title="Ansible配置文件"></a>Ansible配置文件</h1><ol>
<li>配置文件优先顺序</li>
<li>有哪些配置属性</li>
</ol>
<p><a target="_blank" rel="noopener" href="https://ansible-tran.readthedocs.io/en/latest/docs/intro_configuration.html">ansible config</a></p>
<h1 id="hosts"><a href="#hosts" class="headerlink" title="hosts"></a>hosts</h1><p>对哪些机器执行，ansible里叫inventory（清单文件），这个hosts文件默认在<code>/etc/ansible/hosts</code>,不过我们可以在任何目录配置它。</p>
<ol>
<li>在工作目录新建ansible.cfg.</li>
<li>加入配置： <code>inventory = hosts</code>, 注意，必须是在<code>[defaults]</code>模块下才行</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[defaults]</span><br><span class="line">inventory = hosts</span><br></pre></td></tr></table></figure>

      
    </div> -->
          <div class="article-entry" itemprop="articleBody">
            
              
                
                      
                        
                          
                            
                              
                                
                                  
                                    <p>
                                      <p>入门总是简单的，看看你有多快。</p>

                                        <p>
                                          
                                            
                                              
                                                      
          </div>
    <p class="article-more-link">
      <a href="/2019/01/02/ansible/000-ansible-fresh/#more">
        Read More
      </a>
    </p>
    <!-- <div class="article-more-link">
      <a href="/2019/01/02/ansible/000-ansible-fresh/#more">
        read more
      </a>
    </div> -->
    


      <footer class="article-footer">
        <a data-url="http://http//jimolonely.github.io/2019/01/02/ansible/000-ansible-fresh/" data-id="cl1fw7fi6001rvkd36gpp2r92" class="article-share-link">
          Share
        </a>
        
            
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ansible/" rel="tag">ansible</a><span class="article-tag-list-count">7</span></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/linux/" rel="tag">linux</a><span class="article-tag-list-count">57</span></li></ul>

      </footer>
      </div>
      
</article>


  
    <article id="post-tools/013-ssh" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/01/02/tools/013-ssh/" class="article-date">
  <time datetime="2019-01-02T06:55:48.000Z" itemprop="datePublished">2019-01-02</time>
</a>
      
  </div>
  <div class="article-inner">
    
      
        <header class="article-header">
          
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/01/02/tools/013-ssh/">SSH那些事</a>
    </h1>
  

        </header>
        
          <!-- <div class="article-entry" itemprop="articleBody">
      
        <p>ssh已经无处不在，尤其是ansible完全依赖于ssh实现了无agent管理机器。</p>
<h1 id="发布自己的public-key"><a href="#发布自己的public-key" class="headerlink" title="发布自己的public key"></a>发布自己的public key</h1><p>自己电脑 —访问—》 远程电脑</p>
<p>自己电脑的public key —放到—&gt; 远程电脑的<code>.ssh/authorized_keys</code> .</p>
<p>自己的public key：<br>自己生成：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$ </span><span class="language-bash">ssh-keygen -t rsa</span></span><br><span class="line">Generating public/private rsa key pair.</span><br><span class="line">Enter file in which to save the key (/home/jack/.ssh/id_rsa): </span><br><span class="line">Enter passphrase (empty for no passphrase): </span><br><span class="line">Enter same passphrase again: </span><br><span class="line">Your identification has been saved in /home/jack/.ssh/id_rsa.</span><br><span class="line">Your public key has been saved in /home/jack/.ssh/id_rsa.pub.</span><br><span class="line">The key fingerprint is:</span><br><span class="line">SHA256:XNTbM9mTiyFhjgsMG0R/5+Ou6LrBprvlRcxzIfY7dWE jack@jack</span><br><span class="line">The key&#x27;s randomart image is:</span><br><span class="line">+---[RSA 2048]----+</span><br><span class="line">|    oo    ..     |</span><br><span class="line">|     o.  . o.    |</span><br><span class="line">|      =+ o=..E o.|</span><br><span class="line">|     .+++o+oo.*o.|</span><br><span class="line">|       =So.+..ooo|</span><br><span class="line">|    . . o.+ o. . |</span><br><span class="line">|     = . o .     |</span><br><span class="line">|    = o . o      |</span><br><span class="line">|   +o++o ...     |</span><br><span class="line">+----[SHA256]-----+</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">$ </span><span class="language-bash"><span class="built_in">cat</span> ~/.ssh/id_rsa.pub</span> </span><br><span class="line">ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDsP6P3B6JNmkI2xFMXfNUe8LSQC+fWgB7ifNU7uS2iv55dPiU5uWo0LMLW9SQhVHQeFl9V5ur8t19rCY1IoMvQNoSfEnWjN2PTO2rhbugqBBwVQzZLkyqfLtiMGdSIzQ1CFvoHQbX3fb2A70GXpoX8pa2P5TP4WJufsLKEamcnIXhdW8GVQif9Gf24VCYyUn+Omi3RdWHOdn1gQsLB7qfapO/t4vSURHYvdgy0AJ2bmJRBqCKseIEBXsdNy3VbL1DxSTU8kww20nSV4wa9OPxPMApdzPIiXxx+ow70KvgwrfBnc8gQ6yxzdBnyGHizU0TLWv3FLO5ZtDz+6v77zeZX jack@jack</span><br></pre></td></tr></table></figure>
<p>然后复制到远程主机的<code>.ssh/authorized_keys</code>文件里。</p>
<p>当然，也可以一句命令搞定：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat ~/.ssh/id_rsa.pub | ssh USER@HOST &quot;mkdir -p ~/.ssh &amp;&amp; cat &gt;&gt; ~/.ssh/authorized_keys&quot;</span><br></pre></td></tr></table></figure>

<p>当然，还有个软件叫<a target="_blank" rel="noopener" href="http://linux.die.net/man/1/ssh-copy-id">ssh-copy-id</a></p>

      
    </div> -->
          <div class="article-entry" itemprop="articleBody">
            
              
                
                      
                        
                          
                            
                              
                                
                                  
                                    <p>
                                      <p>ssh已经无处不在，尤其是ansible完全依赖于ssh实现了无agent管理机器。</p>

                                        <p>
                                          
                                            
                                              
                                                      
          </div>
    <p class="article-more-link">
      <a href="/2019/01/02/tools/013-ssh/#more">
        Read More
      </a>
    </p>
    <!-- <div class="article-more-link">
      <a href="/2019/01/02/tools/013-ssh/#more">
        read more
      </a>
    </div> -->
    


      <footer class="article-footer">
        <a data-url="http://http//jimolonely.github.io/2019/01/02/tools/013-ssh/" data-id="cl1fw7fo700l8vkd31jcm840g" class="article-share-link">
          Share
        </a>
        
            
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/linux/" rel="tag">linux</a><span class="article-tag-list-count">57</span></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ssh/" rel="tag">ssh</a><span class="article-tag-list-count">5</span></li></ul>

      </footer>
      </div>
      
</article>


  
    <article id="post-git/002-git-commit-wrong-person" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/01/01/git/002-git-commit-wrong-person/" class="article-date">
  <time datetime="2019-01-01T01:45:34.000Z" itemprop="datePublished">2019-01-01</time>
</a>
      
  </div>
  <div class="article-inner">
    
      
        <header class="article-header">
          
  
    <h1 itemprop="name">
      <a class="article-title" href="/2019/01/01/git/002-git-commit-wrong-person/">为什么git提交关联了错误的用户</a>
    </h1>
  

        </header>
        
          <!-- <div class="article-entry" itemprop="articleBody">
      
        <p>前几天检查github提交历史，发现明明提交了，为什么绿格子没有点亮。然后引发了让我惊奇的事情。<br>因为我在2台电脑上提交过，都使用的SSH的方式，然后就出现了2个陌生的用户：</p>
<img src="/2019/01/01/git/002-git-commit-wrong-person/000.png" class="">

<p>而且这2个账户还有自己单独的主页，虽然一看就知道才创建的。</p>
<p>经过查找，发现了<a target="_blank" rel="noopener" href="https://github.community/t5/Support-Protips/Why-is-my-commit-associated-with-the-wrong-person/ba-p/6728">github社区的回答</a>.</p>
<p>大概内容如下：</p>
<ol>
<li>github每次提交关联了3类用户：作者（修改文件的人）、提交者、推送者；</li>
<li>提交者是通过邮件地址来确定的，不管是私有还是公有地址；</li>
<li>查看一下提交者。</li>
</ol>
<p>通过命令行：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ git log</span><br><span class="line">commit 5bca74ff5bcff3ffe9d21d96b4dfb3ba01309638</span><br><span class="line">Author: jimo &lt;11@11.com&gt;</span><br><span class="line">Date:   Mon Dec 31 23:18:58 2018 +0800</span><br><span class="line"></span><br><span class="line">    modify</span><br></pre></td></tr></table></figure>
<p>或通过github网站（所有人都能看到）：在<a target="_blank" rel="noopener" href="https://github.com/%E7%94%A8%E6%88%B7%E5%90%8D/%E4%BB%93%E5%BA%93/commit/id.patch">https://github.com/用户名/仓库/commit/id.patch</a></p>
<img src="/2019/01/01/git/002-git-commit-wrong-person/001.png" class="">

<p>可以看出果然不是我，而是一个jimo的人，但也和上面的用户对不上，所以是根据邮箱随便产生的把（我猜测）。</p>
<p>那解决办法呢？</p>
<p>将邮件改正确(就是github账户里验证过的邮箱)试试：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ git config user.email &quot;yours&quot;</span><br></pre></td></tr></table></figure>

<p>然后再修改提交就ok了：</p>
<img src="/2019/01/01/git/002-git-commit-wrong-person/002.png" class="">


      
    </div> -->
          <div class="article-entry" itemprop="articleBody">
            
              
                
                      
                        
                          
                            
                              
                                
                                  
                                    <p>
                                      <p>前几天检查github提交历史，发现明明提交了，为什么绿格子没有点亮。然后引发了让我惊奇的事情。<br>因为我在2台电脑上提交过，都使用的SSH的方式，然后就出现了2个陌生的用户：</p>

                                        <p>
                                          
                                            
                                              
                                                      
          </div>
    <p class="article-more-link">
      <a href="/2019/01/01/git/002-git-commit-wrong-person/#more">
        Read More
      </a>
    </p>
    <!-- <div class="article-more-link">
      <a href="/2019/01/01/git/002-git-commit-wrong-person/#more">
        read more
      </a>
    </div> -->
    


      <footer class="article-footer">
        <a data-url="http://http//jimolonely.github.io/2019/01/01/git/002-git-commit-wrong-person/" data-id="cl1fw7fjk004svkd3bpik5yk8" class="article-share-link">
          Share
        </a>
        
            
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/git/" rel="tag">git</a><span class="article-tag-list-count">7</span></li></ul>

      </footer>
      </div>
      
</article>


  
    <article id="post-algorithm/001-week-algo" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/12/22/algorithm/001-week-algo/" class="article-date">
  <time datetime="2018-12-22T14:46:02.000Z" itemprop="datePublished">2018-12-22</time>
</a>
      
  </div>
  <div class="article-inner">
    
      
        <header class="article-header">
          
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/12/22/algorithm/001-week-algo/">week1-算法</a>
    </h1>
  

        </header>
        
          <!-- <div class="article-entry" itemprop="articleBody">
      
        <p>还不知道写什么。</p>
<p>也许这就是个不能延续的坑。</p>

      
    </div> -->
          <div class="article-entry" itemprop="articleBody">
            
              
                
                      
                        
                          
                            
                              
                                
                                  
                                    <p>
                                      <p>还不知道写什么。</p>

                                        <p>
                                          
                                            
                                              
                                                      
          </div>
    <p class="article-more-link">
      <a href="/2018/12/22/algorithm/001-week-algo/#more">
        Read More
      </a>
    </p>
    <!-- <div class="article-more-link">
      <a href="/2018/12/22/algorithm/001-week-algo/#more">
        read more
      </a>
    </div> -->
    


      <footer class="article-footer">
        <a data-url="http://http//jimolonely.github.io/2018/12/22/algorithm/001-week-algo/" data-id="cl1fw7fhd0005vkd399s8921y" class="article-share-link">
          Share
        </a>
        
            
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/algorithm/" rel="tag">algorithm</a><span class="article-tag-list-count">2</span></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/java/" rel="tag">java</a><span class="article-tag-list-count">104</span></li></ul>

      </footer>
      </div>
      
</article>


  
    <article id="post-basic/013-consumer-driven-contracts" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/12/19/basic/013-consumer-driven-contracts/" class="article-date">
  <time datetime="2018-12-19T01:11:01.000Z" itemprop="datePublished">2018-12-19</time>
</a>
      
  </div>
  <div class="article-inner">
    
      
        <header class="article-header">
          
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/12/19/basic/013-consumer-driven-contracts/">消费者驱动合同：一种服务进化模式</a>
    </h1>
  

        </header>
        
          <!-- <div class="article-entry" itemprop="articleBody">
      
        <p>本文翻译自：<a target="_blank" rel="noopener" href="https://martinfowler.com/articles/consumerDrivenContracts.html">https://martinfowler.com/articles/consumerDrivenContracts.html</a></p>
<p>本文讨论了发展服务提供商和消费者社区的一些挑战。 它描述了服务提供商更改合同的一部分时出现的一些耦合问题，特别是文档模式，并确定了两个易于理解的策略 - 添加模式扩展点并对接收到的消息执行“足够”验证 - 以减轻此类问题。 这两种策略都有助于保护消费者免受提供商合同的变更，但这些策略都不会让提供商深入了解其使用方式以及随着其发展必须维护的义务。 借鉴其中一种缓解策略的基于断言的语言 - “恰到好处”的验证策略 - 文章随后描述了“消费者驱动的合同”模式，该模式使提供商了解其消费者义务，并关注服务的发展 消费者要求的关键业务功能的交付。</p>
<h1 id="服务进化的一个例子"><a href="#服务进化的一个例子" class="headerlink" title="服务进化的一个例子"></a>服务进化的一个例子</h1><p>为了说明我们在发展服务时遇到的一些问题，请考虑一个简单的ProductSearch服务，它允许消费者应用程序搜索我们的产品目录。 搜索结果具有以下结构：</p>
<p>图1：搜索结果模式</p>
<img src="/2018/12/19/basic/013-consumer-driven-contracts/000.png" class="">

<p>搜索结果文档示例如下所示：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Products</span> <span class="attr">xmlns</span>=<span class="string">&quot;urn:example.com:productsearch:products&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">Product</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">CatalogueID</span>&gt;</span>101<span class="tag">&lt;/<span class="name">CatalogueID</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Name</span>&gt;</span>Widget<span class="tag">&lt;/<span class="name">Name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Price</span>&gt;</span>10.99<span class="tag">&lt;/<span class="name">Price</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Manufacturer</span>&gt;</span>Company A<span class="tag">&lt;/<span class="name">Manufacturer</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">InStock</span>&gt;</span>Yes<span class="tag">&lt;/<span class="name">InStock</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">Product</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">Product</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">CatalogueID</span>&gt;</span>300<span class="tag">&lt;/<span class="name">CatalogueID</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Name</span>&gt;</span>Fooble<span class="tag">&lt;/<span class="name">Name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Price</span>&gt;</span>2.00<span class="tag">&lt;/<span class="name">Price</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Manufacturer</span>&gt;</span>Company B<span class="tag">&lt;/<span class="name">Manufacturer</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">InStock</span>&gt;</span>No<span class="tag">&lt;/<span class="name">InStock</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">Product</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">Products</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>ProductSearch服务目前由两个应用程序使用：内部营销应用程序和外部代理商的Web应用程序。 两个消费者在处理之前都使用XSD(XML结构定义 ( XML Schemas Definition ))验证来验证收到的文档。 内部应用程序使用CatalogueID，Name，Price和Manufacturer字段; 外部应用程序的CatalogueID，Name和Price字段。 既没有使用InStock字段：虽然考虑了营销应用程序，但它在开发生命周期的早期就被删除了。</p>
<p>我们可能发展服务的最常见方式之一是代表一个或多个消费者向文档添加其他字段。 根据提供商和消费者的实施方式，即使是这样的简单更改也会对业务及其合作伙伴产生代价高昂的影响。</p>
<p>在我们的示例中，在ProductSearch服务投入生产一段时间后，第二个经销商会考虑使用它，但要求将“描述”字段添加到每个产品中。由于消费者的构建方式，这种变化对提供商和现有消费者都有重大且代价高昂的影响，每种变化的成本都取决于我们如何实施变更。我们至少有两种方式可以在服务社区成员之间分配变更成本。首先，我们可以修改原始模式，并要求每个使用者更新其模式副本，以便正确验证搜索结果;改变系统的成本在这里分配给提供者 - 面对这样的变更请求，他们总是要做出某种改变 - 以及对更新的功能不感兴趣的消费者。或者，我们可以选择代表新的使用者向服务提供者添加第二个操作和模式，并代表现有的使用者维护原始操作和模式。现在，变更成本仅限于提供商，但代价是使服务更复杂，维护成本更高。</p>
<h1 id="插曲：服务负担沉重"><a href="#插曲：服务负担沉重" class="headerlink" title="插曲：服务负担沉重"></a>插曲：服务负担沉重</h1><p>服务支持企业应用程序环境的主要优势在于提高了组织灵活性并降低了实施变更的总体成本。 SOA通过将高价值业务功能置于离散的可重用服务中，然后连接和编排这些服务以满足核心业务流程，从而提高组织敏捷性。它通过减少服务之间的依赖关系来降低更改成本，允许它们快速重新组合和调整以响应更改或计划外事件。</p>
<p>但是，如果企业的SOA使服务能够彼此独立地发展，那么企业只能充分实现这些优势。为了提高服务独立性，我们构建了共享契约的服务，而不是类型。即便如此，我们最终还是必须以与服务提供商相同的速度发展消费者，主要是因为我们已经让消费者依赖于提供商合同的特定版本。最后，服务提供商发现他们采取谨慎的方法来改变他们为消费者提供的合同的任何要素;这部分是因为他们无法预测或深入了解消费者实现合同的方式。在最坏的情况下，服务消费者通过在其内部逻辑中天真地表达整个文档模式来实现提供者合同并将自己耦合到提供者。</p>
<p>合同使服务独立;矛盾的是，他们还可能以不合需要的方式将服务提供商和消费者联系起来。在没有反省我们在SOA中实现的合同的功能和作用的情况下，我们将服务置于一种“隐藏”耦合的形式，我们很少能够以任何系统的方式解决这种耦合。缺乏对服务社区采用合同的方式的任何程序性见解，以及服务提供商和消费者对实施选择的限制缺乏，这些都破坏了SOA支持企业的所谓好处。简而言之，企业负担得起服务。</p>
<h1 id="架构版本控制"><a href="#架构版本控制" class="headerlink" title="架构版本控制"></a>架构版本控制</h1><p>通过查看模式版本控制问题，我们可以开始调查合同并解决困扰我们的ProductSearch服务的问题。 <a target="_blank" rel="noopener" href="http://www.w3.org/2001/tag/doc/versioning">WC3技术架构小组（TAG）</a>描述了许多版本控制策略，这些策略可能有助于我们以减轻耦合问题的方式发展我们的服务消息模式。这些策略的范围从过于宽松的无，它要求服务不能区分不同版本的模式，因此必须容忍所有变化，对于非常保守的大爆炸，这需要服务在它们收到意外版本的时候中止信息。</p>
<p>这两种极端情况都会带来妨碍业务价值交付并加剧系统总体拥有成本的问题。显式和隐含的“无版本控制”策略导致系统在其交互中变得不可预测，脆弱且下游变更成本高。另一方面，大爆炸战略带来紧密耦合的服务格局，其中架构变化会影响供应商和消费者，破坏正常运行时间，延缓发展并减少创收机会。</p>
<p>我们的示例服务社区有效地实施了一项大爆炸战略。考虑到与提高系统业务价值相关的成本，显然提供商和消费者将受益于更灵活的版本控制策略–TAG发现所谓的兼容策略 - 提供向后兼容的模式。在不断发展的服务环境中，向后兼容的模式使较新模式的使用者能够接受较旧模式的实例：构建为处理向后兼容请求的新版本的服务提供者，但仍然可以接受根据旧架构。另一方面，向前兼容的模式使旧模式的使用者能够处理更新模式的实例。这是现有ProductSearch消费者的关键点：如果搜索结果模式在首次投入生产时已经向前兼容，则消费者将能够处理新版本搜索结果的实例而不会破坏或需要修改。</p>
<h1 id="扩展点"><a href="#扩展点" class="headerlink" title="扩展点"></a>扩展点</h1><p>使模式向后兼容是一个众所周知的设计任务，最好用Must Ignore可扩展模式表达（参见<a target="_blank" rel="noopener" href="http://www.pacificspirit.com/Authoring/Compatibility/ExtendingAndVersioningXMLLanguages.html">David Orchard</a>和<a target="_blank" rel="noopener" href="http://msdn.microsoft.com/library/en-us/dnexxml/html/xml07212004.asp">Dare Obasanjo</a>撰写的论文）。 Must Ignore模式建议模式包含扩展点，这些扩展点允许将扩展元素添加到每个元素的类型和附加属性。 该模式还建议XML语言定义一个处理模型，指定消费者如何处理扩展。 最简单的模型要求消费者忽略他们无法识别的元素 - 因此模式的名称。 该模型还可能要求消费者处理具有“必须理解”标志的元素，或者如果他们无法理解它们则中止。</p>
<p>这是我们最初基于搜索结果文档的架构：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">xs:schema</span> <span class="attr">xmlns</span>=<span class="string">&quot;urn:example.com:productsearch:products&quot;</span> </span></span><br><span class="line"><span class="tag">  <span class="attr">xmlns:xs</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">elementFormDefault</span>=<span class="string">&quot;qualified&quot;</span> </span></span><br><span class="line"><span class="tag">  <span class="attr">targetNamespace</span>=<span class="string">&quot;urn:example.com:productsearch:products&quot;</span> </span></span><br><span class="line"><span class="tag">  <span class="attr">id</span>=<span class="string">&quot;Products&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">xs:element</span> <span class="attr">name</span>=<span class="string">&quot;Products&quot;</span> <span class="attr">type</span>=<span class="string">&quot;Products&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">xs:complexType</span> <span class="attr">name</span>=<span class="string">&quot;Products&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">xs:sequence</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">xs:element</span> <span class="attr">minOccurs</span>=<span class="string">&quot;0&quot;</span> <span class="attr">maxOccurs</span>=<span class="string">&quot;unbounded&quot;</span> <span class="attr">name</span>=<span class="string">&quot;Product&quot;</span> <span class="attr">type</span>=<span class="string">&quot;Product&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">xs:sequence</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">xs:complexType</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">xs:complexType</span> <span class="attr">name</span>=<span class="string">&quot;Product&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">xs:sequence</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">xs:element</span> <span class="attr">name</span>=<span class="string">&quot;CatalogueID&quot;</span> <span class="attr">type</span>=<span class="string">&quot;xs:int&quot;</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">xs:element</span> <span class="attr">name</span>=<span class="string">&quot;Name&quot;</span> <span class="attr">type</span>=<span class="string">&quot;xs:string&quot;</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">xs:element</span> <span class="attr">name</span>=<span class="string">&quot;Price&quot;</span> <span class="attr">type</span>=<span class="string">&quot;xs:double&quot;</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">xs:element</span> <span class="attr">name</span>=<span class="string">&quot;Manufacturer&quot;</span> <span class="attr">type</span>=<span class="string">&quot;xs:string&quot;</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">xs:element</span> <span class="attr">name</span>=<span class="string">&quot;InStock&quot;</span> <span class="attr">type</span>=<span class="string">&quot;xs:string&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">xs:sequence</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">xs:complexType</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">xs:schema</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>现在让我们回滚一下时间，从服务的生命周期开始，指定一个向前兼容的，可扩展的模式：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">xs:schema</span> <span class="attr">xmlns</span>=<span class="string">&quot;urn:example.com:productsearch:products&quot;</span> </span></span><br><span class="line"><span class="tag">  <span class="attr">xmlns:xs</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">elementFormDefault</span>=<span class="string">&quot;qualified&quot;</span> </span></span><br><span class="line"><span class="tag">  <span class="attr">targetNamespace</span>=<span class="string">&quot;urn:example.com:productsearch:products&quot;</span> </span></span><br><span class="line"><span class="tag">  <span class="attr">id</span>=<span class="string">&quot;Products&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">xs:element</span> <span class="attr">name</span>=<span class="string">&quot;Products&quot;</span> <span class="attr">type</span>=<span class="string">&quot;Products&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">xs:complexType</span> <span class="attr">name</span>=<span class="string">&quot;Products&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">xs:sequence</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">xs:element</span> <span class="attr">minOccurs</span>=<span class="string">&quot;0&quot;</span> <span class="attr">maxOccurs</span>=<span class="string">&quot;unbounded&quot;</span> <span class="attr">name</span>=<span class="string">&quot;Product&quot;</span> <span class="attr">type</span>=<span class="string">&quot;Product&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">xs:sequence</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">xs:complexType</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">xs:complexType</span> <span class="attr">name</span>=<span class="string">&quot;Product&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">xs:sequence</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">xs:element</span> <span class="attr">name</span>=<span class="string">&quot;CatalogueID&quot;</span> <span class="attr">type</span>=<span class="string">&quot;xs:int&quot;</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">xs:element</span> <span class="attr">name</span>=<span class="string">&quot;Name&quot;</span> <span class="attr">type</span>=<span class="string">&quot;xs:string&quot;</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">xs:element</span> <span class="attr">name</span>=<span class="string">&quot;Price&quot;</span> <span class="attr">type</span>=<span class="string">&quot;xs:double&quot;</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">xs:element</span> <span class="attr">name</span>=<span class="string">&quot;Manufacturer&quot;</span> <span class="attr">type</span>=<span class="string">&quot;xs:string&quot;</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">xs:element</span> <span class="attr">name</span>=<span class="string">&quot;InStock&quot;</span> <span class="attr">type</span>=<span class="string">&quot;xs:string&quot;</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">xs:element</span> <span class="attr">minOccurs</span>=<span class="string">&quot;0&quot;</span> <span class="attr">maxOccurs</span>=<span class="string">&quot;1&quot;</span> <span class="attr">name</span>=<span class="string">&quot;Extension&quot;</span> <span class="attr">type</span>=<span class="string">&quot;Extension&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">xs:sequence</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">xs:complexType</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">xs:complexType</span> <span class="attr">name</span>=<span class="string">&quot;Extension&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">xs:sequence</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">xs:any</span> <span class="attr">minOccurs</span>=<span class="string">&quot;1&quot;</span> <span class="attr">maxOccurs</span>=<span class="string">&quot;unbounded&quot;</span> <span class="attr">namespace</span>=<span class="string">&quot;##targetNamespace&quot;</span> <span class="attr">processContents</span>=<span class="string">&quot;lax&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">xs:sequence</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">xs:complexType</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">xs:schema</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>此架构在每个产品的底部包含一个可选的Extension元素。 扩展元素本身可以包含目标命名空间中的一个或多个元素：</p>
<p>图2：可扩展的搜索结果模式</p>
<img src="/2018/12/19/basic/013-consumer-driven-contracts/001.png" class="">

<p>现在，当我们收到向每个产品添加描述的更改请求时，我们可以发布一个新的模式，其中包含提供者插入扩展容器中的其他Description元素。 这允许ProductSearch服务返回包含产品描述的结果，并使用新模式的消费者来验证整个文档。 使用旧架构的消费者不会破坏，但他们不会处理描述。 新的结果文档如下所示：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Products</span> <span class="attr">xmlns</span>=<span class="string">&quot;urn:example.com:productsearch:products&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">Product</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">CatalogueID</span>&gt;</span>101<span class="tag">&lt;/<span class="name">CatalogueID</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Name</span>&gt;</span>Widget<span class="tag">&lt;/<span class="name">Name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Price</span>&gt;</span>10.99<span class="tag">&lt;/<span class="name">Price</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Manufacturer</span>&gt;</span>Company A<span class="tag">&lt;/<span class="name">Manufacturer</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">InStock</span>&gt;</span>Yes<span class="tag">&lt;/<span class="name">InStock</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Extension</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">Description</span>&gt;</span>Our top of the range widget<span class="tag">&lt;/<span class="name">Description</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">Extension</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">Product</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">Product</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">CatalogueID</span>&gt;</span>300<span class="tag">&lt;/<span class="name">CatalogueID</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Name</span>&gt;</span>Fooble<span class="tag">&lt;/<span class="name">Name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Price</span>&gt;</span>2.00<span class="tag">&lt;/<span class="name">Price</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Manufacturer</span>&gt;</span>Company B<span class="tag">&lt;/<span class="name">Manufacturer</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">InStock</span>&gt;</span>No<span class="tag">&lt;/<span class="name">InStock</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Extension</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">Description</span>&gt;</span>Our bargain fooble<span class="tag">&lt;/<span class="name">Description</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">Extension</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">Product</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">Products</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>修改后的架构如下所示：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">xs:schema</span> <span class="attr">xmlns</span>=<span class="string">&quot;urn:example.com:productsearch:products&quot;</span> </span></span><br><span class="line"><span class="tag">  <span class="attr">xmlns:xs</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">elementFormDefault</span>=<span class="string">&quot;qualified&quot;</span> </span></span><br><span class="line"><span class="tag">  <span class="attr">targetNamespace</span>=<span class="string">&quot;urn:example.com:productsearch:products&quot;</span> </span></span><br><span class="line"><span class="tag">  <span class="attr">id</span>=<span class="string">&quot;Products&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">xs:element</span> <span class="attr">name</span>=<span class="string">&quot;Products&quot;</span> <span class="attr">type</span>=<span class="string">&quot;Products&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">xs:complexType</span> <span class="attr">name</span>=<span class="string">&quot;Products&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">xs:sequence</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">xs:element</span> <span class="attr">minOccurs</span>=<span class="string">&quot;0&quot;</span> <span class="attr">maxOccurs</span>=<span class="string">&quot;unbounded&quot;</span> <span class="attr">name</span>=<span class="string">&quot;Product&quot;</span> <span class="attr">type</span>=<span class="string">&quot;Product&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">xs:sequence</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">xs:complexType</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">xs:complexType</span> <span class="attr">name</span>=<span class="string">&quot;Product&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">xs:sequence</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">xs:element</span> <span class="attr">name</span>=<span class="string">&quot;CatalogueID&quot;</span> <span class="attr">type</span>=<span class="string">&quot;xs:int&quot;</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">xs:element</span> <span class="attr">name</span>=<span class="string">&quot;Name&quot;</span> <span class="attr">type</span>=<span class="string">&quot;xs:string&quot;</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">xs:element</span> <span class="attr">name</span>=<span class="string">&quot;Price&quot;</span> <span class="attr">type</span>=<span class="string">&quot;xs:double&quot;</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">xs:element</span> <span class="attr">name</span>=<span class="string">&quot;Manufacturer&quot;</span> <span class="attr">type</span>=<span class="string">&quot;xs:string&quot;</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">xs:element</span> <span class="attr">name</span>=<span class="string">&quot;InStock&quot;</span> <span class="attr">type</span>=<span class="string">&quot;xs:string&quot;</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">xs:element</span> <span class="attr">minOccurs</span>=<span class="string">&quot;0&quot;</span> <span class="attr">maxOccurs</span>=<span class="string">&quot;1&quot;</span> <span class="attr">name</span>=<span class="string">&quot;Extension&quot;</span> <span class="attr">type</span>=<span class="string">&quot;Extension&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">xs:sequence</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">xs:complexType</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">xs:complexType</span> <span class="attr">name</span>=<span class="string">&quot;Extension&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">xs:sequence</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">xs:any</span> <span class="attr">minOccurs</span>=<span class="string">&quot;1&quot;</span> <span class="attr">maxOccurs</span>=<span class="string">&quot;unbounded&quot;</span> <span class="attr">namespace</span>=<span class="string">&quot;##targetNamespace&quot;</span> <span class="attr">processContents</span>=<span class="string">&quot;lax&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">xs:sequence</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">xs:complexType</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">xs:element</span> <span class="attr">name</span>=<span class="string">&quot;Description&quot;</span> <span class="attr">type</span>=<span class="string">&quot;xs:string&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">xs:schema</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>请注意，可扩展架构的第一个版本与第二个版本向前兼容，第二个版本与第一个版本向后兼容。 然而，这种灵活性是以增加复杂性为代价的。 可扩展的模式允许我们对XML语言进行无法预料的更改，但出于同样的原因，它们提供了可能永远不会出现的需求; 通过这样做，它们模糊了来自简单设计的表达能力，并通过将元信息容器元素引入域语言来挫败商业信息的有意义表示。</p>
<p>我们不会在这里进一步讨论模式可扩展性。 可以说，扩展点允许我们在不破坏服务提供商和消费者的情况下对模式和文档进行向后和向前兼容的更改。 但是，当我们需要制定表面上对合同的重大改变时，模式扩展不会帮助我们管理系统的演变。</p>

      
    </div> -->
          <div class="article-entry" itemprop="articleBody">
            
              
                
                      
                        
                          
                            
                              
                                
                                  
                                    <p>
                                      <p>本文翻译自：<a target="_blank" rel="noopener" href="https://martinfowler.com/articles/consumerDrivenContracts.html">https://martinfowler.com/articles/consumerDrivenContracts.html</a></p>

                                        <p>
                                          
                                            
                                              
                                                      
          </div>
    <p class="article-more-link">
      <a href="/2018/12/19/basic/013-consumer-driven-contracts/#more">
        Read More
      </a>
    </p>
    <!-- <div class="article-more-link">
      <a href="/2018/12/19/basic/013-consumer-driven-contracts/#more">
        read more
      </a>
    </div> -->
    


      <footer class="article-footer">
        <a data-url="http://http//jimolonely.github.io/2018/12/19/basic/013-consumer-driven-contracts/" data-id="cl1fw7fhy0011vkd3358q8icm" class="article-share-link">
          Share
        </a>
        
            
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/microservice/" rel="tag">microservice</a><span class="article-tag-list-count">9</span></li></ul>

      </footer>
      </div>
      
</article>


  
    <article id="post-basic/012-circuit-breaker" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/12/17/basic/012-circuit-breaker/" class="article-date">
  <time datetime="2018-12-17T06:22:07.000Z" itemprop="datePublished">2018-12-17</time>
</a>
      
  </div>
  <div class="article-inner">
    
      
        <header class="article-header">
          
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/12/17/basic/012-circuit-breaker/">断路器</a>
    </h1>
  

        </header>
        
          <!-- <div class="article-entry" itemprop="articleBody">
      
        <p>本文翻译自：<a target="_blank" rel="noopener" href="https://martinfowler.com/bliki/CircuitBreaker.html">https://martinfowler.com/bliki/CircuitBreaker.html</a></p>
<p>软件系统通常对在不同进程中运行的软件进行远程调用，可能在网络上的不同机器上进行。内存中调用和远程调用之间的一个重大区别是远程调用可能会失败，或者在达到某个超时限制之前挂起而没有响应。如果在没有响应的供应商上有许多调用者，那么更糟糕的是，您可能会耗尽关键资源，导致跨多个系统的级联故障。在他出色的书“<a target="_blank" rel="noopener" href="https://www.amazon.com/gp/product/0978739213?ie=UTF8&tag=martinfowlerc-20&linkCode=as2&camp=1789&creative=9325&creativeASIN=0978739213">发布它</a>”中，Michael Nygard推广了断路器模式，以防止这种灾难性的级联。</p>
<p>断路器背后的基本思想非常简单。将受保护的函数调用包装在断路器对象中，该对象监视故障。一旦故障达到某个阈值，断路器就会跳闸，并且所有对断路器的进一步调用都会返回错误，而根本不会进行受保护的调用。通常，如果断路器跳闸，您还需要某种监控器警报。</p>
<img src="/2018/12/17/basic/012-circuit-breaker/000.png" class="">

<p>下面是Ruby中这种行为的一个简单示例，可以防止超时。</p>
<p>我设置了一个带有块（<a target="_blank" rel="noopener" href="https://martinfowler.com/bliki/Lambda.html">Lambda</a>）的断路器，这是受保护的调用。</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cb = <span class="title class_">CircuitBreaker</span>.new &#123;|<span class="params">arg</span>| <span class="variable">@supplier</span>.func arg&#125;</span><br></pre></td></tr></table></figure>
<p>断路器 存储 块，初始化各种参数（用于阈值，超时和监视），并将断路器复位到其闭合状态。</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">CircuitBreaker</span>...</span><br><span class="line"></span><br><span class="line">  <span class="keyword">attr_accessor</span> <span class="symbol">:invocation_timeout</span>, <span class="symbol">:failure_threshold</span>, <span class="symbol">:monitor</span></span><br><span class="line">  <span class="keyword">def</span> <span class="title function_">initialize</span> &amp;block</span><br><span class="line">    <span class="variable">@circuit</span> = block</span><br><span class="line">    <span class="variable">@invocation_timeout</span> = <span class="number">0.01</span></span><br><span class="line">    <span class="variable">@failure_threshold</span> = <span class="number">5</span></span><br><span class="line">    <span class="variable">@monitor</span> = acquire_monitor</span><br><span class="line">    reset</span><br><span class="line">  <span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p>如果电路关闭，则调用断路器将调用底层块，但如果电路处于打开状态则返回错误</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># client code</span></span><br><span class="line">    aCircuitBreaker.call(<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">CircuitBreaker</span>...</span><br><span class="line"></span><br><span class="line">  <span class="keyword">def</span> <span class="title function_">call</span> args</span><br><span class="line">    <span class="keyword">case</span> state</span><br><span class="line">    <span class="keyword">when</span> <span class="symbol">:closed</span></span><br><span class="line">      <span class="keyword">begin</span></span><br><span class="line">        do_call args</span><br><span class="line">      <span class="keyword">rescue</span> Timeout::Error</span><br><span class="line">        record_failure</span><br><span class="line">        raise <span class="variable">$!</span></span><br><span class="line">      <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">when</span> <span class="symbol">:open</span> <span class="keyword">then</span> raise CircuitBreaker::Open</span><br><span class="line">    <span class="keyword">else</span> raise <span class="string">&quot;Unreachable Code&quot;</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line">  <span class="keyword">def</span> <span class="title function_">do_call</span> args</span><br><span class="line">    result = Timeout::timeout(<span class="variable">@invocation_timeout</span>) <span class="keyword">do</span></span><br><span class="line">      <span class="variable">@circuit</span>.call args</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    reset</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line">  <span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p>如果我们得到超时，则增加失败计数器，成功调用将其重置为零。</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">CircuitBreaker</span>...</span><br><span class="line"></span><br><span class="line">  <span class="keyword">def</span> <span class="title function_">record_failure</span></span><br><span class="line">    <span class="variable">@failure_count</span> += <span class="number">1</span></span><br><span class="line">    <span class="variable">@monitor</span>.alert(<span class="symbol">:open_circuit</span>) <span class="keyword">if</span> <span class="symbol">:open</span> == state</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line">  <span class="keyword">def</span> <span class="title function_">reset</span></span><br><span class="line">    <span class="variable">@failure_count</span> = <span class="number">0</span></span><br><span class="line">    <span class="variable">@monitor</span>.alert <span class="symbol">:reset_circuit</span></span><br><span class="line">  <span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p>我确定断路器的状态，将故障计数与阈值进行比较</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">CircuitBreaker</span>...</span><br><span class="line"></span><br><span class="line">  <span class="keyword">def</span> <span class="title function_">state</span></span><br><span class="line">     (<span class="variable">@failure_count</span> &gt;= <span class="variable">@failure_threshold</span>) ? <span class="symbol">:open</span> : <span class="symbol">:closed</span></span><br><span class="line">  <span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p>这个简单的断路器避免在电路打开时进行受保护的调用，但是当事情再次发生时需要外部干预来重置它。 这是电子断路器的合理方法，但对于软件断路器，我们可以让断路器本身检测基础调用是否再次起作用。我们可以通过在适当的时间间隔后再次尝试受保护的调用来实现此自复位行为，并在成功时重置断路器。</p>
<img src="/2018/12/17/basic/012-circuit-breaker/001.png" class="">

<p>创建此类断路器意味着添加用于尝试重置的阈值并设置变量以保持最后一个错误的时间。</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">ResetCircuitBreaker</span>...</span><br><span class="line"></span><br><span class="line">  <span class="keyword">def</span> <span class="title function_">initialize</span> &amp;block</span><br><span class="line">    <span class="variable">@circuit</span> = block</span><br><span class="line">    <span class="variable">@invocation_timeout</span> = <span class="number">0.01</span></span><br><span class="line">    <span class="variable">@failure_threshold</span> = <span class="number">5</span></span><br><span class="line">    <span class="variable">@monitor</span> = BreakerMonitor.new</span><br><span class="line">    <span class="variable">@reset_timeout</span> = <span class="number">0.1</span></span><br><span class="line">    reset</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line">  <span class="keyword">def</span> <span class="title function_">reset</span></span><br><span class="line">    <span class="variable">@failure_count</span> = <span class="number">0</span></span><br><span class="line">    <span class="variable">@last_failure_time</span> = <span class="literal">nil</span></span><br><span class="line">    <span class="variable">@monitor</span>.alert <span class="symbol">:reset_circuit</span></span><br><span class="line">  <span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p>现在有第三个状态 - 半开 - 意味着电路准备好作为试验进行真正的通话，以查看问题是否已解决。</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">ResetCircuitBreaker</span>...</span><br><span class="line"></span><br><span class="line">  <span class="keyword">def</span> <span class="title function_">state</span></span><br><span class="line">    <span class="keyword">case</span></span><br><span class="line">    <span class="keyword">when</span> (<span class="variable">@failure_count</span> &gt;= <span class="variable">@failure_threshold</span>) &amp;&amp; </span><br><span class="line">        (Time.now - <span class="variable">@last_failure_time</span>) &gt; <span class="variable">@reset_timeout</span></span><br><span class="line">      <span class="symbol">:half_open</span></span><br><span class="line">    <span class="keyword">when</span> (<span class="variable">@failure_count</span> &gt;= <span class="variable">@failure_threshold</span>)</span><br><span class="line">      <span class="symbol">:open</span></span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">      <span class="symbol">:closed</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">  <span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p>要求在半开状态下调用导致试用调用，如果成功则重置断路器，否则重启超时。</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">ResetCircuitBreaker</span>...</span><br><span class="line"></span><br><span class="line">  <span class="keyword">def</span> <span class="title function_">call</span> args</span><br><span class="line">    <span class="keyword">case</span> state</span><br><span class="line">    <span class="keyword">when</span> <span class="symbol">:closed</span>, <span class="symbol">:half_open</span></span><br><span class="line">      <span class="keyword">begin</span></span><br><span class="line">        do_call args</span><br><span class="line">      <span class="keyword">rescue</span> Timeout::Error</span><br><span class="line">        record_failure</span><br><span class="line">        raise <span class="variable">$!</span></span><br><span class="line">      <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">when</span> <span class="symbol">:open</span></span><br><span class="line">      raise CircuitBreaker::Open</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">      raise <span class="string">&quot;Unreachable&quot;</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line">  <span class="keyword">def</span> <span class="title function_">record_failure</span></span><br><span class="line">    <span class="variable">@failure_count</span> += <span class="number">1</span></span><br><span class="line">    <span class="variable">@last_failure_time</span> = Time.now</span><br><span class="line">    <span class="variable">@monitor</span>.alert(<span class="symbol">:open_circuit</span>) <span class="keyword">if</span> <span class="symbol">:open</span> == state</span><br><span class="line">  <span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<p>这个例子是一个简单的解释，在实践中断路器提供了更多的功能和参数化。通常，它们可以防止一系列保护调用可能引发的错误，例如网络连接故障。并非所有错误都应该使电路跳闸，有些应该反映正常故障并作为常规逻辑的一部分处理。</p>
<p>由于流量很大，您可能会遇到许多调用等待初始超时的问题。由于远程调用通常很慢，因此通常最好将每个调用放在不同的线程上，使用<a target="_blank" rel="noopener" href="http://en.wikipedia.org/wiki/Futures_and_promises">未来或承诺</a>在它们返回时处理结果。通过从线程池中建立这些线程，可以在线程池耗尽时安排电路中断。</p>
<p>该示例显示了一种简单的断路器跳闸方式 - 一个重置成功调用的计数。一种更复杂的方法可能会考虑错误的频率，一旦你获得50％的失败率就会绊倒。对于不同的错误，您可能也有不同的阈值，例如超时的阈值为10，连接失败的阈值为3。</p>
<p>我展示的示例是用于同步调用的断路器，但断路器对于异步通信也很有用。这里的一种常见技术是将所有请求放在队列中，供应商以其速度消耗 - 这是避免服务器过载的有用技术。在这种情况下，当队列填满时电路会中断。</p>
<p>断路器本身可以帮助减少可能出现故障的运营中的资源。您可以避免等待客户端的超时，并且断开的电路可以避免将负载放在苦苦挣扎的服务器上。我在这里谈论远程调用，这是断路器的常见情况，但它们可以用于任何你想要保护系统部件免受其他部分故障的情况。</p>
<p>断路器是一个有价值的监控场所。应记录断路器状态的任何变化，断路器应显示其状态的详细信息，以便进行更深入的监控。断路器行为通常是关于环境中更深层次问题的警告的良好来源。操作人员应该能够绊倒或重置断路器。</p>
<p>断路器本身很有价值，但使用它们的客户需要对断路器故障做出反应。与任何远程调用一样，您需要考虑在发生故障时该怎么做。它是否会使您正在执行的操作失败，或者您可以执行哪些操作？信用卡授权可以放在队列中以便稍后处理，可以通过显示一些足以显示的陈旧数据来减轻获取某些数据的失败。</p>

      
    </div> -->
          <div class="article-entry" itemprop="articleBody">
            
              
                
                      
                        
                          
                            
                              
                                
                                  
                                    <p>
                                      <p>本文翻译自：<a target="_blank" rel="noopener" href="https://martinfowler.com/bliki/CircuitBreaker.html">https://martinfowler.com/bliki/CircuitBreaker.html</a></p>

                                        <p>
                                          
                                            
                                              
                                                      
          </div>
    <p class="article-more-link">
      <a href="/2018/12/17/basic/012-circuit-breaker/#more">
        Read More
      </a>
    </p>
    <!-- <div class="article-more-link">
      <a href="/2018/12/17/basic/012-circuit-breaker/#more">
        read more
      </a>
    </div> -->
    


      <footer class="article-footer">
        <a data-url="http://http//jimolonely.github.io/2018/12/17/basic/012-circuit-breaker/" data-id="cl1fw7fhy0014vkd303alh0gb" class="article-share-link">
          Share
        </a>
        
            
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/microservice/" rel="tag">microservice</a><span class="article-tag-list-count">9</span></li></ul>

      </footer>
      </div>
      
</article>


  
    <article id="post-tools/012-idea-question" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/12/14/tools/012-idea-question/" class="article-date">
  <time datetime="2018-12-14T01:30:49.000Z" itemprop="datePublished">2018-12-14</time>
</a>
      
  </div>
  <div class="article-inner">
    
      
        <header class="article-header">
          
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/12/14/tools/012-idea-question/">idea常见问题</a>
    </h1>
  

        </header>
        
          <!-- <div class="article-entry" itemprop="articleBody">
      
        <h1 id="如何不格式化注释"><a href="#如何不格式化注释" class="headerlink" title="如何不格式化注释"></a>如何不格式化注释</h1><p>在使用<code>Ctrl+Alt+L</code>进行格式化时，不想格式化注释。</p>
<h2 id="方法1"><a href="#方法1" class="headerlink" title="方法1"></a>方法1</h2><p>使用手动标注：</p>
<img src="/2018/12/14/tools/012-idea-question/000.png" class="">

<p>然后就可以使用了：在不想注释的前后加上关闭，开启（为何要开启，因为关闭会影响后面所有代码）</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// @formatter:off</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 判断x是否可以由list中的数字不重复相加得到</span></span><br><span class="line"><span class="comment"> * &lt;p&gt;</span></span><br><span class="line"><span class="comment"> * x = a + list</span></span><br><span class="line"><span class="comment"> *          |</span></span><br><span class="line"><span class="comment"> *          a1 + list1</span></span><br><span class="line"><span class="comment"> *                  |</span></span><br><span class="line"><span class="comment"> *                  a2 + list2</span></span><br><span class="line"><span class="comment"> *                          ...</span></span><br><span class="line"><span class="comment"> *                          an + y</span></span><br><span class="line"><span class="comment"> * &lt;/p&gt;</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="comment">// @formatter:on</span></span><br><span class="line"><span class="keyword">private</span> <span class="type">boolean</span> <span class="title function_">foundEqual</span><span class="params">(Integer x, List&lt;Integer&gt; list)</span> &#123;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="方法2"><a href="#方法2" class="headerlink" title="方法2"></a>方法2</h2><p>直接禁用注释的格式化：这个影响是全局的，可能没那么可定制化。<br>以Java为例：</p>
<img src="/2018/12/14/tools/012-idea-question/001.png" class="">

<p>有意思是吧，看自己的选择了。</p>
<h1 id="idea里markdown绘制UML图"><a href="#idea里markdown绘制UML图" class="headerlink" title="idea里markdown绘制UML图"></a>idea里markdown绘制UML图</h1><p><a target="_blank" rel="noopener" href="https://www.jetbrains.com/help/idea/markdown.html">https://www.jetbrains.com/help/idea/markdown.html</a></p>
<p>这样下载：</p>
<img src="/2018/12/14/tools/012-idea-question/002.png" class="">

<p>需要安装：Graphviz<br><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/6c4071eac339">https://www.jianshu.com/p/6c4071eac339</a><br><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/a6bd7e3048ef">https://www.jianshu.com/p/a6bd7e3048ef</a></p>
<h2 id="其他选择"><a href="#其他选择" class="headerlink" title="其他选择"></a>其他选择</h2><p>直接建立uml文件：</p>
<p>安装一个插件：plantuml integration.</p>
<p><a target="_blank" rel="noopener" href="https://plugins.jetbrains.com/plugin/7017-plantuml-integration">https://plugins.jetbrains.com/plugin/7017-plantuml-integration</a></p>
<p>绘制语法：<a target="_blank" rel="noopener" href="http://plantuml.com/">http://plantuml.com/</a></p>
<h1 id="返回上一步下一步"><a href="#返回上一步下一步" class="headerlink" title="返回上一步下一步"></a>返回上一步下一步</h1><p>用于经常看源码。</p>
<p>由于不同操作系统不一样，所以需要去看自己的配置： keymap–&gt;navigate—&gt;back&#x2F;forward</p>
<img src="/2018/12/14/tools/012-idea-question/003.png" class="">

<p>如果冲突了，就需要排查系统快捷键或其他软件，或自己改一下idea的快捷键。</p>
<h1 id="idea如何查看类图"><a href="#idea如何查看类图" class="headerlink" title="idea如何查看类图"></a>idea如何查看类图</h1><p><a target="_blank" rel="noopener" href="https://www.jetbrains.com/help/idea/class-diagram.html">https://www.jetbrains.com/help/idea/class-diagram.html</a></p>
<p>在包上右键，选择diagram.</p>
<h1 id="IDEA-设置代码行宽度"><a href="#IDEA-设置代码行宽度" class="headerlink" title="IDEA 设置代码行宽度"></a>IDEA 设置代码行宽度</h1><ol>
<li><p>在File-&gt;settings-&gt;Editor-&gt;Code Style</p>
</li>
<li><p>有人会问，如果输入的代码超出宽度界线时，如何让IDE自动将代码换行？有两种方式！</p>
</li>
<li><p>第一种，在上述的“Right margin (columns)”的下方，有“Wrap when typing reaches right margin”选项，选中它，是什么效果呢？</p>
</li>
<li><p>随着输入的字符的增加，当代码宽度到达界线时，IDEA会自动将代码换行。</p>
</li>
<li><p>第一种方式是在输入代码时触发，还有第二种方式，在File-&gt;settings-&gt;Code Style-&gt;Java中，选中“Wrapping and Braces”选项卡</p>
</li>
<li><p>在“Keep when reformatting”中有一个“Ensure rigth margin is not exceeded”，选中它，是什么效果呢？</p>
</li>
<li><p>从配置项的字面意思很容易理解，在格式化Java代码时，确保代码没有超过宽度界线。</p>
</li>
<li><p>即输入的代码超出界线后</p>
</li>
</ol>
<h1 id="IntelliJ强制更新Maven-Dependencies"><a href="#IntelliJ强制更新Maven-Dependencies" class="headerlink" title="IntelliJ强制更新Maven Dependencies"></a>IntelliJ强制更新Maven Dependencies</h1><p>Intellj 自动载入Mave依赖的功能很好用，但有时候会碰到问题，导致pom文件修改却没有触发自动重新载入的动作，此时需要手动强制更新依赖。</p>
<p>如下： </p>
<ol>
<li><p>手动删除Project Settings里面的Libraries内容；</p>
</li>
<li><p>在Maven Project的试图里clean一下，删除之前编译过的文件；</p>
</li>
<li><p>项目右键-》Maven-》Reimport</p>
</li>
<li><p>Ok， 此时发现依赖已经建立！</p>
</li>
</ol>
<h1 id="垂直列选择"><a href="#垂直列选择" class="headerlink" title="垂直列选择"></a>垂直列选择</h1><p>按住alt，使用鼠标选择。</p>

      
    </div> -->
          <div class="article-entry" itemprop="articleBody">
            
              
                
                      
                        
                          
                            
                              
                                
                                  
                                    <p>
                                      <h1 id="如何不格式化注释"><a href="#如何不格式化注释" class="headerlink" title="如何不格式化注释"></a>如何不格式化注释</h1><p>在使用<code>Ctrl+Alt+L</code>进行格式化时，不想格式化注释。</p>

                                        <p>
                                          
                                            
                                              
                                                      
          </div>
    <p class="article-more-link">
      <a href="/2018/12/14/tools/012-idea-question/#more">
        Read More
      </a>
    </p>
    <!-- <div class="article-more-link">
      <a href="/2018/12/14/tools/012-idea-question/#more">
        read more
      </a>
    </div> -->
    


      <footer class="article-footer">
        <a data-url="http://http//jimolonely.github.io/2018/12/14/tools/012-idea-question/" data-id="cl1fw7fo300l3vkd3avfv7wer" class="article-share-link">
          Share
        </a>
        
            
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/idea/" rel="tag">idea</a><span class="article-tag-list-count">3</span></li></ul>

      </footer>
      </div>
      
</article>


  
    <article id="post-algorithm/000-week-algo" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/12/14/algorithm/000-week-algo/" class="article-date">
  <time datetime="2018-12-14T00:24:37.000Z" itemprop="datePublished">2018-12-14</time>
</a>
      
  </div>
  <div class="article-inner">
    
      
        <header class="article-header">
          
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/12/14/algorithm/000-week-algo/">week algorithm</a>
    </h1>
  

        </header>
        
          <!-- <div class="article-entry" itemprop="articleBody">
      
        <h1 id="1-超哥的大眼球（2018-12-13～2018-12-20）"><a href="#1-超哥的大眼球（2018-12-13～2018-12-20）" class="headerlink" title="1.超哥的大眼球（2018-12-13～2018-12-20）"></a>1.超哥的大眼球（2018-12-13～2018-12-20）</h1><p>超哥开了一个造仿真机器人的公司，最近新出了一个造机器人眼球的测试机，但是造出来的眼球大小不一，你知道造眼球的原料很贵的，为了不浪费，他想将这些眼球合并成2个最大的眼球，当然不是为了摸的，是用来做广告宣传。<br>问题来了，2个眼球必须一样大，且原来的单个小眼球不可分割，如果能够造成功，返回最大眼球的size，否则返回0。<br>例如：<br>输入小眼球数组(eyeball[n])：[1,1,2,3,6]，输出6（1，2，3合并为6,余下1）；<br>输入：[1,2]，返回0，不可造。</p>
<p>请大家帮助超哥吧^_^。</p>
<p>数据限制：</p>
<ol>
<li>1&lt;&#x3D; n &lt;&#x3D;20</li>
<li>1&lt;&#x3D; eyeball[i] &lt;&#x3D;1000 (0&lt;&#x3D;i&lt;n)</li>
<li>size&lt;&#x3D;5000(即眼球最大为5000)</li>
</ol>
<h1 id="答案"><a href="#答案" class="headerlink" title="答案"></a>答案</h1><p>大脑就像肌肉，也是需要锻炼的，否则会卡在一个舒适区很难走出来，就像看抖音的人和想方设法制作抖音视频的人。<br>我们人类善于从已有知识中总结经验，这是目前和计算机的最大差别，但是人类的这个进化过程异常缓慢，几千年来<br>智力都还差不多，可能我是个进化的失败品把。</p>
<h2 id="1"><a href="#1" class="headerlink" title="1."></a>1.</h2><p>复杂的东西可能很容易，简单的东西也可能很难理解。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">bigEyeball</span><span class="params">(<span class="type">int</span>[] eyes)</span> &#123;</span><br><span class="line">		<span class="type">int</span> <span class="variable">maxSize</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">    <span class="comment">// TODO</span></span><br><span class="line">		<span class="keyword">return</span> maxSize;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<h3 id="让我们热身吧"><a href="#让我们热身吧" class="headerlink" title="让我们热身吧"></a>让我们热身吧</h3><p>你能想到的最直接的算法，实现它。</p>
<p>思考最大size的构成：</p>
<ol>
<li>可能就是其中一个小球的size： eye[i]</li>
<li>可能是其中2个小球+起来的size： eye[i1] + eye[i2]</li>
<li>可能是其中3个小球+起来的size： eye[i1] + eye[i2] + eye[i3]</li>
<li>可能是其中**n-1(当然不可能是n个)**个小球+起来的size： eye[i] +…+ eye[n-1]</li>
</ol>
<p>于是进一步思考：n-1不就等价于1个吗？ 于是猜测，只需要考虑一半的情况？（有待证明）这可是一个大的飞跃，直接奠定了计算机的基础！</p>
<p>然后我们可以求出以上每种情况的解，取最大即可。</p>
<p>于是：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">bigEyeball</span><span class="params">(<span class="type">int</span>[] eyes)</span> &#123;</span><br><span class="line">	<span class="type">int</span> <span class="variable">maxSize</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">	<span class="comment">// 1</span></span><br><span class="line">	maxSize = Math.max(maxSize, getMax1(eyes));</span><br><span class="line">	<span class="comment">// 2</span></span><br><span class="line">	maxSize = Math.max(maxSize, getMax2(eyes));</span><br><span class="line">	<span class="comment">//...</span></span><br><span class="line">	<span class="comment">// 19</span></span><br><span class="line">	maxSize = Math.max(maxSize, getMax19(eyes));</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> maxSize;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>没错，因为<code>n&lt;=20</code>,所以我们只需要写19个方法。。。</p>
<h4 id="如何实现getMax1"><a href="#如何实现getMax1" class="headerlink" title="如何实现getMax1()"></a>如何实现getMax1()</h4><p>一个小球，这个问题不就变成了给定一个数组，判断其中一个数字能否由其他数字相加得到？<br>对把，那就简单了：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="type">int</span> <span class="title function_">getMax1</span><span class="params">(<span class="type">int</span>[] eyes)</span> &#123;</span><br><span class="line">	<span class="type">int</span> <span class="variable">max</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; eyes.length; j++) &#123;</span><br><span class="line">		<span class="keyword">if</span> (foundEqual(eyes[j], removeIndex(eyes, j))) &#123;</span><br><span class="line">			max = Math.max(max, eyes[j]);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> max;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 移除arr中下标i对应的元素，返回一个新的数组</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">private</span> <span class="type">int</span>[] removeIndex(<span class="type">int</span>[] arr, <span class="type">int</span> i) &#123;</span><br><span class="line">	<span class="type">int</span>[] sub = <span class="keyword">new</span> <span class="title class_">int</span>[arr.length - <span class="number">1</span>];</span><br><span class="line">	<span class="type">int</span> <span class="variable">k</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; arr.length; j++) &#123;</span><br><span class="line">		<span class="keyword">if</span> (i != j) &#123;</span><br><span class="line">			sub[k++] = arr[j];</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> sub;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>boolean foundEqual(int x, int[] arr)</code>干什么： 判断x是否能由arr中的元素相加得到，是返回true.</p>
<p>现在，这个问题怎么办？ 依然采用复杂的思考方式，如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">* x = <span class="number">0</span> + arr(n)</span><br><span class="line">*          |</span><br><span class="line">*          a1 + arr(n-<span class="number">1</span>)</span><br><span class="line">*                  |</span><br><span class="line">*                  a2 + arr(n-<span class="number">2</span>)</span><br><span class="line">*                          ...</span><br><span class="line">*                          an-<span class="number">1</span> + arr1</span><br></pre></td></tr></table></figure>
<p>既然这样，一个递归完全能搞定了：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">boolean</span> <span class="title function_">foundEqual</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span>[] arr)</span> &#123;</span><br><span class="line">	<span class="keyword">if</span> (x == <span class="number">0</span>) &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> (x &lt; <span class="number">0</span>) &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> (arr.length == <span class="number">1</span>) &#123;</span><br><span class="line">		<span class="type">return</span> <span class="variable">x</span> <span class="operator">=</span>= arr[<span class="number">0</span>];</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; arr.length; i++) &#123;</span><br><span class="line">		<span class="type">int</span>[] sub = removeIndex(arr, i);</span><br><span class="line">		<span class="type">boolean</span> <span class="variable">ok</span> <span class="operator">=</span> foundEqual(x - arr[i], sub);</span><br><span class="line">		<span class="keyword">if</span> (ok) &#123;</span><br><span class="line">			<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>那么这个问题就算完成了，谁都可以写出来，那它的时间复杂度是多少呢？ </p>
<p><code>f(n) = n*f(n-1) = n*(n-1)*f(n-2) = ... = n!</code>, 所以最坏是<code>O(n!)</code></p>
<p>19!&#x3D;1.22e+17, 如果每秒进行一亿次运算，大概要3.17年，还不算太长，谷歌还花了2年研究如何破解SHA-1呢。</p>
<h4 id="如何实现getMaxn"><a href="#如何实现getMaxn" class="headerlink" title="如何实现getMaxn()"></a>如何实现getMaxn()</h4><p>现在，我们实现了<code>getMax1()</code>，那么<code>getMaxn()</code>怎么实现？</p>
<p>同样的思路，选择2个小球：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="type">int</span> <span class="title function_">getMax2</span><span class="params">(<span class="type">int</span>[] eyes)</span> &#123;</span><br><span class="line">	<span class="type">int</span> <span class="variable">max</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; eyes.length - <span class="number">1</span>; i++) &#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> i + <span class="number">1</span>; j &lt; eyes.length; j++) &#123;</span><br><span class="line">			<span class="type">int</span>[] sub = removeIndex(removeIndex(eyes, j), i);</span><br><span class="line">			<span class="type">int</span> <span class="variable">x</span> <span class="operator">=</span> eyes[i] + eyes[j];</span><br><span class="line">			<span class="keyword">if</span> (foundEqual(x, sub)) &#123;</span><br><span class="line">				max = Math.max(max, x);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> max;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>思考： 如果由2个小球构成，是否可等价于已经确定一个小球，剩下的变为一个小球问题？ 如果可以，那么就简单了：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; eyes.length; j++) &#123;</span><br><span class="line">	<span class="type">int</span>[] sub = removeIndex(eyes, j);</span><br><span class="line">	<span class="comment">//1</span></span><br><span class="line">	max = Math.max(max, eyes[j] + getMax1(sub));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>可惜答案是no，比如[5,4,3,2,1]。</p>
<p>2个选择2个循环，3个也就需要3个，19个循环你写过吗？ 仔细一看，这也就是个组合问题，所以可以改成通用形式：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Comb</span> &#123;</span><br><span class="line">	<span class="type">int</span> sum;</span><br><span class="line">	<span class="type">int</span>[] sub;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">bigEyeball</span><span class="params">(<span class="type">int</span>[] eyes)</span> &#123;</span><br><span class="line">	<span class="type">int</span> <span class="variable">maxSize</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">	<span class="comment">// 每一种情况：从1到n-1</span></span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt; eyes.length; i++) &#123;</span><br><span class="line">		<span class="comment">// 求得这种情况下所有组合和子数组</span></span><br><span class="line">		Comb[] c = getCombination(eyes, i);</span><br><span class="line">		<span class="keyword">for</span> (Comb comb : c) &#123;</span><br><span class="line">			<span class="keyword">if</span> (foundEqual(comb.sum, comb.sub)) &#123;</span><br><span class="line">				maxSize = Math.max(maxSize, comb.sum);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> maxSize;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>关于<code>getCombination()</code>方法是可以实现的，也就是<a target="_blank" rel="noopener" href="https://cgs1999.iteye.com/blog/2327664">m选n的组合问题</a>，或参考<a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/29910312/algorithm-to-get-all-the-combinations-of-size-n-from-an-array-java">stackoverflow</a>。</p>
<p>到此为止，热身运动做完了，可以开始正式活动了。</p>
<p>人天生具有很好的递归思维。</p>
<h3 id="来段长跑吧"><a href="#来段长跑吧" class="headerlink" title="来段长跑吧"></a>来段长跑吧</h3><p>你觉得<code>n!</code>就很厉害了吗？ nonono， 再想想，一定可以想出更低复杂度的。</p>
<p>我们想得到2个球对把，不重复的选择，那么一个球的可能情况不就刚好3种情况：</p>
<ol>
<li>做成球1</li>
<li>做成球2</li>
<li>被抛弃</li>
</ol>
<p>如果遍历出每个球的所有情况，也才 <code>3^20=3486784401</code>, 远低于<code>19!</code>。所以，这个简单：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">bigEyeball</span><span class="params">(<span class="type">int</span>[] eyes)</span> &#123;</span><br><span class="line">	<span class="type">int</span> <span class="variable">maxSize</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; Math.pow(<span class="number">3</span>, eyes.length); i++) &#123;</span><br><span class="line">		<span class="type">int</span> <span class="variable">k</span> <span class="operator">=</span> i;</span><br><span class="line">		<span class="type">int</span> <span class="variable">s1</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">		<span class="type">int</span> <span class="variable">s2</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="type">int</span> s : eyes) &#123;</span><br><span class="line">			<span class="keyword">if</span> (k % <span class="number">3</span> == <span class="number">0</span>) &#123;</span><br><span class="line">				<span class="comment">// 加入球1</span></span><br><span class="line">				s1 += s;</span><br><span class="line">			&#125; <span class="keyword">else</span> <span class="keyword">if</span> (k % <span class="number">3</span> == <span class="number">1</span>) &#123;</span><br><span class="line">				<span class="comment">// 加入球2</span></span><br><span class="line">				s2 += s;</span><br><span class="line">			&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">				<span class="comment">// 都不加入</span></span><br><span class="line">			&#125;</span><br><span class="line">			k /= <span class="number">3</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (s1 == s2) &#123;</span><br><span class="line">			maxSize = Math.max(maxSize, s1);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> maxSize;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>当然，这并不是唯一的一种暴力求解方法，还可以利用数组: 这个思想的解释见下面一节。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">Ball[] state = <span class="keyword">new</span> <span class="title class_">Ball</span>[(<span class="type">int</span>) Math.pow(<span class="number">3</span>, eyes.length)];</span><br><span class="line"><span class="type">int</span> <span class="variable">t</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">state[t++] = <span class="keyword">new</span> <span class="title class_">Ball</span>(<span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> size : eyes) &#123;</span><br><span class="line">	<span class="type">int</span> <span class="variable">end</span> <span class="operator">=</span> t;</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; end; i++) &#123;</span><br><span class="line">		<span class="type">Ball</span> <span class="variable">b</span> <span class="operator">=</span> state[i];</span><br><span class="line">		<span class="comment">// 放入s1</span></span><br><span class="line">		state[t++] = <span class="keyword">new</span> <span class="title class_">Ball</span>(b.s1 + size, b.s2);</span><br><span class="line">		<span class="comment">// 放入s2</span></span><br><span class="line">		state[t++] = <span class="keyword">new</span> <span class="title class_">Ball</span>(b.s1, b.s2 + size);</span><br><span class="line">		<span class="comment">// 不放，舍去</span></span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (Ball b : state) &#123;</span><br><span class="line">	<span class="keyword">if</span> (b.s1 == b.s2) &#123;</span><br><span class="line">		maxSize = Math.max(maxSize, b.s1);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="找个捷径穿过去"><a href="#找个捷径穿过去" class="headerlink" title="找个捷径穿过去"></a>找个捷径穿过去</h3><p>我们有<code>3^N</code>种可能的状态，每个小球x要么放入s1，要么放入s2，要么不放，为了方便计算，我们用数字表示，分别对应：+x，-x 或 0。</p>
<p>为了加快速度，我们先单独求解每一半，然后将它们结合起来。例如，如果我们有球[1,2,3,6]，那么前两个球最多可以创建九种状态：<br><code>[0 + 0,1 + 0,0 - 1,2 + 0,0 - 2，3 + 0，1 - 2,2 - 1,0 - 3]</code>，后两个球也可以创造9个状态。<br>我们将每个状态存储为正项的总和，以及负项的绝对值之和。例如，<code>+ 1 + 2 -3 -4</code>变为（3,7）。<br>我们也将差值<code>3  -  7</code>称为该状态的增量，因此该状态的增量为-4。</p>
<p>我们的下一个目标是将总和为0的增量的状态 结合起来。状态的大小将是正项的总和， 我们希望获得最大大小。请注意，对于每个增量，我们只关心大小最大的状态。</p>
<p>算法</p>
<ol>
<li>将球分成两半：左右两侧。</li>
<li>对于每一半，使用暴力计算上面定义的可达状态。然后，对于每个状态，记录增量和最大分数。</li>
<li>现在，我们有一个左右两半的[（增量，分数）]信息。我们将找到总增量为0的最大总分。</li>
</ol>
<p>如何计算每一半的状态：就是上一节的第二种暴力方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> Map&lt;Integer, Integer&gt; <span class="title function_">cal</span><span class="params">(<span class="type">int</span>[] sizes)</span> &#123;</span><br><span class="line">	Ball[] state = <span class="keyword">new</span> <span class="title class_">Ball</span>[(<span class="type">int</span>) Math.pow(<span class="number">3</span>, sizes.length)];</span><br><span class="line">	<span class="type">int</span> <span class="variable">t</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">	state[t++] = <span class="keyword">new</span> <span class="title class_">Ball</span>(<span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> size : sizes) &#123;</span><br><span class="line">		<span class="type">int</span> <span class="variable">end</span> <span class="operator">=</span> t;</span><br><span class="line">		<span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; end; i++) &#123;</span><br><span class="line">			<span class="type">Ball</span> <span class="variable">b</span> <span class="operator">=</span> state[i];</span><br><span class="line">			<span class="comment">// 放入s1</span></span><br><span class="line">			state[t++] = <span class="keyword">new</span> <span class="title class_">Ball</span>(b.s1 + size, b.s2);</span><br><span class="line">			<span class="comment">// 放入s2</span></span><br><span class="line">			state[t++] = <span class="keyword">new</span> <span class="title class_">Ball</span>(b.s1, b.s2 + size);</span><br><span class="line">			<span class="comment">// 不放，舍去</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">// ...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这个求解的结果如下：以[1,2,3,6]为例，下面是前半段[1,2]的状态集：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Ball&#123;s1=<span class="number">0</span>, s2=<span class="number">0</span>&#125;</span><br><span class="line">Ball&#123;s1=<span class="number">1</span>, s2=<span class="number">0</span>&#125;</span><br><span class="line">Ball&#123;s1=<span class="number">0</span>, s2=<span class="number">1</span>&#125;</span><br><span class="line">Ball&#123;s1=<span class="number">2</span>, s2=<span class="number">0</span>&#125;</span><br><span class="line">Ball&#123;s1=<span class="number">0</span>, s2=<span class="number">2</span>&#125;</span><br><span class="line">Ball&#123;s1=<span class="number">3</span>, s2=<span class="number">0</span>&#125;</span><br><span class="line">Ball&#123;s1=<span class="number">1</span>, s2=<span class="number">2</span>&#125;</span><br><span class="line">Ball&#123;s1=<span class="number">2</span>, s2=<span class="number">1</span>&#125;</span><br><span class="line">Ball&#123;s1=<span class="number">0</span>, s2=<span class="number">3</span>&#125;</span><br></pre></td></tr></table></figure>
<p>接着求解增量状态：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Map&lt;Integer, Integer&gt; map = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;(t);</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; t; i++) &#123;</span><br><span class="line">	<span class="type">int</span> <span class="variable">s1</span> <span class="operator">=</span> state[i].s1;</span><br><span class="line">	<span class="type">int</span> <span class="variable">s2</span> <span class="operator">=</span> state[i].s2;</span><br><span class="line">	map.put(s1 - s2, Math.max(map.getOrDefault(s1 - s2, <span class="number">0</span>), s1));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>最后是合并，完整代码如下：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">bigEyeBallHalf</span><span class="params">(<span class="type">int</span>[] eyes)</span> &#123;</span><br><span class="line">	<span class="type">int</span> <span class="variable">maxSize</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">	<span class="type">int</span> <span class="variable">n</span> <span class="operator">=</span> eyes.length;</span><br><span class="line">	Map&lt;Integer, Integer&gt; delta1 = cal(Arrays.copyOfRange(eyes, <span class="number">0</span>, n / <span class="number">2</span>));</span><br><span class="line">	Map&lt;Integer, Integer&gt; delta2 = cal(Arrays.copyOfRange(eyes, n / <span class="number">2</span>, n));</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 合并，差值为0的最大情况</span></span><br><span class="line">	<span class="keyword">for</span> (Integer d : delta1.keySet()) &#123;</span><br><span class="line">		<span class="keyword">if</span> (delta2.containsKey(-d)) &#123;</span><br><span class="line">			maxSize = Math.max(maxSize, delta1.get(d) + delta2.get(-d));</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> maxSize;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> Map&lt;Integer, Integer&gt; <span class="title function_">cal</span><span class="params">(<span class="type">int</span>[] sizes)</span> &#123;</span><br><span class="line">	Ball[] state = <span class="keyword">new</span> <span class="title class_">Ball</span>[(<span class="type">int</span>) Math.pow(<span class="number">3</span>, sizes.length)];</span><br><span class="line">	<span class="type">int</span> <span class="variable">t</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">	state[t++] = <span class="keyword">new</span> <span class="title class_">Ball</span>(<span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> size : sizes) &#123;</span><br><span class="line">		<span class="type">int</span> <span class="variable">end</span> <span class="operator">=</span> t;</span><br><span class="line">		<span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; end; i++) &#123;</span><br><span class="line">			<span class="type">Ball</span> <span class="variable">b</span> <span class="operator">=</span> state[i];</span><br><span class="line">			<span class="comment">// 放入s1</span></span><br><span class="line">			state[t++] = <span class="keyword">new</span> <span class="title class_">Ball</span>(b.s1 + size, b.s2);</span><br><span class="line">			<span class="comment">// 放入s2</span></span><br><span class="line">			state[t++] = <span class="keyword">new</span> <span class="title class_">Ball</span>(b.s1, b.s2 + size);</span><br><span class="line">			<span class="comment">// 不放，舍去</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	Map&lt;Integer, Integer&gt; map = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;(t);</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; t; i++) &#123;</span><br><span class="line">		<span class="type">int</span> <span class="variable">s1</span> <span class="operator">=</span> state[i].s1;</span><br><span class="line">		<span class="type">int</span> <span class="variable">s2</span> <span class="operator">=</span> state[i].s2;</span><br><span class="line">		map.put(s1 - s2, Math.max(map.getOrDefault(s1 - s2, <span class="number">0</span>), s1));</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> map;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Ball</span> &#123;</span><br><span class="line">	<span class="type">int</span> s1;</span><br><span class="line">	<span class="type">int</span> s2;</span><br><span class="line"></span><br><span class="line">	Ball(<span class="type">int</span> s1, <span class="type">int</span> s2) &#123;</span><br><span class="line">		<span class="built_in">this</span>.s1 = s1;</span><br><span class="line">		<span class="built_in">this</span>.s2 = s2;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="meta">@Override</span></span><br><span class="line">	<span class="keyword">public</span> String <span class="title function_">toString</span><span class="params">()</span> &#123;</span><br><span class="line">		<span class="keyword">return</span> <span class="string">&quot;Ball&#123;&quot;</span> +</span><br><span class="line">				<span class="string">&quot;s1=&quot;</span> + s1 +</span><br><span class="line">				<span class="string">&quot;, s2=&quot;</span> + s2 +</span><br><span class="line">				<span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>为什么可以拆分又合并？<br>为什么可以不需要考虑数组元素的顺序？</p>
<h3 id="穿越虫洞"><a href="#穿越虫洞" class="headerlink" title="穿越虫洞"></a>穿越虫洞</h3><p>总会有更好、更快的方法。 应该一开始就看出来这道题满足动态规划的条件。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">	<span class="type">int</span> <span class="title function_">bigEyeball</span><span class="params">(<span class="type">int</span>[] eyes)</span> &#123;</span><br><span class="line">		<span class="type">int</span> <span class="variable">n</span> <span class="operator">=</span> eyes.length;</span><br><span class="line">		<span class="type">int</span>[][] dp = <span class="keyword">new</span> <span class="title class_">int</span>[n + <span class="number">1</span>][];</span><br><span class="line"></span><br><span class="line">		<span class="type">int</span> <span class="variable">sum</span> <span class="operator">=</span> sum(eyes);</span><br><span class="line"></span><br><span class="line">		initArray(dp, sum);</span><br><span class="line"></span><br><span class="line">		dp[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">1</span>; i &lt;= eyes.length; i++) &#123;</span><br><span class="line">			<span class="type">int</span> <span class="variable">s</span> <span class="operator">=</span> eyes[i - <span class="number">1</span>];</span><br><span class="line">			<span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt;= sum - s; j++) &#123;</span><br><span class="line">				<span class="keyword">if</span> (dp[i - <span class="number">1</span>][j] &lt; <span class="number">0</span>) &#123;</span><br><span class="line">					<span class="keyword">continue</span>;</span><br><span class="line">				&#125;</span><br><span class="line">				<span class="comment">// not choose</span></span><br><span class="line">				dp[i][j] = max(dp[i][j], dp[i - <span class="number">1</span>][j]);</span><br><span class="line">				<span class="comment">// put in bigger</span></span><br><span class="line">				dp[i][j + s] = max(dp[i][j + s], dp[i - <span class="number">1</span>][j]);</span><br><span class="line">				<span class="comment">// put in smaller, 2 situation</span></span><br><span class="line">				dp[i][abs(j - s)] = max(dp[i][abs(j - s)], dp[i - <span class="number">1</span>][j] + min(j, s));</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line"><span class="comment">//		printArray(dp);</span></span><br><span class="line">		<span class="keyword">return</span> dp[n][<span class="number">0</span>];</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">initArray</span><span class="params">(<span class="type">int</span>[][] dp, <span class="type">int</span> sum)</span> &#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt; dp.length; i++) &#123;</span><br><span class="line">			dp[i] = <span class="keyword">new</span> <span class="title class_">int</span>[sum + <span class="number">1</span>];</span><br><span class="line">			<span class="keyword">for</span> (<span class="type">int</span> <span class="variable">j</span> <span class="operator">=</span> <span class="number">0</span>; j &lt; dp[i].length; j++) &#123;</span><br><span class="line">				dp[i][j] = -<span class="number">1</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">private</span> <span class="type">int</span> <span class="title function_">sum</span><span class="params">(<span class="type">int</span>[] eyes)</span> &#123;</span><br><span class="line">		<span class="type">int</span> <span class="variable">sum</span> <span class="operator">=</span> <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="type">int</span> s : eyes) &#123;</span><br><span class="line">			sum += s;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> sum;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>
<p>其中的状态dp[i][j]代表： 已选择i个小球且增量（已经组成的2个球的大小差）为j时的最大大球size。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// not choose</span></span><br><span class="line">dp[i][j] = max(dp[i][j], dp[i - <span class="number">1</span>][j]);</span><br><span class="line"><span class="comment">// put in bigger</span></span><br><span class="line">dp[i][j + s] = max(dp[i][j + s], dp[i - <span class="number">1</span>][j]);</span><br><span class="line"><span class="comment">// put in smaller, 2 situation</span></span><br><span class="line">dp[i][abs(j - s)] = max(dp[i][abs(j - s)], dp[i - <span class="number">1</span>][j] + min(j, s));</span><br></pre></td></tr></table></figure>
<p>这3个状态转移方程对应3种情况，需要说明的就是第3种情况，画个图解释把。</p>
<p>&#x2F;&#x2F; todo</p>
<p>如果你觉得这就完了，那你就太天真了，其实这里的二维数组完全可以变为一维数组：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">bigEyeballDim1</span><span class="params">(<span class="type">int</span>[] eyes)</span> &#123;</span><br><span class="line">	<span class="type">int</span> <span class="variable">n</span> <span class="operator">=</span> eyes.length;</span><br><span class="line">	<span class="type">int</span> <span class="variable">sum</span> <span class="operator">=</span> sum(eyes);</span><br><span class="line">	<span class="type">int</span>[] dp = <span class="keyword">new</span> <span class="title class_">int</span>[sum + <span class="number">1</span>];</span><br><span class="line"></span><br><span class="line">	Arrays.fill(dp, -<span class="number">1</span>);</span><br><span class="line">	dp[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> s : eyes) &#123;</span><br><span class="line">		<span class="type">int</span>[] old = Arrays.copyOf(dp, dp.length);</span><br><span class="line">		<span class="keyword">for</span> (<span class="type">int</span> <span class="variable">i</span> <span class="operator">=</span> <span class="number">0</span>; i &lt;= sum - s; i++) &#123;</span><br><span class="line">			<span class="keyword">if</span> (old[i] &lt; <span class="number">0</span>) &#123;</span><br><span class="line">				<span class="keyword">continue</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			dp[i + s] = max(dp[i + s], old[i]);</span><br><span class="line">			dp[abs(i - s)] = max(dp[abs(i - s)], old[i] + min(s, i));</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> dp[<span class="number">0</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h1 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h1><p><a target="_blank" rel="noopener" href="https://dzone.com/articles/java-8-master-permutations">java8实现排列算法</a></p>

      
    </div> -->
          <div class="article-entry" itemprop="articleBody">
            
              
                
                      
                        
                          
                            
                              
                                
                                  
                                    <p>
                                      <h1 id="1-超哥的大眼球（2018-12-13～2018-12-20）"><a href="#1-超哥的大眼球（2018-12-13～2018-12-20）" class="headerlink" title="1.超哥的大眼球（2018-12-13～2018-12-20）"></a>1.超哥的大眼球（2018-12-13～2018-12-20）</h1><p>超哥开了一个造仿真机器人的公司，最近新出了一个造机器人眼球的测试机，但是造出来的眼球大小不一，你知道造眼球的原料很贵的，为了不浪费，他想将这些眼球合并成2个最大的眼球，当然不是为了摸的，是用来做广告宣传。<br>问题来了，2个眼球必须一样大，且原来的单个小眼球不可分割，如果能够造成功，返回最大眼球的size，否则返回0。<br>例如：<br>输入小眼球数组(eyeball[n])：[1,1,2,3,6]，输出6（1，2，3合并为6,余下1）；<br>输入：[1,2]，返回0，不可造。</p>

                                        <p>
                                          
                                            
                                              
                                                      
          </div>
    <p class="article-more-link">
      <a href="/2018/12/14/algorithm/000-week-algo/#more">
        Read More
      </a>
    </p>
    <!-- <div class="article-more-link">
      <a href="/2018/12/14/algorithm/000-week-algo/#more">
        read more
      </a>
    </div> -->
    


      <footer class="article-footer">
        <a data-url="http://http//jimolonely.github.io/2018/12/14/algorithm/000-week-algo/" data-id="cl1fw7fhc0004vkd37ouzap4i" class="article-share-link">
          Share
        </a>
        
            
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/algorithm/" rel="tag">algorithm</a><span class="article-tag-list-count">2</span></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/java/" rel="tag">java</a><span class="article-tag-list-count">104</span></li></ul>

      </footer>
      </div>
      
</article>


  
    <article id="post-hadoop/003-hdfs-cmd" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/12/12/hadoop/003-hdfs-cmd/" class="article-date">
  <time datetime="2018-12-12T09:33:07.000Z" itemprop="datePublished">2018-12-12</time>
</a>
      
  </div>
  <div class="article-inner">
    
      
        <header class="article-header">
          
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/12/12/hadoop/003-hdfs-cmd/">HDFS常用命令</a>
    </h1>
  

        </header>
        
          <!-- <div class="article-entry" itemprop="articleBody">
      
        <p>本文记录在实践中使用的常用命令。</p>
<h1 id="ls"><a href="#ls" class="headerlink" title="ls"></a>ls</h1><p>按时间倒序查看文件列表：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">hadoop fs -<span class="built_in">ls</span> -t /dir</span></span><br></pre></td></tr></table></figure>

<h1 id="get"><a href="#get" class="headerlink" title="get"></a>get</h1><h1 id="put"><a href="#put" class="headerlink" title="put"></a>put</h1><h1 id="cat"><a href="#cat" class="headerlink" title="cat"></a>cat</h1>
      
    </div> -->
          <div class="article-entry" itemprop="articleBody">
            
              
                
                      
                        
                          
                            
                              
                                
                                  
                                    <p>
                                      <p>本文记录在实践中使用的常用命令。</p>

                                        <p>
                                          
                                            
                                              
                                                      
          </div>
    <p class="article-more-link">
      <a href="/2018/12/12/hadoop/003-hdfs-cmd/#more">
        Read More
      </a>
    </p>
    <!-- <div class="article-more-link">
      <a href="/2018/12/12/hadoop/003-hdfs-cmd/#more">
        read more
      </a>
    </div> -->
    


      <footer class="article-footer">
        <a data-url="http://http//jimolonely.github.io/2018/12/12/hadoop/003-hdfs-cmd/" data-id="cl1fw7fjo0057vkd3a86icg4y" class="article-share-link">
          Share
        </a>
        
            
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/hadoop/" rel="tag">hadoop</a><span class="article-tag-list-count">2</span></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/java/" rel="tag">java</a><span class="article-tag-list-count">104</span></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/shell/" rel="tag">shell</a><span class="article-tag-list-count">6</span></li></ul>

      </footer>
      </div>
      
</article>


  
    <article id="post-basic/011-microservice-trade-offs" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/12/11/basic/011-microservice-trade-offs/" class="article-date">
  <time datetime="2018-12-11T00:48:57.000Z" itemprop="datePublished">2018-12-11</time>
</a>
      
  </div>
  <div class="article-inner">
    
      
        <header class="article-header">
          
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/12/11/basic/011-microservice-trade-offs/">微服务权衡</a>
    </h1>
  

        </header>
        
          <!-- <div class="article-entry" itemprop="articleBody">
      
        <p>本文翻译自：<a target="_blank" rel="noopener" href="https://martinfowler.com/articles/microservice-trade-offs.html">https://martinfowler.com/articles/microservice-trade-offs.html</a></p>
<p>许多开发团队发现<a target="_blank" rel="noopener" href="https://martinfowler.com/articles/microservices.html">微服务架构</a>风格是单片架构的优秀方法。 但其他团队发现它们是一种影响生产力的负担。 与任何架构一样，微服务带来成本和收益。 要做出明智的选择，您必须了解这些并将其应用于您的特定背景。</p>
<h2 id="微服务提供的好处……"><a href="#微服务提供的好处……" class="headerlink" title="微服务提供的好处……"></a>微服务提供的好处……</h2><ul>
<li><p>强大的模块边界：微服务增强了模块化结构，这对大型团队尤为重要。</p>
</li>
<li><p>独立部署：简单的服务更易于部署，并且由于它们是自治的，因此在出错时不太可能导致系统故障。</p>
</li>
<li><p>技术多样性：通过微服务，您可以混合使用多种语言，开发框架和数据存储技术。</p>
</li>
</ul>
<h2 id="……但需要付出代价"><a href="#……但需要付出代价" class="headerlink" title="……但需要付出代价"></a>……但需要付出代价</h2><ul>
<li><p>分布式：分布式系统更难编程，因为远程调用很慢并且始终存在故障风险。</p>
</li>
<li><p>最终的一致性：对于分布式系统来说，保持强一致性非常困难，这意味着每个人都必须管理最终的一致性。</p>
</li>
<li><p>运维复杂性：您需要一个成熟的运营团队来管理大量服务，这些服务需要定期重新部署。</p>
</li>
</ul>
<h1 id="强大的模块边界"><a href="#强大的模块边界" class="headerlink" title="强大的模块边界"></a>强大的模块边界</h1><p>微服务的第一大好处是强大的模块边界。 这是一个重要的好处，但却是一个奇怪的好处，因为从理论上讲，为什么微服务应该具有比单块更强的模块边界。</p>
<p>那么强大的模块边界是什么意思呢？ 我想大多数人都会同意将软件分成模块是很好的：大块的软件彼此分离。 你希望你的模块工作，这样如果我需要更改系统的一部分，大多数时候我只需要了解该系统的一小部分来进行更改，我可以很容易地找到这个小部分。 良好的模块化结构在任何程序中都很有用，但随着软件规模的扩大，它会变得越来越重要。 也许更重要的是，随着开发团队的规模不断扩大，它变得越来越重要。</p>
<p>微服务的倡导者很快就会引入<a target="_blank" rel="noopener" href="http://www.thoughtworks.com/insights/blog/demystifying-conways-law">康微法则</a>，即软件系统的结构反映了构建它的组织的通信结构。对于规模较大的团队，特别是如果这些团队位于不同的地点，重要的是构建软件以识别团队间通信将比团队内的团队通信更频繁，更正式。微服务允许每个团队使用这种通信模式来管理相对独立的单元。</p>
<p>正如我之前所说，单片系统没有理由不具备良好的模块化结构。 [1]但是很多人观察到它似乎很少见，因此<a target="_blank" rel="noopener" href="http://www.laputan.org/mud/">泥大球</a>是最常见的架构模式。事实上，对单一应用的共同命运的这种挫败感正在驱使一些团队进入微服务。与模块的分离是有效的，因为模块边界是模块之间引用的障碍。麻烦的是，使用单片系统，通常很容易绕过障碍物。这样做可以成为快速构建功能的一种有用的战术捷径，但是做得很广泛会破坏模块化结构并破坏团队的工作效率。将模块放入单独的服务使得边界更加牢固，使得找到这些癌症变通方法变得更加困难。</p>
<p>这种耦合的一个重要方面是持久化数据。 微服务的一个关键特性是<a target="_blank" rel="noopener" href="https://martinfowler.com/microservices.html#DecentralizedDataManagement">分散数据管理</a>，它表示每个服务都管理自己的数据库，任何其他服务都必须通过服务的API才能获得它。 这消除了<a target="_blank" rel="noopener" href="https://martinfowler.com/bliki/IntegrationDatabase.html">集成数据库</a>，这是大型系统中令人讨厌的耦合的主要来源。</p>
<p>重要的是要强调，单片系统完全可能具有牢固的模块边界，但它需要规范。 同样地，你可以得到一个微型泥球，但它需要更多的努力，而且是错的。 我看待使用微服务的方式增加了你获得更好的模块化的可能性。 如果你对你的团队的纪律充满信心，那么这可能会消除这种优势，但随着团队的发展，它越来越难以保持纪律，就像维护模块边界变得更加重要一样。</p>
<p>如果你没有正确的界限，这种优势将成为一个障碍。这是<a target="_blank" rel="noopener" href="https://martinfowler.com/bliki/MonolithFirst.html">单片优先</a>策略的两个主要原因之一，以及为什么即使那些<a target="_blank" rel="noopener" href="https://martinfowler.com/articles/dont-start-monolith.html">更倾向于使用微服务运行</a>的人也会强调，只有通过一个易于理解的域才能这样做。</p>
<p>但是我还没有完成关于这一点的警告。在时间过去之后，您才能真正了解系统维护模块化的程度。因此，一旦我们看到微服务系统已经存在至少几年，我们就能真正评估微服务是否会带来更好的模块化。此外，早期采用者往往更有天赋，因此在我们评估普通团队编写的微服务系统的模块化优势之前还会有进一步的延迟。即使在那时，我们也必须接受普通团队编写普通软件，因此我们不必将结果与顶级团队进行比较，而是将所得到的软件与单片体系结构下的软件进行比较 - 这是一个棘手的反事实评估。</p>
<p>我现在所能继续的只是我从我认识的人那里听到的早期证据。他们的判断是维护模块要容易得多。</p>
<p>一个案例研究特别有趣。团队做出了错误的选择，在一个系统上使用微服务，这个系统不够复杂，无法覆盖<a target="_blank" rel="noopener" href="https://martinfowler.com/bliki/MicroservicePremium.html">Microservice Premium</a>。该项目陷入困境，需要获救，因此更多的人被投入到项目中。在这一点上，微服务架构变得有用，因为系统能够吸收开发人员的快速涌入，并且团队能够比单片系统下更容易地利用更大团队的人数数量。因此，该项目加速到比单块预期更高的生产力，使团队能够赶上。结果仍然是一个净负值，因为软件花费的工作时间比它们使用单​​块时所花费的工作时间更多，但微服务架构确实支持提升。</p>
<h1 id="分布式"><a href="#分布式" class="headerlink" title="分布式"></a>分布式</h1><p>因此，微服务使用分布式系统来改善模块化。但是分布式软件有一个主要的缺点，即它是分布式的。一旦你玩分布式，就会产生一系列复杂性。我认为微服务社区并不像分布式对象运动那样天真，但复杂性仍然存在。</p>
<p>第一个是性能。你必须处在一个非常不寻常的地方才能看到进程中的函数调用现在变成性能热点，但是远程调用很慢。如果您的服务调用了六个远程服务，每个远程服务调用另外六个远程服务，这些响应时间会增加一些可怕的延迟特性。</p>
<p>当然，你可以做很多事情来缓解这个问题。首先，您可以增加调用的粒度，因此您可以减少调用的次数。这使您的编程模型变得复杂，您现在必须考虑如何批量处理服务间交互。它也只会让你到目前为止，因为你将不得不至少调用一次合作服务。</p>
<p>第二个缓解是使用异步。如果并行进行六次异步调用，那么现在只有最慢的调用而不是它们的延迟总和。这可能是一个巨大的性能提升，但另一个认知成本。异步编程很难：很难做到正确，而且更难调试。但是我听过的大多数微服务故事需要不同步才能获得可接受的性能。</p>
<p>在速度之后是可靠性。您希望进程内函数调用可以正常工作，但远程调用可能随时失败。有了很多微服务，还有更多潜在的失败点。聪明的开发人员知道这一点并<a target="_blank" rel="noopener" href="https://martinfowler.com/articles/microservices.html#DesignForFailure">设计失败</a>。令人高兴的是，异步协作所需的策略也很适合处理故障，结果可以提高弹性。然而，这并没有太大的补偿，每次远程调用失败的后果仍然带有额外的复杂性。</p>
<p>这只是<a target="_blank" rel="noopener" href="http://www.rgoarchitects.com/Files/fallacies.pdf">分布式计算的两大谬误</a>。</p>
<p>这个问题有一些警告。首先，随着它的发展，许多这些问题都会出现。很少有单片系统是真正独立的，通常还有其他系统，比如遗留系统。与它们交互涉及到网络并遇到同样的问题。这就是为什么许多人倾向于更快地移动到微服务来处理与远程系统的交互。这个问题也是经验有帮助的问题，一个技能更高的团队将能够更好地处理分布式。</p>
<p>但分布式总是一个成本。我总是不愿意玩分布式，并且认为太多人玩分布式玩的太快，因为他们低估了问题。</p>
<h1 id="最终一致性"><a href="#最终一致性" class="headerlink" title="最终一致性"></a>最终一致性</h1><p>我相信你知道需要一点耐心的网站。 您对某些内容进行了更新，它会刷新您的屏幕并且更新不见了。 你等一两分钟，点击刷新，就在那里。</p>
<p>这是一个非常恼人的可用性问题，几乎可以肯定是由于最终一致性的危险。 粉红色节点收到了您的更新，但您的获取请求由绿色节点处理。 在绿色节点从粉红节点获取更新之前，您将陷入不一致的窗口。 最终它将是一致的，但在那之前你想知道是否出了什么问题。</p>
<p>像这样的不一致是足够刺激，但它们可能会更加严重。 业务逻辑最终可能会对不一致的信息做出决策，当发生这种情况时，很难诊断出错的原因，因为任何调查都会在不一致窗口关闭后很久发生。</p>
<p>微服务引入了最终的一致性问题，因为它们对分散的数据管理抱有很大的支持。使用整体应用，您可以在一个事务中一起更新一堆东西。微服务需要多个资源来更新，并且分布式事务不受欢迎（有充分理由）。所以现在，开发人员需要了解一致性问题，并在做任何代码后悔的事情之前弄清楚如何检测事情何时不同步。</p>
<p>整体应用并没有摆脱这些问题。随着系统的发展，需要使用缓存来提高性能，而缓存失效则是<a target="_blank" rel="noopener" href="https://martinfowler.com/bliki/TwoHardThings.html">另一个难题</a>。大多数应用程序需要<a target="_blank" rel="noopener" href="https://martinfowler.com/eaaCatalog/optimisticOfflineLock.html">脱机锁</a> 以避免长期存在的数据库事务。 外部系统需要无法与事务管理器协调的更新。 业务流程通常比你想象的更容忍不一致，因为企业往往更多地奖励可用性（业务流程长期以来对<a target="_blank" rel="noopener" href="http://ksat.me/a-plain-english-introduction-to-cap-theorem/">CAP定理</a>有本能的理解）。</p>
<p>因此，与其他分布式问题一样，整体应用并不能完全避免不一致问题，但它们确实会受到更少的影响，特别是当它们更小时。</p>
<h1 id="独立部署"><a href="#独立部署" class="headerlink" title="独立部署"></a>独立部署</h1><p>在我的整个职业生涯中，模块化边界与分布式系统的复杂性之间的权衡已经存在。但是，在过去的十年中，有一件事情发生了显着变化，即释放到生产中的作用。在二十世纪，生产版本几乎普遍是一个痛苦和罕见的事件，白天&#x2F;晚上的周末转移，以获得一些尴尬的软件，它可以做一些有用的事情。但是现在，熟练的团队经常发布生产，许多组织实行<a target="_blank" rel="noopener" href="https://martinfowler.com/bliki/ContinuousDelivery.html">持续交付</a>，允许他们每天多次进行生产许可。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">微服务是DevOps革命后的第一个架构</span><br><span class="line"></span><br><span class="line"> - 尼尔福特</span><br></pre></td></tr></table></figure>
<p>这种转变对软件行业产生了深远的影响，并且与微服务运动密切相关。部署大型整体应用的难度引发了一些微服务工作，其中部分整体块的微小变化可能导致整个部署失败。微服务的一个关键原则是<a target="_blank" rel="noopener" href="https://martinfowler.com/articles/microservices.html#ComponentizationViaServices">服务是组件</a>，因此可以独立部署。所以现在当你做出改变时，你只需要测试和部署一个小服务。如果搞砸了，你就不会打倒整个系统。毕竟，由于需求设计失败，即使组件完全失效也不应该阻止系统的其他部分工作，尽管有某种形式的优雅降级。</p>
<p>这种关系是双向的。由于许多微服务需要经常部署，因此必须让您的部署协同工作。这就是快速应用程序部署和快速配置基础架构是<a target="_blank" rel="noopener" href="https://martinfowler.com/bliki/MicroservicePrerequisites.html">微服务先决条件</a>的原因。对于除基础之外的任何事情，您需要持续交付。</p>
<p>持续交付的巨大好处是减少了创建和运行软件之间的周期时间。这样做的组织可以快速响应市场变化，并比竞争对手更快地推出新功能。</p>
<p>尽管许多人认为持续交付是使用微服务的一个原因，但必须要提到的是，即使是大型的单一应用也可以连续交付。 Facebook和Etsy是两个最着名的案例。在很多情况下，尝试的微服务架构在独立部署中失败，其中多个服务需要仔细协调它们的发布[2]。虽然我确实听到很多人认为使用微服务进行连续交付要容易得多，但我不太相信它们对模块化的实际重要性 - 尽管自然模块化确实与交付速度密切相关。</p>
<h1 id="运维复杂性"><a href="#运维复杂性" class="headerlink" title="运维复杂性"></a>运维复杂性</h1><p>能够快速部署小型独立单元对于开发来说是一个巨大的福音，但它给运维带来了额外的压力，因为现在有六个应用程序变成了数百个小型微服务。许多组织会发现处理这类快速变化的工具的难度令人望而却步。</p>
<p>这加强了持续交付的重要作用。虽然持续交付对于整体结构来说是一种有价值的技能，但是它几乎总是值得付出努力，但对于严格的微服务设置来说，它变得至关重要。没有持续交付促进的自动化和协作，就没有办法处理数十种服务。由于对管理这些服务和监控的需求增加，运维复杂性也增加了。如果微服务混合在一起，那么对单片应用程序有用的成熟度也是必要的。</p>
<p>微服务支持者喜欢指出，由于每项服务都较小，因此更容易理解。但危险在于没有消除复杂性，它只是转移到服务之间的互连。然后，这可以表现为增加的操作复杂性，例如跨越服务的困难调试行为。良好的服务边界选择将减少这个问题，但错误的界限会使情况变得更糟。</p>
<p>处理这种操作复杂性需要大量新技能和工具 - 最重要的是技能。工具仍然不成熟，但我的直觉告诉我，即使使用更好的工具，在微服务环境中技能的低标准也更高。</p>
<p>然而，对更好技能和工具的这种需求并不是处理这些操作复杂性最困难的部分。要有效地完成所有这些工作，您还需要介绍一种<a target="_blank" rel="noopener" href="https://martinfowler.com/bliki/DevOpsCulture.html">devops文化</a>：开发人员，运维人员以及参与软件交付的其他所有人之间的更好协作。文化变革很难，特别是在较大和较老的组织中。如果你不进行这种技术性的改变，你的整体应用程序将受到阻碍，你的微服务应用程序将受到创伤。</p>
<h1 id="技术多样性"><a href="#技术多样性" class="headerlink" title="技术多样性"></a>技术多样性</h1><p>由于每个微服务都是一个可独立部署的单元，因此您可以自由选择技术。微服务可以用不同的语言编写，使用不同的库，并使用不同的数据存储。这允许团队为工作选择合适的工具，某些语言和库更适合某些类型的问题。</p>
<p>技术多样性的讨论通常集中在最佳工具上，但微服务的最大好处往往是更平淡的版本控制问题。在单块中，您只能使用单个版本的库，这种情况通常会导致有问题的升级。系统的一部分可能需要升级才能使用其新功能，但不能，因为升级会破坏系统的另一部分。处理库版本问题是随着代码库变大而成倍增加的问题之一。</p>
<p>这里有一种危险，即技术的多样性使开发组织不堪重负。我认识的大多数组织确实鼓励使用有限的技术。通过提供监控等常用工具来支持这种鼓励，使服务更容易适应一小部分常见环境。</p>
<p>不要低估支持实验的价值。使用单一系统，语言和框架的早期决策很难逆转。经过十年左右的时间，这些决定可能会使团队陷入尴尬的技术之中。微服务允许团队尝试新工具，并且如果优越的技术变得适用，还可以逐步迁移服务。</p>
<h1 id="次要因素"><a href="#次要因素" class="headerlink" title="次要因素"></a>次要因素</h1><p>我认为上面的项目是需要考虑的主要权衡因素。以下是我认为不太重要的一些事情。</p>
<p>微服务支持者经常说服务更容易扩展，因为如果一个服务获得大量负载，你可以扩展它，而不是整个应用程序。然而，我很难回想起一份体面的体验报告，它让我相信，与通过复制整个应用程序进行<a target="_blank" rel="noopener" href="http://paulhammant.com/2011/11/29/cookie-cutter-scaling/">千篇一律的扩展</a>相比，实际上这种选择性扩展更有效率。</p>
<p>微服务允许您分离敏感数据并为该数据添加更加谨慎的安全性。此外，通过确保微服务之间的所有流量都是安全的，微服务可能会更难以被攻破。随着安全问题变得越来越重要，这可能会成为使用微服务的主要考虑因素。即使没有这一点，主要是单片系统创建单独的服务来处理敏感数据也并不罕见。</p>
<p>对微服务的批评者谈到测试微服务应用程序比单片机更难。虽然这是一个真正的困难 - 分布式应用程序更复杂的一部分 - 但是有<a target="_blank" rel="noopener" href="https://martinfowler.com/articles/microservice-testing/">很好的方法可以对微服务进行测试</a>。这里最重要的是进行严格的测试，而测试单块和测试微服务之间的差异是次要的。</p>
<h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>任何架构的任何帖子都受到<a target="_blank" rel="noopener" href="https://martinfowler.com/bliki/LimitationsOfGeneralAdvice.html">一般建议的限制</a>。所以阅读这样的帖子不能为您做出决定，但这些文章可以帮助您确保考虑应该考虑的各种因素。这里的每个成本和收益对不同的系统都有不同的权重，甚至在成本和收益之间交换（强大的模块边界在更复杂的系统中是好的，但对简单系统来说是一个障碍）你做出的任何决定取决于将这些标准应用于你的背景，评估哪些因素对您的系统最重要，以及它们如何影响您的特定环境。此外，我们对微服务架构的体验相对有限。您通常只能在系统成熟后判断架构决策，并且了解了开发开始后多年的工作。我们还没有很多关于长寿命微服务架构的轶事。</p>
<p>有关微服务的更多信息，请从我的微服务资源指南开始，我在其中选择了有关微服务的内容，时间，方式和人员的最佳信息。</p>
<p>单块和微服务不是简单的二元选择。两者都是模糊定义，这意味着许多系统将位于模糊的边界区域。还有其他系统不适合任何一种类别。包括我自己在内的大多数人都谈论微服务而不是单块，因为将它们与更常见的风格进行对比是有意义的，但我们必须记住，有些系统不适合这两种类型。我认为单体和微观体是架构空间中的两个区域。它们值得命名，因为它们具有有用的讨论特征，但没有明智的架构师将它们视为对架构空间的全面划分。</p>
<p>也就是说，似乎被广泛接受的一个总体观点是<a target="_blank" rel="noopener" href="https://martinfowler.com/bliki/MicroservicePremium.html">微服务高级版</a>：微服务会降低生产力成本，只能在更复杂的系统中弥补。因此，如果您可以使用单片架构管理系统的复杂性，那么您就不应该使用微服务。</p>
<p>但微服务对话的数量不应该让我们忘记推动软件项目成功和失败的更重要的问题。诸如团队成员的质量，他们彼此协作的程度以及与领域专家的沟通程度之类的软因素将比是否使用微服务产生更大的影响。在纯粹的技术层面上，重点关注整洁代码、良好测试和对进化架构的关注等问题更为重要。</p>

      
    </div> -->
          <div class="article-entry" itemprop="articleBody">
            
              
                
                      
                        
                          
                            
                              
                                
                                  
                                    <p>
                                      <p>本文翻译自：<a target="_blank" rel="noopener" href="https://martinfowler.com/articles/microservice-trade-offs.html">https://martinfowler.com/articles/microservice-trade-offs.html</a></p>

                                        <p>
                                          
                                            
                                              
                                                      
          </div>
    <p class="article-more-link">
      <a href="/2018/12/11/basic/011-microservice-trade-offs/#more">
        Read More
      </a>
    </p>
    <!-- <div class="article-more-link">
      <a href="/2018/12/11/basic/011-microservice-trade-offs/#more">
        read more
      </a>
    </div> -->
    


      <footer class="article-footer">
        <a data-url="http://http//jimolonely.github.io/2018/12/11/basic/011-microservice-trade-offs/" data-id="cl1fw7fhx000zvkd36zbdct2u" class="article-share-link">
          Share
        </a>
        
            
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/microservice/" rel="tag">microservice</a><span class="article-tag-list-count">9</span></li></ul>

      </footer>
      </div>
      
</article>


  
    <article id="post-basic/010-devops-culture" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/12/10/basic/010-devops-culture/" class="article-date">
  <time datetime="2018-12-10T12:38:37.000Z" itemprop="datePublished">2018-12-10</time>
</a>
      
  </div>
  <div class="article-inner">
    
      
        <header class="article-header">
          
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/12/10/basic/010-devops-culture/">开发运维文化</a>
    </h1>
  

        </header>
        
          <!-- <div class="article-entry" itemprop="articleBody">
      
        <p>本文翻译自：<a target="_blank" rel="noopener" href="https://martinfowler.com/bliki/DevOpsCulture.html">https://martinfowler.com/bliki/DevOpsCulture.html</a></p>
<p>敏捷软件开发打破了需求分析、测试和开发之间的一些孤岛。 部署、运维和维护是与其他软件开发过程类似分离的其他活动。 DevOps运动旨在消除这些孤岛并鼓励开发和运维之间的协作。</p>
<p>DevOps已经成为可能，主要是由于新的操作工具和已建立的敏捷工程实践的结合[1]，但这些还不足以实现DevOps的优势。 即使使用最好的工具，如果你没有合适的文化，DevOps也只是另一个流行语。</p>
<p>DevOps文化的主要特征是增加开发和运维角色之间的协作。 在团队内部和组织层面，有一些重要的文化转变支持这种合作。</p>
<p>有<strong>共同责任</strong>的态度是DevOps文化的一个方面，鼓励更紧密的合作。如果系统交给另一个团队照顾，开发团队很容易对系统的操作和维护不感兴趣。如果开发团队负责在整个生命周期内管理系统，他们就能够分担运维人员的痛苦，从而确定简化部署和维护的方法（例如，通过自动化部署和改进日志记录）。他们还可能通过监控生产中的系统获得额外的<a target="_blank" rel="noopener" href="https://martinfowler.com/bliki/ObservedRequirement.html">ObservedRequirements</a>。当运营人员分担系统业务目标的责任时，他们能够与开发人员更紧密地合作，以更好地了解系统的运营需求并帮助实现这些目标。在实践中，协作通常始于开发人员对运营问题（例如部署和监控）的认识提高以及运营人员采用新的自动化工具和实践。</p>
<img src="/2018/12/10/basic/010-devops-culture/000.png" class="">

<p>需要进行一些组织变革来支持共同责任的文化。开发和运维之间应该没有孤岛。切换期和文档不能替代从一开始就在解决方案上合作。调整资源结构有助于操作人员尽早参与团队。让开发人员和运营人员共处一地可以帮助他们一起工作。交接和签字不鼓励人们分担责任并导致责备文化。相反，开发人员和操作人员都应该对系统的成功和失败负责。 DevOps文化模糊了开发人员和运营人员之间的界限，最终可能消除这种区别。将DevOps引入组织时，一种常见的反模式是为某人分配“DevOps”角色或<a target="_blank" rel="noopener" href="http://www.thoughtworks.com/radar/techniques/separate-devops-team">将团队称为“DevOps团队”</a>。这样做可以延续DevOps旨在打破的各种孤岛，并防止DevOps文化和实践扩散并被更广泛的组织采用。</p>
<p>另一个有价值的组织转变是支持自治团队。 为了有效协作，开发人员和运营人员需要能够做出决策并应用变更，而无需复杂的决策过程。 这涉及信任团队，改变风险管理方式以及创建一个不用担心失败的环境。 例如，为了部署到测试环境而必须生成用于签核的更改列表的团队可能会经常被延迟。 不需要这样的手动检查，可以依赖版本控制，这是完全可审计的。 版本控制中的更改甚至可以链接到团队项目管理工具中的票证。 如果没有手动注销，团队可以自动部署并加快测试周期。</p>
<p>转向DevOps文化的一个影响是，将新代码投入生产变得更容易。 这需要进一步的文化变革。 为了确保生产变化合理，团队需要将构建质量评估为开发过程。 这包括性能和安全性等跨职能问题。 <a target="_blank" rel="noopener" href="https://martinfowler.com/bliki/ContinuousDelivery.html">持续发布</a>技术（包括<a target="_blank" rel="noopener" href="https://martinfowler.com/bliki/SelfTestingCode.html">自测试代码</a>）构成了允许定期，低风险部署的基础。</p>
<p>为了不断改进开发人员和操作人员以及系统本身的协同工作方式，团队重视反馈也很重要。 生产监控是一个有用的反馈循环，用于诊断问题和发现潜在的改进。</p>
<p>自动化是DevOps运动的基石，有助于协作。 自动化测试、配置和部署等任务可以让人们专注于其他有价值的活动，并减少人为错误的可能性。 自动化的一个有用的副作用是 自动化脚本和测试可以作为有用的、始终是系统最新的文档。 例如，自动化服务器配置可消除与<a target="_blank" rel="noopener" href="https://martinfowler.com/bliki/SnowflakeServer.html">SnowflakeServer</a>相关的猜测，这意味着开发人员和运维人员同样能够了解和更改服务器的配置方式。</p>
<h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>本文概括起来讲了以下几点：</p>
<ol>
<li>DevOps的宗旨：消除开发与运维人员的隔阂，让大家一起合作；</li>
<li>共同责任：开发和运维人员都应该对系统负责，而不是推卸责任；</li>
<li>组织结构调整：打破开发和运维人员的界限；</li>
<li>自治团队：充分相信团队可以自己决定什么时候部署，而无需复杂的手续；</li>
<li>自动化：是DevOps的基础；</li>
<li>其他：更快的部署，系统的反馈也很重要；</li>
</ol>

      
    </div> -->
          <div class="article-entry" itemprop="articleBody">
            
              
                
                      
                        
                          
                            
                              
                                
                                  
                                    <p>
                                      <p>本文翻译自：<a target="_blank" rel="noopener" href="https://martinfowler.com/bliki/DevOpsCulture.html">https://martinfowler.com/bliki/DevOpsCulture.html</a></p>

                                        <p>
                                          
                                            
                                              
                                                      
          </div>
    <p class="article-more-link">
      <a href="/2018/12/10/basic/010-devops-culture/#more">
        Read More
      </a>
    </p>
    <!-- <div class="article-more-link">
      <a href="/2018/12/10/basic/010-devops-culture/#more">
        read more
      </a>
    </div> -->
    


      <footer class="article-footer">
        <a data-url="http://http//jimolonely.github.io/2018/12/10/basic/010-devops-culture/" data-id="cl1fw7fhu000xvkd3ge0efino" class="article-share-link">
          Share
        </a>
        
            
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%9E%B6%E6%9E%84/" rel="tag">架构</a><span class="article-tag-list-count">1</span></li></ul>

      </footer>
      </div>
      
</article>


  
    <article id="post-shell/002-join-list" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/12/10/shell/002-join-list/" class="article-date">
  <time datetime="2018-12-10T03:41:48.000Z" itemprop="datePublished">2018-12-10</time>
</a>
      
  </div>
  <div class="article-inner">
    
      
        <header class="article-header">
          
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/12/10/shell/002-join-list/">shell如何join数组</a>
    </h1>
  

        </header>
        
          <!-- <div class="article-entry" itemprop="articleBody">
      
        <p>shell里如何使用某个分割符连接数组、List等</p>
<h1 id="方法"><a href="#方法" class="headerlink" title="方法"></a>方法</h1><h2 id="1-使用local"><a href="#1-使用local" class="headerlink" title="1.使用local"></a>1.使用local</h2><p><a target="_blank" rel="noopener" href="https://zaiste.net/how_to_join_elements_of_an_array_in_bash/">https://zaiste.net/how_to_join_elements_of_an_array_in_bash&#x2F;</a></p>
<h2 id="2-使用python"><a href="#2-使用python" class="headerlink" title="2.使用python"></a>2.使用python</h2><p>一般在linux系统里都自带python。使用高级语言写起来当然更爽。</p>
<h1 id="例子"><a href="#例子" class="headerlink" title="例子"></a>例子</h1><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash</span></span><br><span class="line"></span><br><span class="line">re=`netstat -anp | grep -E &#x27;::(8001|8003|8761|5557)&#x27; | awk &#x27;&#123;print $7&#125;&#x27; OFS=&quot;\n&quot; | awk -F/ &#x27;&#123;print $1&#125;&#x27;`</span><br><span class="line"></span><br><span class="line">function join &#123; local IFS=&quot;$1&quot;; shift; echo &quot;$*&quot;; &#125;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">以逗号连接</span></span><br><span class="line">pids=`join , $re`</span><br><span class="line">echo $pids</span><br><span class="line"></span><br><span class="line">top -p $pids</span><br></pre></td></tr></table></figure>


      
    </div> -->
          <div class="article-entry" itemprop="articleBody">
            
              
                
                      
                        
                          
                            
                              
                                
                                  
                                    <p>
                                      <p>shell里如何使用某个分割符连接数组、List等</p>

                                        <p>
                                          
                                            
                                              
                                                      
          </div>
    <p class="article-more-link">
      <a href="/2018/12/10/shell/002-join-list/#more">
        Read More
      </a>
    </p>
    <!-- <div class="article-more-link">
      <a href="/2018/12/10/shell/002-join-list/#more">
        read more
      </a>
    </div> -->
    


      <footer class="article-footer">
        <a data-url="http://http//jimolonely.github.io/2018/12/10/shell/002-join-list/" data-id="cl1fw7fnm00jevkd3a5x44e3t" class="article-share-link">
          Share
        </a>
        
            
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/shell/" rel="tag">shell</a><span class="article-tag-list-count">6</span></li></ul>

      </footer>
      </div>
      
</article>


  
    <article id="post-basic/009-observed-required" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/12/10/basic/009-observed-required/" class="article-date">
  <time datetime="2018-12-10T01:35:10.000Z" itemprop="datePublished">2018-12-10</time>
</a>
      
  </div>
  <div class="article-inner">
    
      
        <header class="article-header">
          
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/12/10/basic/009-observed-required/">可观察需求</a>
    </h1>
  

        </header>
        
          <!-- <div class="article-entry" itemprop="articleBody">
      
        <p>本文翻译自：<a target="_blank" rel="noopener" href="https://martinfowler.com/bliki/ObservedRequirement.html">https://martinfowler.com/bliki/ObservedRequirement.html</a></p>
<p>这是我最喜欢的软件开发报价之一：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">需求是您在开始构建产品之前应该发现的事情。 在施工过程中发现需求，或者更糟糕的是，当客户开始使用您的产品时，发现需求非常昂贵且效率低下，我们将假设没有正确思考的人会这样做，并且不会再提及它。</span><br><span class="line"></span><br><span class="line"> -  Suzanne和James Robertson</span><br></pre></td></tr></table></figure>

<p>这是他们的书“掌握需求过程”第一版的开头段落。 正如普通读者可能猜到的那样，我的喜好与规则无关。 我喜欢这句话，因为它总结了瀑布价值体系的需求（事实上，“需求”一词本身就是瀑布式）。</p>
<p>敏捷方法违反了这一基本假设，意图在施工期间和交付后发现“要求”。 但即便是这种对上述圣人建议的无视，与目前许多领先网站的做法相比毫无意义。 这些站点通过观察用户在其站点上执行的操作以及使用该信息生成以下行中的新功能的想法来探索需求：</p>
<ol>
<li>看看人们试图对网站做些什么，并为他们提供更简单的方法。</li>
<li>看看人们放弃做某事的地方，并寻找解决令他们感到沮丧的事情的方法。</li>
<li>构建一个新功能，看看人们是否使用它。</li>
<li>构建实验性功能并使其可供用户群的子集使用。 您不仅可以看到他们是否喜欢它，还可以评估它对服务器的负载程度。</li>
</ol>
<p>要支持此类分析，您需要将用户日志记录行为添加到应用程序中，并构建一些工具来分析这些日志。许多日志记录在Web应用程序中免费显示，我怀疑这是人们开始这样做的主要推动力。但是，日志记录和分析可以进一步添加到应用程序中。</p>
<p>我没有在网上找到关于如何做到这一点的很多建议，我在实践中没有听到太多关于这样做的讨论。像许多事情一样，它需要集中精力花时间来构建监控功能，然后使用它来探索如何改进软件。此外，它远离传统软件流程，即使对于敏捷项目也是如此。</p>
<p>但这里有巨大的潜力。每个人都知道人们说他们想要什么和人们实际需要和使用的差异有多大。通过观察人们对您的应用程序实际执行的操作，您可以了解软件实际发生的情况 - 这可以为您提供比其他来源更直接的信息。因此，我认为更多的团队应该考虑将这种方法添加到他们的工具包中。</p>

      
    </div> -->
          <div class="article-entry" itemprop="articleBody">
            
              
                
                      
                        
                          
                            
                              
                                
                                  
                                    <p>
                                      <p>本文翻译自：<a target="_blank" rel="noopener" href="https://martinfowler.com/bliki/ObservedRequirement.html">https://martinfowler.com/bliki/ObservedRequirement.html</a></p>

                                        <p>
                                          
                                            
                                              
                                                      
          </div>
    <p class="article-more-link">
      <a href="/2018/12/10/basic/009-observed-required/#more">
        Read More
      </a>
    </p>
    <!-- <div class="article-more-link">
      <a href="/2018/12/10/basic/009-observed-required/#more">
        read more
      </a>
    </div> -->
    


      <footer class="article-footer">
        <a data-url="http://http//jimolonely.github.io/2018/12/10/basic/009-observed-required/" data-id="cl1fw7fht000wvkd3bkuz3oex" class="article-share-link">
          Share
        </a>
        
            
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/basic/" rel="tag">basic</a><span class="article-tag-list-count">7</span></li></ul>

      </footer>
      </div>
      
</article>


  
    <article id="post-basic/008-continuous-delivery" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/12/09/basic/008-continuous-delivery/" class="article-date">
  <time datetime="2018-12-09T10:58:17.000Z" itemprop="datePublished">2018-12-09</time>
</a>
      
  </div>
  <div class="article-inner">
    
      
        <header class="article-header">
          
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/12/09/basic/008-continuous-delivery/">持续发布</a>
    </h1>
  

        </header>
        
          <!-- <div class="article-entry" itemprop="articleBody">
      
        <p>本文翻译自：<a target="_blank" rel="noopener" href="https://martinfowler.com/bliki/ContinuousDelivery.html">https://martinfowler.com/bliki/ContinuousDelivery.html</a></p>
<p>持续交付是一个软件开发规程，您可以通过这种方式构建软件，以便软件可以随时发布到生产环境中。</p>
<p>你在以下情况下是持续交付：[1]</p>
<ol>
<li>您的软件可在其整个生命周期内进行部署</li>
<li>您的团队优先考虑保持软件可部署而不是处理新功能</li>
<li>任何人都可以随时获得有关系统生产准备情况的快速自动反馈</li>
<li>您可以根据需要对任何版本的软件执行一键部署</li>
</ol>
<p>通过持续集成开发团队完成的软件，构建可执行文件，并对这些可执行文件运行自动化测试来检测问题，实现持续交付。 此外，您可以将可执行文件推送到越来越像生产环境中，以确保软件可以在生产中运行。 为此，您使用<a target="_blank" rel="noopener" href="https://martinfowler.com/bliki/DeploymentPipeline.html">部署管道</a>。</p>
<p>关键测试是，商业赞助商要求软件的当前开发版本可以立即投入生产 - 没有人会眨眼，更不用说恐慌了。</p>
<p>要实现持续交付，您需要：</p>
<ol>
<li>参与交付的每个人之间的密切协作工作关系（通常称为<a target="_blank" rel="noopener" href="https://martinfowler.com/bliki/DevOpsCulture.html">DevOpsCulture</a> [2]）。</li>
<li>通常使用DeploymentPipeline广泛自动化交付流程的所有可能部分</li>
</ol>
<p>持续交付有时与持续部署相混淆。 持续部署意味着每次更改都会通过管道并自动投入生产，从而导致每天都进行许多生产部署。 持续交付只是意味着您可以进行频繁部署，但可能选择不这样做，通常是因为企业更喜欢较慢的部署速度。 要进行持续部署，您必须进行持续交付。</p>
<p><a target="_blank" rel="noopener" href="https://martinfowler.com/articles/continuousIntegration.html">持续集成</a>通常是指在开发环境中集成、构建和测试代码。持续交付以此为基础，处理生产部署所需的最后阶段。</p>
<p>持续交付的主要好处是：</p>
<ol>
<li>降低部署风险：由于您正在部署较小的更改，因此出现问题的可能性较小，如果出现问题则更容易解决。</li>
<li>可信的进展：许多人通过跟踪已完成的工作来跟踪进度。如果“完成”意味着“开发人员宣称它已完成”，那么它比将其部署到生产（或类似生产）环境中更不可信。</li>
<li>用户反馈：任何软件工作的最大风险是你最终构建了一些无用的东西。越早和越频繁地在真实用户面前获得工作软件，您就越快得到反馈，以找出它的真正价值（特别是如果您使用<a target="_blank" rel="noopener" href="https://martinfowler.com/bliki/ObservedRequirement.html">ObservedRequirements</a>）。</li>
</ol>
<p>用户反馈确实要求您进行持续部署。如果您需要，但不希望将新软件添加到整个用户群，则可以部署到一部分用户。在我们最近的一个项目中，零售商首先将其新的在线系统部署到其员工，然后部署到受邀的优质客户，最后部署到所有客户。</p>

      
    </div> -->
          <div class="article-entry" itemprop="articleBody">
            
              
                
                      
                        
                          
                            
                              
                                
                                  
                                    <p>
                                      <p>本文翻译自：<a target="_blank" rel="noopener" href="https://martinfowler.com/bliki/ContinuousDelivery.html">https://martinfowler.com/bliki/ContinuousDelivery.html</a></p>

                                        <p>
                                          
                                            
                                              
                                                      
          </div>
    <p class="article-more-link">
      <a href="/2018/12/09/basic/008-continuous-delivery/#more">
        Read More
      </a>
    </p>
    <!-- <div class="article-more-link">
      <a href="/2018/12/09/basic/008-continuous-delivery/#more">
        read more
      </a>
    </div> -->
    


      <footer class="article-footer">
        <a data-url="http://http//jimolonely.github.io/2018/12/09/basic/008-continuous-delivery/" data-id="cl1fw7fhq000rvkd3ab1gdsfk" class="article-share-link">
          Share
        </a>
        
            
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/microservice/" rel="tag">microservice</a><span class="article-tag-list-count">9</span></li></ul>

      </footer>
      </div>
      
</article>


  
    <article id="post-basic/007-continuous-integration" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/12/06/basic/007-continuous-integration/" class="article-date">
  <time datetime="2018-12-06T08:02:35.000Z" itemprop="datePublished">2018-12-06</time>
</a>
      
  </div>
  <div class="article-inner">
    
      
        <header class="article-header">
          
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/12/06/basic/007-continuous-integration/">持续集成</a>
    </h1>
  

        </header>
        
          <!-- <div class="article-entry" itemprop="articleBody">
      
        <p>本文翻译自：<a target="_blank" rel="noopener" href="https://martinfowler.com/articles/continuousIntegration.html">https://martinfowler.com/articles/continuousIntegration.html</a></p>
<h1 id="持续集成"><a href="#持续集成" class="headerlink" title="持续集成"></a>持续集成</h1><p>持续集成是一种软件开发实践，团队成员经常整合他们的工作，通常每个人至少每天集成一次 - 每天导致多个集成。 每个集成都通过自动构建（包括测试）进行验证，以尽快检测集成错误。 许多团队发现这种方法可以显着减少集成问题，并允许团队更快地开发内聚软件。 本文简要概述了持续集成，总结了该技术及其当前用法。</p>
<p>我清楚地记得我第一次看到一个大型软件项目。 我正在一家大型英国电子公司做暑期实习。 我的经理，质量保证小组的一部分，让我参观了一个网站，我们进入了一个堆满了立方体的巨大压抑仓库。 有人告诉我，这个项目已经开发了几年，目前正在整合，并已整合了几个月。 我的向导告诉我，没有人真正知道完成整合需要多长时间。 从中我学到了一个软件项目的常见故事：集成是一个漫长而不可预测的过程。</p>
<p>但这不一定是这样。 我在ThoughtWorks的同事以及世界上许多其他人完成的大多数项目都将集成视为非事件。 任何单个开发人员的工作距离共享项目状态只有几个小时，并且可以在几分钟内集成回该状态。 可以快速找到任何集成错误，并且可以快速修复。</p>
<p>这种对比不是昂贵而复杂的工具的结果。 它的本质在于团队中每个人经常（通常是每天）与受控源代码库集成的简单实践。</p>
<p>当我向人们描述这种做法时，我经常会发现两种反应：“它不能起作用（这里）”和“做它不会产生太大的影响”。人们在尝试时发现的是它比听起来容易得多，并且它对开发产生了巨大的影响。因此，第三个常见的反应是“是的，我们这样做 - 你怎么能没有它？”</p>
<p>“持续集成”一词源于极限编程开发过程，是其最初的十二种实践之一。当我在ThoughtWorks开始时，作为顾问，我鼓励我正在一起工作的项目组使用持续集成。 Matthew Foemmel将我模糊的劝诫变成了坚实的行动，我们看到这个项目从罕见和复杂的整合到我所描述的非事件。马修和我在本文的原始版本中写下了我们的经验，这是我网站上最受欢迎的文章之一。</p>
<p>尽管持续集成是一种不需要特定工具进行部署的实践，但我们发现使用Continuous Integration服务很有用。最着名的服务是CruiseControl，这是一个开源工具，最初由ThoughtWorks的几个人构建，现在由一个广泛的社区维护。从那时起，其他几个CI服务器已经出现，包括开源和商业 - 包括来自ThoughtWorks Studios的<a target="_blank" rel="noopener" href="http://studios.thoughtworks.com/cruise-continuous-integration">Cruise</a>。</p>
<h1 id="通过持续集成构建特征"><a href="#通过持续集成构建特征" class="headerlink" title="通过持续集成构建特征"></a>通过持续集成构建特征</h1><p>解释CI是什么以及它如何工作的最简单方法是展示一个如何使用小功能开发的快速示例。 让我们假设我必须对一个软件做一些事情，任务是什么并不重要，目前我认为它很小，可以在几个小时内完成。 （我们将在稍后探讨更长的任务和其他问题。）</p>
<p>我首先将当前集成源码的副本复制到我的本地开发机器上。 我通过使用源代码管理系统检查主线上的工作副本来实现此目的。</p>
<p>上面的段落对使用源代码控制系统的人有意义，但对那些不使用源码控制系统的人来说是胡言乱语。 所以让我快速解释一下后者。 源代码控制系统将项目的所有源代码保存在存储库中。 系统的当前状态通常被称为“主线”。 在任何时候，开发人员都可以将主线的受控副本放到他们自己的机器上，这称为“检出”。 开发人员机器上的副本称为“工作副本”。 （大多数情况下，您实际将工作副本更新到主线 - 实际上它也是一样的。）</p>
<p>现在我拿起我的工作副本，做我需要做的任何事情来完成我的任务。 这将包括更改生产代码，以及添加或更改自动化测试。 持续集成假设高度自动化到软件中的测试：我称之为<a target="_blank" rel="noopener" href="https://martinfowler.com/bliki/SelfTestingCode.html">自测代码</a>的工具。 通常这些使用流行的XUnit测试框架的版本。</p>
<p>一旦我完成了（通常在我工作时的各个阶段），我在我的开发机器上进行自动构建。 这将获取我的工作副本中的源代码，编译并将其链接到可执行文件中，并运行自动化测试。 只有在所有构建和测试没有错误的情况下，整体构建才被认为是好的。</p>
<p>通过良好的构建，我可以考虑将我的更改提交到存储库中。 当然，在我有机会投入之前，其他人可能并且通常已经对主线进行了更改。 所以首先我用他们的更改更新我的工作副本并重建。 如果他们的更改与我的更改发生冲突，它将在编译或测试中显示为失败。 在这种情况下，我有责任修复此问题并重复，直到我可以构建与主线正确同步的工作副本。</p>
<p>一旦我自己构建了一个正确同步的工作副本，我就可以最终将我的更改提交到主线，然后主线更新存储库。</p>
<p>但是我的提交没有完成我的工作。 此时我们再次构建，但这次是在基于主线代码的集成机器上。 只有当这个构建成功时，我们才能说我的更改已经完成。 我总是有机会错过我的机器上的东西，并且存储库没有正确更新。 只有当我提交的更改在集成上成功构建时，我才能完成工作。 这个集成版本可以由我手动执行，也可以由Cruise自动完成。</p>
<p>如果两个开发人员之间发生冲突，则通常会在第二个提交的开发人员构建其更新的工作副本时捕获。 如果不是，集成构建应该失败。 无论哪种方式，都能快速检测到错误。 此时，最重要的任务是修复它，并使构建再次正常工作。 在持续集成环境中，您永远不应该有一个失败的集成构建保持失败很长时间。 一个好的团队每天应该有很多正确的构建。 不良版本确实会不时发生，但应该快速修复。</p>
<p>这样做的结果是有一个稳定的软件可以正常工作并且包含很少的错误。 每个人都发展出共享稳定的基础，并且永远不会离这个基地太远，以至于需要很长时间才能与它集成。 尝试查找错误所花费的时间更少，因为它们很快就会出现。</p>
<p>小结：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">上文讲了持续集成的一个完整过程：</span><br><span class="line">1. 使用源码管理系统（git/svn），协同开发</span><br><span class="line">2. 本地构建和测试成功</span><br><span class="line">3. 远程仓库构建成功</span><br><span class="line">4. 这个过程经常正确发生</span><br></pre></td></tr></table></figure>

<h2 id="持续集成的实践"><a href="#持续集成的实践" class="headerlink" title="持续集成的实践"></a>持续集成的实践</h2><p>上面的故事是CI概述及其在日常生活中的运作方式。 让这一切顺利进行显然不止于此。 我现在将重点关注构成有效CI的关键实践。</p>
<h2 id="维护单一源码库"><a href="#维护单一源码库" class="headerlink" title="维护单一源码库"></a>维护单一源码库</h2><p>软件项目涉及许多需要一起编排以构建产品的文件。 跟踪所有这些是一项重大努力，特别是当涉及多个人时。 因此，多年来软件开发团队已经构建了管理所有这些的工具，这并不奇怪。 这些工具 - 称为源代码管理工具，配置管理，版本控制系统，存储库或其他各种名称 - 是大多数开发项目不可或缺的一部分。 令人遗憾和令人惊讶的是，他们不是所有项目的一部分。 这种情况很少见，但我确实遇到了不使用这种系统的项目，并使用了本地和共享驱动器的混乱组合。</p>
<p>因此，作为一个简单的基础，请确保您获得一个体面的源代码管理系统。 由于可以获得高质量的开源工具，因此成本不是问题。 当前的开源存储库是<a target="_blank" rel="noopener" href="http://subversion.tigris.org/">Subversion</a>(现在应该是Git)。 （旧的开源工具CVS仍然被广泛使用，并且比没有好，但Subversion是现代的选择。）有趣的是，当我与开发人员交谈时，我知道大多数商业源代码管理工具比Subversion更受欢迎。 我一直听到人们说的唯一值得付出的工具是<a target="_blank" rel="noopener" href="http://www.perforce.com/">Perforce</a>。</p>
<p>获得源代码管理系统后，请确保它是众所周知的获取源代码的地方。 没有人应该问“foo-whiffle文件在哪里？” 一切都应该在存储库中。</p>
<p>虽然许多团队使用存储库，但我看到的一个常见错误是他们没有将所有内容都放在存储库中。 如果人们使用其中一个，他们会将代码放在那里，但是你需要做的一切都包括：测试脚本，属性文件，数据库模式，安装脚本和第三方库。 我已经知道将他们的编译器检查到存储库的项目（在C++编译器的早期很重要）。 基本的经验法则是，你应该能够使用原始机器走向项目，进行检出，并能够完全构建系统。 原始机器上应该只有极少量的东西 - 通常是大而且安装复杂且稳定的东西。 操作系统，Java开发环境或基础数据库系统是典型示例。</p>
<p>您必须将构建所需的所有内容放在源代码管理系统中，但是您也可以将人们通常使用的其他内容放在那里。 IDE配置很适合放在那里，因为这样人们可以轻松共享相同的IDE设置。</p>
<p>版本控制系统的一个特性是它们允许您创建多个分支，以处理不同的开发流。这是一个有用的，非必要的功能 - 但它经常被过度使用并让人们陷入困境。尽量减少对分支机构的使用。特别是有一条主线：目前正在开发的项目的一个分支。几乎每个人都应该在大部分时间都在这条主线上工作。 （合理的分支是先前生产版本和临时实验的错误修复。）</p>
<p>通常，您应该在源代码控制中存储构建任何内容所需的所有内容，但实际上不构建任何内容。有些人确实将构建产品保留在源代码控制中，但我认为这是一种气味 - 表明更深层次的问题，通常无法可靠地重新构建。</p>
<h2 id="自动化构建"><a href="#自动化构建" class="headerlink" title="自动化构建"></a>自动化构建</h2><p>将源码变为运行系统通常是一个复杂的过程，涉及编译，移动文件，将模式加载到数据库等等。 但是，与软件开发的这一部分中的大多数任务一样，它可以自动化 - 因此应该是自动化的。 要求人们键入奇怪的命令或点击对话框是浪费时间和错误的滋生地。</p>
<p>构建的自动化环境是系统的常见特征。 Unix世界已经有几十年了，Java社区开发了Ant，.NET社区已经拥有了Nant，现在已经拥有了MSBuild。 确保您可以使用单个命令使用这些脚本构建和启动系统。</p>
<p>一个常见的错误是不要在自动构建中包含所有内容。 构建应该包括从存储库中获取数据库模式并在执行环境中将其激活。 我将详细说明我之前的经验法则：任何人都应该能够引入原始计算机，检查存储库中的源代码，发出单个命令，并在其计算机上运行正在运行的系统。</p>
<p>构建脚本有各种各样的风格，通常特定于平台或社区，但它们并非必须如此。 虽然我们的大多数Java项目都使用Ant，但有些使用了Ruby（Ruby Rake系统是一个非常好的构建脚本工具）。 我们从使用Ant自动化早期Microsoft COM项目中获得了很多价值。</p>
<p>大型构建通常需要时间，如果您只进行了一些小改动，则不希望执行所有这些步骤。 因此，一个好的构建工具可以分析在过程中需要更改的内容。 执行此操作的常用方法是检查源文件和目标文件的日期，并仅在源日期较晚时进行编译。 然后依赖性变得棘手：如果一个对象文件发生了变化，那么依赖它的对象也可能需要重建。 编译器可以处理这种事情，或者他们可能不会。</p>
<p>根据您的需要，您可能需要构建不同类型的东西。 您可以使用或不使用测试代码或使用不同的测试集来构建系统。 某些组件可以独立构建。 构建脚本应该允许您为不同的情况构建替代目标。</p>
<p>我们中的许多人使用IDE，并且大多数IDE在其中都有某种构建管理过程。 但是，这些文件始终是IDE专有的，并且通常很脆弱。 此外，他们需要IDE才能工作。 IDE用户可以设置自己的项目文件并将其用于个人开发。 但是，拥有一个可在服务器上使用并可从其他脚本运行的主构建是至关重要的。 因此，在Java项目中，我们可以让开发人员在他们的IDE中构建，但是主构建使用Ant来确保它可以在开发服务器上运行。</p>
<h2 id="让你的构建可以自测试"><a href="#让你的构建可以自测试" class="headerlink" title="让你的构建可以自测试"></a>让你的构建可以自测试</h2><p>传统上，构建意味着编译，链接以及使程序执行所需的所有其他内容。 程序可能会运行，但这并不意味着它做正确的事情。 现代静态类型语言可以捕获许多错误，但依然存在更多漏洞。</p>
<p>更快速有效地捕获错误的好方法是在构建过程中包含自动化测试。 当然，测试并不完美，但它可以捕获很多错误 - 足以使用。 特别是极限编程（XP）和测试驱动开发（TDD）的兴起在推广自测代码方面做了大量工作，因此许多人已经看到了该技术的价值。</p>
<p>我工作的定期读者将知道我是TDD和XP的忠实粉丝，但是我想强调，这些方法都不是获得自测代码的好处所必需的。 这两种方法都是在编写使代码通过的代码之前编写测试的一点 - 在这种模式下，测试与探索系统的设计一样多，因为它们是关于错误捕获的。 这是一件好事，但对于持续集成而言，这并不是必需的，因为我们对自测代码的要求较低。 （虽然TDD是我制作自测代码的首选方式。）</p>
<p>对于自测代码，您需要一套自动化测试，可以检查大部分代码库中的错误。 测试需要能够从一个简单的命令开始，并进行自我检查。 运行测试套件的结果应指示是否有任何测试失败。 对于要进行自我测试的构建，测试失败会导致构建失败。</p>
<p>在过去几年中，TDD的兴起推广了XUnit系列开源工具，这些工具非常适合这种测试。 事实证明，XUnit工具在ThoughtWorks上对我们非常有价值，我总是建议人们使用它们。 这些由Kent Beck开创的工具使您可以轻松地建立完全自我测试的环境。</p>
<p>XUnit工具无疑是使代码自我测试的起点。 您还应该关注其他专注于更多端到端测试的工具，目前有很多这样的工具，包括<a target="_blank" rel="noopener" href="http://fit.c2.com/">FIT</a>，<a target="_blank" rel="noopener" href="http://www.openqa.org/selenium/">Selenium</a>，<a target="_blank" rel="noopener" href="http://sahi.sourceforge.net/">Sahi</a>，<a target="_blank" rel="noopener" href="http://wtr.rubyforge.org/">Watir</a>，<a target="_blank" rel="noopener" href="http://fitnesse.org/">FITnesse</a>以及其他很多我不是 试图在这里全面列出。</p>
<p>当然，你不能指望测试找到一切。 正如经常说的那样：测试不能证明没有错误。 然而，完美并不是您获得自我测试版本的唯一回报点。 经常运行的不完美测试比完全没有编写的完美测试要好得多。</p>
<h2 id="每个人每天都会提交代码到主线"><a href="#每个人每天都会提交代码到主线" class="headerlink" title="每个人每天都会提交代码到主线"></a>每个人每天都会提交代码到主线</h2><p>集成主要是关于沟通。 集成允许开发人员告诉其他开发人员他们所做的更改。 频繁的沟通使人们可以随着变化的发展而快速了解。</p>
<p>开发人员提交主线的一个先决条件是他们可以正确地构建他们的代码。 当然，这包括传递构建测试。 与任何提交周期一样，开发人员首先更新其工作副本以匹配主线，解决与主线的任何冲突，然后在其本地计算机上构建。 如果构建通过，那么它们可以自由地提交到主线。</p>
<p>通过这样做，开发人员很快就会发现两个开发人员之间是否存在冲突。 快速解决问题的关键是快速找到问题。 开发人员每隔几个小时就会发生一次冲突，可以在发生冲突的几个小时内检测到冲突，此时发生的冲突并不多，而且很容易解决。 几周未被发现的冲突可能很难解决。</p>
<p>更新工作副本时构建的事实意味着您可以检测编译冲突以及文本冲突。 由于构建是自我测试，因此您还可以检测代码运行中的冲突。 后者的冲突是特别难以找到的错误，如果他们在代码中长时间未检测到。 由于提交之间只有几个小时的更改，因此只有很多地方可能会隐藏问题。 此外，由于没有太多变化，您可以使用<a target="_blank" rel="noopener" href="https://martinfowler.com/bliki/DiffDebugging.html">diff-debugging</a>来帮助您找到错误。</p>
<p>我的一般经验法则是每个开发人员每天都应该提交到存储库。 在实践中，如果开发人员更频繁地提交，那么它通常很有用。 您提交的频率越高，您查找冲突错误的位置就越少，您解决冲突的速度就越快。</p>
<p>频繁的提交鼓励开发人员将他们的工作分解成几小时的小块。 这有助于跟踪进度并提供进步感。 人们通常认为他们在短短几个小时内就无法做出有意义的事情，但我们发现指导和实践有助于他们学习。</p>
<h2 id="每个提交都应该在集成机器上构建主线"><a href="#每个提交都应该在集成机器上构建主线" class="headerlink" title="每个提交都应该在集成机器上构建主线"></a>每个提交都应该在集成机器上构建主线</h2><p>使用每日提交，团队可以获得经常测试的构建。 这应该意味着主线保持健康状态。 然而，在实践中，事情仍然出错。 一个原因是纪律，人们在提交之前没有进行更新和构建。 另一个是开发人员机器之间的环境差异。</p>
<p>因此，您应该确保在集成计算机上进行常规构建，并且只有在此集成构建成功时才应该认为提交已完成。 由于提交的开发人员对此负责，因此开发人员需要监视主线构建，以便在中断时能够修复它。 这样做的必然结果是，在主线构建已经过去并且您在当天晚些时候添加的任何提交之前，您不应该回家。</p>
<p>我见过两种主要方法来确保这一点：使用手动构建或持续集成服务器。</p>
<p>手动构建方法是最简单的描述方法。 从本质上讲，它与开发人员在提交到存储库之前所做的本地构建类似。 开发人员进入集成机器，检查主线的头部（现在是他的最后一次提交）并启动集成构建。 他一直关注着它的进步，如果构建成功，他就完成了他的提交。 （另见Jim Shore的<a target="_blank" rel="noopener" href="http://www.jamesshore.com/Blog/Continuous-Integration-on-a-Dollar-a-Day.html">描述</a>。）</p>
<p>持续集成服务器充当存储库的监视器。 每次针对存储库的提交完成时，服务器都会自动将源检出到集成机器上，启动构建，并通知提交者构建结果。 在收到通知之前，提交者不会完成 - 通常是电子邮件。</p>
<p>在ThoughtWorks，我们是持续集成服务器的忠实粉丝 - 事实上，我们领导了<a target="_blank" rel="noopener" href="http://cruisecontrol.sourceforge.net/">CruiseControl</a>和<a target="_blank" rel="noopener" href="http://ccnet.thoughtworks.com/">CruiseControl.NET</a>的原始开发，后者是广泛使用的开源CI服务器。从那时起，我们还构建了商业<a target="_blank" rel="noopener" href="http://studios.thoughtworks.com/cruise-continuous-integration">Cruise</a> CI服务器。我们几乎在每个项目中使用CI服务器，并且对结果非常满意。</p>
<p>并非所有人都喜欢使用CI服务器。 Jim Shore对他为什么更喜欢手动方法做了<a target="_blank" rel="noopener" href="http://www.jamesshore.com/Blog/Continuous-Integration-is-an-Attitude.html">很好的描述</a>。我同意他的看法，CI不仅仅是安装一些软件。这里的所有实践都需要有效地进行持续集成。但同样多的CI团队发现CI服务器是一个有用的工具。</p>
<p>许多组织按照定时计划定期构建，例如每晚。这与连续集成不同，并不足以进行持续集成。持续整合的重点是尽快发现问题。每夜构建意味着在任何人发现它们之前一整天都没有发现错误。一旦他们在系统中长时间，找到并删除它们需要很长时间。</p>
<h2 id="立即修复破碎的构建"><a href="#立即修复破碎的构建" class="headerlink" title="立即修复破碎的构建"></a>立即修复破碎的构建</h2><p>进行连续构建的关键部分是，如果主线构建失败，则需要立即修复。 与CI合作的全部意义在于，您始终在一个已知的稳定基础上发展。 主线构建要打破并不是坏事，尽管如果它一直在发生，它表明人们在提交之前没有足够小心地更新和构建本地。 但是，当主线构建确实中断时，快速修复它很重要。</p>
<p>我记得Kent Beck使用的一句话是“没有人比修复构建有更高优先级的任务”。 这并不意味着团队中的每个人都必须停止他们正在做的事情来修复构建，通常只需要几个人来让事情再次发挥作用。 它确实意味着有意识地将构建修复优先级化为紧急的高优先级任务。</p>
<p>通常，修复构建的最快方法是从主线恢复最新的提交，将系统恢复到最后已知的良好构建。 当然团队不应该尝试在破坏的主线上进行任何调试。 除非破损的原因立即显而易见，否则只需恢复主线并在开发工作站上调试问题。</p>
<p>为了避免破坏主线，您可以考虑使用<a target="_blank" rel="noopener" href="https://martinfowler.com/bliki/PendingHead.html">待处理头</a>。</p>
<p>当团队介绍CI时，通常这是最难解决的问题之一。 在团队的早期阶段，很难养成使用主线构建的常规习惯，特别是如果他们正在处理现有的代码库。 耐心和稳定的应用似乎经常做到这一点，所以不要气馁。</p>
<h2 id="保持快速构建"><a href="#保持快速构建" class="headerlink" title="保持快速构建"></a>保持快速构建</h2><p>持续集成的重点是提供快速反馈。 没有什么比一个需要很长时间的构建更能吸取CI活动血液的了。 在这里，我必须承认一个狡猾的老家伙认为长期构建是娱乐的。 我的大多数同事认为构建需要一个小时才是完全不合理的。 我记得团队梦想着他们可以如此快速地获得它 - 偶尔我们仍会遇到很难让构建达到这种速度的情况。</p>
<p>然而，对于大多数项目而言，10分钟构建的XP准则完全是合理的。 我们的大多数现代项目实现了这一点 值得集中精力实现这一目标，因为每次开发人员每次提交时，每一分钟都会为每个开发人员节省一分钟。 由于CI需要频繁提交，因此需要花费大量时间。</p>
<p>如果你正盯着一个小时的构建时间，那么进入更快的构建可能看起来是一个令人生畏的前景。在一个新项目上工作并考虑如何保持快速，这甚至是令人生畏的。至少对于企业应用程序，我们发现通常的瓶颈是测试 - 特别是涉及外部服务（如数据库）的测试。</p>
<p>可能最关键的一步是开始设置部署管道。部署管道（也称为构建管道或分阶段构建）背后的想法是实际上有多个构建按顺序完成。对主线的提交触发了第一次构建 - 我称之为提交构建。提交构建是当有人提交到主线时所需的构建。提交构建是必须快速完成的构建，因此它将需要许多快捷方式，这将降低检测错误的能力。诀窍是平衡错误查找和速度的需求，以便良好的提交构建足够稳定，以便其他人可以工作。</p>
<p>一旦提交构建良好，那么其他人可以放心地处理代码。 但是，您可以开始进行更久，更慢的测试。 其他计算机可以在构建上运行更长时间的测试例程。</p>
<p>一个简单的例子是两阶段部署管道。 第一阶段将进行编译和运行测试，这些测试是更加本地化的单元测试，数据库完全被删除。 这样的测试可以非常快速地运行，保持在十分钟的指导范围内。 但是，任何涉及更大规模交互的错误，特别是那些涉及真实数据库的错误都将无法找到。 第二阶段构建运行一组不同的测试，这些测试确实击中了真实的数据库，并涉及更多的端到端行为。 这个套件可能需要几个小时才能运行。</p>
<p>在这种情况下，人们使用第一阶段作为提交构建，并将其用作主要CI周期。第二阶段构建可以运行，从最新的良好提交构建中获取可执行文件以进行进一步测试。如果这个辅助构建失败，那么这可能没有相同的“停止一切”质量，但团队确实旨在尽可能快地修复此类错误，同时保持提交构建运行。在这个例子中，后来的构建通常是纯粹的测试，因为这些时间通常是导致缓慢的测试。</p>
<p>如果辅助构建检测到错误，则表明提交构建可以执行另一个测试。您希望尽可能确保任何后续阶段的失败都会导致提交构建中的新测试，这些测试会捕获该错误，因此该错误在提交构建中保持不变。这样，只要有东西超过它们，提交测试就会得到加强。在某些情况下，无法构建暴露错误的快速运行测试，因此您可能决定仅在辅助版本中测试该条件。大多数时候，幸运的是，您可以为提交构建添加合适的测试。</p>
<p>此示例属于两阶段管道，但基本原则可以扩展到任意数量的后续阶段。提交构建之后的构建也可以并行完成，因此如果您有两个小时的辅助测试，则可以通过让两台计算机分别运行一半测试来提高响应能力。通过使用这样的并行辅助构建，您可以在常规构建过程中引入各种进一步的自动化测试，包括性能测试。</p>
<h2 id="在生产环境的克隆中进行测试"><a href="#在生产环境的克隆中进行测试" class="headerlink" title="在生产环境的克隆中进行测试"></a>在生产环境的克隆中进行测试</h2><p>测试的目的是在受控条件下清除系统在生产中会遇到的任何问题。 其中很大一部分是生产系统运行的环境。 如果您在不同的环境中进行测试，则每个差异都会导致测试中发生的情况不会在生产中发生。</p>
<p>因此，您希望将测试环境设置为尽可能模拟生产环境。 使用相同的数据库软件，使用相同版本的操作系统。 将生产环境中的所有适当库放入测试环境中，即使系统实际上并未使用它们。 使用相同的IP地址和端口，在同一硬件上运行它。</p>
<p>嗯，实际上有限制。 如果您正在编写桌面软件，那么使用所有不同人员运行的第三方软件来测试每个可能桌面的克隆是不切实际的。 类似地，一些生产环境的复制成本可能过高（尽管我经常通过不复制中等昂贵的环境而遇到虚假经济）。 尽管存在这些限制，您的目标仍然是尽可能多地复制生产环境，并了解您为测试和生产之间的每个差异所接受的风险。</p>
<p>如果你有一个非常简单的设置，没有很多尴尬的通信，你可能能够在一个模仿的环境中运行你的提交构建。 但是，通常需要使用<a target="_blank" rel="noopener" href="https://martinfowler.com/bliki/TestDouble.html">双倍测试</a>，因为系统响应缓慢或间歇性。 因此，通常会有一个非常人工的环境来进行速度提交测试，并使用生产克隆进行二次测试。</p>
<p>我注意到人们越来越有兴趣使用虚拟化来轻松地将测试环境放在一起。 可以使用虚拟化中包含的所有必要元素保存虚拟机。 然后安装最新的构建和运行测试相对简单。 此外，这可以允许您在一台计算机上运行多个测试，或者在一台计算机上模拟网络中的多台计算机。 随着虚拟化的性能损失减少，此选项越来越有意义。</p>
<h2 id="让任何人都可以轻松获得最新的可执行文件"><a href="#让任何人都可以轻松获得最新的可执行文件" class="headerlink" title="让任何人都可以轻松获得最新的可执行文件"></a>让任何人都可以轻松获得最新的可执行文件</h2><p>软件开发中最困难的部分之一是确保构建正确的软件。 我们发现很难提前确定你想要的东西并且是正确的; 人们发现更容易看到不太正确的事情，并说明需要如何改变。 敏捷开发过程明确地期望并利用这部分人类行为。</p>
<p>为了帮助完成这项工作，任何参与软件项目的人都应该能够获得最新的可执行文件并能够运行它：用于演示，探索性测试，或者只是看看本周发生了什么变化。</p>
<p>这样做非常简单：确保有一个众所周知的地方，人们可以找到最新的可执行文件。 在这样的商店中放置几个可执行文件可能很有用。 对于最新的，您应该将最新的可执行文件传递给提交测试 - 如果提交套件相当强大，这样的可执行文件应该非常稳定。</p>
<p>如果您正在跟踪具有良好定义的迭代的过程，那么通常也可以将迭代构建的结束放在那里。 特别是演示需要熟悉其特性的软件，因此通常值得牺牲最新的演示者知道如何操作的东西。</p>
<h2 id="每个人都可以看到发生了什么"><a href="#每个人都可以看到发生了什么" class="headerlink" title="每个人都可以看到发生了什么"></a>每个人都可以看到发生了什么</h2><p>持续集成完全是为了沟通，因此您需要确保每个人都能轻松查看系统状态以及对系统所做的更改。</p>
<p>沟通最重要的事情之一是主线构建的状态。如果您正在使用Cruise，那么会有一个内置的网站，它会告诉您是否有正在进行的构建以及最后一个主线构建的状态。许多团队喜欢通过将连续显示连接到构建系统来使这一点变得更加明显 - 构建工作时发出绿光的光或者如果失败则发红光是很受欢迎的。一种特别常见的触摸是红色和绿色<a target="_blank" rel="noopener" href="http://www.pragmaticautomation.com/cgi-bin/pragauto.cgi/Monitor/Devices/BubbleBubbleBuildsInTrouble.rdoc">熔岩灯</a> - 不仅仅是这些指示了构建的状态，而且还指示了该状态的持续时间。红色灯泡上的气泡表明构造已经被打破了太长时间。每个团队都会在这些构建传感器上做出自己的选择 - 玩你的选择很有趣（最近我看到有人正在试验一只跳舞的兔子。）</p>
<p>如果您使用的是手动CI流程，则此可见性仍然至关重要。 物理构建机器的监视器可以显示主线构建的状态。 通常你有一个构建令牌可以放在任何正在进行构建的人的桌面上（再次，像橡皮鸡一样愚蠢的东西是一个不错的选择）。 人们常常喜欢在良好的构造上发出简单的声音，比如敲响铃声。</p>
<p>当然，CI服务器的网页可以携带比这更多的信息。 Cruise不仅指出了谁在建造，还指出了他们所做的改变。 Cruise还提供了变更历史，使团队成员能够很好地了解项目的近期活动。 我知道团队负责人喜欢用它来了解人们一直在做什么，并了解系统的变化。</p>
<p>使用网站的另一个好处是，那些不在同一地点的人可以了解项目的状态。总的来说，我更愿意让每个人积极参与一个项目，但往往有外围人士喜欢关注事物。它还可以将组聚合在一起构建来自多个项目的信息 - 提供不同项目的简单自动状态。</p>
<p>良好的信息显示不仅仅是计算机屏幕上的信息。我最喜欢的一个展示是一个进入CI的项目。它有着无法建立稳定版本的悠久历史。我们在墙上放了一个日历，每天显示一个小方块的全年。如果QA小组收到一个通过提交测试的稳定版本，那么QA小组每天都会在当天贴上绿色标签，否则为红色方块。随着时间的推移，日历显示构建过程的状态显示稳定的改善，直到绿色方块如此常见以至于日历消失 - 其目的得以实现。</p>
<h2 id="自动化部署"><a href="#自动化部署" class="headerlink" title="自动化部署"></a>自动化部署</h2><p>要进行持续集成，您需要多个环境，一个用于运行提交测试，一个或多个用于运行二级测试。 由于您每天多次在这些环境之间移动可执行文件，因此您需要自动执行此操作。 因此，拥有允许您轻松地将应用程序部署到任何环境的脚本非常重要。</p>
<p>这样做的一个自然结果是您还应该拥有允许您以类似的方式部署到生产中的脚本。 您可能不会每天部署到生产中（虽然我遇到了可以执行的项目），但自动部署有助于加快流程并减少错误。 它也是一个便宜的选择，因为它只使用您用于部署到测试环境中的相同功能。</p>
<p>如果您将一个额外的自动化功能部署到生产中，您应该考虑自动回滚。不好的事情会不时发生，如果有褐色的物质碰到旋转的金属，那么能够迅速恢复到最后一个已知的良好状态是件好事。能够自动恢复还可以减少部署的紧张程度，鼓励人们更频繁地部署，从而快速地向用户提供新功能。 （Ruby on Rails社区开发了一个名为<a target="_blank" rel="noopener" href="http://capistranorb.com/">Capistrano</a>的工具，它是执行此类工作的工具的一个很好的例子。）</p>
<p>在集群环境中，我看到滚动部署，新软件一次部署到一个节点，在几个小时内逐步替换应用程序。</p>
<p>我遇到的公共Web应用程序的一个特别有趣的变体是将试验版本部署到用户子集的想法。然后，团队会在决定是否将其部署到完整用户群之前查看试用版的使用方式。这允许您在提交最终选择之前测试新功能和用户界面。自动部署与良好的CI规则相结合，对于实现这一目标至关重要</p>
<h1 id="持续集成的好处"><a href="#持续集成的好处" class="headerlink" title="持续集成的好处"></a>持续集成的好处</h1><p>总的来说，我认为持续集成的最大和最广泛的好处是降低风险。 我的思绪仍然浮现在我在第一段中提到的早期软件项目中。 在那里，他们最终（他们希望）有一个漫长的项目，但却没有真正了解它们在完成之前需要多长时间。</p>
<p>延迟整合的问题在于，很难预测需要多长时间才能完成，更糟糕的是，很难看出你在这个过程中走了多远。 结果是，你正在把自己置于一个项目最紧密的部分之一的完全盲点 - 即使你是一个罕见的情况，你还不晚。</p>
<p>持续集成完全解决了这个问题。没有长时间的整合，你完全消除了盲点。在任何时候，您都知道自己在哪里，哪些有效，哪些无效，以及您系统中存在的突出错误。</p>
<p>Bug - 这些是破坏信心和搞乱时间表和声誉的令人讨厌的东西。部署的软件中的bug会让用户生气。正在进行的工作中的bug妨碍了您，使得其他软件更难以正常工作。</p>
<p>Continuous Integrations不会消除bug，但它确实使它们更容易查找和删除。在这方面，它更像是自我测试代码。如果你引入一个bug并快速检测它，那么摆脱它会容易得多。由于您只更改了系统的一小部分，因此您无需深入了解。由于系统的那一点是你刚刚使用过的，它在你的记忆中是新的 - 再次使它更容易找到bug。您还可以使用<a target="_blank" rel="noopener" href="https://martinfowler.com/bliki/DiffDebugging.html">diff调试</a> - 将系统的当前版本与之前没有错误的版本进行比较。</p>
<p>错误也是累积的。你拥有的错误越多，删除每个错误就越困难。这部分是因为你得到了错误交互，其中失败表现为多个错误的结果 - 使每个错误更难找到。这也是心理上的 - 当人们有很多错误时，人们找不到勇气并摆脱错误 - 这是一种实用程序员称之为<a target="_blank" rel="noopener" href="https://www.amazon.com/gp/product/020161622X?ie=UTF8&tag=martinfowlerc-20&linkCode=as2&camp=1789&creative=9325&creativeASIN=020161622X">破碎窗户综合症</a>的现象。</p>
<p>因此，持续集成的项目往往会在生产和流程中显着减少错误。但是我应该强调，这种好处的程度与测试套件的好坏直接相关。您应该发现构建一个明显不同的测试套件并不困难。但是，通常情况下，在团队真正达到他们有可能达到的低级别错误之前需要一段时间。实现目标意味着不断努力并改进您的测试。</p>
<p>如果您持续集成，它将消除频繁部署的最大障碍之一。频繁部署很有价值，因为它可以让您的用户更快地获得新功能，更快地获得有关这些功能的反馈，并且通常在开发周期中变得更加协作。这有助于打破客户与开发之间的障碍 - 我认为这些障碍是成功开发软件的最大障碍。</p>
<h1 id="引入持续集成"><a href="#引入持续集成" class="headerlink" title="引入持续集成"></a>引入持续集成</h1><p>所以你想要尝试持续集成 - 你从哪里开始？ 我在上面概述的全套实践为您提供了全部优势 - 但您无需从所有实践开始。</p>
<p>这里没有固定的配方 - 很大程度上取决于您的设置和团队的性质。 但是，我们已经学到了一些让事情顺利进行的事情。</p>
<p>最初的步骤之一是使构建自动化。 获取源代码控制所需的一切，以便您可以使用单个命令构建整个系统。 对于许多项目来说，这不是一项小任务 - 但它对任何其他事情都很重要。 最初，您可能只是偶尔按需构建，或者只是进行自动夜间构建。 虽然这些不是持续集成，但自动夜间构建是一个很好的步骤。</p>
<p>在构建中引入一些自动化测试。 尝试确定出现问题的主要区域，并通过自动化测试来揭露这些故障。 特别是在现有项目中，很难快速获得一套非常好的测试 - 构建测试需要时间。 你必须从某个地方开始 - 所有关于罗马建造计划的陈词滥调都适用。</p>
<p>尝试加快提交构建。 在几个小时的构建上持续集成总比没有好，但是要达到那个神奇的十分钟数字要好得多。 这通常需要在您的代码库上进行一些非常严格的手术，因为您打破了对系统缓慢部分的依赖性。</p>
<p>如果要开始新项目，请从头开始进行持续集成。 密切关注构建时间，并在开始慢于十分钟规则时立即采取措施。 通过快速行动，您将在代码库变得如此之大之前进行必要的重组，这将成为一个重大的痛苦。</p>
<p>最重要的是得到一些帮助。 找一个做过持续集成的人来帮助你。 像任何新技术一样，当你不知道最终结果是什么时，很难引入它。 获得导师可能需要花钱，但如果你不这样做，你也会付出浪费的时间和生产力。 （免责声明&#x2F;广告 - 是的，我们ThoughtWorks在这方面做了一些咨询。毕竟我们已经犯了很多错误。）</p>
<h1 id="最后的想法"><a href="#最后的想法" class="headerlink" title="最后的想法"></a>最后的想法</h1><p>自从Matt和我在本网站上撰写原始论文以来，持续集成已经成为软件开发的主流技术。 几乎没有任何ThoughtWorks项目没有它 - 我们看到其他人在世界各地使用CI。 我几乎没有听说过这种方法的负面影响 - 不像一些更有争议的极限编程实践。</p>
<p>如果您没有使用持续集成，我强烈建议您尝试一下。 如果你是，也许本文中有一些想法可以帮助你更有效地做到这一点。 我们在过去几年中学到了很多关于持续集成的知识，我希望还有更多需要学习和改进的地方。</p>
<h1 id="进一步阅读"><a href="#进一步阅读" class="headerlink" title="进一步阅读"></a>进一步阅读</h1><p>像这样的文章只能涵盖这么多，但这是一个重要的主题，所以我在我的网站上创建了一个<a target="_blank" rel="noopener" href="https://martinfowler.com/delivery.html">指南页面</a>，为您指出更多信息。</p>
<p>为了更详细地探索持续整合，我建议你看一下Paul Duvall关于这个主题的<a target="_blank" rel="noopener" href="https://martinfowler.com/books/duvall.html">适当标题的书</a>（赢得了Jolt奖 - 比我曾经管理过的更多）。 有关更广泛的持续交付流程的更多信息，请查看<a target="_blank" rel="noopener" href="https://martinfowler.com/books/continuousDelivery.html">Jez Humble和Dave Farley的书</a> - 这本书也让我获得了Jolt奖。</p>
<p>您还可以在<a target="_blank" rel="noopener" href="http://www.thoughtworks.com/continuous-integration">ThoughtWorks站点</a>上找到有关持续集成的更多信息。</p>
<h1 id="旁注"><a href="#旁注" class="headerlink" title="旁注"></a>旁注</h1><p>关于<a target="_blank" rel="noopener" href="https://martinfowler.com/articles/originalContinuousIntegration.html">持续集成的原始文章</a>描述了我们的经验，因为Matt帮助将2000年的ThoughtWorks项目持续集成。</p>
<p>Jez Humble和Dave Farley将这些想法扩展到<a target="_blank" rel="noopener" href="https://martinfowler.com/books/continuousDelivery.html">持续交付</a>的主题，更详细地介绍了部署管道的概念。 他们的书“持续交付”在2011年正确地赢得了Jolt卓越奖。</p>
<p>许多人担心如何处理频繁发布的数据库。 Pramod Sadalage和我写了这篇文章，解释了<a target="_blank" rel="noopener" href="https://martinfowler.com/articles/evodb.html">如何通过自动重构和数据库迁移</a>来解决这个问题。</p>

      
    </div> -->
          <div class="article-entry" itemprop="articleBody">
            
              
                
                      
                        
                          
                            
                              
                                
                                  
                                    <p>
                                      <p>本文翻译自：<a target="_blank" rel="noopener" href="https://martinfowler.com/articles/continuousIntegration.html">https://martinfowler.com/articles/continuousIntegration.html</a></p>

                                        <p>
                                          
                                            
                                              
                                                      
          </div>
    <p class="article-more-link">
      <a href="/2018/12/06/basic/007-continuous-integration/#more">
        Read More
      </a>
    </p>
    <!-- <div class="article-more-link">
      <a href="/2018/12/06/basic/007-continuous-integration/#more">
        read more
      </a>
    </div> -->
    


      <footer class="article-footer">
        <a data-url="http://http//jimolonely.github.io/2018/12/06/basic/007-continuous-integration/" data-id="cl1fw7fhs000tvkd325u5fiqk" class="article-share-link">
          Share
        </a>
        
            
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/microservice/" rel="tag">microservice</a><span class="article-tag-list-count">9</span></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E8%BF%90%E7%BB%B4/" rel="tag">运维</a><span class="article-tag-list-count">1</span></li></ul>

      </footer>
      </div>
      
</article>


  
    <article id="post-basic/006-microservice-prerequisites" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/12/04/basic/006-microservice-prerequisites/" class="article-date">
  <time datetime="2018-12-04T12:44:13.000Z" itemprop="datePublished">2018-12-04</time>
</a>
      
  </div>
  <div class="article-inner">
    
      
        <header class="article-header">
          
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/12/04/basic/006-microservice-prerequisites/">微服务先决条件</a>
    </h1>
  

        </header>
        
          <!-- <div class="article-entry" itemprop="articleBody">
      
        <p>本文翻译自：<a target="_blank" rel="noopener" href="https://martinfowler.com/bliki/MicroservicePrerequisites.html">https://martinfowler.com/bliki/MicroservicePrerequisites.html</a></p>
<p>当我与人们谈论使用微服务架构时，我听到了很多乐观的观点。 开发人员喜欢与较小的单元一起工作，并期望具有比整体更好的模块化。 但是，与任何架构决策一样，需要权衡利弊。 特别是对于微服务，操作会产生严重后果，他们现在必须处理小型服务的生态系统，而不是单一整体的、定义明确的巨型服务。 因此，如果您没有某些基线能力，则不应考虑使用微服务风格。</p>
<img src="/2018/12/04/basic/006-microservice-prerequisites/000.png" class="">

<h1 id="快速配置"><a href="#快速配置" class="headerlink" title="快速配置"></a>快速配置</h1><p>您应该能够在几小时内启动新服务。 当然，这适用于<a target="_blank" rel="noopener" href="https://martinfowler.com/bliki/CloudComputing.html">云计算</a>，但它也可以在没有完整云服务的情况下完成。 为了能够进行这样的快速配置，您需要进行大量的自动化 - 它可能不必完全自动化，但是为了做到严肃的微服务，它将需要这样做。</p>
<h1 id="基本监控"><a href="#基本监控" class="headerlink" title="基本监控"></a>基本监控</h1><p>由于许多松散耦合的服务在生产中协作，因此在测试环境中难以检测到的方式肯定会出错。 因此，必须建立监控机制，以便迅速发现严重问题。 这里的基线是检测技术问题（计算错误，服务可用性等），但也值得监控业务问题（例如检测订单下降）。 如果出现突然问题，那么您需要确保可以快速回滚，因此需要下面的快速部署能力。</p>
<p>2点：</p>
<ol>
<li>技术问题监控</li>
<li>业务问题监控</li>
</ol>
<h1 id="快速应用程序部署"><a href="#快速应用程序部署" class="headerlink" title="快速应用程序部署"></a>快速应用程序部署</h1><p>要管理许多服务，您需要能够快速部署它们，以便测试环境和生产。 通常这将涉及可以在不超过几个小时内执行的<a target="_blank" rel="noopener" href="https://martinfowler.com/bliki/DeploymentPipeline.html">部署流水线</a>。 在早期阶段，一些人工干预是正常的，但您将很快寻求完全自动化。</p>
<h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>这些功能意味着重要的组织转变 - 开发人员和运营之间的密切合作：<a target="_blank" rel="noopener" href="https://martinfowler.com/bliki/DevOpsCulture.html">开发运维文化</a>。 需要进行此协作以确保快速完成配置和部署，确保在监控指示问题时能够快速做出反应也很重要。 特别是任何事件管理都需要涉及开发团队和运维团队，既可以解决当前问题，也可以追寻根本原因分析，以确保解决潜在问题。</p>
<p>有了这种设置，您就可以使用一些微服务为第一个系统做好准备。 部署此系统并在生产中使用它，期望学到很多关于保持健康并确保devops协作运行良好的信息。 在增加服务数量之前，给自己时间做这些，从中学习，增加更多能力。</p>
<p>如果您现在没有这些功能，那么您应该确保开发它们，以便在您将微服务系统投入生产时做好准备。 实际上，这些功能对于单片系统来说也应该是你应该拥有的。 虽然它们并非普遍存在于软件组织中，但很少有地方不重视它。</p>
<p>超越少数服务将需要更多服务。 您需要通过多种服务跟踪业务事务，并通过完全接受<a target="_blank" rel="noopener" href="https://martinfowler.com/bliki/ContinuousDelivery.html">持续发布</a>来自动化您的配置和部署。 还需要启动<a target="_blank" rel="noopener" href="https://martinfowler.com/articles/microservices.html#OrganizedAroundBusinessCapabilities">以产品为中心的团队</a>转变。 您需要组织开发环境，以便开发人员可以轻松地在多个存储库，库和语言之间进行交换。 我的一些联系人感觉到这里可能有一个有用的<a target="_blank" rel="noopener" href="https://martinfowler.com/bliki/MaturityModel.html">成熟模型</a>可以帮助组织进行更多的微服务实现 - 我们应该在未来几年内看到更多的成果。</p>

      
    </div> -->
          <div class="article-entry" itemprop="articleBody">
            
              
                
                      
                        
                          
                            
                              
                                
                                  
                                    <p>
                                      <p>本文翻译自：<a target="_blank" rel="noopener" href="https://martinfowler.com/bliki/MicroservicePrerequisites.html">https://martinfowler.com/bliki/MicroservicePrerequisites.html</a></p>

                                        <p>
                                          
                                            
                                              
                                                      
          </div>
    <p class="article-more-link">
      <a href="/2018/12/04/basic/006-microservice-prerequisites/#more">
        Read More
      </a>
    </p>
    <!-- <div class="article-more-link">
      <a href="/2018/12/04/basic/006-microservice-prerequisites/#more">
        read more
      </a>
    </div> -->
    


      <footer class="article-footer">
        <a data-url="http://http//jimolonely.github.io/2018/12/04/basic/006-microservice-prerequisites/" data-id="cl1fw7fhq000pvkd36r1m35m5" class="article-share-link">
          Share
        </a>
        
            
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/microservice/" rel="tag">microservice</a><span class="article-tag-list-count">9</span></li></ul>

      </footer>
      </div>
      
</article>


  
    <article id="post-basic/005-how-to-break-monolith-into-microservices" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/11/30/basic/005-how-to-break-monolith-into-microservices/" class="article-date">
  <time datetime="2018-11-30T09:32:56.000Z" itemprop="datePublished">2018-11-30</time>
</a>
      
  </div>
  <div class="article-inner">
    
      
        <header class="article-header">
          
  
    <h1 itemprop="name">
      <a class="article-title" href="/2018/11/30/basic/005-how-to-break-monolith-into-microservices/">如何拆分微服务应用</a>
    </h1>
  

        </header>
        
          <!-- <div class="article-entry" itemprop="articleBody">
      
        <p>本文翻译自：<a target="_blank" rel="noopener" href="https://martinfowler.com/articles/break-monolith-into-microservices.html">https://martinfowler.com/articles/break-monolith-into-microservices.html</a></p>
<h1 id="什么时候解偶和，解什么"><a href="#什么时候解偶和，解什么" class="headerlink" title="什么时候解偶和，解什么"></a>什么时候解偶和，解什么</h1><p>由于单一系统变得太大而无法应对，许多企业被迫将其分解为微服务架构风格。 这是一次有价值的旅程，但并不容易。 我们已经了解到，为了做到这一点，我们需要从简单的服务开始，然后提取基于垂直功能的服务，这些服务对业务很重要并且经常变化。 这些服务最初应该很大，并且最好不依赖于剩余的整体结构。 我们应确保每个迁移步骤都代表整体架构的原子改进。</p>
<p>将单片系统迁移到微服务生态系统是一个史诗般的旅程。踏上这一旅程的人们抱有诸如增加运营规模，加快变革步伐，避免高昂变革成本等愿望。他们希望增加团队数量，同时使他们能够并行地相互独立地交付价值。他们希望快速尝试其业务的核心功能并更快地实现价值。他们还希望避免与更改现有单片系统相关的高成本。</p>
<p>决定何时以及如何逐步迁移分离的能力是将整体分解为微服务生态系统的一些架构挑战。在这篇文章中，我分享了一些技术，可以指导交付团队 - 开发人员，架构师，技术经理 - 在整个过程中做出这些分解决策。</p>
<p>为了阐明这些技术，我使用了多层在线零售应用程序。该应用程序紧密结合面向用户，业务逻辑和数据层。我之所以选择这个例子，是因为它的架构具有许多企业运行的单片应用程序的特性，而且它的技术堆栈足够现代，可以证明分解是合理的，而不是完全重写和替换。</p>
<h1 id="微服务生态系统目的地"><a href="#微服务生态系统目的地" class="headerlink" title="微服务生态系统目的地"></a>微服务生态系统目的地</h1><p>在开始之前，每个人都对微服务生态系统有共同的理解是至关重要的。 微服务生态系统是一个服务平台，每个服务都封装了业务能力。 业务功能表示企业在特定域中执行的目标和职责。 每个微服务都公开了一个API，开发人员可以以自助方式发现和使用它。 微服务具有独立的生命周期。 开发人员可以独立构建，测试和发布每个微服务。 微服务生态系统强制执行自主长期团队的组织结构，每个团队负责一个或多个服务。 与微服务中的一般感知和“微观”相反，每项服务的规模最小，并且可能根据组织的运营成熟度而变化。 正如Martin Fowler所说，“微服务是标签，而不是描述”。</p>
<p>图1</p>
<img src="/2018/11/30/basic/005-how-to-break-monolith-into-microservices/000.png" class="">

<h1 id="旅程指南"><a href="#旅程指南" class="headerlink" title="旅程指南"></a>旅程指南</h1><p>在深入了解指南之前，重要的是要知道将现有系统分解为微服务会产生很高的总体成本，并且可能需要多次迭代。 开发人员和架构师必须仔细评估现有巨型组件的分解是否是正确的路径，以及微服务本身是否是<a target="_blank" rel="noopener" href="https://martinfowler.com/articles/microservice-trade-offs.html">正确的目的地</a>。 搞清楚这些后，让我们开始指南。</p>
<h2 id="简单和分离能力的热身"><a href="#简单和分离能力的热身" class="headerlink" title="简单和分离能力的热身"></a>简单和分离能力的热身</h2><p>走上微服务这条路，需要最低级别的操作准备。它需要按需访问部署环境，构建新的连续交付管道以独立构建，测试和部署可执行服务，以及保护，调试和监视分布式体系结构的能力。</p>
<p>无论我们是在构建新的服务还是分解现有系统，都需要运营准备就绪。有关此操作准备情况的更多信息，请参阅<a target="_blank" rel="noopener" href="https://martinfowler.com/bliki/MicroservicePrerequisites.html">Martin Fowler关于微服务先决条件</a>的文章。好消息是，自Martin发表文章以来，运行微服务架构的技术发展迅速。这包括创建Service Mesh，一个专用的基础架构层，用于运行快速，可靠和安全的微服务网络，<a target="_blank" rel="noopener" href="https://www.thoughtworks.com/radar/platforms/kubernetes">容器编排系统</a>，以提供更高级别的部署基础架构抽象，以及持续交付系统（如GoCD）的演进，以构建，测试和部署微服务作为容器。</p>
<p>我的建议是开发人员和运营团队使用他们分解或构建新服务的第一和第二服务构建底层基础架构，持续交付管道和API管理系统。从与monolith完全分离的功能开始，它们不需要更改当前使用整体的许多面向客户端的应用程序，并且可能不需要数据存储。交付团队正在优化的目的是验证他们的交付方法，提高团队成员的技能，并构建提供可自行部署的安全服务所需的最低基础架构，以暴露自助式API。例如，对于在线零售应用程序，第一个服务可以是monolith可以调用以验证最终用户的“最终用户身份验证”服务，第二个服务可以是“客户配置文件”服务，提供外观服务更好地了解新客户。</p>
<p>首先，我建议解耦简单的边缘服务。 接下来，我们采用不同的方法将解藕深深嵌入单片系统的功能。 我建议首先进行边缘服务，因为在旅程开始时，交付团队面临的最大风险是无法正确操作微服务。 因此，使用边缘服务来实践他们所需的操作先决条件是很好的。 一旦他们解决了这个问题，他们就可以解决分裂巨石的关键问题。</p>
<img src="/2018/11/30/basic/005-how-to-break-monolith-into-microservices/001.png" class="">

<h2 id="最大限度地减少对整体应用的依赖"><a href="#最大限度地减少对整体应用的依赖" class="headerlink" title="最大限度地减少对整体应用的依赖"></a>最大限度地减少对整体应用的依赖</h2><p>作为一项基本原则，交付团队需要最大限度地减少新组建的微服务与整体结构的依赖关系。 微服务的一个主要好处是拥有快速独立的发布周期。 如果依赖于整体 - 数据，逻辑，API  - 将服务耦合到整体的发布周期，请禁止这种好处。 远离整体的主要动机通常是锁定其中的功能的高成本和缓慢的变化速度，因此我们希望通过消除对整体结构的依赖性来逐步向这些核心功能分离。 如果团队遵循本指南并将功能构建到他们自己的服务中，他们发现的是相反的依赖性，从整体到服务。 这是一个理想的依赖方向，因为它不会减慢新服务的变化速度。</p>
<p>下一步指南提供了其他方法来确定开发人员分离服务的顺序。 这意味着他们可能无法始终避免依赖回到整体。 如果新服务最终回调整体，我建议从整体中公开一个新的API，并通过新服务中的<a target="_blank" rel="noopener" href="https://martinfowler.com/articles/refactoring-external-service.html#SeparatingTheYoutubeDataStructureIntoAGateway">anti-corruption层</a>访问API，以确保整体概念不会 泄漏。 努力定义反映明确定义的域概念和结构的API，即使monolith的内部实现可能不同。 在这种不幸的情况下，交付团队将承担改变整体，测试和发布新服务以及整体版本的成本和难度。</p>
<p>首先将不需要依赖关系的服务解耦回整体块，并尽量减少对整体块的更改:</p>
<img src="/2018/11/30/basic/005-how-to-break-monolith-into-microservices/002.png" class="">

<h2 id="尽早拆分粘性功能"><a href="#尽早拆分粘性功能" class="headerlink" title="尽早拆分粘性功能"></a>尽早拆分粘性功能</h2><p>我假设在这一点上，交付团队很乐意构建微服务并准备好攻击棘手的问题。 然而，他们可能会发现无法做到在不依赖整体的情况下解耦出下一个服务的能力。 造成这种情况的根本原因通常是整体结构中的功能泄漏，没有明确定义为域概念，其中许多整体功能依赖于它。 为了能够进步，开发人员需要识别粘性功能，将其<a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Reification">解构为定义良好的域概念–物化</a>，然后将这些域概念重新划分为单独的服务。</p>
<p>例如，在基于整体应用的web中，“（web）会话”的概念是最常见的耦合因素之一。在在线零售示例中，会话通常是许多属性的桶，范围从跨越不同域边界的用户偏好（例如运送和支付偏好）到用户意图和诸如最近访问的页面，点击的产品和愿望列表之类的交互。除非我们解决当前的“会话”概念的解耦，解构和统一，否则我们将努力解耦许多未来的能力，因为它们将通过泄漏的会话概念与整体纠缠在一起。我也不鼓励在整体结构之外创建一个“会话”服务，因为它只会导致目前整体流程中存在的类似紧密耦合，更糟糕的是，在流程外和整个网络中。</p>
<p>开发人员可以从粘性功能中逐步提取微服务，即时服务。例如，首先重构“客户愿望清单”并将其提取到新服务中，然后将“客户支付首选项”重构为另一个微服务并重复。</p>
<p>确定最具耦合性的概念，并将其解耦，解构并具体化为具体的域服务:</p>
<img src="/2018/11/30/basic/005-how-to-break-monolith-into-microservices/003.png" class="">

<p><strong>使用依赖关系和结构代码分析工具（如<a target="_blank" rel="noopener" href="http://structure101.com/">Structure101</a>）来识别整体中的最大耦合和约束因子功能。</strong></p>
<h2 id="垂直去耦并尽早释放数据"><a href="#垂直去耦并尽早释放数据" class="headerlink" title="垂直去耦并尽早释放数据"></a>垂直去耦并尽早释放数据</h2><p>从整体解耦功能的主要驱动力是能够独立发布它们。 第一个原则应该指导开发人员围绕如何执行解耦的每个决策。 单片系统通常由紧密集成的层或甚至多个系统组成，这些系统需要一起发布并具有脆弱的相互依赖性。 例如，在在线零售系统中，由一个或多个面向在线购物应用程序的客户组成的整体结构，后端系统通过集中集成的数据存储实现许多业务功能以保持状态。</p>
<p>大多数解耦尝试都是从提取面向用户的组件和一些前端服务开始，为现代UI提供给开发人员友好的API，而数据仍然锁定在一个架构和存储系统中。 虽然这种方法可以获得一些快速的成功，例如更频繁地更改UI，但在核心功能方面，交付团队只能像最慢的部分（整体和整体应用的数据存储）一样缓慢地移动。 <strong>简而言之，在不解耦数据的情况下，架构不是微服务</strong>。 将所有数据保存在同一数据存储中与微服务的分散数据管理特性相反。</p>
<p>该策略是垂直移出功能，将核心功能与其数据分离，并将所有前端应用程序重定向到新的API。</p>
<p>将数据与服务一起解偶的主要障碍是在集中共享数据中心写入和读取数据。 交付团队需要结合适合其环境的数据迁移策略，具体取决于他们是否能够同时重定向和迁移所有数据读&#x2F;写器。 Stripe的<a target="_blank" rel="noopener" href="https://robertheaton.com/2015/08/31/migrating-bajillions-of-database-records-at-stripe">四阶段数据迁移策略</a>适用于需要逐步迁移通过数据库集成的应用程序的许多环境，而所有正在变更的系统都需要连续运行。</p>
<p>将其数据与服务分离到新的微服务，从而暴露新接口，修改消费者并将消费者重定向到新API:</p>
<img src="/2018/11/30/basic/005-how-to-break-monolith-into-microservices/004.png" class="">

<p><strong>避免只去耦外观的反模式或只解耦后端服务或永远不解耦数据。</strong></p>
<h2 id="解藕重要业务功能和经常变化的部分"><a href="#解藕重要业务功能和经常变化的部分" class="headerlink" title="解藕重要业务功能和经常变化的部分"></a>解藕重要业务功能和经常变化的部分</h2><p>解耦整体应用很难。我听说<a target="_blank" rel="noopener" href="http://nealford.com/">Neal Ford</a>使用了仔细的器官手术的类比。在在线零售应用程序中，提取功能包括仔细提取功能的数据，逻辑，面向用户的组件并将其重定向到新服务。因为这是一项非常重要的工作，开发人员需要不断评估与他们获得的好处脱钩的成本，例如：走得更快或规模越来越大。例如，如果交付团队的目标是加速对整体中锁定的现有功能的修改，那么他们必须确定最需要修改的功能。将不断变化的部分代码分离，并从开发人员那里获得很多爱，并且最大限度地限制它们以快速提供价值。交付团队可以分析代码提交模式，找出历史上最变化的内容，并将其与产品路线图和产品组合叠加在一起，以了解最近将获得关注的最佳功能。他们需要与业务和产品经理交谈，以了解对他们而言真正重要的差异化功能。</p>
<p>例如，在在线零售系统中，“客户个性化”是一项经过大量实验的功能，可以为客户提供最佳体验，并且是解耦的理想选择。 这是一项对业务很重要，客户体验和经常修改的功能。</p>
<p>识别并解耦最重要的能力：为业务和客户创造最大价值，同时定期更改。</p>
<img src="/2018/11/30/basic/005-how-to-break-monolith-into-microservices/005.png" class="">

<p><strong>使用<a target="_blank" rel="noopener" href="https://www.empear.com/">CodeScene</a>等<a target="_blank" rel="noopener" href="https://www.thoughtworks.com/radar/techniques/social-code-analysis">社交代码分析工具</a>来查找最活跃的组件。 如果构建系统碰巧触摸或在每次提交时自动生成代码，请务必过滤来自噪声的信号。 将经常更改的代码与产品路线图即将发生的更改重叠，并找到要解耦的交叉点。</strong></p>
<h2 id="解耦功能而不是代码"><a href="#解耦功能而不是代码" class="headerlink" title="解耦功能而不是代码"></a>解耦功能而不是代码</h2><p>每当开发人员想要从现有系统中提取服务时，他们就有两种方法：提取代码或重写功能。</p>
<p>通常默认情况下，服务提取或整体分解被设想为按原样重用现有实现并将其提取到单独服务中的情况。 部分原因是我们对我们设计和编写的代码存在认知偏差。 建筑劳动，无论过程多么痛苦或结果不完美，都会让我们对它产生爱。 这实际上被称为<a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/IKEA_effect">宜家效应</a>。 不幸的是，这种偏见将使整体分解努力回归起点没什么价值。 因为它使开发人员和更重要的技术经理忽视了提取和重用代码的高成本和低价值。</p>
<p>或者，交付团队可以选择重写功能并重新使用旧代码。 重写使他们有机会重新审视业务能力，启动与业务的对话以简化遗留流程，并挑战随着时间推移构建到系统中的旧假设和约束。 它还提供了技术更新的机会，使用最适合该特定服务的编程语言和技术堆栈来实现新服务。</p>
<p>例如，在零售系统中，“定价和促销”功能是一种智能复杂的代码。 它支持动态配置和应用定价和促销规则，根据客户行为，忠诚度，产品包等各种参数提供折扣和优惠。</p>
<p>这种能力可以说是重用和提取的良好候选者。 相比之下，“客户资料”是一种简单的CRUD功能，主要由用于序列化，处理存储和配置的样板代码组成，因此，它是重写和退出的良好候选者。</p>
<p>根据我的经验，在大多数分解场景中，团队最好将该功能重写为新服务并退出旧代码。由于以下原因，这考虑了重用的高成本和低价值：</p>
<ol>
<li>有大量的样板代码可以处理环境依赖性，例如在运行时访问应用程序配置，访问数据存储，缓存，以及使用旧框架构建。大多数样板代码都需要重写。托管微服务的新基础架构与几十年前的应用程序运行时非常不同，需要一种非常不同的样板代码。</li>
<li>现有功能很可能不是围绕明确的域概念构建的。这导致传输或存储不反映新域模型的数据结构，并且需要进行大的重组。</li>
<li>经过多次更改迭代的长期遗留代码可能具有较高的<a target="_blank" rel="noopener" href="https://erik.doernenburg.com/2008/11/how-toxic-is-your-code">代码毒性</a>级别和较低的重用价值。</li>
</ol>
<p>除非与功能相关并与明确的领域概念保持一致并具有高知识产权，否则我强烈建议重写和退出旧代码。</p>
<p>重复使用和提取具有低毒性的高价值代码，重写和退出具有高毒性的低价值代码：</p>
<img src="/2018/11/30/basic/005-how-to-break-monolith-into-microservices/006.png" class="">

<p><strong>使用代码毒性分析工具（如<a target="_blank" rel="noopener" href="http://checkstyle.sourceforge.net/">CheckStyle</a>）来围绕重写和重用做出决策。</strong></p>
<h2 id="首先是宏观（Macro），然后是微观（Micro）"><a href="#首先是宏观（Macro），然后是微观（Micro）" class="headerlink" title="首先是宏观（Macro），然后是微观（Micro）"></a>首先是宏观（Macro），然后是微观（Micro）</h2><p>在传统整体应用中寻找领域边界既是艺术又是科学。作为一般规则，应用域驱动设计技术来查找定义微服务边界的有界上下文是一个很好的起点。我承认，我经常看到从大型整体到真正小型服务的过度修正，实际上是小型服务，其设计受到现有规范化数据视图的启发和驱动。这种识别服务边界的方法几乎总是导致CRUD资源的大量<a target="_blank" rel="noopener" href="https://www.martinfowler.com/bliki/AnemicDomainModel.html">贫血服务</a>的寒武纪爆发。对于许多微服务架构的新手来说，这会产生一个高摩擦环境，最终无法通过独立发布和服务执行的测试。它创建了一个难以调试的分布式系统，一个跨越事务边界的分布式系统，因此难以保持一致，这个系统对于组织的运营成熟度而言过于复杂。虽然有一些关于微观应该如何成为微服务的<a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=UfQTNtbq170">启发式</a>：团队的规模，重写服务的时间，必须封装的行为等等。我的建议是，规模取决于交付的服务数量和运营团队可以独立发布，监控和运营。从围绕逻辑域概念的大型服务开始，并在团队准备就绪时将服务分解为多个服务。</p>
<p>例如，在零售系统脱钩的旅程中，开发商可以从一个服务“购买”开始，该服务包含“购物袋”的内容以及购买购物袋的能力，即“结账”。 随着他们组建小型团队和释放大量服务的能力不断增强，他们可以将“购物袋”与“结账”分离为单独的服务。</p>
<p>围绕丰富域概念去耦宏服务，并在准备就绪时，将服务分解为较小的域概念</p>
<img src="/2018/11/30/basic/005-how-to-break-monolith-into-microservices/007.png" class="">

<p><strong>使用<a target="_blank" rel="noopener" href="https://martinfowler.com/articles/richardsonMaturityModel.html">Richardson成熟度模型L3</a>，以便在不影响调用者的情况下实现服务的未来解耦，即调用者发现如何结账但不知道具体实现。</strong></p>
<h2 id="以原子演化步骤迁移"><a href="#以原子演化步骤迁移" class="headerlink" title="以原子演化步骤迁移"></a>以原子演化步骤迁移</h2><p>通过将传统整体应用像在空气中擦除那样拆分成精美设计的微服务在某种程度上是一种神话，并且可以说是不可取的。任何经验丰富的工程师都可以分享遗留迁移和现代化尝试的故事，这些故事是在总体完成过度乐观的情况下计划和启动的，并且最好在足够好的时间点放弃。这种努力的长期计划因宏观条件的变化而被放弃：该计划耗尽资金，该组织将其重点转向其他方面或支持它的领导层离开。所以这个现实应该根据团队如何接近整体到微服务的旅程来设计。我将这种方法称为“在体系结构演化的原子步骤中迁移”，其中迁移的每一步都应该使体系结构更接近其目标状态。每个进化单位可能是一个小步骤或一个大的飞跃，但是是原子的，要么完成要么还原。这一点非常重要，因为我们采用迭代和增量方法来改进整体架构和解耦服务。每个增量必须使我们在架构目标方面处于更好的位置。使用<a target="_blank" rel="noopener" href="https://www.thoughtworks.com/books/building-evolutionary-architectures">进化架构</a>适应度函数隐喻，迁移的每个原子步骤之后的架构适应度函数应该为架构的目标生成更接近的值。</p>
<p>让我用一个例子说明这一点。 想象一下，微服务架构的目标是提高开发人员修改整个系统以提供价值的速度。 团队决定将最终用户身份验证分离为基于OAuth 2.0协议的单独服务。 此服务旨在替换现有（旧体系结构）客户端应用程序对最终用户进行身份验证的方式，以及新的体系结构微服务验证最终用户。 让我们在演变中称之为“Auth服务介绍”。 引入新服务的一种方法是首先完成以下步骤：</p>
<p>（1）构建Auth服务，实现OAuth 2.0协议。</p>
<p>（2）在整体应用后端添加一个新的认证路径，以调用Auth服务，以便对代表其处理请求的最终用户进行身份验证。</p>
<p>如果团队停在这里并转向构建其他服务或功能，他们会使整体架构处于增加的熵状态。 在此状态下，有两种方法可以对用户进行身份验证，即新的OAuth 2.0基本路径和旧客户端的基于密码&#x2F;会话的路径。 此时，团队实际上远离了他们更快地进行更改的总体目标。 整体代码的任何新开发人员都需要处理两个代码路径，增加了解代码的认知负担，以及更改和测试代码的过程。</p>
<p>相反，团队可以在我们的原子演化单元中包含以下步骤：</p>
<p>（3）用OAuth 2.0路径替换旧客户端的密码&#x2F;基于会话的身份验证</p>
<p>（4）从整体中删除旧的认证代码路径</p>
<p>在这一点上，我们可以争辩说团队已经接近目标架构。</p>
<p>利用体系结构演化的原子步骤将体系结构发展为微服务，在每个步骤之后，整体体系结构朝着其目标进行改进，即使中间代码更改可能会使其远离其适应目标</p>
<img src="/2018/11/30/basic/005-how-to-break-monolith-into-microservices/008.png" class="">

<p>整体分解的原子单位包括：</p>
<ol>
<li>解耦新服务</li>
<li>将所有消费者重定向到新服务</li>
<li>退出整体应用中的旧代码路径。</li>
</ol>
<p>反模式（不可取）：将新服务解耦，用于新消费者，永不退休。</p>
<p>我经常发现团队结束了一个功能的迁移，并且只要构建了新的功能而没有退出旧的代码路径（上面描述的反模式），就可以获得胜利。 主要原因是<br>（a）关注引入新功能的短期利益和（b）在面对构建新功能的竞争优先级的同时退出旧实施所需的总工作量。<br>为了做正确的事情，我们需要努力使原子步骤尽可能小。</p>
<p>通过这种方式迁移，我们可以打破短途旅行的旅程。 我们可以安全地停止，复兴并在这漫长的旅程中幸存下来，杀死整体应用。</p>

      
    </div> -->
          <div class="article-entry" itemprop="articleBody">
            
              
                
                      
                        
                          
                            
                              
                                
                                  
                                    <p>
                                      <p>本文翻译自：<a target="_blank" rel="noopener" href="https://martinfowler.com/articles/break-monolith-into-microservices.html">https://martinfowler.com/articles/break-monolith-into-microservices.html</a></p>

                                        <p>
                                          
                                            
                                              
                                                      
          </div>
    <p class="article-more-link">
      <a href="/2018/11/30/basic/005-how-to-break-monolith-into-microservices/#more">
        Read More
      </a>
    </p>
    <!-- <div class="article-more-link">
      <a href="/2018/11/30/basic/005-how-to-break-monolith-into-microservices/#more">
        read more
      </a>
    </div> -->
    


      <footer class="article-footer">
        <a data-url="http://http//jimolonely.github.io/2018/11/30/basic/005-how-to-break-monolith-into-microservices/" data-id="cl1fw7fhp000ovkd363mshwm9" class="article-share-link">
          Share
        </a>
        
            
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/microservice/" rel="tag">microservice</a><span class="article-tag-list-count">9</span></li></ul>

      </footer>
      </div>
      
</article>


  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/page/9/">&amp;laquo; 上一页</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/8/">8</a><a class="page-number" href="/page/9/">9</a><span class="page-number current">10</span><a class="page-number" href="/page/11/">11</a><a class="page-number" href="/page/12/">12</a><span class="space">&hellip;</span><a class="page-number" href="/page/18/">18</a><a class="extend next" rel="next" href="/page/11/">下一页 &amp;raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/AI/" rel="tag">AI</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/UI-test/" rel="tag">UI test</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/algorithm/" rel="tag">algorithm</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/android/" rel="tag">android</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/annotation/" rel="tag">annotation</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ansible/" rel="tag">ansible</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ant/" rel="tag">ant</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/aop/" rel="tag">aop</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/archiva/" rel="tag">archiva</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/asciidoc/" rel="tag">asciidoc</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/awk/" rel="tag">awk</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/axios/" rel="tag">axios</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/basic/" rel="tag">basic</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/big-data/" rel="tag">big data</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/blockchain/" rel="tag">blockchain</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/centos/" rel="tag">centos</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cglib/" rel="tag">cglib</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/checkstyle/" rel="tag">checkstyle</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/chrome/" rel="tag">chrome</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/computer-principle/" rel="tag">computer principle</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cors/" rel="tag">cors</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/data-structure/" rel="tag">data structure</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/design-pattern/" rel="tag">design-pattern</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/docker/" rel="tag">docker</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/elasticsearch/" rel="tag">elasticsearch</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/es/" rel="tag">es</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/eureka/" rel="tag">eureka</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/firefox/" rel="tag">firefox</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/flask/" rel="tag">flask</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/geohash/" rel="tag">geohash</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/geomesa/" rel="tag">geomesa</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/git/" rel="tag">git</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/gitlab/" rel="tag">gitlab</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/gradle/" rel="tag">gradle</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/groovy/" rel="tag">groovy</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hadoop/" rel="tag">hadoop</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hbase/" rel="tag">hbase</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hexo/" rel="tag">hexo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/html/" rel="tag">html</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/http/" rel="tag">http</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/idea/" rel="tag">idea</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ip/" rel="tag">ip</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/java/" rel="tag">java</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/javascript/" rel="tag">javascript</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/js/" rel="tag">js</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/junit/" rel="tag">junit</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jupyter/" rel="tag">jupyter</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jupyterhub/" rel="tag">jupyterhub</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jvm/" rel="tag">jvm</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jwt/" rel="tag">jwt</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/k8s/" rel="tag">k8s</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/kafka/" rel="tag">kafka</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/katalon/" rel="tag">katalon</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/keepalived/" rel="tag">keepalived</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/latex/" rel="tag">latex</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/life/" rel="tag">life</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux/" rel="tag">linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux-kernel/" rel="tag">linux kernel</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/load-balance/" rel="tag">load balance</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/log/" rel="tag">log</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/log4j/" rel="tag">log4j</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/log4j12/" rel="tag">log4j12</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/logback/" rel="tag">logback</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/lombok/" rel="tag">lombok</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/lru/" rel="tag">lru</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/lucene/" rel="tag">lucene</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/magnet/" rel="tag">magnet</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/make/" rel="tag">make</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/makefile/" rel="tag">makefile</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/manjaro/" rel="tag">manjaro</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/math/" rel="tag">math</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/maven/" rel="tag">maven</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/md5/" rel="tag">md5</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mhtml/" rel="tag">mhtml</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/microservice/" rel="tag">microservice</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/music/" rel="tag">music</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mybatis/" rel="tag">mybatis</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mysql/" rel="tag">mysql</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/nginx/" rel="tag">nginx</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/notebook/" rel="tag">notebook</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/npm/" rel="tag">npm</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/nvidia/" rel="tag">nvidia</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/oauth/" rel="tag">oauth</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/openstack/" rel="tag">openstack</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/optimization/" rel="tag">optimization</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/pandas/" rel="tag">pandas</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/pandoc/" rel="tag">pandoc</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/pgsql/" rel="tag">pgsql</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/probability/" rel="tag">probability</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/pyspark/" rel="tag">pyspark</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python/" rel="tag">python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/quartz/" rel="tag">quartz</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/react/" rel="tag">react</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/redis/" rel="tag">redis</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/resource/" rel="tag">resource</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/review/" rel="tag">review</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sbt/" rel="tag">sbt</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/scala/" rel="tag">scala</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/shell/" rel="tag">shell</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/slf4j/" rel="tag">slf4j</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/spark/" rel="tag">spark</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/spring/" rel="tag">spring</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/spring-cloud/" rel="tag">spring cloud</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/spring-boot/" rel="tag">spring-boot</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/springboot/" rel="tag">springboot</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sql/" rel="tag">sql</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sqlserver/" rel="tag">sqlserver</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ssh/" rel="tag">ssh</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/statistics/" rel="tag">statistics</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/syslog/" rel="tag">syslog</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/term/" rel="tag">term</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/test/" rel="tag">test</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/texlive/" rel="tag">texlive</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/thread/" rel="tag">thread</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tomcat/" rel="tag">tomcat</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tool/" rel="tag">tool</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ubuntu/" rel="tag">ubuntu</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/urban-computing/" rel="tag">urban computing</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/video/" rel="tag">video</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vim/" rel="tag">vim</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vpn/" rel="tag">vpn</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vscode/" rel="tag">vscode</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vue/" rel="tag">vue</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/web/" rel="tag">web</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/web-dav/" rel="tag">web-dav</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/webpack/" rel="tag">webpack</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/week/" rel="tag">week</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/windows/" rel="tag">windows</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/wordcloud/" rel="tag">wordcloud</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/work/" rel="tag">work</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/xml/" rel="tag">xml</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/zipkin/" rel="tag">zipkin</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/zookeeper/" rel="tag">zookeeper</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%BA%91%E8%AE%A1%E7%AE%97/" rel="tag">云计算</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%85%83%E7%BC%96%E7%A8%8B/" rel="tag">元编程</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%9F%8E%E5%B8%82%E8%AE%A1%E7%AE%97/" rel="tag">城市计算</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%9E%B6%E6%9E%84/" rel="tag">架构</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%A6%82%E5%BF%B5/" rel="tag">概念</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%B5%8B%E8%AF%95/" rel="tag">测试</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%88%AC%E8%99%AB/" rel="tag">爬虫</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%BF%90%E7%BB%B4/" rel="tag">运维</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签云</h3>
    <div class="widget tagcloud">
      <a href="/tags/AI/" style="font-size: 10.53px;">AI</a> <a href="/tags/UI-test/" style="font-size: 10px;">UI test</a> <a href="/tags/algorithm/" style="font-size: 10.53px;">algorithm</a> <a href="/tags/android/" style="font-size: 10.53px;">android</a> <a href="/tags/annotation/" style="font-size: 10px;">annotation</a> <a href="/tags/ansible/" style="font-size: 13.16px;">ansible</a> <a href="/tags/ant/" style="font-size: 10px;">ant</a> <a href="/tags/aop/" style="font-size: 10px;">aop</a> <a href="/tags/archiva/" style="font-size: 10px;">archiva</a> <a href="/tags/asciidoc/" style="font-size: 10px;">asciidoc</a> <a href="/tags/awk/" style="font-size: 10px;">awk</a> <a href="/tags/axios/" style="font-size: 10px;">axios</a> <a href="/tags/basic/" style="font-size: 13.16px;">basic</a> <a href="/tags/big-data/" style="font-size: 10.53px;">big data</a> <a href="/tags/blockchain/" style="font-size: 10px;">blockchain</a> <a href="/tags/centos/" style="font-size: 12.11px;">centos</a> <a href="/tags/cglib/" style="font-size: 10px;">cglib</a> <a href="/tags/checkstyle/" style="font-size: 10px;">checkstyle</a> <a href="/tags/chrome/" style="font-size: 11.05px;">chrome</a> <a href="/tags/computer-principle/" style="font-size: 10px;">computer principle</a> <a href="/tags/cors/" style="font-size: 10.53px;">cors</a> <a href="/tags/data-structure/" style="font-size: 10px;">data structure</a> <a href="/tags/design-pattern/" style="font-size: 10.53px;">design-pattern</a> <a href="/tags/docker/" style="font-size: 17.89px;">docker</a> <a href="/tags/elasticsearch/" style="font-size: 13.16px;">elasticsearch</a> <a href="/tags/es/" style="font-size: 10px;">es</a> <a href="/tags/eureka/" style="font-size: 10px;">eureka</a> <a href="/tags/firefox/" style="font-size: 10px;">firefox</a> <a href="/tags/flask/" style="font-size: 10px;">flask</a> <a href="/tags/geohash/" style="font-size: 10px;">geohash</a> <a href="/tags/geomesa/" style="font-size: 10px;">geomesa</a> <a href="/tags/git/" style="font-size: 13.16px;">git</a> <a href="/tags/gitlab/" style="font-size: 11.05px;">gitlab</a> <a href="/tags/gradle/" style="font-size: 10px;">gradle</a> <a href="/tags/groovy/" style="font-size: 10px;">groovy</a> <a href="/tags/hadoop/" style="font-size: 10.53px;">hadoop</a> <a href="/tags/hbase/" style="font-size: 11.58px;">hbase</a> <a href="/tags/hexo/" style="font-size: 10.53px;">hexo</a> <a href="/tags/html/" style="font-size: 10.53px;">html</a> <a href="/tags/http/" style="font-size: 10px;">http</a> <a href="/tags/idea/" style="font-size: 11.05px;">idea</a> <a href="/tags/ip/" style="font-size: 10px;">ip</a> <a href="/tags/java/" style="font-size: 20px;">java</a> <a href="/tags/javascript/" style="font-size: 11.58px;">javascript</a> <a href="/tags/js/" style="font-size: 13.16px;">js</a> <a href="/tags/junit/" style="font-size: 10px;">junit</a> <a href="/tags/jupyter/" style="font-size: 10px;">jupyter</a> <a href="/tags/jupyterhub/" style="font-size: 10.53px;">jupyterhub</a> <a href="/tags/jvm/" style="font-size: 10px;">jvm</a> <a href="/tags/jwt/" style="font-size: 10px;">jwt</a> <a href="/tags/k8s/" style="font-size: 11.05px;">k8s</a> <a href="/tags/kafka/" style="font-size: 10px;">kafka</a> <a href="/tags/katalon/" style="font-size: 10px;">katalon</a> <a href="/tags/keepalived/" style="font-size: 10.53px;">keepalived</a> <a href="/tags/latex/" style="font-size: 11.05px;">latex</a> <a href="/tags/life/" style="font-size: 18.95px;">life</a> <a href="/tags/linux/" style="font-size: 19.47px;">linux</a> <a href="/tags/linux-kernel/" style="font-size: 10px;">linux kernel</a> <a href="/tags/load-balance/" style="font-size: 10px;">load balance</a> <a href="/tags/log/" style="font-size: 10px;">log</a> <a href="/tags/log4j/" style="font-size: 10px;">log4j</a> <a href="/tags/log4j12/" style="font-size: 10px;">log4j12</a> <a href="/tags/logback/" style="font-size: 10px;">logback</a> <a href="/tags/lombok/" style="font-size: 10px;">lombok</a> <a href="/tags/lru/" style="font-size: 10px;">lru</a> <a href="/tags/lucene/" style="font-size: 10px;">lucene</a> <a href="/tags/magnet/" style="font-size: 10px;">magnet</a> <a href="/tags/make/" style="font-size: 10px;">make</a> <a href="/tags/makefile/" style="font-size: 10px;">makefile</a> <a href="/tags/manjaro/" style="font-size: 10px;">manjaro</a> <a href="/tags/math/" style="font-size: 11.05px;">math</a> <a href="/tags/maven/" style="font-size: 15.26px;">maven</a> <a href="/tags/md5/" style="font-size: 10px;">md5</a> <a href="/tags/mhtml/" style="font-size: 10px;">mhtml</a> <a href="/tags/microservice/" style="font-size: 14.21px;">microservice</a> <a href="/tags/music/" style="font-size: 10px;">music</a> <a href="/tags/mybatis/" style="font-size: 11.05px;">mybatis</a> <a href="/tags/mysql/" style="font-size: 12.11px;">mysql</a> <a href="/tags/nginx/" style="font-size: 12.63px;">nginx</a> <a href="/tags/notebook/" style="font-size: 10px;">notebook</a> <a href="/tags/npm/" style="font-size: 10px;">npm</a> <a href="/tags/nvidia/" style="font-size: 10px;">nvidia</a> <a href="/tags/oauth/" style="font-size: 10px;">oauth</a> <a href="/tags/openstack/" style="font-size: 12.11px;">openstack</a> <a href="/tags/optimization/" style="font-size: 10px;">optimization</a> <a href="/tags/pandas/" style="font-size: 10px;">pandas</a> <a href="/tags/pandoc/" style="font-size: 10px;">pandoc</a> <a href="/tags/pgsql/" style="font-size: 11.58px;">pgsql</a> <a href="/tags/probability/" style="font-size: 10px;">probability</a> <a href="/tags/pyspark/" style="font-size: 10px;">pyspark</a> <a href="/tags/python/" style="font-size: 17.37px;">python</a> <a href="/tags/quartz/" style="font-size: 10.53px;">quartz</a> <a href="/tags/react/" style="font-size: 10px;">react</a> <a href="/tags/redis/" style="font-size: 15.79px;">redis</a> <a href="/tags/resource/" style="font-size: 10px;">resource</a> <a href="/tags/review/" style="font-size: 10px;">review</a> <a href="/tags/sbt/" style="font-size: 10px;">sbt</a> <a href="/tags/scala/" style="font-size: 14.74px;">scala</a> <a href="/tags/shell/" style="font-size: 12.63px;">shell</a> <a href="/tags/slf4j/" style="font-size: 10px;">slf4j</a> <a href="/tags/spark/" style="font-size: 14.74px;">spark</a> <a href="/tags/spring/" style="font-size: 15.79px;">spring</a> <a href="/tags/spring-cloud/" style="font-size: 12.11px;">spring cloud</a> <a href="/tags/spring-boot/" style="font-size: 13.68px;">spring-boot</a> <a href="/tags/springboot/" style="font-size: 11.05px;">springboot</a> <a href="/tags/sql/" style="font-size: 11.05px;">sql</a> <a href="/tags/sqlserver/" style="font-size: 10.53px;">sqlserver</a> <a href="/tags/ssh/" style="font-size: 12.11px;">ssh</a> <a href="/tags/statistics/" style="font-size: 10px;">statistics</a> <a href="/tags/syslog/" style="font-size: 10px;">syslog</a> <a href="/tags/term/" style="font-size: 10px;">term</a> <a href="/tags/test/" style="font-size: 10px;">test</a> <a href="/tags/texlive/" style="font-size: 10px;">texlive</a> <a href="/tags/thread/" style="font-size: 10px;">thread</a> <a href="/tags/tomcat/" style="font-size: 13.16px;">tomcat</a> <a href="/tags/tool/" style="font-size: 16.84px;">tool</a> <a href="/tags/ubuntu/" style="font-size: 16.32px;">ubuntu</a> <a href="/tags/urban-computing/" style="font-size: 10px;">urban computing</a> <a href="/tags/video/" style="font-size: 10px;">video</a> <a href="/tags/vim/" style="font-size: 10.53px;">vim</a> <a href="/tags/vpn/" style="font-size: 10px;">vpn</a> <a href="/tags/vscode/" style="font-size: 10px;">vscode</a> <a href="/tags/vue/" style="font-size: 11.05px;">vue</a> <a href="/tags/web/" style="font-size: 10px;">web</a> <a href="/tags/web-dav/" style="font-size: 10px;">web-dav</a> <a href="/tags/webpack/" style="font-size: 10.53px;">webpack</a> <a href="/tags/week/" style="font-size: 18.42px;">week</a> <a href="/tags/windows/" style="font-size: 10px;">windows</a> <a href="/tags/wordcloud/" style="font-size: 10px;">wordcloud</a> <a href="/tags/work/" style="font-size: 10px;">work</a> <a href="/tags/xml/" style="font-size: 10px;">xml</a> <a href="/tags/zipkin/" style="font-size: 10px;">zipkin</a> <a href="/tags/zookeeper/" style="font-size: 10px;">zookeeper</a> <a href="/tags/%E4%BA%91%E8%AE%A1%E7%AE%97/" style="font-size: 12.63px;">云计算</a> <a href="/tags/%E5%85%83%E7%BC%96%E7%A8%8B/" style="font-size: 10px;">元编程</a> <a href="/tags/%E5%9F%8E%E5%B8%82%E8%AE%A1%E7%AE%97/" style="font-size: 10px;">城市计算</a> <a href="/tags/%E6%9E%B6%E6%9E%84/" style="font-size: 10px;">架构</a> <a href="/tags/%E6%A6%82%E5%BF%B5/" style="font-size: 10px;">概念</a> <a href="/tags/%E6%B5%8B%E8%AF%95/" style="font-size: 10px;">测试</a> <a href="/tags/%E7%88%AC%E8%99%AB/" style="font-size: 10px;">爬虫</a> <a href="/tags/%E8%BF%90%E7%BB%B4/" style="font-size: 10px;">运维</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2022/03/">三月 2022</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/10/">十月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/09/">九月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/08/">八月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/07/">七月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/06/">六月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/05/">五月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/04/">四月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/03/">三月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/02/">二月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/01/">一月 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/12/">十二月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/11/">十一月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/10/">十月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/09/">九月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">八月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/07/">七月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/06/">六月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/05/">五月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/04/">四月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/03/">三月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/02/">二月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/01/">一月 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/">十二月 2017</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2022/03/31/redis/000-redis-interview/">Redis面试总结202203</a>
          </li>
        
          <li>
            <a href="/2019/10/27/maven/009-maven-deploy/">使用IDEA部署jar包到maven仓库(maven deploy)</a>
          </li>
        
          <li>
            <a href="/2019/10/24/java/075-pluggable-annotation-processing-lombok/">Pluggable Annotation Processing的讲解与实践</a>
          </li>
        
          <li>
            <a href="/2019/10/18/life/036-weekly-learn/">2019-42-周报</a>
          </li>
        
          <li>
            <a href="/2019/10/15/shell/003-carriage-linechange/">r command not found</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2022 Jackpler<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">home</a>
  
    <a href="/archives" class="mobile-nav-link">archives</a>
  
    <a href="/about" class="mobile-nav-link">about</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>




  </div>
</body>
</html>